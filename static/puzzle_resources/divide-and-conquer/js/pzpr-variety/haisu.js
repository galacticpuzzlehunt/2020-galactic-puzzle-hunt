/*! @license pzpr.js v (c) 2009-2021 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */

!function(a,b){"object"==typeof module&&module.exports?module.exports=[a,b]:pzpr.classmgr.makeCustom(a,b)}(["haisu"],{MouseEvent:{draggingSG:!1,use:!0,inputModes:{edit:["border","number"],play:["line","peke","diraux","info-line"]},mouseinput_other:function(){"diraux"===this.inputMode&&(this.mousestart||this.mousemove?this.inputdiraux_mousemove():this.mouseend&&this.notInputted()&&this.clickdiraux())},mouseinput_auto:function(){this.puzzle.playmode&&"right"===this.btn?this.mousestart?this.inputdiraux_mousedown():2===this.inputData||3===this.inputData?this.inputpeke():this.mousemove&&this.inputdiraux_mousemove():this.puzzle.playmode&&"left"===this.btn?this.mousestart||this.mousemove?this.inputLine():this.mouseend&&this.notInputted()&&this.clickdiraux():this.puzzle.editmode&&(this.mousestart||this.mousemove?this.inputEdit():this.mouseend&&this.inputEdit_end())},inputEdit:function(){var a=this.getcell();a.isnull||(null===this.inputData&&this.inputEdit_first(),this.draggingSG&&10===this.inputData?this.board.startpos.input(a):this.draggingSG&&11===this.inputData?this.board.goalpos.input(a):null!==this.inputData&&this.inputborder())},inputEdit_first:function(){var a=this.getpos(.33),b=this.board;b.startpos.equals(a)?(this.inputData=10,this.draggingSG=!0):b.goalpos.equals(a)?(this.inputData=11,this.draggingSG=!0):this.inputborder()},inputEdit_end:function(){var a=this.getcell();a.isnull||(this.draggingSG?(this.draggingSG=!1,a.draw()):this.notInputted()&&(a!==this.cursor.getc()?this.setcursor(a):this.inputqnum()))}},KeyEvent:{enablemake:!0,keyinput:function(a){this.keydown&&this.puzzle.editmode&&this.key_inputqnum_haisu(a)},key_inputqnum_haisu:function(a){var b=this.cursor.getc(),c=this.board,d=b.ques;"s"===a?c.startpos.input(b):"g"===a?c.goalpos.input(b):this.key_inputqnum_main(b,a),-1===d||c.startpos.equals(b)||c.goalpos.equals(b)||(b.setQues(-1),b.draw())}},Board:{cols:7,rows:7,hasborder:1,startpos:null,goalpos:null,createExtraObject:function(){var a=this.klass;this.startpos=new a.StartAddress(1,1),this.goalpos=new a.GoalAddress(2*this.cols-1,2*this.rows-1),this.startpos.partner=this.goalpos,this.goalpos.partner=this.startpos},initExtraObject:function(a,b){this.disableInfo(),this.startpos.init(1,2*b-1),this.goalpos.init(2*a-1,1),this.enableInfo()},exchangestartgoal:function(){var a=this.startpos.getc(),b=this.goalpos.getc();this.startpos.set(b),this.goalpos.set(a),this.startpos.draw(),this.goalpos.draw()}},LineGraph:{enabled:!0,makeClist:!0},AreaRoomGraph:{enabled:!0},Cell:{maxnum:function(){return this.room.clist.length}},GraphComponent:{visit:0},BoardExec:{posinfo:{},adjustBoardData:function(a,b){var c=this.board;this.posinfo_start=this.getAfterPos(a,b,c.startpos.getc()),this.posinfo_goal=this.getAfterPos(a,b,c.goalpos.getc())},adjustBoardData2:function(a,b){var c,d=this.board,e=this.puzzle.opemgr,f=this.posinfo_start,g=this.posinfo_goal;c=a&this.REDUCE&&(f.isdel||g.isdel)&&!e.undoExec&&!e.redoExec,c&&(e.forceRecord=!0),d.startpos.set(f.pos.getc()),d.goalpos.set(g.pos.getc()),c&&(e.forceRecord=!1)}},OperationManager:{addExtraOperation:function(){this.operationlist.push(this.klass.StartGoalOperation)}},Graphic:{irowake:!0,gridcolor_type:"LIGHT",paint:function(){this.drawBGCells(),this.drawShadedCells(),this.drawGrid(),this.drawBorders(),this.drawQuesNumbers(),this.drawStartGoal(),this.drawLines(),this.drawPekes(),this.drawBorderAuxDir(),this.drawChassis(),this.drawBoxBorders(!0),this.drawTarget()}},Encode:{decodePzpr:function(a){this.decodeSG(),this.decodeBorder(),this.decodeNumber16()},encodePzpr:function(a){this.encodeSG(),this.encodeBorder(),this.encodeNumber16()},decodeSG:function(){this.board.startpos.bx=2*this.decodeOneNumber16()-1,this.board.startpos.by=2*this.decodeOneNumber16()-1,this.board.goalpos.bx=2*this.decodeOneNumber16()-1,this.board.goalpos.by=2*this.decodeOneNumber16()-1},encodeSG:function(){this.outbstr+=this.writeNumber16((this.board.startpos.bx+1)/2),this.outbstr+=this.writeNumber16((this.board.startpos.by+1)/2),this.outbstr+=this.writeNumber16((this.board.goalpos.bx+1)/2),this.outbstr+=this.writeNumber16((this.board.goalpos.by+1)/2)}},FileIO:{decodeData:function(){this.decodeSG(),this.decodeBorderQues(),this.decodeCellQnum(),this.filever>=1?this.decodeBorderArrowAns():this.decodeBorderLine()},encodeData:function(){this.filever=1,this.encodeSG(),this.encodeBorderQues(),this.encodeCellQnum(),this.encodeBorderArrowAns()},decodeSG:function(){var a=this.readLine(),b=a.split(" ");this.board.startpos.bx=parseInt(b[0]),this.board.startpos.by=parseInt(b[1]),this.board.goalpos.bx=parseInt(b[2]),this.board.goalpos.by=parseInt(b[3])},encodeSG:function(){this.writeLine(this.board.startpos.bx+" "+this.board.startpos.by+" "+this.board.goalpos.bx+" "+this.board.goalpos.by)}},AnsCheck:{checklist:["checkBranchLine","checkCrossLine","haisuPassThroughSG","haisuWalk","haisuDeadendOutOfSG","checkNoLine","checkOneLine"],haisuPassThroughSG:function(){var a=this.board,b=a.getc(a.startpos.bx,a.startpos.by),c=a.getc(a.goalpos.bx,a.goalpos.by),d=!1;b.lcnt>1&&(b.seterr(1),b.draw(),d=!0),c.lcnt>1&&(c.seterr(1),b.draw(),d=!0),d&&this.failcode.add("haisuSG")},haisuWalk:function(){var a=this.board,b=a.getc(a.startpos.bx,a.startpos.by),c=!1;if(1===b.lcnt){for(var d=a.roommgr.components,e=0;e<d.length;e++)d[e].visit=0;for(var f=null,g=null,h=null,i=b;i===b||2===i.lcnt;){g=i.room,f!==g&&(g.visit++,f=g),i.qnum>0&&i.qnum!==g.visit&&(i.seterr(1),c=!0);var j=[];i.relbd(-1,0).isLine()&&j.push(i.relcell(-2,0)),i.relbd(0,-1).isLine()&&j.push(i.relcell(0,-2)),i.relbd(1,0).isLine()&&j.push(i.relcell(2,0)),i.relbd(0,1).isLine()&&j.push(i.relcell(0,2)),1===j.length?(h=i,i=j[0]):j[0]===h?(h=i,i=j[1]):(h=i,i=j[0])}c&&this.failcode.add("haisuError")}},haisuDeadendOutOfSG:function(){var a=this.board,b=a.getc(a.startpos.bx,a.startpos.by),c=a.getc(a.goalpos.bx,a.goalpos.by);this.checkAllCell(function(a){return a!==b&&a!==c&&1===a.lcnt},"lnDeadEnd")}},FailCode:{haisuSG:["(please translate) The line goes through S/G","The line goes through S/G"],haisuError:["(please translate) A number is not passed on the right visit","A number is not passed on the right visit"]}});
//# sourceMappingURL=haisu.js.map