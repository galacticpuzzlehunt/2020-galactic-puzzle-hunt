/*! @license pzpr.js v (c) 2009-2021 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */

!function(a,b){"object"==typeof module&&module.exports?module.exports=[a,b]:pzpr.classmgr.makeCustom(a,b)}(["aquarium"],{MouseEvent:{use:!0,inputModes:{edit:["border","number"],play:["shade","unshade"]},mouseinput:function(){"shade"===this.inputMode||"unshade"===this.inputMode?this.inputcell():this.common.mouseinput.call(this)},mouseinput_number:function(){this.mousestart&&this.inputqnum_excell()},mouseinput_auto:function(){this.puzzle.playmode?(this.mousestart||this.mousemove)&&this.inputcell():this.puzzle.editmode&&(this.mousestart||this.mousemove?this.inputborder():this.mouseend&&this.notInputted()&&this.inputqnum_excell())},inputqnum_excell:function(){var a=this.getcell_excell();a.isnull||"excell"!==a.group||(a!==this.cursor.getex()?this.setcursor(a):this.inputqnum_main(a))}},KeyEvent:{enablemake:!0,moveTarget:function(a){var b=this.cursor,c=b.getex(),d=c.NDIR;switch(a){case"up":b.bx===b.minx&&b.miny<b.by&&(d=c.UP);break;case"down":b.bx===b.minx&&b.maxy>b.by&&(d=c.DN);break;case"left":b.by===b.miny&&b.minx<b.bx&&(d=c.LT);break;case"right":b.by===b.miny&&b.maxx>b.bx&&(d=c.RT)}return d!==c.NDIR&&(b.movedir(d,2),c.draw(),b.draw(),!0)},keyinput:function(a){this.key_inputexcell(a)},key_inputexcell:function(a){var b=this.cursor.getex(),c=b.qnum,d=b.getmaxnum();if("0"<=a&&a<="9"){var e=+a;c<=0||this.prev!==b?e<=d&&b.setQnum(e):10*c+e<=d?b.setQnum(10*c+e):e<=d&&b.setQnum(e)}else{if(" "!==a&&"-"!==a)return;b.setQnum(0)}this.prev=b,this.cursor.draw()}},TargetCursor:{initCursor:function(){this.init(-1,-1)}},ExCell:{disInputHatena:!0,maxnum:function(){var a=this.bx,b=this.by;return-1===a&&-1===b?0:-1===b?this.board.rows:this.board.cols},minnum:0},Board:{hasborder:1,hasexcell:1,cols:7,rows:7,addExtraInfo:function(){this.poolgraph=this.addInfoList(this.klass.AreaPoolGraph)}},AreaRoomGraph:{enabled:!0},BoardExec:{adjustBoardData:function(a,b){this.adjustExCellTopLeft_1(a,b)},adjustBoardData2:function(a,b){this.adjustExCellTopLeft_2(a,b)}},"AreaPoolGraph:AreaShadeGraph":{enabled:!0,relation:{"cell.qans":"node","border.ques":"separator"},setComponentRefs:function(a,b){a.pool=b},getObjNodeList:function(a){return a.poolnodes},resetObjNodeList:function(a){a.poolnodes=[]},isedgevalidbylinkobj:function(a){return!a.isBorder()}},Graphic:{enablebcolor:!0,shadecolor:"#0096ff",qanscolor:"#0096ff",paint:function(){this.drawBGCells(),this.drawDotCells(),this.drawShadedCells(),this.drawGrid(),this.drawNumbersExCell(),this.drawBorders(),this.drawChassis(),this.drawTarget()}},Encode:{decodePzpr:function(a){this.decodeBorder(),this.outbstr=this.outbstr.substr(1),this.decodeNumber16ExCell(),this.puzzle.setConfig("aquarium_regions",this.checkpflag("r"))},encodePzpr:function(a){this.outpflag=this.puzzle.getConfig("aquarium_regions")?"r":null,this.encodeBorder(),this.outbstr+="/",this.encodeNumber16ExCell()}},FileIO:{decodeData:function(){this.decodeConfig(),this.decodeBorderQues(),this.decodeCellExCell(function(a,b){"."!==b&&("excell"!==a.group||a.isnull?"cell"===a.group&&("#"===b?a.qans=1:"+"===b&&(a.qsub=1)):a.qnum=+b)})},encodeData:function(){this.encodeConfig(),this.encodeBorderQues(),this.encodeCellExCell(function(a){if("excell"===a.group&&!a.isnull&&-1!==a.qnum)return a.qnum+" ";if("cell"===a.group){if(1===a.qans)return"# ";if(1===a.qsub)return"+ "}return". "})},decodeConfig:function(){"r"===this.dataarray[this.lineseek]?(this.puzzle.setConfig("aquarium_regions",!0),this.readLine()):this.puzzle.setConfig("aquarium_regions",!1)},encodeConfig:function(){this.puzzle.getConfig("aquarium_regions")&&this.writeLine("r")}},AnsCheck:{checklist:["checkShadeCellExist+","checkSupports","checkPoolLevel","checkRegionLevel","checkShadeCount+"],checkSupports:function(){var a=["left","right","bottom"];this.checkAllCell(function(b){if(!b.isShade())return!1;for(var c in a){var d=a[c],e=b.adjborder[d];if(!e.isnull&&!e.isBorder()&&!b.adjacent[d].isShade())return!0}return!1},"csNoSupport")},checkPoolLevel:function(){if(!this.puzzle.getConfig("aquarium_regions"))for(var a=this.board.poolgraph.components,b=!1,c=0;c<a.length;c++){for(var d=a[c].clist,e=d.getRectSize().y1,f=0;f<d.length;f++){var g=d[f];if(g.by!==e&&!g.adjborder.top.isnull&&!g.adjborder.top.isBorder()&&!g.adjacent.top.isShade()){this.failcode.add("csNoLevel"),d.seterr(1),b=!0;break}}if(this.checkOnly&&b)break}},checkRegionLevel:function(){if(this.puzzle.getConfig("aquarium_regions"))for(var a=this.board.roommgr.components,b=0;b<a.length;b++){for(var c=a[b].clist,d=this.board.maxby+1,e=-1,f=0;f<c.length;f++){var g=c[f];if(g.isShade()&&g.by<d?d=g.by:!g.isShade()&&g.by>e&&(e=g.by),e>=d)break}if(e>=d){if(this.failcode.add("bkNoLevel"),this.checkOnly)break;c.seterr(1)}}},checkShadeCount:function(){this.checkRowsCols(this.isExCellCount,"exShadeNe")},isExCellCount:function(a){var b=a.getRectSize(),c=this.board,d=a.filter(function(a){return a.isShade()}).length,e=!0;if(b.x1===b.x2){var f=c.getex(b.x1,-1);-1!==f.qnum&&f.qnum!==d&&(f.seterr(1),e=!1)}if(b.y1===b.y2){var f=c.getex(-1,b.y1);-1!==f.qnum&&f.qnum!==d&&(f.seterr(1),e=!1)}return e||a.seterr(1),e}},FailCode:{csNoSupport:["水の入っているマスの隣や下のマスが空白になっています。","A water cell is next to or above an empty cell."],csNoLevel:["ひとつながりの水のマスの水位が等しくなっていません。","A body of water has different surface levels."],bkNoLevel:["同じブロック内で、水のマスの水位が等しくないブロックがあります。","A region has different water surface levels."],exShadeNe:["行または列内にある水のマスの数と外の数字が異なります。","The number of shaded cells in the row or column is not correct."]}});
//# sourceMappingURL=aquarium.js.map