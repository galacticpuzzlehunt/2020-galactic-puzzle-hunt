/*! @license pzpr.js v (c) 2009-2021 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */

!function(a,b){"object"==typeof module&&module.exports?module.exports=[a,b]:pzpr.classmgr.makeCustom(a,b)}(["nawabari","fourcells","fivecells","heteromino"],{MouseEvent:{mouseinput_auto:function(){this.puzzle.playmode?(this.mousestart||this.mousemove)&&("left"===this.btn&&this.isBorderMode()?this.inputborder():this.inputQsubLine()):this.puzzle.editmode&&this.mousestart&&("heteromino"===this.pid?this.inputempty():this.inputqnum())},mouseinput_other:function(){"empty"===this.inputMode&&this.inputempty()},inputempty:function(){var a=this.getcell();a.isnull||a===this.mouseCell||(null===this.inputData&&(this.inputData=a.isEmpty()?0:7),a.setValid(this.inputData),this.mouseCell=a)}},"MouseEvent@nawabari":{inputModes:{edit:["number","clear"],play:["border","subline"]}},"MouseEvent@fourcells,fivecells":{inputModes:{edit:["empty","number","clear"],play:["border","subline"]}},"MouseEvent@heteromino":{inputModes:{edit:["empty","clear"],play:["border","subline"]}},"MouseEvent@fourcells,fivecells,heteromino":{inputModes:{edit:["empty","number","clear"],play:["border","subline"]}},KeyEvent:{enablemake:!0},"KeyEvent@fourcells,fivecells,heteromino":{keyinput:function(a){"w"===a?this.key_inputvalid(a):"heteromino"!==this.pid&&this.key_inputqnum(a)},key_inputvalid:function(a){if("w"===a){var b=this.cursor.getc();b.isnull||b.setValid(7!==b.ques?7:0)}}},Cell:{getdir4BorderCount:function(){for(var a=0,b=this.getdir4cblist(),c=0;c<b.length;c++){var d=b[c][0],e=b[c][1];(d.isnull||d.isEmpty()||e.isBorder())&&a++}return a},setValid:function(a){this.setQues(a),this.setQnum(-1),this.adjborder.top.qans=0,this.adjborder.bottom.qans=0,this.adjborder.right.qans=0,this.adjborder.left.qans=0,this.drawaround(),this.board.roommgr.rebuild()}},"Cell@nawabari":{maxnum:4,minnum:0},"Cell@fourcells":{maxnum:3},"Cell@fivecells":{maxnum:3,minnum:0},"CellList@heteromino":{triminoShape:function(){if(3!==this.length)return-1;for(var a=this.getRectSize(),b=0,c=0;c<this.length;c++){var d=this[c],e=d.bx-a.x1>>1,f=d.by-a.y1>>1;e>=2||f>=2||(b+=1<<e+2*f)}return b}},Border:{isGrid:function(){return this.sidecell[0].isValid()&&this.sidecell[1].isValid()},isBorder:function(){return this.qans>0||this.isQuesBorder()},isQuesBorder:function(){return!!(this.sidecell[0].isEmpty()^this.sidecell[1].isEmpty())},prehook:{qans:function(){return!this.isGrid()},qsub:function(){return!this.isGrid()}}},Board:{hasborder:2},"Board@fourcells,fivecells":{initBoardSize:function(a,b){this.common.initBoardSize.call(this,a,b);var c=a*b%("fivecells"===this.pid?5:4);c>=1&&(this.getc(this.minbx+1,this.minby+1).ques=7),c>=2&&(this.getc(this.maxbx-1,this.minby+1).ques=7),c>=3&&(this.getc(this.minbx+1,this.maxby-1).ques=7),c>=4&&(this.getc(this.maxbx-1,this.maxby-1).ques=7)}},AreaRoomGraph:{enabled:!0},Graphic:{gridcolor_type:"DLIGHT",numbercolor_func:"qnum",paint:function(){this.drawBGCells(),this.drawValidDashedGrid(),this.drawQansBorders(),this.drawQuesBorders(),this.drawQuesNumbers(),this.drawBorderQsubs(),"heteromino"===this.pid&&this.drawChassis(),this.drawTarget()},getQuesBorderColor:function(a){return a.isQuesBorder()?this.quescolor:null},drawValidDashedGrid:function(){var a=this.vinc("grid_waritai","crispEdges",!0),b=this.getDashArray();a.lineWidth=1,a.strokeStyle=this.gridcolor;for(var c=this.range.borders,d=0;d<c.length;d++){var e=c[d];if(a.vid="b_grid_wari_"+e.id,e.isGrid()){var f=e.bx*this.bw,g=e.by*this.bh;e.isVert()?a.strokeDashedLine(f,g-this.bh,f,g+this.bh,b):a.strokeDashedLine(f-this.bw,g,f+this.bw,g,b)}else a.vhide()}}},"Graphic@heteromino":{getBGCellColor:function(a){return a.isValid()?this.getBGCellColor_error1(a):"black"}},Encode:{decodePzpr:function(a){this.decodeFivecells()},encodePzpr:function(a){this.encodeFivecells()},decodeFivecells:function(){for(var a=0;a<this.board.cell.length;a++)this.board.cell[a].setQues(0);var a=0,b=0,c=this.outbstr,d=this.board;for(b=0;b<c.length;b++){var e=d.cell[a],f=c.charAt(b);if(e.ques=0,"7"===f?e.ques=7:"."===f?e.qnum=-2:this.include(f,"0","9")?e.qnum=parseInt(f,10):this.include(f,"a","z")&&(a+=parseInt(f,36)-10),++a>=d.cell.length)break}this.outbstr=c.substr(b)},encodeFivecells:function(){for(var a="",b=0,c=this.board,d=0;d<c.cell.length;d++){var e="",f=c.cell[d].qnum;7===c.cell[d].ques?e="7":-2===f?e=".":-1!==f?e=f.toString(10):b++,0===b?a+=e:(e||26===b)&&(a+=(9+b).toString(36)+e,b=0)}b>0&&(a+=(9+b).toString(36)),this.outbstr+=a}},FileIO:{decodeData:function(){this.decodeCell(function(a,b){a.ques=0,"*"===b?a.ques=7:"-"===b?a.qnum=-2:"."!==b&&(a.qnum=+b)}),this.decodeBorderAns()},encodeData:function(){"fourcells"===this.pid&&(this.filever=1),this.encodeCell(function(a){return 7===a.ques?"* ":-2===a.qnum?"- ":a.qnum>=0?a.qnum+" ":". "}),this.encodeBorderAns()}},AnsCheck:{checklist:["checkRoomRect@nawabari","checkNoNumber@nawabari","checkDoubleNumber@nawabari","checkOverThreeCells@heteromino","checkOverFourCells@fourcells","checkOverFiveCells@fivecells","checkdir4BorderAns@!heteromino","checkBorderDeadend+","checkLessThreeCells@heteromino","checkLessFourCells@fourcells","checkLessFiveCells@fivecells","checkTouchDifferent@heteromino"],checkOverThreeCells:function(){this.checkAllArea(this.board.roommgr,function(a,b,c,d){return c>=3},"bkSizeLt3")},checkLessThreeCells:function(){this.checkAllArea(this.board.roommgr,function(a,b,c,d){return c<=3},"bkSizeGt3")},checkOverFourCells:function(){this.checkAllArea(this.board.roommgr,function(a,b,c,d){return c>=4},"bkSizeLt4")},checkLessFourCells:function(){this.checkAllArea(this.board.roommgr,function(a,b,c,d){return c<=4},"bkSizeGt4")},checkOverFiveCells:function(){this.checkAllArea(this.board.roommgr,function(a,b,c,d){return c>=5},"bkSizeLt5")},checkLessFiveCells:function(){this.checkAllArea(this.board.roommgr,function(a,b,c,d){return c<=5},"bkSizeGt5")},checkdir4BorderAns:function(){this.checkAllCell(function(a){return a.isValidNum()&&a.getdir4BorderCount()!==a.qnum},"nmBorderNe")},checkTouchDifferent:function(){for(var a=this.board,b=0;b<a.border.length;b++){var c=a.border[b];if(c.isBorder()){var d=c.sidecell[0],e=c.sidecell[1];if(d.isValid()&&e.isValid()){var f=d.room.clist,g=e.room.clist;if(3===f.length&&3===g.length&&f.triminoShape()===g.triminoShape()){if(this.failcode.add("bkSameTouch"),this.checkOnly)return;f.seterr(1),g.seterr(1)}}}}}},FailCode:{nmBorderNe:["数字の周りにある境界線の本数が違います。","The number is not equal to the number of border lines around it."],bkNoNum:["数字の入っていない部屋があります。","A room has no numbers."],bkNumGe2:["1つの部屋に2つ以上の数字が入っています。","A room has more than one number."],bkSizeLt3:["サイズが3マスより小さいブロックがあります。","The size of an area is smaller than three."],bkSizeLt4:["サイズが4マスより小さいブロックがあります。","The size of an area is smaller than four."],bkSizeLt5:["サイズが5マスより小さいブロックがあります。","The size of an area is smaller than five."],bkSizeGt3:["サイズが3マスより大きいブロックがあります。","The size of an area is larger than three."],bkSizeGt4:["サイズが4マスより大きいブロックがあります。","The size of an area is larger than four."],bkSizeGt5:["サイズが5マスより大きいブロックがあります。","The size of an area is larger than five."],bkSameTouch:["向きも形も同じブロックが接しています。","Two areas of the same shape and orientation area adjacent."]}});
//# sourceMappingURL=nawabari.js.map