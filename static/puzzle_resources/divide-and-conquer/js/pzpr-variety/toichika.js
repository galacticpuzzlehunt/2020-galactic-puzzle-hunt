/*! @license pzpr.js v (c) 2009-2021 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */

!function(a,b){"object"==typeof module&&module.exports?module.exports=[a,b]:pzpr.classmgr.makeCustom(a,b)}(["toichika","toichika2"],{MouseEvent:{inputModes:{edit:["border","arrow","clear"],play:["arrow","objblank","clear"]},mouseinput_other:function(){"objblank"===this.inputMode&&this.inputDot()},mouseinput_auto:function(){this.puzzle.playmode?this.mousestart||this.mousemove?"left"===this.btn?this.inputarrow_cell():"right"===this.btn&&this.inputDot():this.mouseend&&this.notInputted()&&this.inputqnum():this.puzzle.editmode&&(this.mousestart||this.mousemove?this.isBorderMode()?this.inputborder():this.inputarrow_cell():this.mouseend&&this.notInputted()&&this.inputqnum())},inputDot:function(){var a=this.getcell();a.isnull||a===this.mouseCell||"toichika2"!==this.pid&&-1!==a.qnum||(null===this.inputData&&(this.inputData=1===a.qsub?0:1),a.setAnum(-1),a.setQsub(1===this.inputData?1:0),this.mouseCell=a,a.draw())},inputclean_cell:function(){this.common.inputclean_cell.call(this);var a=this.getcell();a.isnull||a.room.checkAutoCmp()}},"MouseEvent@toichika2":{inputModes:{edit:["border","number","clear"],play:["number","objblank","clear"]},mouseinput_auto:function(){this.puzzle.playmode?"left"===this.btn?this.mousemove&&this.dragDots():"right"===this.btn&&this.mousemove&&this.inputDot():this.puzzle.editmode&&(this.mousestart||this.mousemove)&&this.inputborder(),this.mouseend&&this.notInputted()&&(this.mouseCell=null,this.inputqnum())},dragDots:function(){var a=this.getcell();if(!a.isnull&&a!==this.mouseCell){if(this.mouseCell.isnull){if(-1!==a.anum)return;return this.inputData=1===a.qsub?-2:10,void(this.mouseCell=a)}-2===this.inputData?(a.setAnum(-1),a.setQsub(1)):10===this.inputData&&(a.setAnum(-1),a.setQsub(0)),this.mouseCell=a,a.draw()}}},KeyEvent:{enablemake:!0,enableplay:!0},"KeyEvent@toichika":{moveTarget:function(a){return!a.match(/shift/)&&this.moveTCell(a)},keyinput:function(a){this.key_toichika(a)},key_toichika:function(a){"1"===a||"w"===a||"shift+up"===a?a="1":"2"===a||"s"===a||"shift+right"===a?a="4":"3"===a||"z"===a||"shift+down"===a?a="2":"4"===a||"a"===a||"shift+left"===a?a="3":"5"===a||"q"===a||"-"===a?a="s1":"6"!==a&&"e"!==a&&" "!==a||(a=" "),this.key_inputqnum(a)}},"KeyEvent@toichika2":{keyinput:function(a){"q"!==a&&"-"!==a||(a="s1"),this.key_inputqnum(a)}},Cell:{numberAsObject:!0,maxnum:4,posthook:{qnum:function(a){this.room.checkAutoCmp()},anum:function(a){this.room.checkAutoCmp()}}},"Cell@toichika2":{disInputHatena:!0,supportQnumAnum:!0,maxnum:function(){return Math.max(this.board.cols-2,this.board.rows-2)},setNum:function(a){0!==a&&(this.puzzle.editmode?this.setQnum(a):-2!==a?(this.setQsub(0),this.setAnum(a)):(this.setQsub(1),this.setAnum(-1)))},getNum:function(){return this.puzzle.editmode?this.qnum:this.anum},isNum:function(){return!this.isnull&&this.anum!==this.temp.anum},noNum:function(){return!this.isnull&&this.anum===this.temp.anum}},Board:{hasborder:1},CellList:{checkCmp:function(){return 1===this.filter(function(a){return a.isNum()}).length}},"BoardExec@toichika":{adjustBoardData:function(a,b){this.adjustCellArrow(a,b)}},AreaRoomGraph:{enabled:!0,getSideAreaKeys:function(){for(var a=this.components.length,b={len:a},c=this.board,d=0;d<a;d++)this.components[d].id=d;for(var e=0;e<c.border.length;e++){var f=c.border[e].sidecell[0],g=c.border[e].sidecell[1];if(!f.isnull&&!g.isnull){var h=f.room,i=g.room;if(h!==i&&null!==h&&null!==i){var j=h.id<i.id?h.id*a+i.id:i.id*a+h.id;b[j]||(b[j]=!0)}}}return b}},"AreaRoomGraph@toichika2":{hastop:!0},Graphic:{gridcolor_type:"LIGHT",autocmp:"room",bgcellcolor_func:"qcmp",paint:function(){this.drawBGCells(),this.drawGrid(),this.drawBorders(),this.drawDotCells(),"toichika"===this.pid?(this.drawCellArrows(),this.drawHatenas()):(this.drawAnsNumbers(),this.drawQuesNumbers()),this.drawChassis(),this.drawCursor()}},"Graphic@toichika2":{hideHatena:!0,textoption:{ratio:.45,position:5}},Encode:{decodePzpr:function(a){this.decodeBorder(),this.decodeRoomNumber16()},encodePzpr:function(a){this.encodeBorder(),this.encodeRoomNumber16()}},"Encode@toichika":{decodePzpr:function(a){this.decodeBorder(),this.decode4Cell_toichika()},encodePzpr:function(a){this.encodeBorder(),this.encode4Cell_toichika()},decode4Cell_toichika:function(){var a=0,b=0,c=this.outbstr,d=this.board;for(b=0;b<c.length;b++){var e=d.cell[a],f=c.charAt(b);if(this.include(f,"1","4")?e.qnum=parseInt(c.substr(b,1),10):"."===f?e.qnum=-2:a+=parseInt(f,36)-5,a++,!d.cell[a])break}this.outbstr=c.substr(b)},encode4Cell_toichika:function(){for(var a="",b=0,c=this.board,d=0;d<c.cell.length;d++){var e="",f=c.cell[d].qnum;-2===f?e=".":f>=1&&f<=4?e=f.toString(10):b++,0===b?a+=e:(e||31===b)&&(a+=(4+b).toString(36)+e,b=0)}b>0&&(a+=(4+b).toString(36)),this.outbstr+=a}},FileIO:{decodeData:function(){this.decodeAreaRoom(),this.decodeCellQnum(),this.decodeCellAnumsub()},encodeData:function(){this.encodeAreaRoom(),this.encodeCellQnum(),this.encodeCellAnumsub()}},AnsCheck:{checklist:["checkDoubleNumber","checkAdjacentCountries","checkToichikaClue@toichika2","checkNumberDistance@toichika2","checkNumberBlocked@toichika2","checkTripleRow@toichika2","checkBothRowAndColumn@toichika2","checkDirectionOfArrow","checkNoNumber"],checkDirectionOfArrow:function(){for(var a=this.getPairArrowsInfo(),b=0;b<a.length;b++)if(1===a[b].length){if(this.failcode.add("arAlone"),this.checkOnly)break;a[b][0].seterr(1)}},checkAdjacentCountries:function(){for(var a=this.board.roommgr.getSideAreaKeys(),b=a.len,c=this.getPairArrowsInfo(),d=0;d<c.length;d++)if(2===c[d].length){var e=c[d][0].room,f=c[d][1].room,g=e.id<f.id?e.id*b+f.id:f.id*b+e.id;if(a[g]){if(this.failcode.add("arAdjPair"),this.checkOnly)break;e.clist.seterr(1),f.clist.seterr(1)}}},getPairArrowsInfo:function(){if(this._info.parrow)return this._info.parrow;for(var a=[],b=[],c=this.board,d=0;d<c.cell.length;d++)b[d]=c.cell[d].isNum();for(var d=0;d<c.cell.length;d++){var e=c.cell[d];if(!e.noNum())for(var f=e.getaddr(),g=e.getNum();;){f.movedir(g,2);var h=f.getc();if(h.isnull){a.push([e]);break}if(b[h.id]){h.getNum()!==[0,h.DN,h.UP,h.RT,h.LT][g]?a.push([e]):a.push([h,e]);break}}}return this._info.parrow=a}},"AnsCheck@toichika2":{checkToichikaClue:function(){this.checkAllCell(function(a){return a.isNum()&&a.room.top.qnum>0&&a.anum!==a.room.top.qnum},"bkClue")},checkNumberDistance:function(){for(var a=this.getPairArrowsInfo(),b=0;b<a.length;b++)if(2===a[b].length){var c=a[b][0],d=a[b][1],e=2*c.anum+2;if(Math.abs(c.bx-d.bx)!==e&&Math.abs(c.by-d.by)!==e){if(this.failcode.add("arDistance"),this.checkOnly)break;c.seterr(1),d.seterr(1)}}},checkNumberBlocked:function(){for(var a=this.getPairArrowsInfo(),b=0;b<a.length;b++)if(2===a[b].length){var c=this.board.cellinside(a[b][0].bx,a[b][0].by,a[b][1].bx,a[b][1].by);if(2!==c.filter(function(a){return a.isNum()}).length){if(this.failcode.add("arBlocked"),this.checkOnly)break;c.seterr(1)}}},checkTripleRow:function(){this.multipleCount(!0,"nmTripRow")},checkBothRowAndColumn:function(){this.multipleCount(!1,"nmDupRowCol")},multipleCount:function(a,b){for(var c=this.getPairArrowsInfo(),d=0;d<c.length;d++)if(!(c[d].length<=2)){var e=new this.klass.CellList(c[d]),f=e.getRectSize();if(1===f.rows||1===f.cols){if(!a)continue}else if(a)continue;if(this.failcode.add(b),this.checkOnly)break;e.seterr(1)}},getPairArrowsInfo:function(){if(this._info.parrow)return this._info.parrow;var a=[];this.checkRowsCols(function(b){for(var c=[],d=0;d<b.length;d++)if(!b[d].noNum()){var e=b[d].anum;if(!c[e]){for(var f=[b[d]],g=d+1;g<b.length;g++)b[g].anum===e&&f.push(b[g]);c[e]=!0,a.push(f)}}return!0});for(var b=0;b<a.length;b++)for(var c=b+1;c<a.length;c++)if(a[b].some(function(b){return-1!==a[c].indexOf(b)})){if(1===a[b].length){a.splice(b,1),b--;break}a[c].length>1&&(a[b]=a[b].concat(a[c])),a.splice(c,1),c--}return this._info.parrow=a}},"FailCode@toichika":{bkNoNum:["国に矢印が入っていません。","A country has no arrow."],bkNumGe2:["1つの国に2つ以上の矢印が入っています。","A country has more than one arrow."],arAdjPair:["辺を共有する国にペアとなる矢印が入っています。","There are paired arrows in adjacent countries."],arAlone:["矢印の先にペアとなる矢印がいません。","There is no paired arrow in the direction of an arrow."]},"FailCode@toichika2":{arAdjPair:["(please translate) There are paired numbers in adjacent countries.","There are paired numbers in adjacent countries."],arAlone:["(please translate) A number can not see an identical number.","A number can not see an identical number."],nmDupRowCol:["(please translate) A number has an identical number in both the same row and column.","A number has an identical number in both the same row and column."],nmTripRow:["(please translate) A number appears more than twice in the same row or column.","A number appears more than twice in the same row or column."],bkClue:["(please translate) A number does not match the clue for the country.","A number does not match the clue for the country."],arDistance:["(please translate) A pair of numbers does not have the correct distance.","A pair of numbers does not have the correct distance."],arBlocked:["(please translate) Other numbers are between a pair of numbers.","Other numbers are between a pair of numbers."]}});
//# sourceMappingURL=toichika.js.map