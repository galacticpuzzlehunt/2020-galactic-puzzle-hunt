{"version":3,"sources":["../../src-ui/js/common/intro.js","../../src-ui/js/ui/UI.js","../../src-ui/js/ui/Misc.js","../../src-ui/js/ui/Boot.js","../../src-ui/js/ui/Event.js","../../src-ui/js/ui/Listener.js","../../src-ui/js/ui/MenuConfig.js","../../src-ui/js/ui/UrlConfig.js","../../src-ui/js/ui/MenuArea.js","../../src-ui/js/ui/PopupMenu.js","../../src-ui/js/ui/ToolArea.js","../../src-ui/js/ui/Notify.js","../../src-ui/js/ui/KeyPopup.js","../../src-ui/js/ui/Timer.js","../../src-ui/js/ui/AuxEditor.js","../../src-ui/js/ui/Network.js"],"names":["getEL","id","_doc","getElementById","createEL","tagName","createElement","toBGimage","pid","indexOf","data","aho","amibo","ayeheya","cave","barns","bdblock","bonsan","box","cbblock","chocona","cojun","country","creek","factors","fillmat","fillomino","firefly","fivecells","fourcells","goishi","gokigen","hakoiri","hanare","hashikake","hebi","herugolf","heyabon","heyawake","hitori","icebarn","icelom","icelom2","ichimaga","ichimagam","ichimagax","juosan","kaero","kazunori","kakuro","kakuru","kinkonkan","kouchoku","kramma","kramman","kurochute","kurodoko","kurotto","kusabi","lightup","lits","lookair","loopsp","loute","makaro","mashu","mejilink","minarism","mochikoro","mochinyoro","nagare","nagenawa","nanro","nawabari","norinori","numlin","nuribou","nurikabe","nurimaze","paintarea","pipelink","pipelinkr","rectslider","reflect","renban","ringring","ripple","roma","sashigane","shakashaka","shikaku","shimaguni","shugaku","shwolf","slalom","slither","sudoku","sukoro","tapa","tasquare","tatamibari","tateyoko","tawa","tentaisho","tilepaint","toichika","triplace","usotatami","wagiri","yajikazu","yajilin","yajitatami","yosenabe","bosanowa","dosufuwa","sukororoom","view","wblink","length","importData","onload_pzl","importURL","failOpen","ui","puzzle","title2","document","innerHTML","startPuzzle","pzl","pzv","onload_pzv","ua","match","navigator","userAgent","onload_option","graphic","element","pzpr","Puzzle","connectKeyEvents","event","onload_func","once","open","variant","config","set","on","auxeditor","net","network","configure","key","search","location","charAt","substr","RegExp","$1","$2","$3","parser","parseURL","startmode","mode","body","type","boot","setTimeout","window","version","currentpid","menuconfig","urlconfig","menuarea","toolarea","popupmgr","keypopup","timer","enableGetText","enableReadText","reader","enableSaveImage","enableImageType","enableSaveBlob","callbackComplete","displayAll","display","translate","misc","displayDesign","setdisplay","idname","customAttr","el","name","value","dataset","lowername","i","ch","toLowerCase","getAttribute","windowWidth","innerHeight","innerWidth","clientWidth","adjustcellsize","mwidth","cellsize","pc","painter","cols","getCanvasCols","getBoardPadding","wwidth","embed","uiconf","cellsizeval","get","cr","base","limit","ws","ci","outputImage","style","width","border","setCanvasSizeByCellSize","padding","selectStr","strJP","strEN","lang","getCurrentConfigList","getList","initFileReadMethod","FileReader","this","onload","e","target","result","FileList","File","prototype","getAsText","initImageSaveMethod","Candle","enable","canvas","toDataURL","png","height","gif","jpeg","webp","svg","btoa","saveBlob","resizetimer","visibilitystate","visibilityCallbacks","removers","addEvent","self","callback","capt","push","util","removeAllEvents","forEach","remover","addVisibilityCallback","setWindowEvents","DDhandler","readAsText","dataTransfer","files","preventDefault","stopPropagation","onblur_func","evname","env","OS","iOS","onresize_func","onbeforeunload_func","onunload_func","matchMedia","addListener","onpixelratiochange_func","setDocumentEvents","onvisibilitychange_func","init","restore","listener","setListeners","Android","modifyCSS","body, .btn","fontFamily","save","clearTimeout","keyreset","mouse","mousereset","playeronly","ismodified","msg","returnValue","state","visibilityState","redraw","onFirstReady","onReady","onKeyInput","onMouseInput","onHistoryChange","onTrialModeChange","onModeChange","onAdjust","onResize","onCellOp","create","reset","notify","sync","start","c","kc","ut","undotimer","keydown","startUndo","startRedo","editmode","MODE_PLAYER","playmode","MODE_EDITOR","keyup","stop","cancelEvent","mv","mousestart","btn","trialstage","list","val","inputMode","getVariants","Math","min","cw","valTop","parentNode","paddingTop","resizepanel","op","Config","add","option","volatile","item","extoption","field","defval","defvalue","call","getConfig","inversion","getCurrentName","getNormalizedName","argname","newval","names","popups","pop","close","setMode","setInputMode","setproper","setConfig","configevent","json_puzzle","localStorage","json_menu","setAll","JSON","parse","stringify","saveConfig","getAll","getexec","validConfig","setting","autocheck_once","autocheck_mode","valid","paneltype","getInputModeList","menuitem","setInversion","pinfo","variety","title","ja","en","background","backgroundImage","bgimage","input","sheet","styleSheets","rules","cssRules","modifyCSS_sub","sel","insertRule","modified","len","rule","selectorText","pps","p","walker","parent","func","els","firstChild","nextSibling","nodeType","childNodes","displayByPid","disppid","checkpid","autocmp","captions","nohover","createMenu","modifySelector","walkElement","stopHovering","menufactory","role","addmenuevent","nodeName","setevent","className","children","roles","split","querySelector","showHovering","link","setAttribute","label","menu","str_jp","str_en","textnode","mobile","classList","cssText","replace","deleteRule","el0","toggle","contains","remove","EDITOR","obj","trial","board","str","textContent","validval","child","selected","cname","disabled","getvariant","checkclick","childclick","undo","undostop","stopUndo","undoall","redo","redostop","stopRedo","redoall","enterTrial","enterFurtherTrial","acceptTrial","rejectTrial","rejectCurrentTrial","disppopup","rect","getRect","bottom","pos","getPagePos","px","py","updatelink","url","getURL","URL_PZPRFILE","check","complete","text","texts","alert","win","checknw","completeq","checkne","checksw","checkse","answerclear","confirm","ansclear","submarkclear","subclear","popup","movingpop","offset","setEvents","titlebarmove","titlebarup","addpopup","proto","NewPopup","template","multipopup","show","titlebardown","popel","parseInt","left","top","enableMouse","formname","form","titlebar","unselectable","walkCaption","walkEvent","button","eventfactory","API","touchevent","enableKey","_div","_img","src","clip","setsize_sudoku","setsize_tawa","setsize","bd","col","row","rows","getsize","checked","getsize_sudoku","shape","setshape","getsize_tawa","getshape","isNaN","setshapeidx","idx","getshapeidx","clickshape","backgroundColor","execute","urlinput","ta","urlanchor","exists","URL_PZPRV3","href","kanpen","heyaapp","urloutput","URL_KANPEN","URL_HEYAAPP","fileopen","fileEL","filebox","fitem","anchor","anchor_download","ispencilbox","pencilbox","filetype","options","getFileData","FILE_PZPR","ta2","filename","changefilename","filesaveurl","URL","revokeObjectURL","ext","urlid","kanpenid","filesave","prohibit","FILE_PBOX","FILE_PBOX_XML","history","blob","filedata","Blob","createObjectURL","download","click","ques","operation","submit","saved","showsize","removeChild","estimatesize","saveimageurl","setCanvasSize","getCanvasRows","replaceChild","createTextNode","saveimage","transparent","bgcolor","toBlob","bind","urlstr","openimage","writeContent","cdoc","writeln","dataurl","defaultView","IEkei","toBuffer","adjust","operate","turnl","turnr","meta","metadata","author","source","hard","comment","changesize","csize","random","toString","coop","items","btnfactory","addbtnevent","checkbox","datanode","mandisp","displayVariantPanel","disable_subclear","hasflush","irowake","irowakeblk","shouldDisplay","variants","Object","keys","vardisp","opemgr","enableUndo","enableRedo","atStartOfTrial","toolitem","toolclick","encolorall","dropblocks","resetblocks","flushexcell","onconfirm","setVerticalPosition","elbg","rectbg","closealert","confirmtrue","confirmfalse","1","3","tdcolor","imgCR","imgs","basepanel","clearflag","tapaloop","satogaeri","symmarea","skyscrapers","kropki","doppelblock","interbd","toichika2","createtable","bar","fontAnscolor","generate","gentable4","gentable10","gentable51","gentable3","gentable5","gentable6","gentable8","generate_slalom","generate_reflect","generate_pipelink","generate_tatamibari","generate_hakoiri","generate_kusabi","generate_doppelblock","generate_interbd","itemlist","cap","hideHatena","mbcolor","color","generate_main","klass","Cell","numberWithMB","image","inputcol","insertrow","ca","disp","_child","onclick","keyevent","x","y","clear","appendChild","dsize","tsize","img","div.kpcell","lineHeight","span.kpnum","fontSize","shitappa","TID","current","bseconds","timerEL","worstACtime","nextACtime","showtime","resetTime","update","setInterval","clearInterval","currentTime","updatetime","autocheck","seconds","hours","minutes","join","getTime","guarded","checker","inCheck","undecided","max","inUNDO","inREDO","proc","handler","inithandler","exec","checknextprop","cb","apply","sender","args","floor","pz","innerText","info","bounds","maxSeen","loc","wsurl","protocol","host","WebSocket","onclose","onmessage","send","applyOp","encOp","ObjectOperation","decode","external","disableRecord","enableRecord","newOperation"],"mappings":"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","file":"pzpr-ui.js","sourcesContent":["// intro.js\r\n\r\n(function(){\r\n","// UI.js v3.4.0\r\n/* eslint-env browser */\r\n/* exported ui, _doc, getEL, createEL */\r\n\r\n/* ui.js Locals */\r\nvar _doc = document;\r\nfunction getEL(id) {\r\n\treturn _doc.getElementById(id);\r\n}\r\nfunction createEL(tagName) {\r\n\treturn _doc.createElement(tagName);\r\n}\r\n\r\n//---------------------------------------------------------------------------\r\n// ★uiオブジェクト UserInterface側のオブジェクト\r\n//---------------------------------------------------------------------------\r\n/* extern */\r\nwindow.ui = {\r\n\tversion: \"\",\r\n\r\n\t/* このサイトで使用するパズルのオブジェクト */\r\n\tpuzzle: null,\r\n\r\n\t/* どの種類のパズルのメニューを表示しているか */\r\n\tcurrentpid: \"\",\r\n\r\n\t/* メンバオブジェクト */\r\n\tevent: null,\r\n\tmenuconfig: null,\r\n\turlconfig: null,\r\n\tmenuarea: null,\r\n\ttoolarea: null,\r\n\tpopupmgr: null,\r\n\tkeypopup: null,\r\n\ttimer: null,\r\n\tnetwork: null,\r\n\r\n\tenableGetText: false, // FileReader APIの旧仕様でファイルが読めるか\r\n\tenableReadText: false, // HTML5 FileReader APIでファイルが読めるか\r\n\treader: null, // FileReaderオブジェクト\r\n\r\n\tenableSaveImage: false, // 画像保存が可能か\r\n\tenableImageType: {}, // 保存可能な画像形式\r\n\r\n\tenableSaveBlob: false, // saveBlobが使用できるか\r\n\r\n\tcallbackComplete: null,\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ui.displayAll()     全てのメニュー、ボタン、ラベルに対して文字列を設定する\r\n\t// ui.setdisplay()     個別のメニュー、ボタン、ラベルに対して文字列を設定する\r\n\t//---------------------------------------------------------------------------\r\n\tdisplayAll: function() {\r\n\t\tui.menuarea.display();\r\n\t\tui.toolarea.display();\r\n\t\tui.popupmgr.translate();\r\n\t\tui.misc.displayDesign();\r\n\t},\r\n\tsetdisplay: function(idname) {\r\n\t\tui.menuarea.setdisplay(idname);\r\n\t\tui.toolarea.setdisplay(idname);\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ui.customAttr()   エレメントのカスタムattributeの値を返す\r\n\t//---------------------------------------------------------------------------\r\n\tcustomAttr: function(el, name) {\r\n\t\tvar value = \"\";\r\n\t\tif (el.dataset !== void 0) {\r\n\t\t\tvalue = el.dataset[name];\r\n\t\t} else {\r\n\t\t\t/* IE10, Firefox5, Chrome7, Safari5.1以下のフォールバック */\r\n\t\t\tvar lowername = \"data-\";\r\n\t\t\tfor (var i = 0; i < name.length; i++) {\r\n\t\t\t\tvar ch = name[i] || name.charAt(i);\r\n\t\t\t\tlowername += ch >= \"A\" && ch <= \"Z\" ? \"-\" + ch.toLowerCase() : ch;\r\n\t\t\t}\r\n\t\t\tvalue = el[lowername] || el.getAttribute(lowername) || \"\";\r\n\t\t}\r\n\t\treturn value;\r\n\t},\r\n\r\n\t//----------------------------------------------------------------------\r\n\t// ui.windowWidth()   ウィンドウの幅を返す\r\n\t//----------------------------------------------------------------------\r\n\twindowWidth: function() {\r\n\t\treturn window.innerHeight !== void 0\r\n\t\t\t? window.innerWidth\r\n\t\t\t: _doc.body.clientWidth;\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ui.adjustcellsize()  resizeイベント時に、pc.cw, pc.chのサイズを(自動)調節する\r\n\t// ui.getBoardPadding() Canvasと境界線の周りの間にあるpaddingのサイズを求めます\r\n\t//---------------------------------------------------------------------------\r\n\tadjustcellsize: function() {\r\n\t\tvar puzzle = ui.puzzle,\r\n\t\t\tpc = puzzle.painter;\r\n\t\tvar cols = pc.getCanvasCols() + ui.getBoardPadding() * 2;\r\n\t\tvar wwidth = ui.windowWidth() - (ui.urlconfig.embed ? 0 : 6);\r\n\t\tvar mwidth; //  margin/borderがあるので、適当に引いておく\r\n\t\tvar uiconf = ui.menuconfig;\r\n\r\n\t\tvar cellsize,\r\n\t\t\tcellsizeval = uiconf.get(\"cellsizeval\");\r\n\t\tvar cr = { base: 1.0, limit: 0.4 },\r\n\t\t\tws = { base: 0.8, limit: 0.96 },\r\n\t\t\tci = [];\r\n\t\tci[0] = (wwidth * ws.base) / (cellsizeval * cr.base);\r\n\t\tci[1] = (wwidth * ws.limit) / (cellsizeval * cr.base);\r\n\t\tci[2] = (wwidth * ws.limit) / (cellsizeval * cr.limit);\r\n\r\n\t\t// 横幅いっぱいに広げたい場合\r\n\t\tif (uiconf.get(\"fullwidth\")) {\r\n\t\t\tmwidth = wwidth * 0.98;\r\n\t\t\tcellsize = (mwidth * 0.92) / cols;\r\n\t\t}\r\n\t\t// 縮小が必要ない場合\r\n\t\telse if (!uiconf.get(\"adjsize\") || cols < ci[0]) {\r\n\t\t\tmwidth = wwidth * ws.base - 4;\r\n\t\t\tcellsize = cellsizeval * cr.base;\r\n\t\t}\r\n\t\t// ひとまずセルのサイズを変えずにmainの幅を調節する場合\r\n\t\telse if (cols < ci[1]) {\r\n\t\t\tcellsize = cellsizeval * cr.base;\r\n\t\t\tmwidth = cellsize * cols;\r\n\t\t}\r\n\t\t// base～limit間でサイズを自動調節する場合\r\n\t\telse if (cols < ci[2]) {\r\n\t\t\tmwidth = wwidth * ws.limit - 4;\r\n\t\t\tcellsize = mwidth / cols; // 外枠ぎりぎりにする\r\n\t\t}\r\n\t\t// 自動調整の下限値を超える場合\r\n\t\telse {\r\n\t\t\tcellsize = cellsizeval * cr.limit;\r\n\t\t\tmwidth = cellsize * cols;\r\n\t\t}\r\n\r\n\t\t// mainのサイズ変更\r\n\t\tif (!pc.outputImage) {\r\n\t\t\tgetEL(\"main\").style.width = \"\" + (mwidth | 0) + \"px\";\r\n\t\t\tif (ui.urlconfig.embed) {\r\n\t\t\t\tgetEL(\"main\").style.border = \"none\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpuzzle.setCanvasSizeByCellSize(cellsize);\r\n\t},\r\n\tgetBoardPadding: function() {\r\n\t\tvar puzzle = ui.puzzle,\r\n\t\t\tpadding = 0;\r\n\t\tswitch (puzzle.pid) {\r\n\t\t\tcase \"firefly\":\r\n\t\t\tcase \"hashikake\":\r\n\t\t\tcase \"wblink\":\r\n\t\t\tcase \"ichimaga\":\r\n\t\t\tcase \"ichimagam\":\r\n\t\t\tcase \"ichimagax\":\r\n\t\t\t\tpadding = 0.3;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"kouchoku\":\r\n\t\t\tcase \"gokigen\":\r\n\t\t\tcase \"wagiri\":\r\n\t\t\tcase \"creek\":\r\n\t\t\t\tpadding = 0.2;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"slither\":\r\n\t\t\tcase \"cave\":\r\n\t\t\tcase \"mejilink\":\r\n\t\t\t\tpadding = 0.15;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"kinkonkan\":\r\n\t\t\tcase \"skyscrapers\":\r\n\t\t\tcase \"easyasabc\":\r\n\t\t\tcase \"box\":\r\n\t\t\t\tpadding = 0.05;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"bosanowa\":\r\n\t\t\t\tpadding = ui.menuconfig.get(\"disptype_bosanowa\") !== 2 ? 0.5 : 0.05;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tpadding = 0.5;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tif (ui.menuconfig.get(\"fullwidth\")) {\r\n\t\t\tpadding = 0;\r\n\t\t}\r\n\t\treturn padding;\r\n\t},\r\n\r\n\t//--------------------------------------------------------------------------------\r\n\t// ui.selectStr()  現在の言語に応じた文字列を返す\r\n\t//--------------------------------------------------------------------------------\r\n\tselectStr: function(strJP, strEN) {\r\n\t\tif (!strEN) {\r\n\t\t\treturn strJP;\r\n\t\t}\r\n\t\treturn pzpr.lang === \"ja\" ? strJP : strEN;\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ui.getCurrentConfigList() 現在のパズルで有効な設定と設定値を返す\r\n\t//---------------------------------------------------------------------------\r\n\tgetCurrentConfigList: function() {\r\n\t\treturn ui.menuconfig.getList();\r\n\t},\r\n\r\n\t//----------------------------------------------------------------------\r\n\t// ui.initFileReadMethod() ファイルアクセス関連の処理の初期化を行う\r\n\t//----------------------------------------------------------------------\r\n\tinitFileReadMethod: function() {\r\n\t\t// File Reader (あれば)の初期化処理\r\n\t\tif (typeof FileReader !== \"undefined\") {\r\n\t\t\tthis.reader = new FileReader();\r\n\t\t\tthis.reader.onload = function(e) {\r\n\t\t\t\tui.puzzle.open(e.target.result);\r\n\t\t\t};\r\n\t\t\tthis.enableReadText = true;\r\n\t\t} else {\r\n\t\t\tthis.reader = null;\r\n\t\t\tthis.enableGetText =\r\n\t\t\t\ttypeof FileList !== \"undefined\" &&\r\n\t\t\t\ttypeof File.prototype.getAsText !== \"undefined\";\r\n\t\t}\r\n\t},\r\n\r\n\t//----------------------------------------------------------------------\r\n\t// ui.initImageSaveMethod() 画像保存関連の処理の初期化を行う\r\n\t//----------------------------------------------------------------------\r\n\tinitImageSaveMethod: function(puzzle) {\r\n\t\tif (\r\n\t\t\t!!pzpr.Candle.enable.canvas &&\r\n\t\t\t!!_doc.createElement(\"canvas\").toDataURL\r\n\t\t) {\r\n\t\t\tthis.enableImageType.png = true;\r\n\r\n\t\t\tvar canvas = _doc.createElement(\"canvas\");\r\n\t\t\tcanvas.width = canvas.height = 1;\r\n\t\t\tif (canvas.toDataURL(\"image/gif\").match(\"image/gif\")) {\r\n\t\t\t\tthis.enableImageType.gif = true;\r\n\t\t\t}\r\n\t\t\tif (canvas.toDataURL(\"image/jpeg\").match(\"image/jpeg\")) {\r\n\t\t\t\tthis.enableImageType.jpeg = true;\r\n\t\t\t}\r\n\t\t\tif (canvas.toDataURL(\"image/webp\").match(\"image/webp\")) {\r\n\t\t\t\tthis.enableImageType.webp = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!!pzpr.Candle.enable.svg && !!window.btoa) {\r\n\t\t\tthis.enableImageType.svg = true;\r\n\t\t}\r\n\t\tif (!!this.enableImageType.png || !!this.enableImageType.svg) {\r\n\t\t\tthis.enableSaveImage = true;\r\n\t\t}\r\n\r\n\t\tthis.enableSaveBlob = !!window.navigator.saveBlob;\r\n\t}\r\n};\r\n","// Misc.js v3.4.1\r\n/* global _doc:readonly */\r\n\r\n//---------------------------------------------------------------------------\r\n// ★Miscクラス html表示系 (Menu, Button以外)の制御を行う\r\n//---------------------------------------------------------------------------\r\nui.misc = {\r\n\t//---------------------------------------------------------------------------\r\n\t// misc.displayDesign()  背景画像とかtitle・背景画像・html表示の設定\r\n\t// misc.bgimage()        背景画像を返す\r\n\t//---------------------------------------------------------------------------\r\n\tdisplayDesign: function() {\r\n\t\tvar pid = ui.puzzle.pid;\r\n\t\tvar pinfo = pzpr.variety(pid);\r\n\t\tvar title = ui.selectStr(pinfo.ja, pinfo.en);\r\n\t\ttitle += ui.puzzle.playeronly\r\n\t\t\t? \" player\"\r\n\t\t\t: ui.selectStr(\" エディタ\", \" editor\");\r\n\r\n\t\t_doc.title = title;\r\n\t\tvar titleEL = _doc.getElementById(\"title2\");\r\n\t\ttitleEL.innerHTML = title;\r\n\r\n\t\tif (ui.urlconfig.embed) {\r\n\t\t\t_doc.body.style.background = \"white\";\r\n\t\t} else {\r\n\t\t\t_doc.body.style.backgroundImage = \"url(\" + this.bgimage(pid) + \")\";\r\n\t\t}\r\n\t},\r\n\tbgimage: function(pid) {\r\n\t\treturn toBGimage(pid);\r\n\t},\r\n\r\n\t//--------------------------------------------------------------------------------\r\n\t// misc.modifyCSS()   スタイルシートの中身を変更する\r\n\t//--------------------------------------------------------------------------------\r\n\tmodifyCSS: function(input) {\r\n\t\tvar sheet = _doc.styleSheets[0];\r\n\t\tvar rules = sheet.cssRules;\r\n\t\tif (rules === null) {\r\n\t\t} // Chromeでローカルファイルを開くとおかしくなるので、とりあえず何もしないようにします\r\n\t\telse if (!this.modifyCSS_sub(rules, input)) {\r\n\t\t\tvar sel = \"\";\r\n\t\t\tfor (sel in input) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tsheet.insertRule(\"\" + sel + \" {}\", rules.length);\r\n\t\t\trules = sheet.cssRules;\r\n\t\t\tthis.modifyCSS_sub(rules, input);\r\n\t\t}\r\n\t},\r\n\tmodifyCSS_sub: function(rules, input) {\r\n\t\tvar modified = false;\r\n\t\tfor (var i = 0, len = rules.length; i < len; i++) {\r\n\t\t\tvar rule = rules[i];\r\n\t\t\tif (!rule.selectorText) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tvar pps = input[rule.selectorText];\r\n\t\t\tif (!!pps) {\r\n\t\t\t\tfor (var p in pps) {\r\n\t\t\t\t\tif (!!pps[p]) {\r\n\t\t\t\t\t\trule.style[p] = pps[p];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tmodified = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn modified;\r\n\t},\r\n\r\n\t//--------------------------------------------------------------------------------\r\n\t// misc.walker()        DOMツリーをたどる\r\n\t// misc.displayByPid()  要素のdata-pid, autocmp-typeカスタム属性によって表示するしないを切り替える\r\n\t//--------------------------------------------------------------------------------\r\n\twalker: function(parent, func) {\r\n\t\tvar els = [parent.firstChild];\r\n\t\twhile (els.length > 0) {\r\n\t\t\tvar el = els.pop();\r\n\t\t\tfunc(el);\r\n\t\t\tif (!!el.nextSibling) {\r\n\t\t\t\tels.push(el.nextSibling);\r\n\t\t\t}\r\n\t\t\tif (el.nodeType === 1 && el.childNodes.length > 0) {\r\n\t\t\t\tels.push(el.firstChild);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tdisplayByPid: function(parent) {\r\n\t\tui.misc.walker(parent, function(el) {\r\n\t\t\tif (el.nodeType === 1) {\r\n\t\t\t\tvar disppid = ui.customAttr(el, \"dispPid\");\r\n\t\t\t\tif (!!disppid) {\r\n\t\t\t\t\tel.style.display = pzpr.util.checkpid(disppid, ui.puzzle.pid)\r\n\t\t\t\t\t\t? \"\"\r\n\t\t\t\t\t\t: \"none\";\r\n\t\t\t\t}\r\n\t\t\t\tvar autocmp = ui.customAttr(el, \"autocmpType\");\r\n\t\t\t\tif (!!autocmp) {\r\n\t\t\t\t\tel.style.display =\r\n\t\t\t\t\t\tui.puzzle.painter.autocmp === autocmp ? \"\" : \"none\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n};\r\n\r\nfunction toBGimage(pid) {\r\n\tvar imgs = [\r\n\t\t\"angleloop\",\r\n\t\t\"aquarium\",\r\n\t\t\"araf\",\r\n\t\t\"skyscrapers\",\r\n\t\t\"balance\",\r\n\t\t\"castle\",\r\n\t\t\"compass\",\r\n\t\t\"curvedata\",\r\n\t\t\"dbchoco\",\r\n\t\t\"detour\",\r\n\t\t\"doppelblock\",\r\n\t\t\"doubleback\",\r\n\t\t\"easyasabc\",\r\n\t\t\"geradeweg\",\r\n\t\t\"heteromino\",\r\n\t\t\"kropki\",\r\n\t\t\"maxi\",\r\n\t\t\"midloop\",\r\n\t\t\"moonsun\",\r\n\t\t\"nondango\",\r\n\t\t\"nonogram\",\r\n\t\t\"nurimisaki\",\r\n\t\t\"pencils\",\r\n\t\t\"satogaeri\",\r\n\t\t\"scrin\",\r\n\t\t\"simpleloop\",\r\n\t\t\"snake\",\r\n\t\t\"starbattle\",\r\n\t\t\"symmarea\",\r\n\t\t\"tapaloop\",\r\n\t\t\"tents\",\r\n\t\t\"walllogic\",\r\n\t\t\"yinyang\"\r\n\t];\r\n\tif (imgs.indexOf(pid) >= 0) {\r\n\t\treturn \"img/\" + pid + \".png\";\r\n\t}\r\n\tvar header;\r\n\tvar data = {\r\n\t\t/* カラーパレットが2色時のHeader(途中まで), 16×16サイズのData Block(途中から) */\r\n\t\taho: [\"ICAgKCgoC\", \"I4Qdp3vJDxwMtNorV85sQ6RwWhhiZPNF57Q+3udgcjWmLVMAADs=\"],\r\n\t\tamibo: [\"P/AwP///y\", \"HoRjqQvI36AKtNrrolx5Hz+BXjeKX4KlVWmSmyt1BQA7\"],\r\n\t\tayeheya: [\"P/ow////y\", \"F4SPGJEN66KctNoGaZ5b9guGIsdoZVUAADs=\"],\r\n\t\tcave: [\r\n\t\t\t\"P+vg///wC\",\r\n\t\t\t\"JYRjl4DbmlqYtNr3mFs67g+FYiZd5uSlYjdyJNim56mytv3CeQEAOw==\"\r\n\t\t],\r\n\t\tbarns: [\r\n\t\t\t\"MDAwID//y\",\r\n\t\t\t\"JQyCqZa369hTDtg7cYxT+r51zUVyWSMiYbqKJZl65tOCqDHjZQEAOw==\"\r\n\t\t],\r\n\t\tbdblock: [\r\n\t\t\t\"Dn/pP///y\",\r\n\t\t\t\"IoyPqQHb+lJE81RzmdsMeI994EKWJsVJKQqtlouFovydSgEAOw==\"\r\n\t\t],\r\n\t\tbonsan: [\r\n\t\t\t\"P//wMD/wC\",\r\n\t\t\t\"JoSPicGqcWCSgBpbJWa81zlR4hNizomeHMh+1wZ2MtssrTmmmVQAADs=\"\r\n\t\t],\r\n\t\tbox: [\"ICAgKCgoC\", \"IgyOCaadxpyKEkHqKH5tLxmEondg5MeBU2WyKziGakfPRwEAOw==\"],\r\n\t\tcbblock: [\"P/QQf///y\", \"H4wDp3vJj+BzUlEIst784rp4lSiRH9igKdNpk2qYRwEAOw==\"],\r\n\t\tchocona: [\"P/AwP///y\", \"IIyPGcDtD1BUM1WpVr6HG69R2yiWFnmamNqh0Ntk8iwXADs=\"],\r\n\t\tcojun: [\r\n\t\t\t\"MD//////y\",\r\n\t\t\t\"I4wfgMvKD+Jrcp6IrcF18ux9DiWOSNldaJqspgu28AZndVYAADs=\"\r\n\t\t],\r\n\t\tcountry: [\"P/Gif///y\", \"IISPGZFtDKB7SDZL78RYna6BjhhO1WdG3siubWZC5FkAADs=\"],\r\n\t\tcreek: [\r\n\t\t\t\"AD//8H+/y\",\r\n\t\t\t\"JIQfGces2tyD8RkrU16XboBVExd1YTmSjXWa5NlirTsjU/k1BQA7\"\r\n\t\t],\r\n\t\tfactors: [\"AD//////y\", \"IISPqcsWHxp4iKq4cGXayd5dWwN+SXigqHeBawpJ8pwUADs=\"],\r\n\t\tfillmat: [\r\n\t\t\t\"P//wLP/gS\",\r\n\t\t\t\"JoSDAam2yh6SM9pbE4UaT3d0HrWRmDOiXMZ+oLfG5cjIMAnOIlsAADs=\"\r\n\t\t],\r\n\t\tfillomino: [\r\n\t\t\t\"ODg4P///y\",\r\n\t\t\t\"I4QPgcvKn4KU0DhbE7qP3wl608FtDVRq3bkuYZillYxmLlQAADs=\"\r\n\t\t],\r\n\t\tfirefly: [\r\n\t\t\t\"ID/gP//wC\",\r\n\t\t\t\"JISDpqvRzNySME2EMaAHzuddXEiWlVVSYxRl7riCsqeaG2orBQA7\"\r\n\t\t],\r\n\t\tfivecells: [\r\n\t\t\t\"MD/wP///y\",\r\n\t\t\t\"IwyOmWbqDaCLCgY7T5NT8vV02fdpYpVRSAmqZ4S145rS7FMAADs=\"\r\n\t\t],\r\n\t\tfourcells: [\r\n\t\t\t\"MD/wP///y\",\r\n\t\t\t\"JoSPELeZrdxjoUJbmTYQ3T1xoEdh1gh+jhqtaZlxGOqK0nvL5o4VADs=\"\r\n\t\t],\r\n\t\tgoishi: [\r\n\t\t\t\"P/zwf///y\",\r\n\t\t\t\"JoSPiRHK2UA0cU5JVz5V79stFzUq5oly5eOBG8a9sAu/4QetZXoUADs=\"\r\n\t\t],\r\n\t\tgokigen: [\"OD/g////y\", \"HYQPgafbvlKUMD42r9HbZg9W4oh9IdmZaLpSLZcUADs=\"],\r\n\t\thakoiri: [\r\n\t\t\t\"MD//////y\",\r\n\t\t\t\"KISPicEa+UyUYE5KLcSVY81FVyc1JYMq6oKm6zgu2zur8Eoesd6aSgEAOw==\"\r\n\t\t],\r\n\t\thanare: [\"AD//////y\", \"FYSPqcvtDyMMdNLqLm46WC+F4kgmBQA7\"],\r\n\t\thashikake: [\r\n\t\t\t\"P///8DAwC\",\r\n\t\t\t\"JoQflse829qLMlhLVYQuw8s5F+JtpTJSIKm2UgaAGBxrdI3TU1MAADs=\"\r\n\t\t],\r\n\t\thebi: [\"ID/gMD/wC\", \"FISPqcvtD1WYtM6Is96825pcHVQAADs=\"],\r\n\t\therugolf: [\r\n\t\t\t\"MD//+H//y\",\r\n\t\t\t\"I4SPiRHqwJ6KcrV6KIbXdqNlITeNo3Q+zMo67Ou+ayx/G1IAADs=\"\r\n\t\t],\r\n\t\theyabon: [\r\n\t\t\t\"P//wMD/wC\",\r\n\t\t\t\"LYyPacDtH9p5LgJ7IYt4V559Clh9Idad0kJ57caimmex7nqNUN2lti8JvSaAAgA7\"\r\n\t\t],\r\n\t\theyawake: [\"MD/wP///y\", \"F4SPGJEN66KctNoGaZ5b9guGIsdoZVUAADs=\"],\r\n\t\thitori: [\"P//QP///y\", \"H4SPFhvpwNpDcVJ2lz11Q+x1HgduonVOZ/qwjpvASAEAOw==\"],\r\n\t\ticebarn: [\"EH9/////y\", \"F4SPqcvt3wJEcpp6g95cW/yAjmiV5nkWADs=\"],\r\n\t\ticelom: [\"EH9/////y\", \"GYSPqcvdAYOblMl1UU7b9PN9XkWSkVimaQEAOw==\"],\r\n\t\ticelom2: [\"H///////y\", \"G4SPqcvNEQxsMVX71MWue7SBWjZyywSg38o2BQA7\"],\r\n\t\tichimaga: [\"ODg4P///y\", \"IIyPGcDtfZ4EUdmLzWRxQ+1kovh0HgVO42qhy+nCHBsUADs=\"],\r\n\t\tichimagam: [\"ODg4P///y\", \"F4yPGcDtD6NTtFojs3639w1m3kiW5lUAADs=\"],\r\n\t\tichimagax: [\"ODg4P///y\", \"HkSOicDtDyNUtNHKltzcXXsloNKVm2aEqHqYbsQuBQA7\"],\r\n\t\tjuosan: [\"Pjzu9/bqC\", \"H4SPEMm43R5MUoWLZZ1mcz+BIDRGHHU6ToYdJfOiZwEAOw==\"],\r\n\t\tkaero: [\r\n\t\t\t\"P/A/////y\",\r\n\t\t\t\"KIyPecDtbUB4dE5JIbtSxa1VISaC5sOlmXo6LImOnCt77BxjuPhlbgEAOw==\"\r\n\t\t],\r\n\t\tkazunori: [\r\n\t\t\t\"KD/wND/4C\",\r\n\t\t\t\"IwyOqaaN7BqMKdiL86xU9vVx4bEtFklBRglcj4a1T0qe9AgUADs=\"\r\n\t\t],\r\n\t\tkakuro: [\"ICAgP///y\", \"F4SPqcut4V5McJ5qAbZ79vg5YTNmZlYAADs=\"],\r\n\t\tkakuru: [\"MD/wP///y\", \"HYSPqcut4QA8c1Vq2ZWu7vxpERYmXmeKz6oaJVUAADs=\"],\r\n\t\tkinkonkan: [\r\n\t\t\t\"P//gP///y\",\r\n\t\t\t\"JoSDAanmrKBbsDaL7ctoUuwdjBhSWxdyHod+bObCZyetiVuOo1MAADs=\"\r\n\t\t],\r\n\t\tkouchoku: [\"ODg4P///y\", \"IIwDp3vJbxxccqraMKK6xX4BYDh+0SRSTLparevBsVwVADs=\"],\r\n\t\tkramma: [\"ID/gMD/wC\", \"IISPGJFt6xqMitEzL8hv+Q+G4idZGkehkeqwpdbBj7wVADs=\"],\r\n\t\tkramman: [\"ID/gMD/wC\", \"GYSPqcvtj4IMb85mbcy8+7xxGOho0ImmaQEAOw==\"],\r\n\t\tkurochute: [\r\n\t\t\t\"PDw8ODg4C\",\r\n\t\t\t\"IYSPFpGty9yBUD5qb9QVrER1GTaSUvWdadqILCKW2UzTBQA7\"\r\n\t\t],\r\n\t\tkurodoko: [\"ICAgMDAwC\", \"H4SPiRHqDaAzMk66Lraa1g6GIhNCn1Kd2aGubUKKSAEAOw==\"],\r\n\t\tkurotto: [\r\n\t\t\t\"MDAwODg4C\",\r\n\t\t\t\"KYxvoKuIzNKSD8gWMM2T12t5h+ZAncOZaoiu6LZFYtyRmGyHuPqmUF8AADs=\"\r\n\t\t],\r\n\t\tkusabi: [\r\n\t\t\t\"MD/wP///y\",\r\n\t\t\t\"I4SPqZvh/06QaxoLMMK80uuBYvaRY3eWW6mxqjuuJwQx9r0UADs=\"\r\n\t\t],\r\n\t\tlightup: [\"MD//////y\", \"IIRvgcvKDxycNAY5r6a6I99t2xdijVeN1bqYHJvA0VMAADs=\"],\r\n\t\tlits: [\"ICAgKCgoC\", \"IYQRqXmNq9yBUT7alr1wU2Z9gfeRWFiip6RNKfs6otkdBQA7\"],\r\n\t\tlookair: [\"AD//6D//y\", \"GoSPqcsa/5qBUdIgwc07+w92jciQi+lQYFYAADs=\"],\r\n\t\tloopsp: [\r\n\t\t\t\"P+AgP/Pgy\",\r\n\t\t\t\"KYwPeLtpzoCcVDb1Mg7QQb55T9VVGrOBaPqhHomY6iyG2EfCa7dep1EAADs=\"\r\n\t\t],\r\n\t\tloute: [\"IH/gf///y\", \"IYyPaaDB+lJE89TVrssZ+Ph5zUiWG8ShqpSyK9V9Vmg2BQA7\"],\r\n\t\tmakaro: [\r\n\t\t\t\"NnZ2e3t7S\",\r\n\t\t\t\"I0xgmYDqytpzUa6K7cl1wuh9lnZ93siEompwoOhSHTuz26kUADs=\"\r\n\t\t],\r\n\t\tmashu: [\r\n\t\t\t\"P/AwP///y\",\r\n\t\t\t\"JoR/kRntvYxCFExb6b0ZS/Y4kdeRXLaVViqFJ1vCndw+oziP+QcUADs=\"\r\n\t\t],\r\n\t\tmejilink: [\r\n\t\t\t\"NDQ0P///y\",\r\n\t\t\t\"JoxheZrI4VhUE9iLc5ztQc8tz9ZBpPiN4Kq2hwZbpcTS7lk1zlYAADs=\"\r\n\t\t],\r\n\t\tminarism: [\"AD//4H+/y\", \"HYyPqcutAKN8DNBlU75oa/6FoOF141EG0po67vsWADs=\"],\r\n\t\tmochikoro: [\r\n\t\t\t\"AAAAICAgC\",\r\n\t\t\t\"IYwDqXmNq9yBUT7alr1wU2Z9gPeRWFiip6RNKfs6otkdBQA7\"\r\n\t\t],\r\n\t\tmochinyoro: [\"MDAwKCgoC\", \"FoSPqct9AaOctNqLs4au+29s4kiWUwEAOw==\"],\r\n\t\tnagare: [\"N/Z/+7r/y\", \"H4SPEJtt7FqItFo678t3ceWF4iGWIWim6sqirbtubQEAOw==\"],\r\n\t\tnagenawa: [\r\n\t\t\t\"ACAgACeoC\",\r\n\t\t\t\"JYSPacHdCgKUiiaL8NFrO7eF3RiJJWml5geS2QRX8TWxDITnegEAOw==\"\r\n\t\t],\r\n\t\tnanro: [\"MD//+H//y\", \"IIQfGcet2+KLUlFnL8rs+Q+G4khOWKJtaAqYqavBlwwUADs=\"],\r\n\t\tnawabari: [\r\n\t\t\t\"MD//////y\",\r\n\t\t\t\"IwRihsnK2xI88dnqJM68zhl9G6V5wYmmagc24vZisavWKYsVADs=\"\r\n\t\t],\r\n\t\tnorinori: [\r\n\t\t\t\"P/d1MDAwC\",\r\n\t\t\t\"I4QfGcet2+KLUlFn8USvJ+Z5YLgZogZdZqYCpfpeMTVXX1MAADs=\"\r\n\t\t],\r\n\t\tnumlin: [\r\n\t\t\t\"MDAwP///y\",\r\n\t\t\t\"JYyBaJG6Cx6UhzIbacuszaphYkhKG+SVD7eOJpZ2yXepdGuDRgEAOw==\"\r\n\t\t],\r\n\t\tnuribou: [\r\n\t\t\t\"KCgoICAgC\",\r\n\t\t\t\"JYQRGYfKug58TlYzbaJbR3w1HTiKn8mdGamGK+ql6Uu7dlnjYQEAOw==\"\r\n\t\t],\r\n\t\tnurikabe: [\"P+hof/R0S\", \"FoSPqcvtD1eY1NHa7rSaX49F4kiWTAEAOw==\"],\r\n\t\tnurimaze: [\r\n\t\t\t\"MD/wP/0/y\",\r\n\t\t\t\"I4Qfp4u8aYKcs0WnINBYc+dRlIVtZHeCiMh6JfO9MSitbTwbBQA7\"\r\n\t\t],\r\n\t\tpaintarea: [\r\n\t\t\t\"P//wMD/wC\",\r\n\t\t\t\"JowDCYfKug58TlYzbaJbR3w1HTiKn8lBZ5oxpOp6rTurIXvL+TsXADs=\"\r\n\t\t],\r\n\t\tpipelink: [\r\n\t\t\t\"ID/gM//gy\",\r\n\t\t\t\"Kkxgqae4bYCcjs6YaoaY9a99BxWRz4mmi1VeW+d44Px6cWXhrHzG/OMoAAA7\"\r\n\t\t],\r\n\t\tpipelinkr: [\r\n\t\t\t\"ID//8D//y\",\r\n\t\t\t\"Kkxgqae4bYCcjs6YaoaY9a99BxWRz4mmi1VeW+d44Px6cWXhrHzG/OMoAAA7\"\r\n\t\t],\r\n\t\trectslider: [\r\n\t\t\t\"MDAwODg4C\",\r\n\t\t\t\"IIxvoKuIzNyBa1Jqb5RB8359mseRkumMG6gCGSSGpSwVADs=\"\r\n\t\t],\r\n\t\treflect: [\"MDAwP///y\", \"HoyPqcvtCMAzMb5aWw5YbfpxVtKJEoONWrhO7gsnBQA7\"],\r\n\t\trenban: [\r\n\t\t\t\"ID/gP//wC\",\r\n\t\t\t\"JoRjeZrI4FhUM9h7F4yzPfh1mkRp2MmF6iOCLIVaZvrWpF16bnwVADs=\"\r\n\t\t],\r\n\t\tringring: [\r\n\t\t\t\"KCgoMDAwC\",\r\n\t\t\t\"JwRiqae4bYKctDr3Isw63dp1VsgcYCmeWDmirLpx6/p81n1xJL04BQA7\"\r\n\t\t],\r\n\t\tripple: [\"AD//////y\", \"IIyBYJG6jRg8sNqLs97RyvZMnxNGo3liKce2XkuBVVAAADs=\"],\r\n\t\troma: [\"P/wwf///y\", \"IoSPqXvBGtxrcZpYJ85sc+hJYLiE2Ggm5oas7OWeQMzSWwEAOw==\"],\r\n\t\tsashigane: [\"IH/gf///y\", \"HYyPqcsBrcBrskp4LjZz+79p2NQxZRkhaOp4IhgUADs=\"],\r\n\t\tshakashaka: [\r\n\t\t\t\"AAAAICAgC\",\r\n\t\t\t\"IoSPqRe7AR2CVAKKHd5q++l9VxgaJMecTXJqoltZ4ypfSwEAOw==\"\r\n\t\t],\r\n\t\tshikaku: [\"ICAgMDAwC\", \"HoSPGcm43YKctMoIcVab9/N8QPiRjoVe4riyq7kFBQA7\"],\r\n\t\tshimaguni: [\"P//wMD/wC\", \"G4yPqavgDx2KFMwKL5as+w+GBqVtJXZWqcgeBQA7\"],\r\n\t\tshugaku: [\r\n\t\t\t\"AAAQAAAgC\",\r\n\t\t\t\"JoRvoauIzNyBSyYaXp37Nv55GTiKGnWWQESmbguLrISp6ezUFlAAADs=\"\r\n\t\t],\r\n\t\tshwolf: [\"ID/gMD/wC\", \"IQyOiQas6RqcytlXsY569RaE4vhx5Zedx5WulKuamNwFBQA7\"],\r\n\t\tslalom: [\"ID//////y\", \"IIwPecsJDIOLcNJlr3FP76yBF+d9SkmipydSbbWOsVEAADs=\"],\r\n\t\tslither: [\"AAAAP///y\", \"F4yPqcutAF5MULqLs978Vjohnxh2ZlYAADs=\"],\r\n\t\tsudoku: [\"P//wP///y\", \"HoRvgcvKDxxccp5qY0bY9hiE4khCn7ldabJq6/l8BQA7\"],\r\n\t\tsukoro: [\r\n\t\t\t\"MDAwODg4C\",\r\n\t\t\t\"JYyPoMin39KDMUwa76p2crd9HGaQF0hpQHeqrOe671p6KEOKSAEAOw==\"\r\n\t\t],\r\n\t\ttapa: [\"P+hof/R0S\", \"IISPqRAdm9yDR9LqrjY2ZvYhXSd+JNZs2gmxi6vAqlEAADs=\"],\r\n\t\ttasquare: [\"ICAgGBgYC\", \"IYxvoKuIzNyBSyYKbMDZcv15HPaMzWR2l1mmFcrCYzsfBQA7\"],\r\n\t\ttatamibari: [\"LP/gf///y\", \"HYSPqaHA2x6SM9pETzbbwY9dFTiG5lmmzcq2rlIAADs=\"],\r\n\t\ttateyoko: [\"P/AwP///y\", \"H4RjqQvI3+BzJ9hLqUx6R8+BXreRkoZhofiJJvROSgEAOw==\"],\r\n\t\ttawa: [\"MDAwODg4C\", \"GIR/gcud3hRccj57Mai6+8lZIeiNkOlwBQA7\"],\r\n\t\ttentaisho: [\r\n\t\t\t\"IWL/X23/y\",\r\n\t\t\t\"KASCYcum+5qDUx6mYtPZ3u19VZhooVWeBzJK5WNCr7jNsfOyXq6mQAEAOw==\"\r\n\t\t],\r\n\t\ttilepaint: [\r\n\t\t\t\"KCgoICAgC\",\r\n\t\t\t\"JowDCYfKug58TlYzbaJbR3w1HTiKn8lBZ5oxpOp6rTurIXvL+TsXADs=\"\r\n\t\t],\r\n\t\ttoichika: [\r\n\t\t\t\"ID/gP///y\",\r\n\t\t\t\"IoSPqRvsGlqSJlp6adXAwreE4nhwooeYWWlW6ZpObfeRYQEAOw==\"\r\n\t\t],\r\n\t\ttriplace: [\r\n\t\t\t\"MD/wP///y\",\r\n\t\t\t\"JgyOCXas6dxrKNiLb51xv0593lJhI6ig0jlCZQabEzuHZH0v8V4AADs=\"\r\n\t\t],\r\n\t\tusotatami: [\r\n\t\t\t\"MD/wP//wC\",\r\n\t\t\t\"KIQTppqcvc6BMKIKsIuZN10hjDdZnkguKNeV2ri+pQquKi2l9nulQAEAOw==\"\r\n\t\t],\r\n\t\twagiri: [\"P/rw////y\", \"IIQPEci42dgzs1Ua77na7ShBoNR1YpilKmqtrOd+MVUAADs=\"],\r\n\t\tyajikazu: [\"P/B/f///y\", \"HoSPEMm5DZ8JtNoKmcyTo+1loBh25YVSX3mMnMsyBQA7\"],\r\n\t\tyajilin: [\"MD/wP///y\", \"HISDicas2tpL0c1Qs968nwuGl0eWHqihmVqxRgEAOw==\"],\r\n\t\tyajitatami: [\r\n\t\t\t\"MD/wP//wC\",\r\n\t\t\t\"J4wPeRvpj9SbwLhG4WV8aZkpWBVWFkh1HHSSZTuGY7ypXYnSE/y2BQA7\"\r\n\t\t],\r\n\t\tyosenabe: [\r\n\t\t\t\"ODg/////y\",\r\n\t\t\t\"JIwDd6nGjdqD0VFZr5qg+4ltGgiKJkWO4bJ8nVhCT8yeq20dBQA7\"\r\n\t\t],\r\n\r\n\t\t/* カラーパレットが3-4色時のHeader(途中まで), 16×16サイズのData Block(途中から) */\r\n\t\tbosanowa: [\r\n\t\t\t\"P/AwP/hw////////y\",\r\n\t\t\t\"LowtAst5l1gTL6Q4r968e5VR0CUBToVJ55NOlQWqIhsvGv3l+j22/FgyzYAlRwEAOw==\"\r\n\t\t],\r\n\t\tdosufuwa: [\r\n\t\t\t\"JmZmbKysszMzP///y\",\r\n\t\t\t\"KUyAYMuW3lhCMJ6plMXZXu59TyiSpIAKZmqoXoq2L6y6EV3PeLifbFAAADs=\"\r\n\t\t],\r\n\t\tsukororoom: [\r\n\t\t\t\"NDQ0ODg4PDw8P///y\",\r\n\t\t\t\"NIwfgqebBqJpS8X7nL0g18B1FNJgHukkwsqu6ZiioISYmzljN51LewfhZHBBICw2aSmXggIAOw==\"\r\n\t\t],\r\n\t\tview: [\r\n\t\t\t\"MD/wP//wP///////y\",\r\n\t\t\t\"LoQtEst5l1gTDykZXNq8+99hThWJFHlJ41OqJ5tOFdDKaAbmOnebc71YQWJBSgEAOw==\"\r\n\t\t],\r\n\t\twblink: [\r\n\t\t\t\"NDQ0ODg4Pj4+P///y\",\r\n\t\t\t\"LoQdIct5l1gLDykpXNq8+99hThWJFHlJ41OqJ5tOFdDKaAbmOnebc71YQWJBSgEAOw==\"\r\n\t\t]\r\n\t}[pid];\r\n\r\n\t/* 無い場合はimage.gifを返します */\r\n\tif (!data) {\r\n\t\tdata = [\r\n\t\t\t\"MD/wPD/8C\",\r\n\t\t\t\"KYQTpogKnFxbMDpa7W18yjhp1yGO1OidW5mSKFuaTyy585t0ctZ+EFAAADs=\"\r\n\t\t];\r\n\t}\r\n\r\n\tif (data[0].length <= 10) {\r\n\t\theader = \"R0lGODdhEAAQAIAAA\";\r\n\t} else {\r\n\t\theader = \"R0lGODdhEAAQAKEAA\";\r\n\t}\r\n\r\n\treturn (\r\n\t\t\"data:image/gif;base64,\" + header + data[0] + \"wAAAAAEAAQAAAC\" + data[1]\r\n\t);\r\n}\r\n","// Boot.js v3.4.0\r\n\r\n(function() {\r\n\t/********************************/\r\n\t/* 初期化時のみ使用するルーチン */\r\n\t/********************************/\r\n\r\n\tvar onload_pzv = null;\r\n\tvar onload_pzl = null;\r\n\tvar onload_option = {};\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ★boot() window.onload直後の処理\r\n\t//---------------------------------------------------------------------------\r\n\tpzpr.on(\"load\", function boot() {\r\n\t\tif (importData()) {\r\n\t\t\tstartPuzzle();\r\n\t\t} else {\r\n\t\t\tsetTimeout(boot, 0);\r\n\t\t}\r\n\t});\r\n\r\n\tfunction importData() {\r\n\t\tif (!onload_pzl) {\r\n\t\t\t/* 1) 盤面複製・index.htmlからのファイル入力/Database入力か */\r\n\t\t\t/* 2) URL(?以降)をチェック */\r\n\t\t\tonload_pzl = importURL();\r\n\r\n\t\t\t/* 指定されたパズルがない場合はさようなら～ */\r\n\t\t\tif (!onload_pzl || !onload_pzl.pid) {\r\n\t\t\t\tfailOpen();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tfunction failOpen() {\r\n\t\tif (!!ui.puzzle && !!ui.puzzle.pid) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar title2 = document.getElementById(\"title2\");\r\n\t\tif (!!title2) {\r\n\t\t\ttitle2.innerHTML = \"Fail to import puzzle data or URL.\";\r\n\t\t}\r\n\t\tdocument.getElementById(\"menupanel\").innerHTML = \"\";\r\n\t}\r\n\r\n\tfunction startPuzzle() {\r\n\t\tvar pzl = onload_pzl;\r\n\t\tui.pzv = onload_pzv; // for the puzz.link callback\r\n\r\n\t\t/* IE SVGのtextLengthがうまく指定できていないので回避策を追加 */\r\n\t\tif (\r\n\t\t\t(function(ua) {\r\n\t\t\t\treturn (\r\n\t\t\t\t\tua.match(/MSIE/) || (ua.match(/AppleWebKit/) && ua.match(/Edge/))\r\n\t\t\t\t);\r\n\t\t\t})(navigator.userAgent)\r\n\t\t) {\r\n\t\t\tonload_option.graphic = \"canvas\";\r\n\t\t}\r\n\r\n\t\t/* パズルオブジェクトの作成 */\r\n\t\tvar element = document.getElementById(\"divques\");\r\n\t\tvar puzzle = (ui.puzzle = new pzpr.Puzzle(element, onload_option));\r\n\t\tpzpr.connectKeyEvents(puzzle);\r\n\r\n\t\t/* パズルオブジェクト作成〜open()間に呼ぶ */\r\n\t\tui.event.onload_func(onload_option);\r\n\r\n\t\t// 単体初期化処理のルーチンへ\r\n\t\tpuzzle.once(\"fail-open\", failOpen);\r\n\t\tpuzzle.open(pzl);\r\n\t\tif (onload_option.variant !== void 0) {\r\n\t\t\tpuzzle.config.set(\"variant\", true);\r\n\t\t}\r\n\r\n\t\tpuzzle.on(\"request-aux-editor\", ui.auxeditor.open);\r\n\r\n\t\tif (!!onload_option.net) {\r\n\t\t\tui.network.configure(onload_option.net, onload_option.key);\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ★importURL() 初期化時にURLを解析し、パズルの種類・エディタ/player判定を行う\r\n\t//---------------------------------------------------------------------------\r\n\tfunction importURL() {\r\n\t\t/* index.htmlからURLが入力されていない場合は現在のURLの?以降をとってくる */\r\n\t\tvar search = location.search;\r\n\t\tif (!search) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t/* 一旦先頭の?記号を取り除く */\r\n\t\tif (search.charAt(0) === \"?\") {\r\n\t\t\tsearch = search.substr(1);\r\n\t\t}\r\n\r\n\t\twhile (search.match(/^(\\w+)\\=(\\w+)\\&(.*)/)) {\r\n\t\t\tonload_option[RegExp.$1] = RegExp.$2;\r\n\t\t\tsearch = RegExp.$3;\r\n\t\t}\r\n\r\n\t\tonload_pzv = search;\r\n\t\tvar pzl = pzpr.parser.parseURL(search);\r\n\t\tvar startmode = pzl.mode || (!pzl.body ? \"editor\" : \"player\");\r\n\t\tonload_option.type = onload_option.type || startmode;\r\n\r\n\t\treturn pzl;\r\n\t}\r\n})();\r\n","// Event.js v3.4.0\r\n/* global _doc:readonly */\r\n\r\n//---------------------------------------------------------------------------\r\n// ★UIEventsクラス イベント設定の管理を行う\r\n//---------------------------------------------------------------------------\r\n// メニュー描画/取得/html表示系\r\nui.event = {\r\n\tresizetimer: null, // resizeタイマー\r\n\tvisibilitystate: null,\r\n\r\n\tvisibilityCallbacks: [],\r\n\r\n\tremovers: [],\r\n\r\n\t//----------------------------------------------------------------------\r\n\t// event.addEvent()        addEventListener(など)を呼び出す\r\n\t//----------------------------------------------------------------------\r\n\taddEvent: function(el, event, self, callback, capt) {\r\n\t\tthis.removers.push(pzpr.util.addEvent(el, event, self, callback, !!capt));\r\n\t},\r\n\r\n\t//----------------------------------------------------------------------\r\n\t// event.removeAllEvents() addEventで登録されたイベントを削除する\r\n\t//----------------------------------------------------------------------\r\n\tremoveAllEvents: function() {\r\n\t\tthis.removers.forEach(function(remover) {\r\n\t\t\tremover();\r\n\t\t});\r\n\t\tthis.removers = [];\r\n\t},\r\n\r\n\taddVisibilityCallback: function(callback) {\r\n\t\tif (this.visibilitystate === \"visible\") {\r\n\t\t\tcallback();\r\n\t\t} else {\r\n\t\t\tthis.visibilityCallbacks.push(callback);\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// event.setWindowEvents()  マウス入力、キー入力以外のイベントの設定を行う\r\n\t//---------------------------------------------------------------------------\r\n\tsetWindowEvents: function() {\r\n\t\t// File API＋Drag&Drop APIの設定\r\n\t\tif (!!ui.reader) {\r\n\t\t\tvar DDhandler = function(e) {\r\n\t\t\t\tui.reader.readAsText(e.dataTransfer.files[0]);\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t};\r\n\t\t\tthis.addEvent(\r\n\t\t\t\twindow,\r\n\t\t\t\t\"dragover\",\r\n\t\t\t\tthis,\r\n\t\t\t\tfunction(e) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t},\r\n\t\t\t\ttrue\r\n\t\t\t);\r\n\t\t\tthis.addEvent(window, \"drop\", this, DDhandler, true);\r\n\t\t}\r\n\r\n\t\t// onBlurにイベントを割り当てる\r\n\t\tthis.addEvent(_doc, \"blur\", this, this.onblur_func);\r\n\r\n\t\t// onresizeイベントを割り当てる\r\n\t\tvar evname = !pzpr.env.OS.iOS ? \"resize\" : \"orientationchange\";\r\n\t\tthis.addEvent(window, evname, this, this.onresize_func);\r\n\r\n\t\t// onbeforeunloadイベントを割り当てる\r\n\t\tthis.addEvent(window, \"beforeunload\", this, this.onbeforeunload_func);\r\n\r\n\t\t// onunloadイベントを割り当てる\r\n\t\tthis.addEvent(window, \"unload\", this, this.onunload_func);\r\n\r\n\t\tif (!!matchMedia) {\r\n\t\t\tvar mqString = \"(resolution: 1dppx)\";\r\n\t\t\tmatchMedia(mqString).addListener(this.onpixelratiochange_func);\r\n\t\t}\r\n\t},\r\n\r\n\tsetDocumentEvents: function() {\r\n\t\tthis.addEvent(\r\n\t\t\tdocument,\r\n\t\t\t\"visibilitychange\",\r\n\t\t\tthis,\r\n\t\t\tthis.onvisibilitychange_func\r\n\t\t);\r\n\t\tthis.onvisibilitychange_func(); // set state\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// event.onload_func()   ウィンドウを開いた時に呼ばれる関数\r\n\t// event.onunload_func() ウィンドウをクローズする前に呼ばれる関数\r\n\t//---------------------------------------------------------------------------\r\n\tonload_func: function(onload_option) {\r\n\t\tui.initFileReadMethod();\r\n\r\n\t\tui.urlconfig.init(onload_option);\r\n\t\tui.menuconfig.restore();\r\n\r\n\t\tui.listener.setListeners(ui.puzzle);\r\n\r\n\t\tif (pzpr.env.OS.Android) {\r\n\t\t\tui.misc.modifyCSS({\r\n\t\t\t\t\"body, .btn\": { fontFamily: \"Verdana, Arial, sans-serif\" }\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\tonunload_func: function() {\r\n\t\tui.menuconfig.save();\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// event.onresize_func() ウィンドウリサイズ時に呼ばれる関数\r\n\t// event.onblur_func()   ウィンドウからフォーカスが離れた時に呼ばれる関数\r\n\t// event.onbeforeunload_func()  ウィンドウをクローズする前に呼ばれる関数\r\n\t//---------------------------------------------------------------------------\r\n\tonresize_func: function() {\r\n\t\tif (this.resizetimer) {\r\n\t\t\tclearTimeout(this.resizetimer);\r\n\t\t}\r\n\t\tthis.resizetimer = setTimeout(function() {\r\n\t\t\tui.adjustcellsize();\r\n\t\t}, 250);\r\n\t},\r\n\tonblur_func: function() {\r\n\t\tui.puzzle.key.keyreset();\r\n\t\tui.puzzle.mouse.mousereset();\r\n\t},\r\n\tonbeforeunload_func: function(e) {\r\n\t\tif (ui.puzzle.playeronly || !ui.puzzle.ismodified()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar msg = ui.selectStr(\"盤面が更新されています\", \"The board is edited.\");\r\n\t\te.returnValue = msg;\r\n\t\treturn msg;\r\n\t},\r\n\r\n\tonvisibilitychange_func: function(e) {\r\n\t\tvar state = document.visibilityState;\r\n\t\tif (state !== this.visibilitystate) {\r\n\t\t\tthis.visibilitystate = state;\r\n\t\t\tif (state === \"visible\") {\r\n\t\t\t\tfor (var i = 0; i < this.visibilityCallbacks.length; i++) {\r\n\t\t\t\t\tthis.visibilityCallbacks[i]();\r\n\t\t\t\t}\r\n\t\t\t\tthis.visibilityCallbacks = [];\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tonpixelratiochange_func: function(e) {\r\n\t\tui.puzzle.redraw(true);\r\n\t}\r\n};\r\n","// Listener.js v3.4.1\r\n\r\n//---------------------------------------------------------------------------\r\n// ★UIListener Puzzleに付加するListenerイベント設定の管理を行う\r\n//  注意：execListenerで呼び出される関数は、thisがui.listenerになっていません\r\n//---------------------------------------------------------------------------\r\nui.listener = {\r\n\t//---------------------------------------------------------------------------\r\n\t// listener.setListeners()  PuzzleのListenerを登録する\r\n\t//---------------------------------------------------------------------------\r\n\tsetListeners: function(puzzle) {\r\n\t\tpuzzle.once(\"ready\", this.onFirstReady);\r\n\t\tpuzzle.on(\"ready\", this.onReady);\r\n\r\n\t\tpuzzle.on(\"key\", this.onKeyInput);\r\n\t\tpuzzle.on(\"mouse\", this.onMouseInput);\r\n\t\tpuzzle.on(\"history\", this.onHistoryChange);\r\n\t\tpuzzle.on(\"trial\", this.onTrialModeChange);\r\n\t\tpuzzle.on(\"mode\", this.onModeChange);\r\n\r\n\t\tpuzzle.on(\"adjust\", this.onAdjust);\r\n\t\tpuzzle.on(\"resize\", this.onResize);\r\n\r\n\t\tpuzzle.on(\"cellop\", this.onCellOp);\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// listener.onFirstReady() 初回のパズル読み込み完了時に呼び出される関数\r\n\t// listener.onReady()  パズル読み込み完了時に呼び出される関数\r\n\t//---------------------------------------------------------------------------\r\n\tonFirstReady: function(puzzle) {\r\n\t\tui.initImageSaveMethod(puzzle);\r\n\t\tui.timer.init();\r\n\t},\r\n\tonReady: function(puzzle) {\r\n\t\t/* パズルの種類が同じならMenuArea等の再設定は行わない */\r\n\t\tif (ui.currentpid !== puzzle.pid) {\r\n\t\t\t/* 以前設定済みのイベントを削除する */\r\n\t\t\tui.event.removeAllEvents();\r\n\r\n\t\t\t/* menuareaより先に キーポップアップを作成する必要がある */\r\n\t\t\tui.keypopup.create();\r\n\r\n\t\t\t/* メニュー用の設定を消去・再設定する */\r\n\t\t\tui.menuarea.reset();\r\n\t\t\tui.toolarea.reset();\r\n\t\t\tui.popupmgr.reset();\r\n\t\t\tui.notify.reset();\r\n\t\t\tui.misc.displayDesign();\r\n\r\n\t\t\t/* Windowへのイベント設定 */\r\n\t\t\tui.event.setWindowEvents();\r\n\t\t\tui.event.setDocumentEvents();\r\n\t\t}\r\n\r\n\t\tui.menuconfig.sync();\r\n\t\tui.menuconfig.set(\r\n\t\t\t\"autocheck_once\",\r\n\t\t\tui.menuconfig.get(\"autocheck_mode\") !== \"off\" && ui.puzzle.playeronly\r\n\t\t);\r\n\t\tui.currentpid = puzzle.pid;\r\n\r\n\t\tui.adjustcellsize();\r\n\t\tui.keypopup.display();\r\n\r\n\t\tui.event.addVisibilityCallback(function() {\r\n\t\t\tui.timer.start();\r\n\t\t});\r\n\r\n\t\tui.network.start();\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// listener.onKeyInput()    キー入力時に呼び出される関数 (return false = 処理をキャンセル)\r\n\t// listener.onMouseInput()  盤面へのマウス入力時に呼び出される関数 (return false = 処理をキャンセル)\r\n\t//---------------------------------------------------------------------------\r\n\tonKeyInput: function(puzzle, c) {\r\n\t\tvar kc = puzzle.key,\r\n\t\t\tut = ui.undotimer,\r\n\t\t\tresult = true;\r\n\t\tif (kc.keydown) {\r\n\t\t\t/* TimerでUndo/Redoする */\r\n\t\t\tif (c === \"ctrl+z\" || c === \"meta+z\") {\r\n\t\t\t\tut.startUndo();\r\n\t\t\t\tresult = false;\r\n\t\t\t}\r\n\t\t\tif (c === \"ctrl+y\" || c === \"meta+y\") {\r\n\t\t\t\tut.startRedo();\r\n\t\t\t\tresult = false;\r\n\t\t\t}\r\n\r\n\t\t\t/* F2で回答モード Shift+F2で問題作成モード */\r\n\t\t\tif (!puzzle.playeronly) {\r\n\t\t\t\tif (puzzle.editmode && c === \"F2\") {\r\n\t\t\t\t\tui.menuconfig.set(\"mode\", puzzle.MODE_PLAYER);\r\n\t\t\t\t\tresult = false;\r\n\t\t\t\t} else if (puzzle.playmode && c === \"shift+F2\") {\r\n\t\t\t\t\tui.menuconfig.set(\"mode\", puzzle.MODE_EDITOR);\r\n\t\t\t\t\tresult = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (kc.keyup) {\r\n\t\t\t/* TimerのUndo/Redoを停止する */\r\n\t\t\tut.stop();\r\n\t\t}\r\n\r\n\t\tkc.cancelEvent = !result;\r\n\t},\r\n\tonMouseInput: function(puzzle) {\r\n\t\tvar mv = puzzle.mouse,\r\n\t\t\tresult = true;\r\n\t\tif (mv.mousestart && mv.btn === \"middle\") {\r\n\t\t\t/* 中ボタン */\r\n\t\t\tui.menuconfig.set(\"mode\", puzzle.playmode ? \"edit\" : \"play\");\r\n\t\t\tmv.mousereset();\r\n\t\t\tresult = false;\r\n\t\t}\r\n\r\n\t\tmv.cancelEvent = !result;\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// listener.onHistoryChange() 履歴変更時に呼び出される関数\r\n\t// listener.onTrialModeChange() 仮置きモード変更時に呼び出される関数\r\n\t// listener.onModeChange()      Mode変更時に呼び出される関数\r\n\t//---------------------------------------------------------------------------\r\n\tonHistoryChange: function(puzzle) {\r\n\t\tif (!!ui.currentpid) {\r\n\t\t\tui.setdisplay(\"operation\");\r\n\t\t}\r\n\t},\r\n\tonTrialModeChange: function(puzzle, trialstage) {\r\n\t\tif (!!ui.currentpid) {\r\n\t\t\tui.setdisplay(\"trialmode\");\r\n\t\t}\r\n\t},\r\n\tonModeChange: function(puzzle) {\r\n\t\tui.menuconfig.list.mode.val = ui.puzzle.playmode ? \"play\" : \"edit\";\r\n\t\tui.setdisplay(\"mode\");\r\n\t\tui.menuconfig.set(\"inputmode\", ui.puzzle.mouse.inputMode);\r\n\r\n\t\tui.setdisplay(\"keypopup\");\r\n\t\tui.setdisplay(\"bgcolor\");\r\n\t\tfor (var key in ui.puzzle.config.getVariants()) {\r\n\t\t\tui.setdisplay(key);\r\n\t\t}\r\n\t\tui.keypopup.display();\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// listener.onAdjust()  盤面の大きさが変わったときの処理を呼び出す\r\n\t//---------------------------------------------------------------------------\r\n\tonAdjust: function(puzzle) {\r\n\t\tui.adjustcellsize();\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// listener.onResize()  canvasのサイズを変更したときの処理を呼び出す\r\n\t//---------------------------------------------------------------------------\r\n\tonResize: function(puzzle) {\r\n\t\tvar pc = puzzle.painter,\r\n\t\t\tcellsize = Math.min(pc.cw, pc.ch);\r\n\t\tvar val = (ui.getBoardPadding() * cellsize) | 0,\r\n\t\t\tvalTop = val;\r\n\t\tif (puzzle.pid === \"starbattle\" || puzzle.pid === \"easyasabc\") {\r\n\t\t\tvalTop = ((0.05 * cellsize) | 0) + \"px\";\r\n\t\t}\r\n\t\tpuzzle.canvas.parentNode.style.padding = val + \"px\";\r\n\t\tpuzzle.canvas.parentNode.style.paddingTop = valTop + \"px\";\r\n\r\n\t\tui.keypopup.resizepanel();\r\n\t},\r\n\r\n\tonCellOp: function(puzzle, op) {\r\n\t\tui.network.onCellOp(op);\r\n\t}\r\n};\r\n","// MenuConfig.js v3.4.1\r\n\r\n(function() {\r\n\t//---------------------------------------------------------------------------\r\n\t// ★MenuConfigクラス UI側の設定値を管理する\r\n\t//---------------------------------------------------------------------------\r\n\tvar Config = pzpr.Puzzle.prototype.Config.prototype;\r\n\r\n\t// メニュー描画/取得/html表示系\r\n\t// Menuクラス\r\n\tui.menuconfig = {\r\n\t\tlist: null, // MenuConfigの設定内容を保持する\r\n\t\tpuzzle: null,\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// menuconfig.init()  MenuConfigの初期化を行う\r\n\t\t// menuconfig.add()   初期化時に設定を追加する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinit: function() {\r\n\t\t\tthis.list = {};\r\n\r\n\t\t\t/* 正解自動判定機能 */\r\n\t\t\tthis.add(\"autocheck_mode\", \"guarded\", {\r\n\t\t\t\toption: [\"off\", \"simple\", \"guarded\"]\r\n\t\t\t});\r\n\r\n\t\t\t/* per-solve autocheck status, turned off when complete */\r\n\t\t\tthis.add(\"autocheck_once\", ui.puzzle.playeronly, {\r\n\t\t\t\tvolatile: true\r\n\t\t\t});\r\n\r\n\t\t\tthis.add(\"keypopup\", false); /* キーポップアップ (数字などのパネル入力) */\r\n\r\n\t\t\tthis.add(\"adjsize\", true); /* 自動横幅調節 */\r\n\t\t\tthis.add(\r\n\t\t\t\t\"cellsizeval\",\r\n\t\t\t\tui.windowWidth() <= 960 ? 36 : 48\r\n\t\t\t); /* セルのサイズ設定用 */\r\n\t\t\tthis.add(\r\n\t\t\t\t\"fullwidth\",\r\n\t\t\t\tui.windowWidth() < 600\r\n\t\t\t); /* キャンバスを横幅いっぱいに広げる */\r\n\r\n\t\t\tthis.add(\"toolarea\", true); /* ツールエリアの表示 */\r\n\r\n\t\t\tthis.add(\"inputmode\", \"auto\", { volatile: true }); /* inputMode */\r\n\t\t\tthis.add(\"auxeditor_inputmode\", \"auto\", { volatile: true });\r\n\r\n\t\t\tthis.add(\"lrinvert\", false, {\r\n\t\t\t\tvolatile: true\r\n\t\t\t}); /* マウスの左右ボタンを反転する設定 */\r\n\r\n\t\t\tthis.add(\"language\", pzpr.lang, { option: [\"en\", \"ja\"] }); /* 言語設定 */\r\n\r\n\t\t\t/* puzzle.configを一括で扱うため登録 */\r\n\t\t\tthis.puzzle = ui.puzzle;\r\n\t\t\tfor (var name in ui.puzzle.config.list) {\r\n\t\t\t\tvar item = ui.puzzle.config.list[name],\r\n\t\t\t\t\textoption = { puzzle: true };\r\n\t\t\t\tfor (var field in item.extoption) {\r\n\t\t\t\t\textoption[field] = item[field];\r\n\t\t\t\t}\r\n\t\t\t\tthis.add(name, item.defval, extoption);\r\n\t\t\t}\r\n\t\t\tthis.add(\"mode\", !ui.puzzle.playmode ? \"edit\" : \"play\", {\r\n\t\t\t\toption: [\"edit\", \"play\"],\r\n\t\t\t\tpuzzle: true\r\n\t\t\t});\r\n\t\t},\r\n\t\tadd: function(name, defvalue, extoption) {\r\n\t\t\tConfig.add.call(this, name, defvalue, extoption);\r\n\t\t\tif (!!extoption && extoption.puzzle) {\r\n\t\t\t\tvar item = this.list[name];\r\n\t\t\t\titem.volatile = item.puzzle = true;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// menuconfig.sync()  URL形式などによって変化する可能性がある設定値を同期する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsync: function() {\r\n\t\t\tvar idname = null;\r\n\t\t\tswitch (ui.puzzle.pid) {\r\n\t\t\t\tcase \"yajilin\":\r\n\t\t\t\t\tidname = \"disptype_yajilin\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"bosanowa\":\r\n\t\t\t\t\tidname = \"disptype_bosanowa\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"interbd\":\r\n\t\t\t\t\tidname = \"disptype_interbd\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"arukone\":\r\n\t\t\t\t\tidname = \"dontpassallcell\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"aquarium\":\r\n\t\t\t\t\tidname = \"aquarium_regions\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"country\":\r\n\t\t\t\t\tidname = \"country_empty\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif (!!idname) {\r\n\t\t\t\tthis.set(idname, ui.puzzle.getConfig(idname));\r\n\t\t\t}\r\n\r\n\t\t\tthis.set(\"variant\", ui.puzzle.getConfig(\"variant\"));\r\n\t\t\tthis.set(\"lrinvert\", ui.puzzle.mouse.inversion);\r\n\t\t\tthis.set(\"autocmp\", ui.puzzle.getConfig(\"autocmp\"));\r\n\t\t\tthis.set(\"autoerr\", ui.puzzle.getConfig(\"autoerr\"));\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// menuconfig.getCurrentName()  指定されたidを現在使用している名前に変換する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetCurrentName: Config.getCurrentName,\r\n\t\tgetNormalizedName: Config.getNormalizedName,\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// menuconfig.get()  各フラグの設定値を返す\r\n\t\t// menuconfig.get()  各フラグの設定値を返す\r\n\t\t// menuconfig.reset() 各フラグの設定値を初期化する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tget: Config.get,\r\n\t\tset: function(argname, newval) {\r\n\t\t\tvar names = this.getNormalizedName(argname),\r\n\t\t\t\tidname = names.name;\r\n\t\t\tif (!this.list[idname]) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (idname === \"mode\" || idname === \"inputmode\") {\r\n\t\t\t\tif (ui.popupmgr.popups.auxeditor.pop) {\r\n\t\t\t\t\tui.popupmgr.popups.auxeditor.close();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (idname === \"mode\") {\r\n\t\t\t\tui.puzzle.setMode(newval);\r\n\t\t\t\tnewval = !ui.puzzle.playmode ? \"edit\" : \"play\";\r\n\t\t\t} else if (idname === \"inputmode\") {\r\n\t\t\t\tui.puzzle.mouse.setInputMode(newval);\r\n\t\t\t\tnewval = ui.puzzle.mouse.inputMode;\r\n\t\t\t} else if (idname === \"auxeditor_inputmode\") {\r\n\t\t\t\tui.auxeditor.puzzle.mouse.setInputMode(newval);\r\n\t\t\t\tnewval = ui.auxeditor.puzzle.mouse.inputMode;\r\n\t\t\t}\r\n\r\n\t\t\tnewval = this.setproper(names, newval);\r\n\r\n\t\t\tif (idname === \"language\") {\r\n\t\t\t\tpzpr.lang = newval;\r\n\t\t\t} else if (this.list[idname].puzzle) {\r\n\t\t\t\tui.puzzle.setConfig(argname, newval);\r\n\t\t\t}\r\n\r\n\t\t\tthis.configevent(idname, newval);\r\n\t\t},\r\n\t\treset: Config.reset,\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// menuconfig.restore()  保存された各種設定値を元に戻す\r\n\t\t// menuconfig.save()     各種設定値を保存する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\trestore: function() {\r\n\t\t\t/* 設定が保存されている場合は元に戻す */\r\n\t\t\tui.puzzle.config.init();\r\n\t\t\tthis.init();\r\n\t\t\tvar json_puzzle = localStorage[\"pzprv3_config:puzzle\"];\r\n\t\t\tvar json_menu = localStorage[\"pzprv3_config:ui\"];\r\n\t\t\tif (!!json_puzzle) {\r\n\t\t\t\tthis.setAll(JSON.parse(json_puzzle));\r\n\t\t\t}\r\n\t\t\tif (!!json_menu) {\r\n\t\t\t\tthis.setAll(JSON.parse(json_menu));\r\n\t\t\t}\r\n\t\t},\r\n\t\tsave: function() {\r\n\t\t\tlocalStorage[\"pzprv3_config:puzzle\"] = JSON.stringify(\r\n\t\t\t\tui.puzzle.saveConfig()\r\n\t\t\t);\r\n\t\t\tlocalStorage[\"pzprv3_config:ui\"] = JSON.stringify(this.getAll());\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// menuconfig.getList()  現在有効な設定値のリストを返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetList: Config.getList,\r\n\t\tgetexec: function(name) {\r\n\t\t\tif (!this.list[name]) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (name === \"mode\") {\r\n\t\t\t\treturn !ui.puzzle.playeronly;\r\n\t\t\t} else if (this.list[name].puzzle) {\r\n\t\t\t\treturn ui.puzzle.validConfig(name);\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// menuconfig.getAll()  全フラグの設定値を返す\r\n\t\t// menuconfig.setAll()  全フラグの設定値を設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetAll: Config.getAll,\r\n\t\tsetAll: function(setting) {\r\n\t\t\tfor (var key in setting) {\r\n\t\t\t\tthis.set(key, setting[key]);\r\n\t\t\t}\r\n\t\t\tthis.list.autocheck_once.val = this.list.autocheck_mode.val !== \"off\";\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// menuconfig.setproper()    設定値の型を正しいものに変換して設定変更する\r\n\t\t// menuconfig.valid()        設定値が有効なパズルかどうかを返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetproper: Config.setproper,\r\n\t\tvalid: function(idname) {\r\n\t\t\tif (!this.list[idname]) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (idname === \"keypopup\") {\r\n\t\t\t\treturn ui.keypopup.paneltype[1] !== 0 || ui.keypopup.paneltype[3] !== 0;\r\n\t\t\t} else if (idname === \"mode\") {\r\n\t\t\t\treturn !ui.puzzle.playeronly;\r\n\t\t\t} else if (idname === \"inputmode\") {\r\n\t\t\t\treturn (\r\n\t\t\t\t\tui.puzzle.mouse.getInputModeList(\"play\").length > 1 ||\r\n\t\t\t\t\t(!ui.puzzle.playeronly &&\r\n\t\t\t\t\t\tui.puzzle.mouse.getInputModeList(\"edit\").length > 1)\r\n\t\t\t\t);\r\n\t\t\t} else if (idname === \"autocheck_mode\" || idname === \"autocheck_once\") {\r\n\t\t\t\treturn ui.puzzle.playeronly && !ui.puzzle.getConfig(\"variant\");\r\n\t\t\t} else if (this.list[idname].puzzle) {\r\n\t\t\t\treturn ui.puzzle.validConfig(idname);\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// config.configevent()  設定変更時の動作を記述する (modeはlistener.onModeChangeで変更)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tconfigevent: function(idname, newval) {\r\n\t\t\tif (!ui.menuarea.menuitem) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tui.setdisplay(idname);\r\n\t\t\tswitch (idname) {\r\n\t\t\t\tcase \"keypopup\":\r\n\t\t\t\t\tui.keypopup.display();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"adjsize\":\r\n\t\t\t\tcase \"cellsizeval\":\r\n\t\t\t\tcase \"fullwidth\":\r\n\t\t\t\t\tui.adjustcellsize();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"autocheck_mode\":\r\n\t\t\t\t\tthis.list.autocheck_once.val = newval !== \"off\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"language\":\r\n\t\t\t\t\tui.displayAll();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"lrinvert\":\r\n\t\t\t\t\tui.puzzle.mouse.setInversion(newval);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n})();\r\n","(function() {\r\n\tui.urlconfig = {\r\n\t\tembed: false,\r\n\r\n\t\tinit: function(onload_option) {\r\n\t\t\tif (onload_option.embed === \"yes\") {\r\n\t\t\t\tthis.embed = true;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n})();\r\n","// MenuArea.js v3.4.0\r\n/* global getEL:readonly, _doc:readonly */\r\n\r\n// メニュー描画/取得/html表示系\r\nvar winstr = \"Congratulations! The answer is COMPARED.\"\r\nui.menuarea = {\r\n\tcaptions: [], // 言語指定を切り替えた際のキャプションを保持する\r\n\tmenuitem: null, // メニューの設定切り替え用エレメント等を保持する\r\n\tnohover: false, // :hover擬似クラスを使用しないでhover表示する\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// menuarea.reset()  メニュー、サブメニュー、フロートメニューの初期設定を行う\r\n\t//---------------------------------------------------------------------------\r\n\treset: function() {\r\n\t\tthis.createMenu();\r\n\r\n\t\tthis.display();\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// menuarea.createMenu()  メニューの初期設定を行う\r\n\t//---------------------------------------------------------------------------\r\n\tcreateMenu: function() {\r\n\t\tif (this.menuitem === null) {\r\n\t\t\tthis.modifySelector();\r\n\r\n\t\t\tthis.menuitem = {};\r\n\t\t\tthis.walkElement(getEL(\"menupanel\"));\r\n\t\t}\r\n\t\tui.misc.displayByPid(getEL(\"menupanel\"));\r\n\t\tthis.stopHovering();\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// menuarea.walkElement()  エレメントを探索して領域の初期設定を行う\r\n\t//---------------------------------------------------------------------------\r\n\twalkElement: function(parent) {\r\n\t\tvar menuarea = this;\r\n\t\tfunction menufactory(role) {\r\n\t\t\treturn function(e) {\r\n\t\t\t\tmenuarea[role](e);\r\n\t\t\t\tif (menuarea.nohover) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t\tfunction addmenuevent(el, type, role) {\r\n\t\t\tvar func = typeof role === \"function\" ? role : menufactory(role);\r\n\t\t\tpzpr.util.addEvent(el, type, menuarea, func);\r\n\t\t}\r\n\t\tui.misc.walker(parent, function(el) {\r\n\t\t\tif (el.nodeType === 1 && el.nodeName === \"LI\") {\r\n\t\t\t\tvar setevent = false;\r\n\t\t\t\tvar idname = ui.customAttr(el, \"config\");\r\n\t\t\t\tif (!!idname) {\r\n\t\t\t\t\tmenuarea.menuitem[idname] = { el: el };\r\n\t\t\t\t\tif (el.className === \"check\") {\r\n\t\t\t\t\t\taddmenuevent(el, \"mousedown\", \"checkclick\");\r\n\t\t\t\t\t\tsetevent = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar value = ui.customAttr(el, \"value\");\r\n\t\t\t\tif (!!value) {\r\n\t\t\t\t\tvar parent = el.parentNode.parentNode;\r\n\t\t\t\t\tidname = ui.customAttr(parent, \"config\");\r\n\t\t\t\t\tvar item = menuarea.menuitem[idname];\r\n\t\t\t\t\tif (!item.children) {\r\n\t\t\t\t\t\titem.children = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t\titem.children.push(el);\r\n\r\n\t\t\t\t\taddmenuevent(el, \"mousedown\", \"childclick\");\r\n\t\t\t\t\tsetevent = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar role = ui.customAttr(el, \"menuExec\");\r\n\t\t\t\tif (!!role) {\r\n\t\t\t\t\taddmenuevent(el, \"mousedown\", role);\r\n\t\t\t\t\tsetevent = true;\r\n\t\t\t\t}\r\n\t\t\t\trole = ui.customAttr(el, \"pressExec\");\r\n\t\t\t\tif (!!role) {\r\n\t\t\t\t\tvar roles = role.split(/,/);\r\n\t\t\t\t\taddmenuevent(el, \"mousedown\", roles[0]);\r\n\t\t\t\t\tif (!!role[1]) {\r\n\t\t\t\t\t\taddmenuevent(el, \"mouseup\", roles[1]);\r\n\t\t\t\t\t\taddmenuevent(el, \"mouseleave\", roles[1]);\r\n\t\t\t\t\t\taddmenuevent(el, \"touchcancel\", roles[1]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetevent = true;\r\n\t\t\t\t}\r\n\t\t\t\trole = ui.customAttr(el, \"popup\");\r\n\t\t\t\tif (!!role) {\r\n\t\t\t\t\taddmenuevent(el, \"mousedown\", \"disppopup\");\r\n\t\t\t\t\tsetevent = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (el.className === \"link\") {\r\n\t\t\t\t\taddmenuevent(el, \"mousedown\", \"updatelink\");\r\n\t\t\t\t\tsetevent = true; // bypass setting event below\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!setevent) {\r\n\t\t\t\t\tif (!menuarea.nohover || !el.querySelector(\"menu\")) {\r\n\t\t\t\t\t\taddmenuevent(el, \"mousedown\", function(e) {\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\taddmenuevent(el, \"mousedown\", function(e) {\r\n\t\t\t\t\t\t\tmenuarea.showHovering(e, el);\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar link = ui.customAttr(el, \"pidlink\");\r\n\t\t\t\tif (!!link) {\r\n\t\t\t\t\tel.firstChild.setAttribute(\"href\", link + ui.puzzle.pid);\r\n\t\t\t\t}\r\n\t\t\t} else if (el.nodeType === 1 && el.nodeName === \"MENU\") {\r\n\t\t\t\tvar label = el.getAttribute(\"label\");\r\n\t\t\t\tif (!!label && label.match(/^__(.+)__(.+)__$/)) {\r\n\t\t\t\t\tmenuarea.captions.push({\r\n\t\t\t\t\t\tmenu: el,\r\n\t\t\t\t\t\tstr_jp: RegExp.$1,\r\n\t\t\t\t\t\tstr_en: RegExp.$2\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (menuarea.nohover) {\r\n\t\t\t\t\t\taddmenuevent(el, \"mousedown\", function(e) {\r\n\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (el.nodeType === 3) {\r\n\t\t\t\tif (el.data.match(/^__(.+)__(.+)__$/)) {\r\n\t\t\t\t\tmenuarea.captions.push({\r\n\t\t\t\t\t\ttextnode: el,\r\n\t\t\t\t\t\tstr_jp: RegExp.$1,\r\n\t\t\t\t\t\tstr_en: RegExp.$2\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\t//--------------------------------------------------------------------------------\r\n\t// menuarea.modifySelector()  MenuAreaに関するCSSセレクタテキストを変更する (Android向け)\r\n\t//--------------------------------------------------------------------------------\r\n\tmodifySelector: function() {\r\n\t\t/* Android 4.0, iOS5.1以上向け処理です */\r\n\t\tif (!pzpr.env.OS.mobile || !getEL(\"menupanel\").classList) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar sheet = _doc.styleSheets[0];\r\n\t\tvar rules = sheet.cssRules || sheet.rules;\r\n\t\tif (rules === null) {\r\n\t\t} // Chromeでローカルファイルを開くとおかしくなるので、とりあえず何もしないようにします\r\n\r\n\t\tfor (var i = 0, len = rules.length; i < len; i++) {\r\n\t\t\tvar rule = rules[i];\r\n\t\t\tif (!rule.selectorText) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (rule.selectorText.match(/\\#menupanel.+\\:hover.*/)) {\r\n\t\t\t\tsheet.insertRule(rule.cssText.replace(\":hover\", \".hovering\"), i);\r\n\t\t\t\tsheet.deleteRule(i + 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.nohover = true;\r\n\t},\r\n\r\n\t//--------------------------------------------------------------------------------\r\n\t// menuarea.showHovering()  MenuAreaのポップアップを表示する (Android向け)\r\n\t// menuarea.stopHovering()  MenuAreaのポップアップを消去する (Android向け)\r\n\t//--------------------------------------------------------------------------------\r\n\tshowHovering: function(e, el0) {\r\n\t\tif (!this.nohover) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tel0.classList.toggle(\"hovering\");\r\n\t\tui.misc.walker(getEL(\"menupanel\"), function(el) {\r\n\t\t\tif (el.nodeType === 1 && !!el.classList && !el.contains(el0)) {\r\n\t\t\t\tel.classList.remove(\"hovering\");\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tstopHovering: function() {\r\n\t\tif (!this.nohover) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tui.misc.walker(getEL(\"menupanel\"), function(el) {\r\n\t\t\tif (el.nodeType === 1 && !!el.classList) {\r\n\t\t\t\tel.classList.remove(\"hovering\");\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// menuarea.display()    全てのメニューに対して文字列を設定する\r\n\t// menuarea.setdisplay() サブメニューに表示する文字列を個別に設定する\r\n\t//---------------------------------------------------------------------------\r\n\tdisplay: function() {\r\n\t\tgetEL(\"menupanel\").style.display = \"\";\r\n\r\n\t\tgetEL(\"menu_imagesave\").className = ui.enableSaveImage ? \"\" : \"disabled\";\r\n\r\n\t\tvar EDITOR = !ui.puzzle.playeronly;\r\n\t\tgetEL(\"menu_edit\").style.display = EDITOR ? \"\" : \"none\";\r\n\t\tgetEL(\"menu_newboard\").style.display = EDITOR ? \"\" : \"none\";\r\n\t\tgetEL(\"menu_urloutput\").style.display = EDITOR ? \"\" : \"none\";\r\n\t\tgetEL(\"menu_adjust\").style.display = EDITOR ? \"\" : \"none\";\r\n\t\tgetEL(\"menu_turnflip\").style.display = EDITOR ? \"\" : \"none\";\r\n\r\n\t\tfor (var idname in this.menuitem) {\r\n\t\t\tthis.setdisplay(idname);\r\n\t\t}\r\n\t\tthis.setdisplay(\"operation\");\r\n\t\tthis.setdisplay(\"trialmode\");\r\n\t\tthis.setdisplay(\"toolarea\");\r\n\t\tthis.setdisplay(\"networkplay\");\r\n\r\n\t\t/* キャプションの設定 */\r\n\t\tfor (var i = 0; i < this.captions.length; i++) {\r\n\t\t\tvar obj = this.captions[i];\r\n\t\t\tif (!!obj.textnode) {\r\n\t\t\t\tobj.textnode.data = ui.selectStr(obj.str_jp, obj.str_en);\r\n\t\t\t} else if (!!obj.menu) {\r\n\t\t\t\tobj.menu.setAttribute(\"label\", ui.selectStr(obj.str_jp, obj.str_en));\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tsetdisplay: function(idname) {\r\n\t\tif (idname === \"trialmode\") {\r\n\t\t\tvar trial = ui.puzzle.board.trialstage > 0;\r\n\t\t\tgetEL(\"menu_adjust\").className = trial ? \"disabled\" : \"\";\r\n\t\t\tgetEL(\"menu_turnflip\").className = trial ? \"disabled\" : \"\";\r\n\t\t}\r\n\r\n\t\tif (idname === \"toolarea\") {\r\n\t\t\tvar str;\r\n\t\t\tif (!ui.menuconfig.get(\"toolarea\")) {\r\n\t\t\t\tstr = ui.selectStr(\"ツールエリアを表示\", \"Show tool area\");\r\n\t\t\t} else {\r\n\t\t\t\tstr = ui.selectStr(\"ツールエリアを隠す\", \"Hide tool area\");\r\n\t\t\t}\r\n\t\t\tgetEL(\"menu_toolarea\").textContent = str;\r\n\t\t} else if (idname === \"networkplay\") {\r\n\t\t\t/* ALSO DO NOTHING */\r\n\t\t} else if (this.menuitem === null || !this.menuitem[idname]) {\r\n\t\t\t/* DO NOTHING */\r\n\t\t} else if (ui.menuconfig.valid(idname)) {\r\n\t\t\tvar menuitem = this.menuitem[idname];\r\n\t\t\tmenuitem.el.style.display = \"\";\r\n\r\n\t\t\t/* セレクタ部の設定を行う */\r\n\t\t\tif (!!menuitem.children) {\r\n\t\t\t\tvar children = menuitem.children;\r\n\t\t\t\tvar validval =\r\n\t\t\t\t\tidname === \"inputmode\" ? ui.puzzle.mouse.getInputModeList() : null;\r\n\t\t\t\tfor (var i = 0; i < children.length; i++) {\r\n\t\t\t\t\tvar child = children[i],\r\n\t\t\t\t\t\tvalue = ui.customAttr(child, \"value\"),\r\n\t\t\t\t\t\tselected = value === \"\" + ui.menuconfig.get(idname);\r\n\t\t\t\t\tchild.className = selected ? \"checked\" : \"\";\r\n\t\t\t\t\tchild.style.display =\r\n\t\t\t\t\t\tvalidval === null || validval.indexOf(value) >= 0 ? \"\" : \"none\";\r\n\t\t\t\t}\r\n\t\t\t} else if (!!menuitem.el) {\r\n\t\t\t\t/* Check部の表記の変更 */\r\n\t\t\t\tvar cname = ui.menuconfig.get(idname) ? \"checked\" : \"check\";\r\n\t\t\t\tvar disabled = null;\r\n\t\t\t\tif (ui.puzzle.config.getvariant(idname)) {\r\n\t\t\t\t\tdisabled = !ui.puzzle.editmode;\r\n\t\t\t\t}\r\n\t\t\t\tif (disabled === true) {\r\n\t\t\t\t\tcname += \" disabled\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmenuitem.el.className = cname;\r\n\t\t\t}\r\n\t\t} else if (!!this.menuitem[idname]) {\r\n\t\t\tthis.menuitem[idname].el.style.display = \"none\";\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// menuarea.checkclick()   メニューから設定値の入力があった時、設定を変更する\r\n\t// menuarea.childclick()   メニューから設定値の入力があった時、設定を変更する\r\n\t//---------------------------------------------------------------------------\r\n\tcheckclick: function(e) {\r\n\t\tvar el = e.target;\r\n\t\tif (el.nodeName === \"SPAN\") {\r\n\t\t\tel = el.parentNode;\r\n\t\t}\r\n\t\tif (el.className.match(/disabled/)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar idname = ui.customAttr(el, \"config\");\r\n\t\tui.menuconfig.set(idname, !ui.menuconfig.get(idname));\r\n\t},\r\n\tchildclick: function(e) {\r\n\t\tvar el = e.target;\r\n\t\tif (el.nodeName === \"SPAN\") {\r\n\t\t\tel = el.parentNode;\r\n\t\t}\r\n\r\n\t\tvar parent = el.parentNode.parentNode;\r\n\t\tui.menuconfig.set(\r\n\t\t\tui.customAttr(parent, \"config\"),\r\n\t\t\tui.customAttr(el, \"value\")\r\n\t\t);\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// メニューがクリックされた時の動作を呼び出す\r\n\t//---------------------------------------------------------------------------\r\n\t// submenuから呼び出される関数たち\r\n\tundo: function() {\r\n\t\tui.undotimer.startUndo();\r\n\t},\r\n\tundostop: function() {\r\n\t\tui.undotimer.stopUndo();\r\n\t},\r\n\tundoall: function() {\r\n\t\tui.puzzle.undoall();\r\n\t},\r\n\tredo: function() {\r\n\t\tui.undotimer.startRedo();\r\n\t},\r\n\tredostop: function() {\r\n\t\tui.undotimer.stopRedo();\r\n\t},\r\n\tredoall: function() {\r\n\t\tui.puzzle.redoall();\r\n\t},\r\n\tenterTrial: function() {\r\n\t\tif (ui.puzzle.board.trialstage === 0) {\r\n\t\t\tui.puzzle.enterTrial();\r\n\t\t}\r\n\t},\r\n\tenterFurtherTrial: function() {\r\n\t\tui.puzzle.enterTrial();\r\n\t},\r\n\tacceptTrial: function() {\r\n\t\tui.puzzle.acceptTrial();\r\n\t},\r\n\trejectTrial: function() {\r\n\t\tui.puzzle.rejectTrial();\r\n\t},\r\n\trejectCurrentTrial: function() {\r\n\t\tui.puzzle.rejectCurrentTrial();\r\n\t},\r\n\ttoolarea: function() {\r\n\t\tui.menuconfig.set(\"toolarea\", !ui.menuconfig.get(\"toolarea\"));\r\n\t\tui.displayAll();\r\n\t},\r\n\tdisppopup: function(e) {\r\n\t\tvar el = e.target;\r\n\t\tif (el.nodeName === \"SPAN\") {\r\n\t\t\tel = el.parentNode;\r\n\t\t}\r\n\t\tif (el.className !== \"disabled\") {\r\n\t\t\tvar idname = ui.customAttr(el, \"popup\");\r\n\t\t\tif (!pzpr.env.OS.mobile) {\r\n\t\t\t\tvar pos = pzpr.util.getPagePos(e);\r\n\t\t\t\tui.popupmgr.open(idname, pos.px - 8, pos.py - 8);\r\n\t\t\t} else {\r\n\t\t\t\tvar rect = pzpr.util.getRect(getEL(\"menupanel\"));\r\n\t\t\t\tui.popupmgr.open(idname, 8, rect.bottom + 8);\r\n\t\t\t}\r\n\t\t\tthis.stopHovering();\r\n\t\t}\r\n\t},\r\n\tupdatelink: function(e) {\r\n\t\tvar el = e.target;\r\n\t\tvar linktype = ui.customAttr(el.parentNode, \"linktype\");\r\n\t\tswitch (linktype) {\r\n\t\t\tcase \"duplicate\":\r\n\t\t\t\tvar url = ui.puzzle.getURL(\r\n\t\t\t\t\tpzpr.parser.URL_PZPRFILE,\r\n\t\t\t\t\tui.puzzle.playeronly ? \"player\" : \"editor\"\r\n\t\t\t\t);\r\n\t\t\t\tel.setAttribute(\"href\", url);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t},\r\n\r\n\t//------------------------------------------------------------------------------\r\n\t// menuarea.answercheck()「正答判定」ボタンを押したときの処理\r\n\t// menuarea.answerclear()  「解答消去」ボタンを押したときの処理\r\n\t// menuarea.submarkclear()  「補助消去」ボタンを押したときの処理\r\n\t//------------------------------------------------------------------------------\r\n\ttarget: function() {\r\n\t\tvar check = ui.puzzle.check(true);\r\n\t\tif (check.complete || check.text === \"Sorry, you're on your own now. Good luck!\") {\r\n\t\t\tif (check.complete) {\r\n\t\t\t\tui.timer.stop();\r\n\t\t\t\tif (ui.callbackComplete) {\r\n\t\t\t\t\tui.callbackComplete(ui.puzzle, check);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar str = \"\",\r\n\t\t\t\ttexts = check.text.split(/\\n/);\r\n\t\t\tfor (var i = 0; i < texts.length; i++) {\r\n\t\t\t\tstr += '<div style=\"margin-bottom:6pt;\">' + texts[i] + \"</div>\";\r\n\t\t\t}\r\n\t\t\tui.notify.alert(str);\r\n\t\t}\r\n\t\tthis.stopHovering();\r\n\t\t/* REMOVE THIS PART, DEBUG ONLY */\r\n\t\t// str = \"\";\r\n\t\t// texts = check.text.split(/\\n/);\r\n\t\t// for (i = 0; i < texts.length; i++) {\r\n\t\t// \tstr += '<div style=\"margin-bottom:6pt;\">' + texts[i] + \"</div>\";\r\n\t\t// }\r\n\t\t// ui.notify.alert(str);\r\n\t\t/* REMOVE THIS PART, DEBUG ONLY */\r\n\t},\r\n\twin: function() {\r\n\t\tvar check = ui.puzzle.check(true);\r\n\t\tif (check.complete) {\r\n\t\t\tui.timer.stop();\r\n\t\t\tif (ui.callbackComplete) {\r\n\t\t\t\tui.callbackComplete(ui.puzzle, check);\r\n\t\t\t}\r\n\t\t\tui.notify.alert(winstr);\r\n\t\t}\r\n\t\tthis.stopHovering();\r\n\t},\r\n\tui: function() {\r\n\t\tvar check = ui.puzzle.checknw(true);\r\n\t\tif (check.completeq) {\r\n\t\t\tui.notify.alert('<div style=\"margin-bottom:6pt;\">NW quadrant good</div>')\r\n\t\t}\r\n\t\tthis.stopHovering();\r\n\t},\r\n\tstr: function() {\r\n\t\tvar check = ui.puzzle.checkne(true);\r\n\t\tif (check.completeq) {\r\n\t\t\tui.notify.alert('<div style=\"margin-bottom:6pt;\">NE quadrant good</div>')\r\n\t\t}\r\n\t\tthis.stopHovering();\r\n\t},\r\n\tpuzzle: function() {\r\n\t\tvar check = ui.puzzle.checksw(true);\r\n\t\tif (check.completeq) {\r\n\t\t\tui.notify.alert('<div style=\"margin-bottom:6pt;\">SW quadrant good</div>')\r\n\t\t}\r\n\t\tthis.stopHovering();\r\n\t},\r\n\tvalue: function() {\r\n\t\tvar check = ui.puzzle.checkse(true);\r\n\t\tif (check.completeq) {\r\n\t\t\tui.notify.alert('<div style=\"margin-bottom:6pt;\">SE quadrant good</div>')\r\n\t\t}\r\n\t\tthis.stopHovering();\r\n\t},\r\n\tanswerclear: function() {\r\n\t\tthis.stopHovering();\r\n\t\tui.notify.confirm(\r\n\t\t\t\"解答を消去しますか？\",\r\n\t\t\t\"Do you want to erase the answer?\",\r\n\t\t\tfunction() {\r\n\t\t\t\tui.puzzle.ansclear();\r\n\t\t\t}\r\n\t\t);\r\n\t},\r\n\tsubmarkclear: function() {\r\n\t\tthis.stopHovering();\r\n\t\tui.notify.confirm(\r\n\t\t\t\"補助記号を消去しますか？\",\r\n\t\t\t\"Do you want to erase the auxiliary marks?\",\r\n\t\t\tfunction() {\r\n\t\t\t\tui.puzzle.subclear();\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n};\r\n","// Menu.js v3.4.0\r\n/* global _doc:readonly, getEL:readonly */\r\n\r\n//---------------------------------------------------------------------------\r\n// ★PopupManagerクラス ポップアップメニューを管理します\r\n//---------------------------------------------------------------------------\r\nui.popupmgr = {\r\n\tpopup: null /* 表示中のポップアップメニュー */,\r\n\r\n\tpopups: {} /* 管理しているポップアップメニューのオブジェクト一覧 */,\r\n\r\n\tmovingpop: null /* 移動中のポップアップメニュー */,\r\n\toffset: {\r\n\t\tpx: 0,\r\n\t\tpy: 0\r\n\t} /* 移動中ポップアップメニューのページ左上からの位置 */,\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// popupmgr.reset()      ポップアップメニューの設定をクリアする\r\n\t// popupmgr.setEvents()  ポップアップメニュー(タイトルバー)のイベントを設定する\r\n\t//---------------------------------------------------------------------------\r\n\treset: function() {\r\n\t\t/* イベントを割り当てる */\r\n\t\tthis.setEvents();\r\n\r\n\t\t/* Captionを設定する */\r\n\t\tthis.translate();\r\n\t},\r\n\r\n\tsetEvents: function() {\r\n\t\tui.event.addEvent(_doc, \"mousemove\", this, this.titlebarmove);\r\n\t\tui.event.addEvent(_doc, \"mouseup\", this, this.titlebarup);\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// popupmgr.translate()  言語切り替え時にキャプションを変更する\r\n\t//---------------------------------------------------------------------------\r\n\ttranslate: function() {\r\n\t\tfor (var name in this.popups) {\r\n\t\t\tthis.popups[name].translate();\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// popupmgr.addpopup()   ポップアップメニューを追加する\r\n\t//---------------------------------------------------------------------------\r\n\taddpopup: function(idname, proto) {\r\n\t\tvar NewPopup = {},\r\n\t\t\ttemplate = this.popups.template || {};\r\n\t\tfor (var name in template) {\r\n\t\t\tNewPopup[name] = template[name];\r\n\t\t}\r\n\t\tfor (name in proto) {\r\n\t\t\tNewPopup[name] = proto[name];\r\n\t\t}\r\n\t\tthis.popups[idname] = NewPopup;\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// popupmgr.open()  ポップアップメニューを開く\r\n\t//---------------------------------------------------------------------------\r\n\topen: function(idname, px, py) {\r\n\t\tvar target = this.popups[idname] || null;\r\n\t\tif (target !== null) {\r\n\t\t\t/* 表示しているウィンドウがある場合は閉じる */\r\n\t\t\tif (!target.multipopup && !!this.popup) {\r\n\t\t\t\tthis.popup.close();\r\n\t\t\t}\r\n\r\n\t\t\t/* ポップアップメニューを表示する */\r\n\t\t\ttarget.show(px, py);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// popupmgr.titlebardown()  タイトルバーをクリックしたときの動作を行う(タイトルバーにbind)\r\n\t// popupmgr.titlebarup()    タイトルバーでボタンを離したときの動作を行う(documentにbind)\r\n\t// popupmgr.titlebarmove()  タイトルバーからマウスを動かしたときポップアップメニューを動かす(documentにbind)\r\n\t//---------------------------------------------------------------------------\r\n\ttitlebardown: function(e) {\r\n\t\tvar popel = e.target.parentNode;\r\n\t\tvar pos = pzpr.util.getPagePos(e);\r\n\t\tthis.movingpop = popel;\r\n\t\tthis.offset.px = pos.px - parseInt(popel.style.left, 10);\r\n\t\tthis.offset.py = pos.py - parseInt(popel.style.top, 10);\r\n\t\tui.event.enableMouse = false;\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t},\r\n\ttitlebarup: function(e) {\r\n\t\tvar popel = this.movingpop;\r\n\t\tif (!!popel) {\r\n\t\t\tthis.movingpop = null;\r\n\t\t\tui.event.enableMouse = true;\r\n\t\t}\r\n\t},\r\n\ttitlebarmove: function(e) {\r\n\t\tvar popel = this.movingpop;\r\n\t\tif (!!popel) {\r\n\t\t\tvar pos = pzpr.util.getPagePos(e);\r\n\t\t\tpopel.style.left = pos.px - this.offset.px + \"px\";\r\n\t\t\tpopel.style.top = pos.py - this.offset.py + \"px\";\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t}\r\n};\r\n\r\n//---------------------------------------------------------------------------\r\n// ★PopupMenuクラス ポップアップメニューを作成表示するベースのオブジェクトです\r\n//---------------------------------------------------------------------------\r\nui.popupmgr.addpopup(\"template\", {\r\n\tformname: \"\",\r\n\tmultipopup: false,\r\n\tpid: \"\",\r\n\r\n\tinit: function() {\r\n\t\t// 初回1回のみ呼び出される\r\n\t\tthis.form = document[this.formname];\r\n\t\tthis.pop = this.form.parentNode;\r\n\t\tthis.titlebar = this.pop.querySelector(\".titlebar\") || null;\r\n\t\tif (!!this.titlebar) {\r\n\t\t\tpzpr.util.unselectable(this.titlebar);\r\n\t\t\tpzpr.util.addEvent(\r\n\t\t\t\tthis.titlebar,\r\n\t\t\t\t\"mousedown\",\r\n\t\t\t\tui.popupmgr,\r\n\t\t\t\tui.popupmgr.titlebardown\r\n\t\t\t);\r\n\t\t}\r\n\t\tpzpr.util.addEvent(this.form, \"submit\", this, function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t});\r\n\r\n\t\tthis.walkCaption(this.pop);\r\n\t\tthis.translate();\r\n\r\n\t\tthis.walkEvent(this.pop);\r\n\t},\r\n\treset: function() {\r\n\t\t// パズルの種類が変わったら呼び出される\r\n\t},\r\n\r\n\ttranslate: function() {\r\n\t\tif (!this.captions) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor (var i = 0; i < this.captions.length; i++) {\r\n\t\t\tvar obj = this.captions[i];\r\n\t\t\tvar text = ui.selectStr(obj.str_jp, obj.str_en);\r\n\t\t\tif (!!obj.textnode) {\r\n\t\t\t\tobj.textnode.data = text;\r\n\t\t\t} else if (!!obj.button) {\r\n\t\t\t\tobj.button.value = text;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\twalkCaption: function(parent) {\r\n\t\tvar popup = this;\r\n\t\tthis.captions = [];\r\n\t\tui.misc.walker(parent, function(el) {\r\n\t\t\tif (el.nodeType === 3 && el.data.match(/^__(.+)__(.+)__$/)) {\r\n\t\t\t\tpopup.captions.push({\r\n\t\t\t\t\ttextnode: el,\r\n\t\t\t\t\tstr_jp: RegExp.$1,\r\n\t\t\t\t\tstr_en: RegExp.$2\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\twalkEvent: function(parent) {\r\n\t\tvar popup = this;\r\n\t\tfunction eventfactory(role) {\r\n\t\t\treturn function(e) {\r\n\t\t\t\tpopup[role](e);\r\n\t\t\t\tif (e.type !== \"click\") {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t\tui.misc.walker(parent, function(el) {\r\n\t\t\tif (el.nodeType !== 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar role = ui.customAttr(el, \"buttonExec\");\r\n\t\t\tif (!!role) {\r\n\t\t\t\tpzpr.util.addEvent(\r\n\t\t\t\t\tel,\r\n\t\t\t\t\t!pzpr.env.API.touchevent ? \"click\" : \"mousedown\",\r\n\t\t\t\t\tpopup,\r\n\t\t\t\t\teventfactory(role)\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\trole = ui.customAttr(el, \"changeExec\");\r\n\t\t\tif (!!role) {\r\n\t\t\t\tpzpr.util.addEvent(el, \"change\", popup, eventfactory(role));\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\tshow: function(px, py) {\r\n\t\t// 表示するたびに呼び出される\r\n\t\tif (!this.pop) {\r\n\t\t\tthis.init();\r\n\t\t}\r\n\t\tif (this.pid !== ui.puzzle.pid) {\r\n\t\t\tthis.pid = ui.puzzle.pid;\r\n\t\t\tthis.reset();\r\n\t\t}\r\n\r\n\t\tthis.pop.style.left = px + \"px\";\r\n\t\tthis.pop.style.top = py + \"px\";\r\n\t\tthis.pop.style.display = \"inline\";\r\n\t\tif (!this.multipopup) {\r\n\t\t\tui.popupmgr.popup = this;\r\n\t\t}\r\n\t},\r\n\tclose: function() {\r\n\t\tthis.pop.style.display = \"none\";\r\n\t\tif (!this.multipopup) {\r\n\t\t\tui.popupmgr.popup = null;\r\n\t\t}\r\n\r\n\t\tui.puzzle.key.enableKey = true;\r\n\t\tui.puzzle.mouse.enableMouse = true;\r\n\t}\r\n});\r\n\r\n//---------------------------------------------------------------------------\r\n// ★Popup_NewBoardクラス 新規盤面作成のポップアップメニューを作成したり表示します\r\n//---------------------------------------------------------------------------\r\nui.popupmgr.addpopup(\"newboard\", {\r\n\tformname: \"newboard\",\r\n\r\n\treset: function() {\r\n\t\tui.misc.displayByPid(this.pop);\r\n\t\tif (this.pid !== \"tawa\") {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor (var i = 0; i <= 3; i++) {\r\n\t\t\tvar _div = getEL(\"nb_shape_\" + i),\r\n\t\t\t\t_img = _div.children[0];\r\n\t\t\t_img.src =\r\n\t\t\t\t\"data:image/gif;base64,R0lGODdhgAAgAKEBAAAAAP//AP//////ACwAAAAAgAAgAAAC/pSPqcvtD6OctNqLs968+98A4kiWJvmcquisrtm+MpAAwY0Hdn7vPN1aAGstXs+oQw6FyqZxKfDlpDhqLyXMhpw/ZfHJndbCVW9QATWkEdYk+Pntvn/j+dQc0hK39jKcLxcoxkZ29JeHpsfUZ0gHeMeoUyfo54i4h7lI2TjI0PaJp1boZumpeLCGOvoZB7kpyTbzIiTrglY7o4Yrc8l2irYamjiciar2G4VM7Lus6fpcdVZ8PLxmrTyd3AwcydprvK19HZ6aPf5YCX31TW3ezuwOcQ7vGXyIPA+e/w6ORZ5ir9S/gfu0ZRt4UFU3YfHiFSyoaxeMWxJLUKx4IiLGZIn96HX8iNBjQ5EG8Zkk+dDfyJAgS7Lkxy9lOJTYXMK0ibOlTJ0n2eEs97OnUJ40X668SfRo0ZU7SS51erOp0XxSkSaFGtTo1a0bUcSo9bVr2I0gypo9izat2rVs27p9Czfu2QIAOw==\";\r\n\t\t\t_img.style.clip =\r\n\t\t\t\t\"rect(0px,\" + (i + 1) * 32 + \"px,\" + 32 + \"px,\" + i * 32 + \"px)\";\r\n\t\t}\r\n\t},\r\n\tshow: function(px, py) {\r\n\t\tui.popupmgr.popups.template.show.call(this, px, py);\r\n\t\tui.puzzle.key.enableKey = false;\r\n\r\n\t\tswitch (ui.puzzle.pid) {\r\n\t\t\tcase \"sudoku\":\r\n\t\t\t\tthis.setsize_sudoku();\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"tawa\":\r\n\t\t\t\tthis.setsize_tawa();\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthis.setsize();\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// setsize()   盤面のサイズをセットする\r\n\t// getsize()   盤面のサイズを取得する\r\n\t//---------------------------------------------------------------------------\r\n\tsetsize: function() {\r\n\t\tvar bd = ui.puzzle.board;\r\n\t\tthis.form.col.value = \"\" + bd.cols;\r\n\t\tthis.form.row.value = \"\" + bd.rows;\r\n\t},\r\n\tgetsize: function() {\r\n\t\tvar col = this.form.col.value | 0;\r\n\t\tvar row = this.form.row.value | 0;\r\n\t\treturn !!col && !!row ? { col: col, row: row } : null;\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// setsize_sudoku()   盤面のサイズをセットする (数独向け)\r\n\t// getsize_sudoku()   盤面のサイズを取得する (数独向け)\r\n\t//---------------------------------------------------------------------------\r\n\tsetsize_sudoku: function() {\r\n\t\tfor (var i = 0; i < 4; i++) {\r\n\t\t\tgetEL(\"nb_size_sudoku_\" + i).checked = \"\";\r\n\t\t}\r\n\t\tswitch (ui.puzzle.board.cols) {\r\n\t\t\tcase 16:\r\n\t\t\t\tgetEL(\"nb_size_sudoku_2\").checked = true;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 25:\r\n\t\t\t\tgetEL(\"nb_size_sudoku_3\").checked = true;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 4:\r\n\t\t\t\tgetEL(\"nb_size_sudoku_0\").checked = true;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 6:\r\n\t\t\t\tgetEL(\"nb_size_sudoku_4\").checked = true;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tgetEL(\"nb_size_sudoku_1\").checked = true;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t},\r\n\tgetsize_sudoku: function() {\r\n\t\tvar col, row;\r\n\t\tif (getEL(\"nb_size_sudoku_2\").checked) {\r\n\t\t\tcol = row = 16;\r\n\t\t} else if (getEL(\"nb_size_sudoku_3\").checked) {\r\n\t\t\tcol = row = 25;\r\n\t\t} else if (getEL(\"nb_size_sudoku_0\").checked) {\r\n\t\t\tcol = row = 4;\r\n\t\t} else if (getEL(\"nb_size_sudoku_4\").checked) {\r\n\t\t\tcol = row = 6;\r\n\t\t} else {\r\n\t\t\tcol = row = 9;\r\n\t\t}\r\n\t\treturn { col: col, row: row };\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// setsize_tawa()   盤面のサイズをセットする (たわむれんが向け)\r\n\t// getsize_tawa()   盤面のサイズを取得する (たわむれんが向け)\r\n\t//---------------------------------------------------------------------------\r\n\tsetsize_tawa: function() {\r\n\t\t/* タテヨコのサイズ指定部分 */\r\n\t\tvar bd = ui.puzzle.board,\r\n\t\t\tcol = bd.cols,\r\n\t\t\trow = bd.rows,\r\n\t\t\tshape = bd.shape;\r\n\r\n\t\tif (shape === 3) {\r\n\t\t\tcol++;\r\n\t\t}\r\n\t\tthis.form.col.value = \"\" + col;\r\n\t\tthis.form.row.value = \"\" + row;\r\n\r\n\t\t/* たわむレンガの形状指定ルーチン */\r\n\t\tthis.setshape(shape);\r\n\t},\r\n\tgetsize_tawa: function() {\r\n\t\tvar col = this.form.col.value | 0;\r\n\t\tvar row = this.form.row.value | 0;\r\n\t\tif (!col || !row) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tvar shape = this.getshape();\r\n\t\tif (!isNaN(shape) && !(col === 1 && (shape === 0 || shape === 3))) {\r\n\t\t\tif (shape === 3) {\r\n\t\t\t\tcol--;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn { col: col, row: row, shape: shape };\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// setshape()   たわむれんの形状から形状指定ボタンの初期値をセットする\r\n\t// getshape()   たわむれんがのどの形状が指定されか取得する\r\n\t// clickshape() たわむれんがの形状指定ボタンを押した時の処理を行う\r\n\t// setshapeidx() たわむれんがの形状指定ボタンに背景色を設定する\r\n\t// getshapeidx() たわむれんがの形状指定ボタン背景色からインデックスを取得する\r\n\t//---------------------------------------------------------------------------\r\n\tsetshape: function(shape) {\r\n\t\tthis.setshapeidx([0, 2, 3, 1][shape]);\r\n\t},\r\n\tgetshape: function() {\r\n\t\tvar idx = this.getshapeidx();\r\n\t\treturn idx !== null ? [0, 3, 1, 2][idx] : null;\r\n\t},\r\n\tclickshape: function(e) {\r\n\t\tthis.setshapeidx(+e.target.parentNode.id.charAt(9));\r\n\t},\r\n\r\n\tsetshapeidx: function(idx) {\r\n\t\tfor (var i = 0; i <= 3; i++) {\r\n\t\t\tgetEL(\"nb_shape_\" + i).style.backgroundColor = i === idx ? \"red\" : \"\";\r\n\t\t}\r\n\t},\r\n\tgetshapeidx: function() {\r\n\t\tfor (var i = 0; i <= 3; i++) {\r\n\t\t\tif (getEL(\"nb_shape_\" + i).style.backgroundColor === \"red\") {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// execute() 新規盤面を作成するボタンを押したときの処理を行う\r\n\t//---------------------------------------------------------------------------\r\n\texecute: function() {\r\n\t\tvar pid = ui.puzzle.pid;\r\n\t\tvar obj;\r\n\t\tswitch (pid) {\r\n\t\t\tcase \"sudoku\":\r\n\t\t\t\tobj = this.getsize_sudoku();\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"tawa\":\r\n\t\t\t\tobj = this.getsize_tawa();\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tobj = this.getsize();\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tthis.close();\r\n\t\tif (!!obj) {\r\n\t\t\tvar url = pid + \"/\" + obj.col + \"/\" + obj.row;\r\n\t\t\tif (pid === \"tawa\") {\r\n\t\t\t\turl += \"/\" + obj.shape;\r\n\t\t\t}\r\n\t\t\tui.puzzle.open(url);\r\n\t\t}\r\n\t}\r\n});\r\n\r\n//---------------------------------------------------------------------------\r\n// ★Popup_URLInputクラス URL入力のポップアップメニューを作成したり表示します\r\n//---------------------------------------------------------------------------\r\nui.popupmgr.addpopup(\"urlinput\", {\r\n\tformname: \"urlinput\",\r\n\r\n\t//------------------------------------------------------------------------------\r\n\t// urlinput() URLを入力する\r\n\t//------------------------------------------------------------------------------\r\n\turlinput: function() {\r\n\t\tthis.close();\r\n\t\tui.puzzle.open(this.form.ta.value.replace(/\\n/g, \"\"));\r\n\t}\r\n});\r\n\r\n//---------------------------------------------------------------------------\r\n// ★Popup_URLOutputクラス URL出力のポップアップメニューを作成したり表示します\r\n//---------------------------------------------------------------------------\r\nui.popupmgr.addpopup(\"urloutput\", {\r\n\tformname: \"urloutput\",\r\n\r\n\tinit: function() {\r\n\t\tui.popupmgr.popups.template.init.call(this);\r\n\t\tthis.urlanchor = getEL(\"urlanchor\");\r\n\t},\r\n\r\n\treset: function(px, py) {\r\n\t\tvar form = this.form,\r\n\t\t\tpid = ui.puzzle.pid,\r\n\t\t\texists = pzpr.variety(pid).exists,\r\n\t\t\tparser = pzpr.parser;\r\n\t\tvar url = ui.puzzle.getURL(parser.URL_PZPRV3);\r\n\t\tthis.urlanchor.href = this.urlanchor.textContent = url;\r\n\t\tform.kanpen.style.display = form.kanpen.nextSibling.style.display = exists.kanpen\r\n\t\t\t? \"\"\r\n\t\t\t: \"none\";\r\n\t\tform.heyaapp.style.display = form.heyaapp.nextSibling.style.display =\r\n\t\t\tpid === \"heyawake\" ? \"\" : \"none\";\r\n\t},\r\n\r\n\tshow: function(px, py) {\r\n\t\tui.popupmgr.popups.template.show.call(this, px, py);\r\n\t\tthis.reset(px, py);\r\n\t},\r\n\r\n\t//------------------------------------------------------------------------------\r\n\t// urloutput() URLを出力する\r\n\t// openurl()   「このURLを開く」を実行する\r\n\t//------------------------------------------------------------------------------\r\n\turloutput: function(e) {\r\n\t\tvar url = \"\",\r\n\t\t\tparser = pzpr.parser;\r\n\t\tswitch (e.target.name) {\r\n\t\t\tcase \"kanpen\":\r\n\t\t\t\turl = ui.puzzle.getURL(parser.URL_KANPEN);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"pzprv3e\":\r\n\t\t\t\turl = ui.puzzle\r\n\t\t\t\t\t.getURL(parser.URL_PZPRV3)\r\n\t\t\t\t\t.replace(/\\?(\\w+)/, \"?$1_edit\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"heyaapp\":\r\n\t\t\t\turl = ui.puzzle.getURL(parser.URL_HEYAAPP);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tthis.urlanchor.href = this.urlanchor.textContent = url;\r\n\t}\r\n});\r\n\r\n//---------------------------------------------------------------------------\r\n// ★Popup_FileOpenクラス ファイル入力のポップアップメニューを作成したり表示します\r\n//---------------------------------------------------------------------------\r\nui.popupmgr.addpopup(\"fileopen\", {\r\n\tformname: \"fileform\",\r\n\r\n\tinit: function() {\r\n\t\tui.popupmgr.popups.template.init.call(this);\r\n\t},\r\n\r\n\t//------------------------------------------------------------------------------\r\n\t// fileopen()  ファイルを開く\r\n\t//------------------------------------------------------------------------------\r\n\tfileopen: function(e) {\r\n\t\tvar fileEL = this.form.filebox;\r\n\t\tif (!!ui.reader || ui.enableGetText) {\r\n\t\t\tvar fitem = fileEL.files[0];\r\n\t\t\tif (!fitem) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!!ui.reader) {\r\n\t\t\t\tui.reader.readAsText(fitem);\r\n\t\t\t} else {\r\n\t\t\t\tui.puzzle.open(fitem.getAsText(\"\"));\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.form.reset();\r\n\t\tthis.close();\r\n\t}\r\n});\r\n\r\n//---------------------------------------------------------------------------\r\n// ★Popup_FileSaveクラス ファイル出力のポップアップメニューを作成したり表示します\r\n//---------------------------------------------------------------------------\r\nui.popupmgr.addpopup(\"filesave\", {\r\n\tformname: \"filesave\",\r\n\tanchor: null,\r\n\tinit: function() {\r\n\t\tui.popupmgr.popups.template.init.call(this);\r\n\r\n\t\tthis.anchor =\r\n\t\t\t!ui.enableSaveBlob && pzpr.env.API.anchor_download\r\n\t\t\t\t? getEL(\"saveanchor\")\r\n\t\t\t\t: null;\r\n\t},\r\n\treset: function() {\r\n\t\t/* ファイル形式選択オプション */\r\n\t\tvar ispencilbox = pzpr.variety(ui.puzzle.pid).exists.pencilbox;\r\n\t\tthis.form.filetype.options[1].disabled = !ispencilbox;\r\n\t\tthis.form.filetype.options[2].disabled = !ispencilbox;\r\n\t\tvar parser = pzpr.parser;\r\n\t\tthis.form.ta.value = ui.puzzle.getFileData(parser.FILE_PZPR, {});\r\n\t\tthis.form.ta2.value = this.form.ta.value.replace(/\\n/g, \"/\");\r\n\t},\r\n\t/* オーバーライド */\r\n\tshow: function(px, py) {\r\n\t\tui.popupmgr.popups.template.show.call(this, px, py);\r\n\t\tthis.reset();\r\n\r\n\t\tthis.form.filename.value = ui.puzzle.pid + \".txt\";\r\n\t\tthis.changefilename();\r\n\r\n\t\tui.puzzle.key.enableKey = false;\r\n\t},\r\n\tclose: function() {\r\n\t\tif (!!this.filesaveurl) {\r\n\t\t\tURL.revokeObjectURL(this.filesaveurl);\r\n\t\t}\r\n\r\n\t\tui.popupmgr.popups.template.close.call(this);\r\n\t},\r\n\tchangefilename: function() {\r\n\t\tvar filetype = this.form.filetype.value;\r\n\t\tvar filename = this.form.filename.value\r\n\t\t\t.replace(\".xml\", \"\")\r\n\t\t\t.replace(\".txt\", \"\");\r\n\t\tvar ext = filetype !== \"filesave4\" ? \".txt\" : \".xml\";\r\n\t\tvar pinfo = pzpr.variety(filename);\r\n\t\tif (pinfo.pid === ui.puzzle.pid) {\r\n\t\t\tif (filetype === \"filesave\" || filetype === \"filesave3\") {\r\n\t\t\t\tfilename = pinfo.urlid;\r\n\t\t\t} else {\r\n\t\t\t\tfilename = pinfo.kanpenid;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.form.filename.value = filename + ext;\r\n\t},\r\n\r\n\t//------------------------------------------------------------------------------\r\n\t// filesave()  ファイルを保存する\r\n\t//------------------------------------------------------------------------------\r\n\tfilesaveurl: null,\r\n\tfilesave: function() {\r\n\t\tvar form = this.form;\r\n\t\tvar filename = form.filename.value;\r\n\t\tvar prohibit = [\"\\\\\", \"/\", \":\", \"*\", \"?\", '\"', \"<\", \">\", \"|\"];\r\n\t\tfor (var i = 0; i < prohibit.length; i++) {\r\n\t\t\tif (filename.indexOf(prohibit[i]) !== -1) {\r\n\t\t\t\tui.notify.alert(\"ファイル名として使用できない文字が含まれています。\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar parser = pzpr.parser,\r\n\t\t\tfiletype = parser.FILE_PZPR,\r\n\t\t\toption = {};\r\n\t\tswitch (form.filetype.value) {\r\n\t\t\tcase \"filesave2\":\r\n\t\t\t\tfiletype = parser.FILE_PBOX;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"filesave4\":\r\n\t\t\t\tfiletype = parser.FILE_PBOX_XML;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"filesave3\":\r\n\t\t\t\tfiletype = parser.FILE_PZPR;\r\n\t\t\t\toption.history = true;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tvar blob = null,\r\n\t\t\tfiledata = null;\r\n\t\tif (ui.enableSaveBlob || !!this.anchor) {\r\n\t\t\tblob = new Blob([ui.puzzle.getFileData(filetype, option)], {\r\n\t\t\t\ttype: \"text/plain\"\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tfiledata = ui.puzzle.getFileData(filetype, option);\r\n\t\t}\r\n\r\n\t\tif (ui.enableSaveBlob) {\r\n\t\t\tnavigator.saveBlob(blob, filename);\r\n\t\t\tthis.close();\r\n\t\t} else if (!!this.anchor) {\r\n\t\t\tif (!!this.filesaveurl) {\r\n\t\t\t\tURL.revokeObjectURL(this.filesaveurl);\r\n\t\t\t}\r\n\t\t\tthis.filesaveurl = URL.createObjectURL(blob);\r\n\t\t\tthis.anchor.href = this.filesaveurl;\r\n\t\t\tthis.anchor.download = filename;\r\n\t\t\tthis.anchor.click();\r\n\t\t} else {\r\n\t\t\tform.ques.value = filedata;\r\n\t\t\tform.operation.value =\r\n\t\t\t\tform.filetype.value !== \"filesave4\" ? \"save\" : \"savexml\";\r\n\t\t\tform.submit();\r\n\t\t\tthis.close();\r\n\t\t}\r\n\r\n\t\tui.puzzle.saved();\r\n\t}\r\n});\r\n\r\n//---------------------------------------------------------------------------\r\n// ★Popup_ImageSaveクラス 画像出力のポップアップメニューを作成したり表示します\r\n//---------------------------------------------------------------------------\r\nui.popupmgr.addpopup(\"imagesave\", {\r\n\tformname: \"imagesave\",\r\n\tanchor: null,\r\n\tshowsize: null,\r\n\tinit: function() {\r\n\t\tui.popupmgr.popups.template.init.call(this);\r\n\r\n\t\tthis.anchor =\r\n\t\t\t!ui.enableSaveBlob && pzpr.env.API.anchor_download\r\n\t\t\t\t? getEL(\"saveanchor\")\r\n\t\t\t\t: null;\r\n\t\tthis.showsize = getEL(\"showsize\");\r\n\r\n\t\t/* ファイル形式選択オプション */\r\n\t\tvar filetype = this.form.filetype,\r\n\t\t\toptions = filetype.options;\r\n\t\tfor (var i = 0; i < options.length; i++) {\r\n\t\t\tvar option = options[i];\r\n\t\t\tif (!ui.enableImageType[option.value]) {\r\n\t\t\t\tfiletype.removeChild(option);\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t/* オーバーライド */\r\n\tshow: function(px, py) {\r\n\t\tui.popupmgr.popups.template.show.call(this, px, py);\r\n\r\n\t\tui.puzzle.key.enableKey = false;\r\n\t\tui.puzzle.mouse.enableMouse = false;\r\n\r\n\t\tthis.form.filename.value = pzpr.variety(ui.puzzle.pid).urlid + \".png\";\r\n\t\tthis.form.cellsize.value = ui.menuconfig.get(\"cellsizeval\");\r\n\r\n\t\tthis.changefilename();\r\n\t\tthis.estimatesize();\r\n\t},\r\n\tclose: function() {\r\n\t\tif (!!this.saveimageurl) {\r\n\t\t\tURL.revokeObjectURL(this.saveimageurl);\r\n\t\t}\r\n\r\n\t\tui.puzzle.setCanvasSize();\r\n\t\tui.popupmgr.popups.template.close.call(this);\r\n\t},\r\n\r\n\tchangefilename: function() {\r\n\t\tvar filename = this.form.filename.value.replace(/\\.\\w{3,4}$/, \".\");\r\n\t\tthis.form.filename.value = filename + this.form.filetype.value;\r\n\t},\r\n\testimatesize: function() {\r\n\t\tvar cellsize = +this.form.cellsize.value;\r\n\t\tvar width = (+cellsize * ui.puzzle.painter.getCanvasCols()) | 0;\r\n\t\tvar height = (+cellsize * ui.puzzle.painter.getCanvasRows()) | 0;\r\n\t\tthis.showsize.replaceChild(\r\n\t\t\t_doc.createTextNode(width + \" x \" + height),\r\n\t\t\tthis.showsize.firstChild\r\n\t\t);\r\n\t},\r\n\r\n\t//------------------------------------------------------------------------------\r\n\t// saveimage()    画像をダウンロードする\r\n\t// submitimage() \"画像をダウンロード\"の処理ルーチン\r\n\t// saveimage()   \"画像をダウンロード\"の処理ルーチン (IE10用)\r\n\t//------------------------------------------------------------------------------\r\n\tsaveimageurl: null,\r\n\tsaveimage: function() {\r\n\t\t/* ファイル名チェックルーチン */\r\n\t\tvar form = this.form;\r\n\t\tvar filename = form.filename.value;\r\n\t\tvar prohibit = [\"\\\\\", \"/\", \":\", \"*\", \"?\", '\"', \"<\", \">\", \"|\"];\r\n\t\tfor (var i = 0; i < prohibit.length; i++) {\r\n\t\t\tif (filename.indexOf(prohibit[i]) !== -1) {\r\n\t\t\t\tui.notify.alert(\"ファイル名として使用できない文字が含まれています。\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/* 画像出力ルーチン */\r\n\t\tvar option = { cellsize: +this.form.cellsize.value };\r\n\t\tif (this.form.transparent.checked) {\r\n\t\t\toption.bgcolor = \"\";\r\n\t\t}\r\n\t\tvar type = form.filetype.value;\r\n\r\n\t\ttry {\r\n\t\t\tif (ui.enableSaveBlob || !!this.anchor) {\r\n\t\t\t\tui.puzzle.toBlob(\r\n\t\t\t\t\tfunction(blob) {\r\n\t\t\t\t\t\t/* 出力された画像の保存ルーチン */\r\n\t\t\t\t\t\tif (ui.enableSaveBlob) {\r\n\t\t\t\t\t\t\tnavigator.saveBlob(blob, filename);\r\n\t\t\t\t\t\t\tthis.close();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (!!this.filesaveurl) {\r\n\t\t\t\t\t\t\t\tURL.revokeObjectURL(this.filesaveurl);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.filesaveurl = URL.createObjectURL(blob);\r\n\t\t\t\t\t\t\tthis.anchor.href = this.filesaveurl;\r\n\t\t\t\t\t\t\tthis.anchor.download = filename;\r\n\t\t\t\t\t\t\tthis.anchor.click();\r\n\t\t\t\t\t\t\tthis.close();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\ttype,\r\n\t\t\t\t\t1.0,\r\n\t\t\t\t\toption\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\t/* 出力された画像の保存ルーチン */\r\n\t\t\t\tform.urlstr.value = ui.puzzle\r\n\t\t\t\t\t.toDataURL(type, 1.0, option)\r\n\t\t\t\t\t.replace(/data:.*;base64,/, \"\");\r\n\t\t\t\tform.submit();\r\n\t\t\t\tthis.close();\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tui.notify.alert(\"画像の出力に失敗しました\", \"Fail to Output the Image\");\r\n\t\t}\r\n\t},\r\n\r\n\t//------------------------------------------------------------------------------\r\n\t// openimage()   \"別ウィンドウで開く\"の処理ルーチン\r\n\t//------------------------------------------------------------------------------\r\n\topenimage: function() {\r\n\t\t/* 画像出力ルーチン */\r\n\t\tvar option = { cellsize: +this.form.cellsize.value };\r\n\t\tif (this.form.transparent.checked) {\r\n\t\t\toption.bgcolor = \"\";\r\n\t\t}\r\n\t\tvar type = this.form.filetype.value;\r\n\t\tvar IEkei = navigator.userAgent.match(/(Trident|Edge)\\//);\r\n\r\n\t\tvar dataurl = \"\";\r\n\t\ttry {\r\n\t\t\tif (!IEkei || type !== \"svg\") {\r\n\t\t\t\tdataurl = ui.puzzle.toDataURL(type, 1.0, option);\r\n\t\t\t} else {\r\n\t\t\t\tdataurl = ui.puzzle.toBuffer(\"svg\", option);\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tui.notify.alert(\"画像の出力に失敗しました\", \"Fail to Output the Image\");\r\n\t\t}\r\n\t\tif (!dataurl) {\r\n\t\t\t/* No Data URL */ return;\r\n\t\t}\r\n\r\n\t\t/* 出力された画像を開くルーチン */\r\n\t\tfunction writeContent(blob) {\r\n\t\t\tvar filename = this.form.filename.value;\r\n\t\t\tvar cdoc = window.open(\"\", \"\", \"\").document;\r\n\t\t\tcdoc.open();\r\n\t\t\tcdoc.writeln('<!DOCTYPE html>\\n<HTML LANG=\"ja\">\\n<HEAD>');\r\n\t\t\tcdoc.writeln('<META CHARSET=\"utf-8\">');\r\n\t\t\tcdoc.writeln(\"<TITLE>ぱずぷれv3</TITLE>\\n</HEAD><BODY>\");\r\n\t\t\tif (!!blob) {\r\n\t\t\t\tcdoc.writeln('<img src=\"', dataurl, '\"><br>\\n');\r\n\t\t\t\tcdoc.writeln(\r\n\t\t\t\t\t'<a href=\"',\r\n\t\t\t\t\tcdoc.defaultView.URL.createObjectURL(blob),\r\n\t\t\t\t\t'\" download=\"',\r\n\t\t\t\t\tfilename,\r\n\t\t\t\t\t'\">Download ',\r\n\t\t\t\t\tfilename,\r\n\t\t\t\t\t\"</a>\"\r\n\t\t\t\t);\r\n\t\t\t} else if (!IEkei || type !== \"svg\") {\r\n\t\t\t\tcdoc.writeln('<img src=\"', dataurl, '\">');\r\n\t\t\t} else {\r\n\t\t\t\tcdoc.writeln(dataurl.replace(/^<\\?.+?\\?>/, \"\"));\r\n\t\t\t}\r\n\t\t\tcdoc.writeln(\"</BODY>\\n</HTML>\");\r\n\t\t\tcdoc.close();\r\n\t\t}\r\n\t\tif (pzpr.env.API.anchor_download) {\r\n\t\t\t// ChromeでDataURLが直接開けない対策\r\n\t\t\tui.puzzle.toBlob(writeContent.bind(this), type, 1.0, option);\r\n\t\t} else {\r\n\t\t\twriteContent(null);\r\n\t\t}\r\n\t}\r\n});\r\n\r\n//---------------------------------------------------------------------------\r\n// ★Popup_Adjustクラス 盤面の調整のポップアップメニューを作成したり表示します\r\n//---------------------------------------------------------------------------\r\nui.popupmgr.addpopup(\"adjust\", {\r\n\tformname: \"adjust\",\r\n\r\n\tadjust: function(e) {\r\n\t\tui.puzzle.board.operate(e.target.name);\r\n\t}\r\n});\r\n\r\n//---------------------------------------------------------------------------\r\n// ★Popup_TurnFlipクラス 回転・反転のポップアップメニューを作成したり表示します\r\n//---------------------------------------------------------------------------\r\nui.popupmgr.addpopup(\"turnflip\", {\r\n\tformname: \"turnflip\",\r\n\r\n\treset: function() {\r\n\t\tthis.form.turnl.disabled = ui.puzzle.pid === \"tawa\";\r\n\t\tthis.form.turnr.disabled = ui.puzzle.pid === \"tawa\";\r\n\t},\r\n\r\n\tadjust: function(e) {\r\n\t\tui.puzzle.board.operate(e.target.name);\r\n\t}\r\n});\r\n\r\n//---------------------------------------------------------------------------\r\n// ★Popup_Metadataクラス メタデータの設定・表示を行うメニューを作成したり表示します\r\n//---------------------------------------------------------------------------\r\nui.popupmgr.addpopup(\"metadata\", {\r\n\tformname: \"metadata\",\r\n\r\n\tshow: function(px, py) {\r\n\t\tui.popupmgr.popups.template.show.call(this, px, py);\r\n\r\n\t\tvar form = this.form;\r\n\t\tvar puzzle = ui.puzzle,\r\n\t\t\tbd = puzzle.board,\r\n\t\t\tmeta = puzzle.metadata;\r\n\t\tgetEL(\"metadata_variety\").innerHTML =\r\n\t\t\tpzpr.variety(puzzle.pid)[pzpr.lang] + \"&nbsp;\" + bd.cols + \"×\" + bd.rows;\r\n\t\tform.author.value = meta.author;\r\n\t\tform.source.value = meta.source;\r\n\t\tform.hard.value = meta.hard;\r\n\t\tform.comment.value = meta.comment;\r\n\t},\r\n\r\n\tsave: function() {\r\n\t\tvar form = this.form;\r\n\t\tvar puzzle = ui.puzzle,\r\n\t\t\tmeta = puzzle.metadata;\r\n\t\tmeta.author = form.author.value;\r\n\t\tmeta.source = form.source.value;\r\n\t\tmeta.hard = form.hard.value;\r\n\t\tmeta.comment = form.comment.value;\r\n\t\tthis.close();\r\n\t}\r\n});\r\n\r\n//---------------------------------------------------------------------------\r\n// ★Popup_DispSizeクラス サイズの変更を行うポップアップメニューを作成したり表示します\r\n//---------------------------------------------------------------------------\r\nui.popupmgr.addpopup(\"dispsize\", {\r\n\tformname: \"dispsize\",\r\n\r\n\tshow: function(px, py) {\r\n\t\tui.popupmgr.popups.template.show.call(this, px, py);\r\n\r\n\t\tthis.form.cellsize.value = ui.menuconfig.get(\"cellsizeval\");\r\n\t\tui.puzzle.key.enableKey = false;\r\n\t},\r\n\r\n\t//------------------------------------------------------------------------------\r\n\t// changesize()  Canvasでのマス目の表示サイズを変更する\r\n\t//------------------------------------------------------------------------------\r\n\tchangesize: function(e) {\r\n\t\tvar csize = this.form.cellsize.value | 0;\r\n\t\tif (csize > 0) {\r\n\t\t\tui.menuconfig.set(\"cellsizeval\", csize);\r\n\t\t}\r\n\t\tthis.close();\r\n\t}\r\n});\r\n\r\n//---------------------------------------------------------------------------\r\n// ★Popup_About\r\n//---------------------------------------------------------------------------\r\nui.popupmgr.addpopup(\"about\", {\r\n\tformname: \"about\"\r\n});\r\n\r\nui.popupmgr.addpopup(\"network\", {\r\n\tformname: \"network\", // just to fit in with how popup template works\r\n\turlanchor: null,\r\n\tkey: \"\",\r\n\r\n\tinit: function() {\r\n\t\tui.popupmgr.popups.template.init.call(this);\r\n\t\tthis.urlanchor = getEL(\"urlanchor_network\");\r\n\t\tthis.key = Math.random()\r\n\t\t\t.toString(36)\r\n\t\t\t.substr(2, 8);\r\n\t},\r\n\r\n\tcoop: function(px, py) {\r\n\t\tvar parser = pzpr.parser;\r\n\t\tvar url = ui.puzzle.getURL(parser.URL_PZPRV3);\r\n\t\turl = url.replace(\"?\", \"?net=coop&key=\" + this.key + \"&\");\r\n\t\tthis.urlanchor.href = this.urlanchor.textContent = url;\r\n\t\tui.network.configure(\"coop\", this.key);\r\n\t\tui.network.start();\r\n\t}\r\n});\r\n","// ToolArea.js v3.4.0\r\n/* global getEL:readonly */\r\n\r\n// メニュー描画/取得/html表示系\r\n// toolareaオブジェクト\r\nui.toolarea = {\r\n\titems: null, // ツールパネルのエレメント等を保持する\r\n\tcaptions: [], // 言語指定を切り替えた際のキャプションを保持する\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// toolarea.reset()  ツールパネル・ボタン領域の初期設定を行う\r\n\t//---------------------------------------------------------------------------\r\n\treset: function() {\r\n\t\tif (this.items === null) {\r\n\t\t\tthis.items = {};\r\n\t\t\tthis.walkElement(getEL(\"usepanel\"));\r\n\t\t\tthis.walkElement(getEL(\"checkpanel\"));\r\n\t\t\tthis.walkElement(getEL(\"variantpanel\"));\r\n\t\t\tthis.walkElement(getEL(\"btnarea\"));\r\n\t\t}\r\n\t\tui.misc.displayByPid(getEL(\"checkpanel\"));\r\n\t\tui.misc.displayByPid(getEL(\"btnarea\"));\r\n\r\n\t\tthis.display();\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// toolarea.walkElement()  エレメントを探索して領域の初期設定を行う\r\n\t//---------------------------------------------------------------------------\r\n\twalkElement: function(parent) {\r\n\t\tvar toolarea = this;\r\n\t\tfunction btnfactory(role) {\r\n\t\t\treturn function(e) {\r\n\t\t\t\ttoolarea[role](e);\r\n\t\t\t\tif (e.type !== \"click\") {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t\tfunction addbtnevent(el, type, role) {\r\n\t\t\tpzpr.util.addEvent(el, type, toolarea, btnfactory(role));\r\n\t\t}\r\n\t\tui.misc.walker(parent, function(el) {\r\n\t\t\tif (el.nodeType === 1) {\r\n\t\t\t\t/* ツールパネル領域 */\r\n\t\t\t\tvar parent, idname;\r\n\t\t\t\tif (el.className === \"config\") {\r\n\t\t\t\t\ttoolarea.items[ui.customAttr(el, \"config\")] = { el: el };\r\n\t\t\t\t} else if (el.className.match(/child/)) {\r\n\t\t\t\t\t(parent = el.parentNode.parentNode),\r\n\t\t\t\t\t\t(idname = ui.customAttr(parent, \"config\"));\r\n\t\t\t\t\tvar item = toolarea.items[idname];\r\n\t\t\t\t\tif (!item.children) {\r\n\t\t\t\t\t\titem.children = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t\titem.children.push(el);\r\n\r\n\t\t\t\t\taddbtnevent(el, \"mousedown\", \"toolclick\");\r\n\t\t\t\t} else if (el.nodeName === \"INPUT\" && el.type === \"checkbox\") {\r\n\t\t\t\t\t(parent = el.parentNode), (idname = ui.customAttr(parent, \"config\"));\r\n\t\t\t\t\tif (!idname) {\r\n\t\t\t\t\t\t(parent = parent.parentNode),\r\n\t\t\t\t\t\t\t(idname = ui.customAttr(parent, \"config\"));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!idname) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttoolarea.items[idname].checkbox = el;\r\n\r\n\t\t\t\t\taddbtnevent(el, \"click\", \"toolclick\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\t/* ボタン領域 */\r\n\t\t\t\tvar role = ui.customAttr(el, \"buttonExec\");\r\n\t\t\t\tif (!!role) {\r\n\t\t\t\t\taddbtnevent(\r\n\t\t\t\t\t\tel,\r\n\t\t\t\t\t\t!pzpr.env.API.touchevent ? \"click\" : \"mousedown\",\r\n\t\t\t\t\t\trole\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\trole = ui.customAttr(el, \"pressExec\");\r\n\t\t\t\tif (!!role) {\r\n\t\t\t\t\tvar roles = role.split(/,/);\r\n\t\t\t\t\taddbtnevent(el, \"mousedown\", roles[0]);\r\n\t\t\t\t\tif (!!role[1]) {\r\n\t\t\t\t\t\taddbtnevent(el, \"mouseup\", roles[1]);\r\n\t\t\t\t\t\taddbtnevent(el, \"mouseleave\", roles[1]);\r\n\t\t\t\t\t\taddbtnevent(el, \"touchcancel\", roles[1]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (el.nodeType === 3) {\r\n\t\t\t\tif (el.data.match(/^__(.+)__(.+)__$/)) {\r\n\t\t\t\t\tvar str_jp = RegExp.$1,\r\n\t\t\t\t\t\tstr_en = RegExp.$2;\r\n\t\t\t\t\ttoolarea.captions.push({\r\n\t\t\t\t\t\ttextnode: el,\r\n\t\t\t\t\t\tstr_jp: str_jp,\r\n\t\t\t\t\t\tstr_en: str_en\r\n\t\t\t\t\t});\r\n\t\t\t\t\tparent = el.parentNode;\r\n\t\t\t\t\tif (parent.className.match(/child/)) {\r\n\t\t\t\t\t\ttoolarea.captions.push({\r\n\t\t\t\t\t\t\tdatanode: parent,\r\n\t\t\t\t\t\t\tstr_jp: str_jp,\r\n\t\t\t\t\t\t\tstr_en: str_en\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// toolarea.display()    全てのラベルに対して文字列を設定する\r\n\t// toolarea.displayVariantPanel() display the variant panel\r\n\t// toolarea.setdisplay() 管理パネルに表示する文字列を個別に設定する\r\n\t//---------------------------------------------------------------------------\r\n\tdisplay: function() {\r\n\t\t/* ツールパネル領域 */\r\n\t\t/* -------------- */\r\n\t\tvar mandisp = ui.menuconfig.get(\"toolarea\") ? \"block\" : \"none\";\r\n\t\tgetEL(\"usepanel\").style.display = mandisp;\r\n\t\tgetEL(\"checkpanel\").style.display = mandisp;\r\n\r\n\t\t/* 経過時間の表示/非表示設定 */\r\n\t\tgetEL(\"separator2\").style.display =\r\n\t\t\tui.puzzle.playeronly && ui.menuconfig.get(\"toolarea\") ? \"\" : \"none\";\r\n\t\tgetEL(\"timerpanel\").style.display = ui.puzzle.playeronly ? \"block\" : \"none\";\r\n\t\tthis.displayVariantPanel();\r\n\r\n\t\tfor (var idname in this.items) {\r\n\t\t\tthis.setdisplay(idname);\r\n\t\t}\r\n\r\n\t\t/* ボタン領域 */\r\n\t\t/* --------- */\r\n\t\tgetEL(\"btnarea\").style.display = \"\";\r\n\t\tpzpr.util.unselectable(getEL(\"btnarea\"));\r\n\r\n\t\tthis.setdisplay(\"operation\");\r\n\t\tgetEL(\"btnclear2\").style.display = !ui.puzzle.board.disable_subclear\r\n\t\t\t? \"\"\r\n\t\t\t: \"none\";\r\n\t\tgetEL(\"btncolor\").style.display =\r\n\t\t\tui.puzzle.pid === \"tentaisho\" ? \"\" : \"none\";\r\n\t\tgetEL(\"btnflush\").style.display =\r\n\t\t\tui.puzzle.board.hasflush && !ui.puzzle.playeronly ? \"\" : \"none\";\r\n\t\t/* ボタンエリアの色分けボタンは、ツールパネル領域が消えている時に表示 */\r\n\t\tgetEL(\"btnirowake\").style.display =\r\n\t\t\tui.puzzle.painter.irowake && !ui.menuconfig.get(\"toolarea\") ? \"\" : \"none\";\r\n\t\tgetEL(\"btnirowakeblk\").style.display =\r\n\t\t\tui.puzzle.painter.irowakeblk && !ui.menuconfig.get(\"toolarea\")\r\n\t\t\t\t? \"\"\r\n\t\t\t\t: \"none\";\r\n\t\tthis.setdisplay(\"trialmode\");\r\n\t\tthis.setdisplay(\"network\");\r\n\r\n\t\t/* 共通：キャプションの設定 */\r\n\t\t/* --------------------- */\r\n\t\tfor (var i = 0; i < this.captions.length; i++) {\r\n\t\t\tvar obj = this.captions[i];\r\n\t\t\tif (!!obj.textnode) {\r\n\t\t\t\tobj.textnode.data = ui.selectStr(obj.str_jp, obj.str_en);\r\n\t\t\t}\r\n\t\t\tif (!!obj.datanode) {\r\n\t\t\t\tobj.datanode.setAttribute(\r\n\t\t\t\t\t\"data-text\",\r\n\t\t\t\t\tui.selectStr(obj.str_jp, obj.str_en)\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tdisplayVariantPanel: function() {\r\n\t\t// display if the type has variants, and we're in edit mode or some\r\n\t\t// variants are enabled\r\n\t\tvar shouldDisplay = (function() {\r\n\t\t\tif (!ui.menuconfig.get(\"toolarea\")) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tvar variants = ui.puzzle.config.getVariants();\r\n\t\t\tif (Object.keys(variants).length <= 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (!ui.puzzle.playmode) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tfor (var key in variants) {\r\n\t\t\t\tif (variants[key]) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})();\r\n\t\tvar vardisp = shouldDisplay ? \"block\" : \"none\";\r\n\t\tgetEL(\"separator1\").style.display = vardisp;\r\n\t\tgetEL(\"variantpanel\").style.display = vardisp;\r\n\t},\r\n\tsetdisplay: function(idname) {\r\n\t\tif (idname === \"variant\") {\r\n\t\t\tvar str;\r\n\t\t\tif (ui.menuconfig.get(\"variant\")) {\r\n\t\t\t\tstr = ui.selectStr(\"本家ルールでチェック\", \"Check base type\");\r\n\t\t\t} else {\r\n\t\t\t\tstr = ui.selectStr(\"チェック\", \"Check\");\r\n\t\t\t}\r\n\t\t\tgetEL(\"btncheck\").textContent = str;\r\n\t\t}\r\n\r\n\t\tvar trial = ui.puzzle.board.trialstage > 0;\r\n\t\tvar net = ui.network.mode !== \"\";\r\n\r\n\t\tif (idname === \"operation\") {\r\n\t\t\tvar opemgr = ui.puzzle.opemgr;\r\n\t\t\tgetEL(\"btnundo\").disabled = !opemgr.enableUndo;\r\n\t\t\tgetEL(\"btnredo\").disabled = !opemgr.enableRedo;\r\n\t\t\tgetEL(\"btntriale\").disabled = opemgr.atStartOfTrial();\r\n\t\t} else if (idname === \"trialmode\") {\r\n\t\t\tgetEL(\"btnclear\").disabled = trial;\r\n\t\t\tgetEL(\"btntrial\").disabled = trial;\r\n\t\t\tgetEL(\"btntrialarea\").style.display = trial && !net ? \"block\" : \"none\";\r\n\t\t} else if (idname === \"network\") {\r\n\t\t\tgetEL(\"btnundo\").style.display = net ? \"none\" : \"inline\";\r\n\t\t\tgetEL(\"btnredo\").style.display = net ? \"none\" : \"inline\";\r\n\t\t\tgetEL(\"btntrial\").style.display = net ? \"none\" : \"inline\";\r\n\t\t\tgetEL(\"btntrialarea\").style.display = trial && !net ? \"block\" : \"none\";\r\n\t\t} else if (this.items === null || !this.items[idname]) {\r\n\t\t\t/* DO NOTHING */\r\n\t\t} else if (ui.menuconfig.valid(idname)) {\r\n\t\t\tvar toolitem = this.items[idname];\r\n\t\t\ttoolitem.el.style.display = \"\";\r\n\r\n\t\t\tif (idname === \"mode\") {\r\n\t\t\t\tthis.displayVariantPanel();\r\n\t\t\t}\r\n\r\n\t\t\tvar disabled = null;\r\n\t\t\t/* 子要素の設定を行う */\r\n\t\t\tif (!!toolitem.children) {\r\n\t\t\t\tvar children = toolitem.children;\r\n\t\t\t\tvar validval =\r\n\t\t\t\t\tidname === \"inputmode\" ? ui.puzzle.mouse.getInputModeList() : null;\r\n\t\t\t\tfor (var i = 0; i < children.length; i++) {\r\n\t\t\t\t\tvar child = children[i],\r\n\t\t\t\t\t\tvalue = ui.customAttr(child, \"value\"),\r\n\t\t\t\t\t\tselected = value === \"\" + ui.menuconfig.get(idname);\r\n\t\t\t\t\tchild.className = selected ? \"child childsel\" : \"child\";\r\n\t\t\t\t\tchild.style.display =\r\n\t\t\t\t\t\tvalidval === null || validval.indexOf(value) >= 0 ? \"\" : \"none\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (idname === \"inputmode\") {\r\n\t\t\t\t\tdisabled = validval.length === 1;\r\n\t\t\t\t}\r\n\t\t\t\tif (disabled !== null) {\r\n\t\t\t\t\ttoolitem.el.className = !disabled ? \"\" : \"disabled\";\r\n\t\t\t\t}\r\n\t\t\t} else if (!!toolitem.checkbox) {\r\n\t\t\t\t/* チェックボックスの表記の設定 */\r\n\t\t\t\tvar check = toolitem.checkbox;\r\n\t\t\t\tif (!!check) {\r\n\t\t\t\t\tcheck.checked = ui.menuconfig.get(idname);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (idname === \"keypopup\") {\r\n\t\t\t\t\tdisabled = !ui.keypopup.paneltype[ui.puzzle.editmode ? 1 : 3];\r\n\t\t\t\t}\r\n\t\t\t\tif (idname === \"bgcolor\") {\r\n\t\t\t\t\tdisabled = ui.puzzle.editmode;\r\n\t\t\t\t}\r\n\t\t\t\tif (ui.puzzle.config.getvariant(idname)) {\r\n\t\t\t\t\tdisabled = !ui.puzzle.editmode;\r\n\t\t\t\t}\r\n\t\t\t\tif (disabled !== null) {\r\n\t\t\t\t\ttoolitem.checkbox.disabled = !disabled ? \"\" : \"true\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (!!this.items[idname]) {\r\n\t\t\tthis.items[idname].el.style.display = \"none\";\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// toolarea.toolclick()   ツールパネルの入力があった時、設定を変更する\r\n\t//---------------------------------------------------------------------------\r\n\ttoolclick: function(e) {\r\n\t\tvar el = e.target,\r\n\t\t\tparent = el.parentNode;\r\n\t\tvar idname =\r\n\t\t\t\tui.customAttr(parent, \"config\") ||\r\n\t\t\t\tui.customAttr(parent.parentNode, \"config\"),\r\n\t\t\tvalue;\r\n\t\tif (!!this.items[idname].checkbox) {\r\n\t\t\tvalue = !!el.checked;\r\n\t\t} else {\r\n\t\t\tvalue = ui.customAttr(el, \"value\");\r\n\t\t}\r\n\t\tui.menuconfig.set(idname, value);\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// Canvas下にあるボタンが押された/放された時の動作\r\n\t//---------------------------------------------------------------------------\r\n\ttarget: function() {\r\n\t\tui.menuarea.target();\r\n\t},\r\n\tui: function() {\r\n\t\tui.menuarea.ui();\r\n\t},\r\n\tstr: function() {\r\n\t\tui.menuarea.str();\r\n\t},\r\n\tpuzzle: function() {\r\n\t\tui.menuarea.puzzle();\r\n\t},\r\n\tvalue: function() {\r\n\t\tui.menuarea.value();\r\n\t},\r\n\tundo: function() {\r\n\t\tui.undotimer.startUndo();\r\n\t},\r\n\tundostop: function() {\r\n\t\tui.undotimer.stopUndo();\r\n\t},\r\n\tredo: function() {\r\n\t\tui.undotimer.startRedo();\r\n\t},\r\n\tredostop: function() {\r\n\t\tui.undotimer.stopRedo();\r\n\t},\r\n\tansclear: function() {\r\n\t\tui.menuarea.answerclear();\r\n\t},\r\n\tsubclear: function() {\r\n\t\tui.menuarea.submarkclear();\r\n\t},\r\n\tirowake: function() {\r\n\t\tui.puzzle.irowake();\r\n\t},\r\n\tencolorall: function() {\r\n\t\tui.puzzle.board.encolorall();\r\n\t} /* 天体ショーのボタン */,\r\n\tdropblocks: function() {\r\n\t\tui.puzzle.board.operate(\"drop\");\r\n\t},\r\n\tresetblocks: function() {\r\n\t\tui.puzzle.board.operate(\"resetpos\");\r\n\t},\r\n\tflushexcell: function() {\r\n\t\tui.puzzle.board.flushexcell();\r\n\t},\r\n\tenterTrial: function() {\r\n\t\tif (ui.puzzle.board.trialstage === 0) {\r\n\t\t\tui.puzzle.enterTrial();\r\n\t\t}\r\n\t},\r\n\tenterFurtherTrial: function() {\r\n\t\tui.puzzle.enterTrial();\r\n\t},\r\n\tacceptTrial: function() {\r\n\t\tui.puzzle.acceptTrial();\r\n\t},\r\n\trejectTrial: function() {\r\n\t\tui.puzzle.rejectCurrentTrial();\r\n\t}\r\n};\r\n","// Notify.js v3.5.0\r\n/* global getEL:readonly */\r\n\r\n//---------------------------------------------------------------------------\r\n// ★Notifyクラス alert, confirm関連を管理します\r\n//---------------------------------------------------------------------------\r\nui.notify = {\r\n\tonconfirm: null,\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// notify.reset()      Notificationの設定を初期化する\r\n\t//---------------------------------------------------------------------------\r\n\treset: function() {\r\n\t\t/* イベントを割り当てる */\r\n\t\tthis.walkElement(getEL(\"notifies\"));\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// notify.walkElement()  エレメントを探索して領域の初期設定を行う\r\n\t//---------------------------------------------------------------------------\r\n\twalkElement: function(parent) {\r\n\t\tvar notify = this;\r\n\t\tui.misc.walker(parent, function(el) {\r\n\t\t\tif (el.nodeType === 1) {\r\n\t\t\t\t/* ボタン領域 */\r\n\t\t\t\tvar role = ui.customAttr(el, \"buttonExec\");\r\n\t\t\t\tif (!!role) {\r\n\t\t\t\t\tpzpr.util.addEvent(\r\n\t\t\t\t\t\tel,\r\n\t\t\t\t\t\t!pzpr.env.API.touchevent ? \"click\" : \"mousedown\",\r\n\t\t\t\t\t\tnotify,\r\n\t\t\t\t\t\tnotify[role]\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t/* タイトルバーでボックスを動かす設定 */\r\n\t\t\t\tif (el.className === \"titlebar\") {\r\n\t\t\t\t\tpzpr.util.addEvent(\r\n\t\t\t\t\t\tel,\r\n\t\t\t\t\t\t\"mousedown\",\r\n\t\t\t\t\t\tui.popupmgr,\r\n\t\t\t\t\t\tui.popupmgr.titlebardown\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\t//--------------------------------------------------------------------------------\r\n\t// ui.alert()   現在の言語に応じたダイアログを表示する\r\n\t// ui.confirm() 現在の言語に応じた選択ダイアログを表示し、結果を返す\r\n\t// ui.setVerticalPosition() 指定したエレメントの盾位置を画面中央に設定して表示する\r\n\t//--------------------------------------------------------------------------------\r\n\talert: function(strJP, strEN) {\r\n\t\tgetEL(\"notification\").innerHTML = ui.selectStr(strJP, strEN);\r\n\t\tthis.setVerticalPosition(getEL(\"assertbox\"));\r\n\t},\r\n\tconfirm: function(strJP, strEN, func) {\r\n\t\tgetEL(\"confirmcaption\").innerHTML = ui.selectStr(strJP, strEN);\r\n\t\tthis.setVerticalPosition(getEL(\"confirmbox\"));\r\n\t\tthis.onconfirm = func;\r\n\t},\r\n\tsetVerticalPosition: function(el) {\r\n\t\tvar elbg = getEL(\"notifybg\");\r\n\t\telbg.style.display = \"block\";\r\n\t\tel.style.display = \"inline-block\";\r\n\r\n\t\t/* innerHeightがIE8以下にないので、代わりに背景要素の高さ(height=100%), 幅を取得します */\r\n\t\tvar rect = pzpr.util.getRect(el),\r\n\t\t\trectbg = pzpr.util.getRect(elbg);\r\n\t\tel.style.top = (rectbg.height - rect.height) / 2 + \"px\";\r\n\t\tel.style.left = (rectbg.width - rect.width) / 2 + \"px\";\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// notify.closealert()  alertを非表示に戻す\r\n\t//---------------------------------------------------------------------------\r\n\tclosealert: function(e) {\r\n\t\tgetEL(\"assertbox\").style.display = \"none\";\r\n\t\tgetEL(\"notifybg\").style.display = \"none\";\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// notify.confirmtrue()  confirmでOKが押された時の処理を記入する\r\n\t// notify.confirmfalse() confirmでCancelが押されたときの処理を記入する\r\n\t//---------------------------------------------------------------------------\r\n\tconfirmtrue: function(e) {\r\n\t\tif (!!this.onconfirm) {\r\n\t\t\tthis.onconfirm();\r\n\t\t}\r\n\t\tthis.onconfirm = null;\r\n\t\tthis.confirmfalse(e);\r\n\t},\r\n\tconfirmfalse: function(e) {\r\n\t\tgetEL(\"confirmbox\").style.display = \"none\";\r\n\t\tgetEL(\"notifybg\").style.display = \"none\";\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t}\r\n};\r\n","// KeyPopup.js v3.4.0\r\n/* global createEL:readonly, getEL:readonly */\r\n\r\n//---------------------------------------------------------------------------\r\n// ★KeyPopupクラス マウスからキーボード入力する際のPopupウィンドウを管理する\r\n//---------------------------------------------------------------------------\r\n// キー入力用Popupウィンドウ\r\nui.keypopup = {\r\n\t/* メンバ変数 */\r\n\tpaneltype: { 1: 0, 3: 0 } /* パネルのタイプ */,\r\n\telement: null /* キーポップアップのエレメント */,\r\n\r\n\ttdcolor: \"black\" /* 文字の色 */,\r\n\timgCR: [1, 1] /* img表示用画像の横×縦のサイズ */,\r\n\r\n\timgs: [] /* resize用 */,\r\n\r\n\tbasepanel: null,\r\n\tclearflag: false,\r\n\r\n\t/* どの文字配置を作成するかのテーブル */\r\n\ttype: {\r\n\t\tslither: [3, 0],\r\n\t\tnawabari: [4, 0],\r\n\t\tfourcells: [4, 0],\r\n\t\tfivecells: [4, 0],\r\n\t\tfillmat: [4, 0],\r\n\t\tpaintarea: [4, 0],\r\n\t\tlightup: [4, 0],\r\n\t\tshakashaka: [4, 0],\r\n\t\tgokigen: [4, 0],\r\n\t\twagiri: [4, 0],\r\n\t\tshugaku: [4, 0],\r\n\t\tcreek: [4, 0],\r\n\t\tichimaga: [4, 0],\r\n\t\tichimagam: [4, 0],\r\n\t\tichimagax: [4, 0],\r\n\t\tsukoro: [4, 4],\r\n\t\tsukororoom: [4, 4],\r\n\t\tlookair: [5, 0],\r\n\t\ttawa: [6, 0],\r\n\t\thashikake: [8, 0],\r\n\t\ttapa: [8, 0],\r\n\t\ttapaloop: [8, 0],\r\n\t\tamibo: [10, 0],\r\n\t\tcave: [10, 0],\r\n\t\tbdblock: [10, 0],\r\n\t\tcountry: [10, 0],\r\n\t\tusotatami: [10, 0],\r\n\t\theyawake: [10, 0],\r\n\t\tayeheya: [10, 0],\r\n\t\tkurodoko: [10, 0],\r\n\t\tnagenawa: [10, 0],\r\n\t\tringring: [10, 0],\r\n\t\tnumlin: [10, 0],\r\n\t\tnurikabe: [10, 0],\r\n\t\tnuribou: [10, 0],\r\n\t\tmochikoro: [10, 0],\r\n\t\tmochinyoro: [10, 0],\r\n\t\tshikaku: [10, 0],\r\n\t\taho: [10, 0],\r\n\t\tshimaguni: [10, 0],\r\n\t\tchocona: [10, 0],\r\n\t\tyajitatami: [10, 0],\r\n\t\ttasquare: [10, 0],\r\n\t\tkurotto: [10, 0],\r\n\t\tbonsan: [10, 0],\r\n\t\theyabon: [10, 0],\r\n\t\trectslider: [10, 0],\r\n\t\tsatogaeri: [10, 0],\r\n\t\tyosenabe: [10, 0],\r\n\t\therugolf: [10, 0],\r\n\t\tfirefly: [10, 0],\r\n\t\ttateyoko: [10, 0],\r\n\t\tfactors: [10, 10],\r\n\t\tfillomino: [10, 10],\r\n\t\tsymmarea: [10, 10],\r\n\t\trenban: [10, 10],\r\n\t\tripple: [10, 10],\r\n\t\tcojun: [10, 10],\r\n\t\tmakaro: [10, 10],\r\n\t\tsudoku: [10, 10],\r\n\t\tnanro: [10, 10],\r\n\t\tview: [10, 10],\r\n\t\tkakuru: [10, 10],\r\n\t\tkazunori: [10, 10],\r\n\t\tskyscrapers: [10, 10],\r\n\t\tkropki: [10, 10],\r\n\t\ttilepaint: [51, 0],\r\n\t\ttriplace: [51, 0],\r\n\t\tkakuro: [51, 10],\r\n\r\n\t\tslalom: [101, 0],\r\n\t\treflect: [102, 0],\r\n\t\tpipelink: [111, 0],\r\n\t\tpipelinkr: [111, 0],\r\n\t\tloopsp: [111, 0],\r\n\t\ttatamibari: [112, 0],\r\n\t\thakoiri: [113, 113],\r\n\t\tkusabi: [114, 0],\r\n\t\tdoppelblock: [10, 115],\r\n\t\tinterbd: [116, 0],\r\n\t\ttoichika2: [10, 10]\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// kp.display()     キーポップアップを表示する\r\n\t//---------------------------------------------------------------------------\r\n\tdisplay: function() {\r\n\t\tvar mode = ui.puzzle.editmode ? 1 : 3;\r\n\t\tif (\r\n\t\t\tthis.element &&\r\n\t\t\t!!this.paneltype[mode] &&\r\n\t\t\tui.menuconfig.get(\"keypopup\")\r\n\t\t) {\r\n\t\t\tthis.element.style.display = \"block\";\r\n\r\n\t\t\tgetEL(\"panelbase1\").style.display = mode === 1 ? \"block\" : \"none\";\r\n\t\t\tgetEL(\"panelbase3\").style.display = mode === 3 ? \"block\" : \"none\";\r\n\t\t} else if (!!this.element) {\r\n\t\t\tthis.element.style.display = \"none\";\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// kp.create()      キーポップアップを生成して初期化する\r\n\t// kp.createtable() キーポップアップのポップアップを作成する\r\n\t//---------------------------------------------------------------------------\r\n\tcreate: function() {\r\n\t\tif (!!this.element) {\r\n\t\t\tgetEL(\"panelbase1\").innerHTML = \"\";\r\n\t\t\tgetEL(\"panelbase3\").innerHTML = \"\";\r\n\t\t}\r\n\r\n\t\tthis.imgs = []; // resize用\r\n\r\n\t\tvar type = this.type[ui.puzzle.pid];\r\n\t\tif (!type) {\r\n\t\t\ttype = [0, 0];\r\n\t\t}\r\n\r\n\t\tthis.paneltype = { 1: !ui.puzzle.playeronly ? type[0] : 0, 3: type[1] };\r\n\t\tif (!this.paneltype[1] && !this.paneltype[3]) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!this.element) {\r\n\t\t\tvar rect = pzpr.util.getRect(getEL(\"divques\"));\r\n\t\t\tthis.element = getEL(\"keypopup\");\r\n\t\t\tthis.element.style.left = rect.left + 48 + \"px\";\r\n\t\t\tthis.element.style.top = rect.top + 48 + \"px\";\r\n\t\t\tpzpr.util.unselectable(this.element);\r\n\t\t}\r\n\r\n\t\tif (this.paneltype[1] !== 0) {\r\n\t\t\tthis.createtable(1);\r\n\t\t}\r\n\t\tif (this.paneltype[3] !== 0) {\r\n\t\t\tthis.createtable(3);\r\n\t\t}\r\n\r\n\t\tthis.resizepanel();\r\n\r\n\t\tvar bar = getEL(\"barkeypopup\");\r\n\t\tui.event.addEvent(bar, \"mousedown\", ui.popupmgr, ui.popupmgr.titlebardown);\r\n\t\tui.event.addEvent(bar, \"dblclick\", ui.menuconfig, function() {\r\n\t\t\tthis.set(\"keypopup\", false);\r\n\t\t});\r\n\t},\r\n\tcreatetable: function(mode, type) {\r\n\t\tthis.basepanel = getEL(\"panelbase\" + mode);\r\n\t\tthis.basepanel.innerHTML = \"\";\r\n\r\n\t\tthis.tdcolor = mode === 3 ? ui.puzzle.painter.fontAnscolor : \"black\";\r\n\r\n\t\tthis.generate(mode);\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// kp.generate()    キーポップアップのテーブルを作成する\r\n\t// kp.gentable4()   キーポップアップの0～4を入力できるテーブルを作成する\r\n\t// kp.gentable10()  キーポップアップの0～9を入力できるテーブルを作成する\r\n\t// kp.gentable51()  キーポップアップの[＼],0～9を入力できるテーブルを作成する\r\n\t//---------------------------------------------------------------------------\r\n\tgenerate: function(mode) {\r\n\t\tvar type = this.paneltype[mode];\r\n\t\tif (type === 4) {\r\n\t\t\tthis.gentable4(mode);\r\n\t\t} else if (type === 10) {\r\n\t\t\tthis.gentable10(mode);\r\n\t\t} else if (type === 51) {\r\n\t\t\tthis.gentable51(mode);\r\n\t\t} else if (type === 3) {\r\n\t\t\tthis.gentable3(mode);\r\n\t\t} else if (type === 5) {\r\n\t\t\tthis.gentable5(mode);\r\n\t\t} else if (type === 6) {\r\n\t\t\tthis.gentable6(mode);\r\n\t\t} else if (type === 8) {\r\n\t\t\tthis.gentable8(mode);\r\n\t\t} else if (type === 101) {\r\n\t\t\tthis.generate_slalom(mode);\r\n\t\t} else if (type === 102) {\r\n\t\t\tthis.generate_reflect(mode);\r\n\t\t} else if (type === 111) {\r\n\t\t\tthis.generate_pipelink(mode);\r\n\t\t} else if (type === 112) {\r\n\t\t\tthis.generate_tatamibari(mode);\r\n\t\t} else if (type === 113) {\r\n\t\t\tthis.generate_hakoiri(mode);\r\n\t\t} else if (type === 114) {\r\n\t\t\tthis.generate_kusabi(mode);\r\n\t\t} else if (type === 115) {\r\n\t\t\tthis.generate_doppelblock();\r\n\t\t} else if (type === 116) {\r\n\t\t\tthis.generate_interbd();\r\n\t\t}\r\n\t},\r\n\tgentable4: function(mode) {\r\n\t\tvar pid = ui.puzzle.pid,\r\n\t\t\titemlist = [\"1\", \"2\", \"3\", \"4\"];\r\n\t\tif (mode === 3 && (pid === \"sukoro\" || pid === \"sukororoom\")) {\r\n\t\t\tvar mbcolor = ui.puzzle.painter.mbcolor;\r\n\t\t\titemlist.push(\r\n\t\t\t\t[\"q\", { text: \"○\", color: mbcolor }],\r\n\t\t\t\t[\"w\", { text: \"×\", color: mbcolor }],\r\n\t\t\t\t\" \",\r\n\t\t\t\tnull\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tvar cap = \"?\";\r\n\t\t\tif (ui.puzzle.painter.hideHatena) {\r\n\t\t\t\tswitch (pid) {\r\n\t\t\t\t\tcase \"lightup\":\r\n\t\t\t\t\tcase \"shakashaka\":\r\n\t\t\t\t\t\tcap = \"■\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"gokigen\":\r\n\t\t\t\t\tcase \"wagiri\":\r\n\t\t\t\t\tcase \"shugaku\":\r\n\t\t\t\t\tcase \"creek\":\r\n\t\t\t\t\t\tcap = \"○\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\titemlist.push(\"0\", null, \" \", [\"-\", cap]);\r\n\t\t}\r\n\t\tthis.generate_main(itemlist, 4);\r\n\t},\r\n\tgentable10: function(mode) {\r\n\t\tvar pid = ui.puzzle.pid,\r\n\t\t\titemlist = [];\r\n\t\tif (mode === 3 && ui.puzzle.klass.Cell.prototype.numberWithMB) {\r\n\t\t\tvar mbcolor = ui.puzzle.painter.mbcolor;\r\n\t\t\titemlist.push(\r\n\t\t\t\t[\"q\", { text: \"○\", color: mbcolor }],\r\n\t\t\t\t[\"w\", { text: \"×\", color: mbcolor }],\r\n\t\t\t\t\" \",\r\n\t\t\t\tnull\r\n\t\t\t);\r\n\t\t}\r\n\t\tif (mode === 1 && (pid === \"kakuru\" || pid === \"tateyoko\")) {\r\n\t\t\titemlist.push([\"q1\", \"■\"], [\"w2\", \"□\"], \" \", [\"-\", \"?\"]);\r\n\t\t}\r\n\r\n\t\titemlist.push(\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\");\r\n\t\tif (mode === 3 && pid === \"toichika2\") {\r\n\t\t\titemlist.push([\"-\", { text: \"・\", color: \"rgb(255, 96, 191)\" }]);\r\n\t\t}\r\n\t\titemlist.push(\r\n\t\t\tmode === 1 || !ui.puzzle.klass.Cell.prototype.numberWithMB ? \" \" : null\r\n\t\t);\r\n\r\n\t\tvar cap = null;\r\n\t\tif (mode === 3 || pid === \"kakuru\" || pid === \"tateyoko\") {\r\n\t\t} else if (!ui.puzzle.painter.hideHatena) {\r\n\t\t\tcap = \"?\";\r\n\t\t} else if (pid === \"tasquare\") {\r\n\t\t\tcap = \"□\";\r\n\t\t} else if (pid === \"rectslider\") {\r\n\t\t\tcap = \"■\";\r\n\t\t} else if (\r\n\t\t\tpid === \"kurotto\" ||\r\n\t\t\tpid === \"bonsan\" ||\r\n\t\t\tpid === \"satogaeri\" ||\r\n\t\t\tpid === \"heyabon\" ||\r\n\t\t\tpid === \"yosenabe\" ||\r\n\t\t\tpid === \"herugolf\" ||\r\n\t\t\tpid === \"kazunori\"\r\n\t\t) {\r\n\t\t\tcap = \"○\";\r\n\t\t}\r\n\t\tif (cap !== null) {\r\n\t\t\titemlist.push([\"-\", cap]);\r\n\t\t}\r\n\t\tthis.generate_main(itemlist, 4);\r\n\t},\r\n\tgentable51: function(mode) {\r\n\t\tthis.generate_main(\r\n\t\t\t[\r\n\t\t\t\t[\"q\", { image: 0 }],\r\n\t\t\t\t\" \",\r\n\t\t\t\t\"1\",\r\n\t\t\t\t\"2\",\r\n\t\t\t\t\"3\",\r\n\t\t\t\t\"4\",\r\n\t\t\t\t\"5\",\r\n\t\t\t\t\"6\",\r\n\t\t\t\t\"7\",\r\n\t\t\t\t\"8\",\r\n\t\t\t\t\"9\",\r\n\t\t\t\t\"0\"\r\n\t\t\t],\r\n\t\t\t4\r\n\t\t);\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// kp.gentable3()  キーポップアップの0～4を入力できるテーブルを作成する\r\n\t// kp.gentable5()  キーポップアップの0～5を入力できるテーブルを作成する\r\n\t// kp.gentable6()  キーポップアップの0～6を入力できるテーブルを作成する\r\n\t// kp.gentable8()  キーポップアップの0～8を入力できるテーブルを作成する\r\n\t//---------------------------------------------------------------------------\r\n\tgentable3: function(mode) {\r\n\t\tthis.generate_main([\"1\", \"2\", \"3\", \"0\", \" \", [\"-\", \"?\"]], 3);\r\n\t},\r\n\tgentable5: function(mode) {\r\n\t\tthis.generate_main(\r\n\t\t\t[\"1\", \"2\", \"3\", \"4\", \"5\", null, \"0\", \" \", [\"-\", \"?\"]],\r\n\t\t\t3\r\n\t\t);\r\n\t},\r\n\tgentable6: function(mode) {\r\n\t\tthis.generate_main([\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"0\", \" \", [\"-\", \"?\"]], 3);\r\n\t},\r\n\tgentable8: function(mode) {\r\n\t\tif (ui.puzzle.pid !== \"tapa\" && ui.puzzle.pid !== \"tapaloop\") {\r\n\t\t\tthis.generate_main(\r\n\t\t\t\t[\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \" \", [\"-\", \"○\"]],\r\n\t\t\t\t4\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tthis.generate_main(\r\n\t\t\t\t[\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"0\", \" \", [\"-\", \"?\"]],\r\n\t\t\t\t4\r\n\t\t\t);\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// kp.generate_slalom()     スラローム用のテーブルを作成する\r\n\t// kp.generate_reflect()    リフレクトリンク用のテーブルを作成する\r\n\t//---------------------------------------------------------------------------\r\n\tgenerate_slalom: function(mode) {\r\n\t\tthis.imgCR = [4, 1];\r\n\t\tthis.generate_main(\r\n\t\t\t[\r\n\t\t\t\t[\"q\", { image: 0 }],\r\n\t\t\t\t[\"s\", { image: 1 }],\r\n\t\t\t\t[\"w\", { image: 2 }],\r\n\t\t\t\t[\"e\", { image: 3 }],\r\n\t\t\t\t[\"r\", \" \"],\r\n\t\t\t\t\"1\",\r\n\t\t\t\t\"2\",\r\n\t\t\t\t\"3\",\r\n\t\t\t\t\"4\",\r\n\t\t\t\t\"5\",\r\n\t\t\t\t\"6\",\r\n\t\t\t\t\"7\",\r\n\t\t\t\t\"8\",\r\n\t\t\t\t\"9\",\r\n\t\t\t\t\"0\",\r\n\t\t\t\t\"-\",\r\n\t\t\t\t\" \"\r\n\t\t\t],\r\n\t\t\t5\r\n\t\t);\r\n\t},\r\n\tgenerate_reflect: function(mode) {\r\n\t\tthis.imgCR = [4, 1];\r\n\t\tthis.generate_main(\r\n\t\t\t[\r\n\t\t\t\t[\"q\", { image: 0 }],\r\n\t\t\t\t[\"w\", { image: 1 }],\r\n\t\t\t\t[\"e\", { image: 2 }],\r\n\t\t\t\t[\"r\", { image: 3 }],\r\n\t\t\t\t[\"t\", \"╋\"],\r\n\t\t\t\t[\"y\", \" \"],\r\n\t\t\t\t\"1\",\r\n\t\t\t\t\"2\",\r\n\t\t\t\t\"3\",\r\n\t\t\t\t\"4\",\r\n\t\t\t\t\"5\",\r\n\t\t\t\t\"6\",\r\n\t\t\t\t\"7\",\r\n\t\t\t\t\"8\",\r\n\t\t\t\t\"9\",\r\n\t\t\t\t\"0\",\r\n\t\t\t\t\"-\"\r\n\t\t\t],\r\n\t\t\t6\r\n\t\t);\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// kp.generate_pipelink()   パイプリンク、帰ってきたパイプリンク、環状線スペシャル用のテーブルを作成する\r\n\t// kp.generate_tatamibari() タタミバリ用のテーブルを作成する\r\n\t// kp.generate_hakoiri()    はこいり○△□用のテーブルを作成する\r\n\t// kp.generate_kusabi()     クサビリンク用のテーブルを作成する\r\n\t//---------------------------------------------------------------------------\r\n\tgenerate_pipelink: function(mode) {\r\n\t\tvar pid = ui.puzzle.pid,\r\n\t\t\titemlist = [];\r\n\t\titemlist.push(\r\n\t\t\t[\"q\", \"╋\"],\r\n\t\t\t[\"w\", \"┃\"],\r\n\t\t\t[\"e\", \"━\"],\r\n\t\t\t[\"r\", \" \"],\r\n\t\t\tpid !== \"loopsp\" ? [\"-\", \"?\"] : null,\r\n\t\t\t[\"a\", \"┗\"],\r\n\t\t\t[\"s\", \"┛\"],\r\n\t\t\t[\"d\", \"┓\"],\r\n\t\t\t[\"f\", \"┏\"]\r\n\t\t);\r\n\t\tif (pid === \"pipelink\") {\r\n\t\t\titemlist.push(null);\r\n\t\t} else if (pid === \"pipelinkr\") {\r\n\t\t\titemlist.push([\"1\", \"○\"]);\r\n\t\t} else if (pid === \"loopsp\") {\r\n\t\t\titemlist.push([\"-\", \"○\"]);\r\n\t\t}\r\n\r\n\t\tif (pid === \"loopsp\") {\r\n\t\t\titemlist.push(\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"0\");\r\n\t\t}\r\n\t\tthis.generate_main(itemlist, 5);\r\n\t},\r\n\tgenerate_tatamibari: function(mode) {\r\n\t\tthis.generate_main(\r\n\t\t\t[\r\n\t\t\t\t[\"q\", \"╋\"],\r\n\t\t\t\t[\"w\", \"┃\"],\r\n\t\t\t\t[\"e\", \"━\"],\r\n\t\t\t\t[\"r\", \" \"],\r\n\t\t\t\t[\"-\", \"?\"]\r\n\t\t\t],\r\n\t\t\t3\r\n\t\t);\r\n\t},\r\n\tgenerate_hakoiri: function(mode) {\r\n\t\tthis.generate_main(\r\n\t\t\t[\r\n\t\t\t\t[\"1\", \"○\"],\r\n\t\t\t\t[\"2\", \"△\"],\r\n\t\t\t\t[\"3\", \"□\"],\r\n\t\t\t\t[\r\n\t\t\t\t\t\"4\",\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttext: mode === 1 ? \"?\" : \"・\",\r\n\t\t\t\t\t\tcolor: mode === 3 ? \"rgb(255, 96, 191)\" : \"\"\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\t\" \"\r\n\t\t\t],\r\n\t\t\t3\r\n\t\t);\r\n\t},\r\n\tgenerate_kusabi: function(mode) {\r\n\t\tthis.generate_main(\r\n\t\t\t[[\"1\", \"同\"], [\"2\", \"短\"], [\"3\", \"長\"], [\"-\", \"○\"], \" \"],\r\n\t\t\t3\r\n\t\t);\r\n\t},\r\n\tgenerate_doppelblock: function() {\r\n\t\tthis.generate_main(\r\n\t\t\t[\r\n\t\t\t\t\"1\",\r\n\t\t\t\t\"2\",\r\n\t\t\t\t\"3\",\r\n\t\t\t\t\"4\",\r\n\t\t\t\t\"5\",\r\n\t\t\t\t\"6\",\r\n\t\t\t\t\"7\",\r\n\t\t\t\t\"8\",\r\n\t\t\t\t\"9\",\r\n\t\t\t\t\"0\",\r\n\t\t\t\t[\"q\", \"⋅\"],\r\n\t\t\t\t[\"w\", \"■\"],\r\n\t\t\t\t\" \"\r\n\t\t\t],\r\n\t\t\t5\r\n\t\t);\r\n\t},\r\n\tgenerate_interbd: function() {\r\n\t\tthis.generate_main(\r\n\t\t\t[\r\n\t\t\t\t\"1\",\r\n\t\t\t\t\"2\",\r\n\t\t\t\t\"3\",\r\n\t\t\t\t\"4\",\r\n\t\t\t\t\"0\",\r\n\t\t\t\t[\"-\", { text: \"?\", color: \"gray\" }],\r\n\t\t\t\t[\"q\", { text: \"●\", color: \"red\" }],\r\n\t\t\t\t[\"w\", { text: \"◆\", color: \"blue\" }],\r\n\t\t\t\t[\"e\", { text: \"▲\", color: \"green\" }],\r\n\t\t\t\t[\"r\", { text: \"■\", color: \"#c000c0\" }],\r\n\t\t\t\t[\"t\", { text: \"⬟\", color: \"#ff8000\" }],\r\n\t\t\t\t[\"y\", { text: \"⬣\", color: \"#00c0c0\" }],\r\n\t\t\t\t\" \"\r\n\t\t\t],\r\n\t\t\t4\r\n\t\t);\r\n\t},\r\n\r\n\tgenerate_main: function(list, split) {\r\n\t\tfor (var i = 0; i < list.length; i++) {\r\n\t\t\tthis.inputcol(list[i]);\r\n\t\t\tif ((i + 1) % split === 0) {\r\n\t\t\t\tthis.insertrow();\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (i % split !== 0) {\r\n\t\t\tthis.insertrow();\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// kp.inputcol()  テーブルのセルを追加する\r\n\t// kp.insertrow() テーブルの行を追加する\r\n\t//---------------------------------------------------------------------------\r\n\tinputcol: function(item) {\r\n\t\tvar type = \"num\",\r\n\t\t\tca,\r\n\t\t\tdisp,\r\n\t\t\tcolor = this.tdcolor;\r\n\t\tif (!item) {\r\n\t\t\ttype = \"empty\";\r\n\t\t} else {\r\n\t\t\tif (typeof item === \"string\") {\r\n\t\t\t\tca = disp = item;\r\n\t\t\t} else if (typeof item[1] === \"string\") {\r\n\t\t\t\tca = item[0];\r\n\t\t\t\tdisp = item[1];\r\n\t\t\t} else if (!!item[1].text) {\r\n\t\t\t\tca = item[0];\r\n\t\t\t\tdisp = item[1].text;\r\n\t\t\t\tcolor = item[1].color;\r\n\t\t\t} else if (item[1].image !== void 0) {\r\n\t\t\t\tca = item[0];\r\n\t\t\t\tdisp = item[1].image;\r\n\t\t\t\ttype = \"image\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar _div = null,\r\n\t\t\t_child = null;\r\n\t\tif (type !== \"empty\") {\r\n\t\t\t_div = createEL(\"div\");\r\n\t\t\t_div.className = \"kpcell kpcellvalid\";\r\n\t\t\t_div.onclick = function(e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t};\r\n\t\t\tui.event.addEvent(_div, \"mousedown\", ui.puzzle, function(e) {\r\n\t\t\t\tthis.key.keyevent(ca, 0);\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t});\r\n\t\t\tpzpr.util.unselectable(_div);\r\n\t\t} else {\r\n\t\t\t_div = createEL(\"div\");\r\n\t\t\t_div.className = \"kpcell kpcellempty\";\r\n\t\t\tpzpr.util.unselectable(_div);\r\n\t\t}\r\n\r\n\t\tif (type === \"num\") {\r\n\t\t\t_child = createEL(\"span\");\r\n\t\t\t_child.className = \"kpnum\";\r\n\t\t\t_child.style.color = color;\r\n\t\t\t_child.innerHTML = disp;\r\n\t\t\tpzpr.util.unselectable(_child);\r\n\t\t} else if (type === \"image\") {\r\n\t\t\t_child = createEL(\"img\");\r\n\t\t\t_child.className = \"kpimg\";\r\n\t\t\tvar pid = ui.puzzle.pid;\r\n\t\t\t_child.src =\r\n\t\t\t\t\"data:image/gif;base64,\" +\r\n\t\t\t\tthis.dataurl[!!this.dataurl[pid] ? pid : \"shitappa\"];\r\n\t\t\tpzpr.util.unselectable(_child);\r\n\t\t\tvar x = disp % this.imgCR[0],\r\n\t\t\t\ty = (disp - x) / this.imgCR[1];\r\n\t\t\tthis.imgs.push({ el: _child, x: x, y: y });\r\n\t\t}\r\n\r\n\t\tif (this.clearflag) {\r\n\t\t\t_div.style.clear = \"both\";\r\n\t\t\tthis.clearflag = false;\r\n\t\t}\r\n\t\tif (!!_child) {\r\n\t\t\t_div.appendChild(_child);\r\n\t\t}\r\n\t\tthis.basepanel.appendChild(_div);\r\n\t},\r\n\tinsertrow: function() {\r\n\t\tthis.clearflag = true;\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// kp.resizepanel() キーポップアップのセルのサイズを変更する\r\n\t//---------------------------------------------------------------------------\r\n\tresizepanel: function() {\r\n\t\tvar cellsize = Math.min(ui.puzzle.painter.cw, 120);\r\n\t\tif (cellsize < 20) {\r\n\t\t\tcellsize = 20;\r\n\t\t}\r\n\r\n\t\tvar dsize = (cellsize * 0.9) | 0,\r\n\t\t\ttsize = (cellsize * 0.7) | 0;\r\n\t\tfor (var i = 0, len = this.imgs.length; i < len; i++) {\r\n\t\t\tvar obj = this.imgs[i],\r\n\t\t\t\timg = obj.el;\r\n\t\t\timg.style.width = \"\" + dsize * this.imgCR[0] + \"px\";\r\n\t\t\timg.style.height = \"\" + dsize * this.imgCR[1] + \"px\";\r\n\t\t\timg.style.clip =\r\n\t\t\t\t\"rect(\" +\r\n\t\t\t\t(dsize * obj.y + 1) +\r\n\t\t\t\t\"px,\" +\r\n\t\t\t\tdsize * (obj.x + 1) +\r\n\t\t\t\t\"px,\" +\r\n\t\t\t\tdsize * (obj.y + 1) +\r\n\t\t\t\t\"px,\" +\r\n\t\t\t\t(dsize * obj.x + 1) +\r\n\t\t\t\t\"px)\";\r\n\t\t\timg.style.top = \"-\" + obj.y * dsize + \"px\";\r\n\t\t\timg.style.left = \"-\" + obj.x * dsize + \"px\";\r\n\t\t}\r\n\r\n\t\tui.misc.modifyCSS({\r\n\t\t\t\"div.kpcell\": {\r\n\t\t\t\twidth: \"\" + dsize + \"px\",\r\n\t\t\t\theight: \"\" + dsize + \"px\",\r\n\t\t\t\tlineHeight: \"\" + dsize + \"px\"\r\n\t\t\t},\r\n\t\t\t\"span.kpnum\": { fontSize: \"\" + tsize + \"px\" }\r\n\t\t});\r\n\t},\r\n\r\n\tdataurl: {\r\n\t\tslalom:\r\n\t\t\t\"R0lGODlhAAFAAMIEAAICAmBgYJ+fn///////AP//AP//AP//ACH5BAEKAAQALAAAAAAAAUAAAAP+OLrc/jDKSau9OOvNu/9gKI5kaZ5oqq5s675wLM90bd94ru+24AdAH68BKBqHNqNyyWw6n9DSD2oMCHhMZI3K7XqLI0Hgq7TmstoZec0GhMTt8jW5TKvj+OhnnFfOaWh2MH2EdR0ChUtmd0qCMYmJHXxOQFZ/P5OUjEeOL5CFHJmKfxFTmp2oIZ+EG6JVpBVwTQGptR2rfRquAIsbiLO2wRi4eRm7tB+yS7DCzQ7EeBi/yyO7zCiBziTQcRfTfiWuyCzZ2iLcbReu1yDrLeXmIOhsFt9F7CGu74bx5/NkFkSNO2EPAL4R8Prd+vclFpODbxKWkKhQA8OGFAS2EAX+UR6/ih4ueqFQsGPEMiCDieySUZGLkilrreTSEpwLjjFTzaRCweULewNz2tmpR4JPTyhTUBQ6geiTCUBjiFKxlGkEp06gUoMxVelHqxawNpmAE4Y9kxyqevw4dkFbt+XeQhBbtezPrSfUfpDLN67fr8/oNpLQ1SxeE3pDZuv7Ve4Ax4EFgyF8uMVZr4MxZ368+O9mzoCJSJ5cqjILeyAZb3bMuupo0hAucw3tTDUnBa0bu36tNemLwmCRvHbT1Lflo8GHDO9JG0XU5MJ5kzWdwm7e5tBFjyaJXAVMzbCzX5Ve3OaK5+CJizdKnrLx9GgXfl4fWbJD6iQ0rkgMfXmvBX0pfEcVdvT5x113+SF43Xz0MWBgTeYliF+DgLTH3IShMBEUhTc8eCCGxjQRH4fkWAjhe744MSKJ+5l4YoQhisjiDh4GRMmKBRmx4lq3zQiafa08YQlUu+goA3/J1agOFUH44CQQXOyoCoHrKelNkXj08giV4lkpTSJaHslldl5Kg2UXYW4SHotlapAjk1Iu2KOPVplCyZB05pmDk0Lo6eefgAYq6KCEFmrooSwkAAA7\",\r\n\t\treflect:\r\n\t\t\t\"R0lGODlhAAFAAIABAAAAAP///yH5BAEKAAEALAAAAAAAAUAAAAL+jI+py+0Po5y02ouz3rz7D4biSJbmiabqyrbuC8fyTNf2jef6bgD8H/A9AMSi8YhMKpdJCPMJjSKdQiCOGJFqt9Mh96vNYq22ogSMflLT7OPZTJ4ZJ+362GGv0+dxmHufh7YW+EXR1cdy+EbINcgoVdGEqCJp+BjmdRlloTSJ0smpCeUoWmlp6hmyhFHKRNoKFwqaCuLKCqvIgJt7OkvLoZaxy4c3fHcx+ruRLGz8WrrMrCxrq+GciQu8OR25HZ2N3dqByS3m/S0eLuqxVf7si76ufvnR6K7bXp9eDK2ff4+gUK1+/DSpEggwCEJ/9OYFEiEIYMSDDQsyGpHmXkb+jBUbGOQ4URmbEh3xXSTRZlpKkict2jGhh1ZMlg8dbqQ50tPLE4Tegfm0s0+eFDVd3oQ5NE5RnkE9NkWaFEhPSjOdriQ6lUdLrDmN2qOaNcejFlethuQatsxYskdN/mS7Vm3cRGcXtAU7V4Y8F3UV9EWb9wVBvgvdkiO8V/BgxIcNn2P8EXJJycG8rtILi3JgzfDsNlacecWuGp/9QqIxDO8+OY89S8M8mmls0q9dV0N9DWVu2rcd84KdGmTwG5XNosJtrArD4cQvW1YuN/nA5NCj/7G8g3qseLuvHDf9m7d2bdqrN79u/JjY8uq7sZeK3jF89ubNvZ/fHnx+7/Q96z9nrtV2bpHRn4A2SUfgfgEpyF+BiziolH8HMNgghP8hqJQTCW3IYYcefghiiCKOSGKJJp6IYooqrlhOAQA7\",\r\n\t\tshitappa:\r\n\t\t\t\"R0lGODlhQABAAIABAAAAAP//ACH5BAEKAAEALAAAAABAAEAAAAL6jI+py+0Po5y02ouz3rz7DwHiSJbmiaZnqLbuW7LwTMdPjdcyCUb8veo5fkOUsEFEjgK2YyLJ+DWdBuiCOHVaFcmscPtcIrwg8Fh8Rn/VUXbVvIG/RW13R860z+k9PJys4ad3AIghyFc0aHEI4IMnwQj5uEMpqWjZCIToeFmZmDlRyAmqtIlJWhG5OMnVyRrWeeUaW2c66nkhKmvbykuhC4u6K7xKm+ebRlyMHIwb+Kh6F12qbCg3La2InY28za3s/T3sXGYV7pF1jt41y7yOpv5hEy/PQ18f9Ek1fF8OnAPwxY6ABP8VPMgIYcF9DBs6fAgxosSJFBMUAAA7\"\r\n\t}\r\n};\r\n","// Timer.js v3.4.0\r\n\r\n(function() {\r\n\t//---------------------------------------------------------------------------\r\n\t// ★Timerクラス  一般タイマー(経過時間の表示/自動正答判定用)\r\n\t//---------------------------------------------------------------------------\r\n\tvar timerInterval = 100; /* タイマー割り込み間隔 */\r\n\r\n\tui.timer = {\r\n\t\t/* メンバ変数 */\r\n\t\tTID: null /* タイマーID */,\r\n\t\tcurrent: 0 /* 現在のgetTime()取得値(ミリ秒) */,\r\n\r\n\t\t/* 経過時間表示用変数 */\r\n\t\tbseconds: 0 /* 前回ラベルに表示した時間(秒数) */,\r\n\t\ttimerEL: null /* 経過時間表示用要素 */,\r\n\r\n\t\t/* 自動正答判定用変数 */\r\n\t\tworstACtime: 0 /* 正答判定にかかった時間の最悪値(ミリ秒) */,\r\n\t\tnextACtime: 0 /* 次に自動正答判定ルーチンに入ることが可能になる時間 */,\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// tm.reset()      タイマーのカウントを0にして、スタートする\r\n\t\t// tm.start()      update()関数を200ms間隔で呼び出す\r\n\t\t// tm.update()     200ms単位で呼び出される関数\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinit: function() {\r\n\t\t\tthis.worstACtime = 0;\r\n\t\t\tthis.timerEL = document.getElementById(\"timerpanel\");\r\n\t\t\tthis.showtime(0);\r\n\t\t},\r\n\t\tstart: function() {\r\n\t\t\tvar self = this;\r\n\t\t\tif (!!this.TID) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tui.puzzle.resetTime();\r\n\t\t\tthis.update();\r\n\t\t\tthis.TID = setInterval(function() {\r\n\t\t\t\tself.update();\r\n\t\t\t}, timerInterval);\r\n\t\t},\r\n\t\tstop: function() {\r\n\t\t\tif (!this.TID) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tclearInterval(this.TID);\r\n\t\t\tthis.TID = null;\r\n\t\t},\r\n\t\tupdate: function() {\r\n\t\t\tthis.current = pzpr.util.currentTime();\r\n\r\n\t\t\tif (ui.puzzle.playeronly) {\r\n\t\t\t\tthis.updatetime();\r\n\t\t\t}\r\n\t\t\tif (ui.menuconfig.get(\"autocheck_once\")) {\r\n\t\t\t\tvar mode = ui.menuconfig.get(\"autocheck_mode\");\r\n\t\t\t\tthis.autocheck(mode === \"guarded\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// tm.updatetime() 秒数の表示を行う\r\n\t\t// tm.label()      経過時間に表示する文字列を返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tshowtime: function(seconds) {\r\n\t\t\tvar hours = (seconds / 3600) | 0;\r\n\t\t\tvar minutes = ((seconds / 60) | 0) - hours * 60;\r\n\t\t\tseconds = seconds - minutes * 60 - hours * 3600;\r\n\r\n\t\t\tif (minutes < 10) {\r\n\t\t\t\tminutes = \"0\" + minutes;\r\n\t\t\t}\r\n\t\t\tif (seconds < 10) {\r\n\t\t\t\tseconds = \"0\" + seconds;\r\n\t\t\t}\r\n\r\n\t\t\tthis.timerEL.innerHTML = [\r\n\t\t\t\tthis.label(),\r\n\t\t\t\t!!hours ? hours + \":\" : \"\",\r\n\t\t\t\tminutes,\r\n\t\t\t\t\":\",\r\n\t\t\t\tseconds\r\n\t\t\t].join(\"\");\r\n\t\t},\r\n\t\tupdatetime: function() {\r\n\t\t\tvar seconds = (ui.puzzle.getTime() / 1000) | 0;\r\n\t\t\tif (this.bseconds === seconds) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.showtime(seconds);\r\n\t\t\tthis.bseconds = seconds;\r\n\t\t},\r\n\t\tlabel: function() {\r\n\t\t\treturn ui.selectStr(\"経過時間：\", \"Time: \");\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// tm.autocheck()    自動正解判定を呼び出す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tautocheck: function(guarded) {\r\n\t\t\tvar puzzle = ui.puzzle;\r\n\t\t\tif (\r\n\t\t\t\tthis.current > this.nextACtime &&\r\n\t\t\t\tpuzzle.playmode &&\r\n\t\t\t\t!puzzle.checker.inCheck &&\r\n\t\t\t\tpuzzle.board.trialstage === 0 &&\r\n\t\t\t\t!puzzle.getConfig(\"variant\")\r\n\t\t\t) {\r\n\t\t\t\tvar check = puzzle.check(false);\r\n\t\t\t\tif (check.complete && (!guarded || !check.undecided)) {\r\n\t\t\t\t\tui.timer.stop();\r\n\t\t\t\t\tpuzzle.mouse.mousereset();\r\n\t\t\t\t\tui.menuconfig.set(\"autocheck_once\", false);\r\n\t\t\t\t\tif (ui.callbackComplete) {\r\n\t\t\t\t\t\tui.callbackComplete(puzzle, check);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.notify.alert(\"正解です！\", \"Complete!\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.worstACtime = Math.max(\r\n\t\t\t\t\tthis.worstACtime,\r\n\t\t\t\t\tpzpr.util.currentTime() - this.current\r\n\t\t\t\t);\r\n\t\t\t\tthis.nextACtime =\r\n\t\t\t\t\tthis.current +\r\n\t\t\t\t\t(this.worstACtime < 250\r\n\t\t\t\t\t\t? this.worstACtime * 4 + 120\r\n\t\t\t\t\t\t: this.worstACtime * 2 + 620);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ★UndoTimerクラス   Undo/Redo用タイマー\r\n\t//---------------------------------------------------------------------------\r\n\tvar undoTimerInterval = 25 /* タイマー割り込み間隔 */,\r\n\t\texecWaitTime = 300; /* 1回目にwaitを多く入れるための値 */\r\n\r\n\tui.undotimer = {\r\n\t\t/* メンバ変数 */\r\n\t\tTID: null /* タイマーID */,\r\n\r\n\t\tinUNDO: false /* Undo実行中 */,\r\n\t\tinREDO: false /* Redo実行中 */,\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ut.reset()  タイマーをスタートする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\treset: function() {\r\n\t\t\tthis.stop();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ut.startUndo() Undo開始共通処理\r\n\t\t// ut.startRedo() Redo開始共通処理\r\n\t\t// ut.stopUndo() Undo停止共通処理\r\n\t\t// ut.stopRedo() Redo停止共通処理\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tstartUndo: function() {\r\n\t\t\tif (!(this.inUNDO || this.inREDO)) {\r\n\t\t\t\tthis.inUNDO = true;\r\n\t\t\t\tthis.proc();\r\n\t\t\t}\r\n\t\t},\r\n\t\tstartRedo: function() {\r\n\t\t\tif (!(this.inREDO || this.inUNDO)) {\r\n\t\t\t\tthis.inREDO = true;\r\n\t\t\t\tthis.proc();\r\n\t\t\t}\r\n\t\t},\r\n\t\tstopUndo: function() {\r\n\t\t\tif (this.inUNDO) {\r\n\t\t\t\tthis.inUNDO = false;\r\n\t\t\t\tthis.proc();\r\n\t\t\t}\r\n\t\t},\r\n\t\tstopRedo: function() {\r\n\t\t\tif (this.inREDO) {\r\n\t\t\t\tthis.inREDO = false;\r\n\t\t\t\tthis.proc();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ut.start() Undo/Redo呼び出しを開始する\r\n\t\t// ut.stop()  Undo/Redo呼び出しを終了する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tstart: function() {\r\n\t\t\tvar self = this;\r\n\t\t\tfunction handler() {\r\n\t\t\t\tself.proc();\r\n\t\t\t}\r\n\t\t\tfunction inithandler() {\r\n\t\t\t\tclearInterval(self.TID);\r\n\t\t\t\tself.TID = setInterval(handler, undoTimerInterval);\r\n\t\t\t}\r\n\t\t\tthis.TID = setInterval(inithandler, execWaitTime);\r\n\t\t\tthis.exec();\r\n\t\t},\r\n\t\tstop: function() {\r\n\t\t\tthis.inUNDO = false;\r\n\t\t\tthis.inREDO = false;\r\n\r\n\t\t\tclearInterval(this.TID);\r\n\t\t\tthis.TID = null;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ut.proc()  Undo/Redo呼び出しを実行する\r\n\t\t// ut.exec()  Undo/Redo関数を呼び出す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tproc: function() {\r\n\t\t\tif ((this.inUNDO || this.inREDO) && !this.TID) {\r\n\t\t\t\tthis.start();\r\n\t\t\t} else if (!(this.inUNDO || this.inREDO) && !!this.TID) {\r\n\t\t\t\tthis.stop();\r\n\t\t\t} else if (!!this.TID) {\r\n\t\t\t\tthis.exec();\r\n\t\t\t}\r\n\t\t},\r\n\t\texec: function() {\r\n\t\t\tif (!this.checknextprop()) {\r\n\t\t\t\tthis.stop();\r\n\t\t\t} else if (this.inUNDO) {\r\n\t\t\t\tui.puzzle.undo();\r\n\t\t\t} else if (this.inREDO) {\r\n\t\t\t\tui.puzzle.redo();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ut.checknextprop()  次にUndo/Redoができるかどうかの判定を行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tchecknextprop: function() {\r\n\t\t\tvar opemgr = ui.puzzle.opemgr;\r\n\t\t\tvar isenable =\r\n\t\t\t\t(this.inUNDO && opemgr.enableUndo) ||\r\n\t\t\t\t(this.inREDO && opemgr.enableRedo);\r\n\t\t\treturn isenable;\r\n\t\t}\r\n\t};\r\n})();\r\n","/* jshint devel:true */\r\n/* global ui:false, getEL:readonly */\r\n\r\nui.popupmgr.addpopup(\"auxeditor\", {\r\n\tformname: \"auxeditor\",\r\n\r\n\tclose: function() {\r\n\t\tif (ui.auxeditor.cb && ui.auxeditor.puzzle) {\r\n\t\t\tui.auxeditor.cb(ui.auxeditor.puzzle);\r\n\t\t\tui.auxeditor.cb = null;\r\n\t\t}\r\n\t\tui.auxeditor.current = null;\r\n\r\n\t\tui.popupmgr.popups.template.close.apply(this);\r\n\t},\r\n\r\n\tinit: function() {\r\n\t\tui.popupmgr.popups.template.init.call(this);\r\n\r\n\t\tfunction btnfactory(role) {\r\n\t\t\treturn function(e) {\r\n\t\t\t\tui.toolarea[role](e);\r\n\t\t\t\tif (e.type !== \"click\") {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t\tfunction addbtnevent(el, type, role) {\r\n\t\t\tpzpr.util.addEvent(el, type, ui.toolarea, btnfactory(role));\r\n\t\t}\r\n\r\n\t\tui.misc.walker(this.form, function(el) {\r\n\t\t\tif (el.nodeType === 1) {\r\n\t\t\t\tif (el.className === \"config\") {\r\n\t\t\t\t\tui.toolarea.items[ui.customAttr(el, \"config\")] = { el: el };\r\n\t\t\t\t} else if (el.className.match(/child/)) {\r\n\t\t\t\t\tvar parent = el.parentNode.parentNode,\r\n\t\t\t\t\t\tidname = ui.customAttr(parent, \"config\");\r\n\t\t\t\t\tvar item = ui.toolarea.items[idname];\r\n\t\t\t\t\tif (!item.children) {\r\n\t\t\t\t\t\titem.children = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t\titem.children.push(el);\r\n\r\n\t\t\t\t\taddbtnevent(el, \"mousedown\", \"toolclick\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n});\r\n\r\nui.auxeditor = {\r\n\tcurrent: null,\r\n\tcb: null,\r\n\r\n\topen: function(sender, args, cb) {\r\n\t\tif (ui.auxeditor.current === args.key) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar cellsize = ui.puzzle.painter.cw;\r\n\t\tif (cellsize > 32) {\r\n\t\t\tcellsize = Math.floor(cellsize * 0.75);\r\n\t\t}\r\n\r\n\t\tvar rect = pzpr.util.getRect(getEL(\"divques\"));\r\n\t\tui.popupmgr.open(\"auxeditor\", 4, rect.top);\r\n\r\n\t\tif (!ui.auxeditor.puzzle) {\r\n\t\t\tvar element = document.getElementById(\"divauxeditor\");\r\n\t\t\tui.auxeditor.puzzle = new pzpr.Puzzle(element, {\r\n\t\t\t\ttype: \"player\",\r\n\t\t\t\tcellsize: cellsize\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar pz = ui.auxeditor.puzzle;\r\n\r\n\t\tpz.open(args.pid + \"/\" + args.url, function() {\r\n\t\t\tui.popupmgr.popups.auxeditor.titlebar.innerText = ui.selectStr(\r\n\t\t\t\tpz.info.ja,\r\n\t\t\t\tpz.info.en\r\n\t\t\t);\r\n\t\t\tui.auxeditor.puzzle.setCanvasSizeByCellSize(cellsize);\r\n\r\n\t\t\tvar bounds = pzpr.util.getRect(getEL(\"popauxeditor\"));\r\n\t\t\tui.popupmgr.open(\r\n\t\t\t\t\"auxeditor\",\r\n\t\t\t\tMath.max(4, rect.left - bounds.width),\r\n\t\t\t\tbounds.top\r\n\t\t\t);\r\n\t\t});\r\n\r\n\t\tui.auxeditor.current = args.key;\r\n\t\tui.auxeditor.cb = cb;\r\n\t\tui.menuconfig.set(\"auxeditor_inputmode\", \"auto\");\r\n\t}\r\n};\r\n","(function() {\r\n\tui.network = {\r\n\t\tws: null,\r\n\t\tmode: \"\",\r\n\t\tkey: \"\",\r\n\t\tmaxSeen: -1,\r\n\r\n\t\tconfigure: function(mode, key) {\r\n\t\t\tthis.mode = mode;\r\n\t\t\tthis.key = key;\r\n\t\t\tui.setdisplay(\"network\");\r\n\t\t},\r\n\r\n\t\tstart: function() {\r\n\t\t\tif (!this.mode) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar loc = window.location;\r\n\t\t\tvar wsurl = \"ws://\";\r\n\t\t\tif (document.location.protocol === \"https:\") {\r\n\t\t\t\twsurl = \"wss://\";\r\n\t\t\t}\r\n\t\t\twsurl = wsurl + loc.host + \"/game/\" + this.key;\r\n\r\n\t\t\tthis.ws = new WebSocket(wsurl);\r\n\t\t\tthis.ws.onclose = this.onclose;\r\n\t\t\tthis.ws.onmessage = this.onmessage;\r\n\t\t},\r\n\r\n\t\tonCellOp: function(op) {\r\n\t\t\tif (!!this.ws) {\r\n\t\t\t\tthis.ws.send(op);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonclose: function(event) {\r\n\t\t\tui.network.start();\r\n\t\t},\r\n\r\n\t\tonmessage: function(event) {\r\n\t\t\tvar msg = JSON.parse(event.data);\r\n\t\t\tvar id = msg.id;\r\n\t\t\tif (id > ui.network.maxSeen) {\r\n\t\t\t\tui.network.maxSeen = id;\r\n\t\t\t\tui.network.applyOp(msg.operation);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tapplyOp: function(encOp) {\r\n\t\t\tvar op = new ui.puzzle.klass.ObjectOperation();\r\n\t\t\top.decode(encOp.split(\",\"));\r\n\t\t\top.external = true;\r\n\r\n\t\t\tui.puzzle.opemgr.disableRecord();\r\n\t\t\top.redo();\r\n\t\t\tui.puzzle.opemgr.enableRecord();\r\n\r\n\t\t\tui.puzzle.opemgr.newOperation();\r\n\t\t\tui.puzzle.opemgr.add(op);\r\n\t\t}\r\n\t};\r\n})();\r\n"]}