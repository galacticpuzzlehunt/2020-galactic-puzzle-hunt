{"version":3,"sources":["../../src/common/intro.js","../../src/pzpr/core.js","../../src/lib/candle-intro.js","../../node_modules/pzpr-canvas/dist/candle.js","../../src/lib/candle-outro.js","../../src/pzpr/env.js","../../src/pzpr/event.js","../../src/pzpr/classmgr.js","../../src/pzpr/variety.js","../../src/pzpr/parser.js","../../src/pzpr/metadata.js","../../src/pzpr/util.js","../../src/puzzle/Puzzle.js","../../src/puzzle/Config.js","../../src/puzzle/Address.js","../../src/puzzle/Piece.js","../../src/puzzle/PieceList.js","../../src/puzzle/Board.js","../../src/puzzle/BoardExec.js","../../src/puzzle/GraphBase.js","../../src/puzzle/LineManager.js","../../src/puzzle/AreaManager.js","../../src/puzzle/Graphic.js","../../src/puzzle/MouseInput.js","../../src/puzzle/KeyInput.js","../../src/puzzle/Encode.js","../../src/puzzle/FileData.js","../../src/puzzle/Answer.js","../../src/puzzle/Operation.js","../../src/variety-common/Graphic.js","../../src/variety-common/KeyInput.js","../../src/variety-common/MouseInput.js","../../src/variety-common/Answer.js","../../src/variety-common/BoardExec.js","../../src/variety-common/Encode.js","../../src/variety-common/FileData.js","../../src/variety-common/Operation.js","../../src/variety-common/Piece.js"],"names":["pzpr","version","module","exports","this","document","_doc","_2PI","Math","PI","_color","_hex","a","b","toString","substr","Candle","env","node","require","browser","window","location","wrapper","addWrapper","c","d","initialize","apply","arguments","wrapperbase","prototype","constructor","addType","_order","enable","push","current","TypeList","length","select","ME","initME","createElement","style","display","position","top","left","innerHTML","body","appendChild","offsetHeight","removeChild","getoffsetHeight","match","RegExp","$2","font","lineHeight","color","parse","join","getRectSize","width","offsetWidth","clientWidth","height","clientHeight","_counter","getcanvasid","start","getContext","e","parentNode","_children","indexOf","splice","replace","firstChild","pop","h","nextSibling","childNodes","f","call","g","tagName","_attr","id","i","reduce","outerHTML","j","k","l","setAttribute","m","split","forEach","n","o","nodeType","nodeName","lastChild","insertBefore","setAttributeNS","getAttribute","getAttributeNS","removeAttribute","textContent","bind","querySelector","querySelectorAll","data","chilsNodes","p","MockDocument","createElementNS","createTextNode","getElementById","q","MockXMLSerializer","serializeToString","r","MockDOMParser","parseFromString","XMLSerializer","DOMParser","fillStyle","strokeStyle","lineWidth","textAlign","textBaseline","canvas","canvasid","child","enableTextLengthWA","initElement","initFunction","initLayer","rectcenter","rect","fillRectCenter","fillRect","strokeRectCenter","strokeRect","shapeRectCenter","shapeRect","vhide","navigator","userAgent","candle-top","hanging","middle","alphabetic","bottom","opera","SVGNS","XLINKNS","center","right","use","vid","elements","_textcache","target","layers","cpath","lastpath","freezepath","overflow","btoa","Buffer","isBuffer","toDataURL","toBlob","Blob","type","toBuffer","setLayer","addVectorElement","clear","rendering","setRendering","freeze","changeSize","translate","beginPath","closePath","moveTo","lineTo","arc","cos","sin","abs","fill","stroke","shape","setLinePath","setLinePath_com","setOffsetLinePath","strokeLine","strokeDashedLine","strokeCross","fillCircle","strokeCircle","shapeCircle","getDefsElement","getImageElement","src","ownerDocument","getImageSymbol","fillText","fillText_main","hide","show","x","y","ml","ta","tb","toLowerCase","$1","$3","getBoundingClientRect","drawImage","drawImage_main","addVectorElement_main","probablySupportsContext","Canvas","context","currentLayerId","isedgearray","_empty","isedge","x0","y0","setkey","hidekey","release","atob","Uint8Array","charCodeAt","buffer","setProperties","setTransform","clearRect","setEdgeStyle","imageRendering","parseInt","setLineDash","concat","sqrt","isbrowser","UA","ios","android","os","iOS","Android","mobile","FireFoxVersion","ver","ChromeVersion","SafariVersion","bz","AndroidBrowser","Presto","OS","API","touchevent","ontouchstart","createTouch","pointerevent","PointerEvent","mspointerevent","MSPointerEvent","maxWidth","svgTextLength","anchor_download","download","lang","userlang","process","LANG","browserLanguage","language","userLanguage","postload","preinit","loadfun","execKeyDown","keytarget","key","e_keydown","execKeyUp","e_keyup","on","eventtype","func","readyState","setTimeout","addEventListener","util","addEvent","connectKeyEvents","puzzle","common","custom","","classmgr","makeCommon","commonbase","createCommon","names","searchName","NewClass","real","createClass","base","pid","extendPrototype","makeCustom","pidlist","custombase","createCustom","getExtension","extension","hashkey","proto","name","pidcond","isexist","classname","colon","basename","realname","BaseClass","NewProto","Object","includeCustomFile","scriptid","variety","script","includedFile","customfile","getpath","_script","getElementsByTagName","exporteddata","setPuzzleClass","newpid","callback","valid","emit","setClasses","klass","PuzzleClass","args","Array","slice","CustomProto","setPrototypeRef","info","ref","klassname","toPID","_info","alias","_list","genre","extend","obj","exists","each","getList","Genre","pzprid","datalist","ja","en","pzprapp","kanpen","pencilbox","urlid","pzprurl","kanpenid","aho","amibo","angleloop","aqre","aquarium","araf","armyants","arukone","ayeheya","balance","cave","alias2","alias3","barns","bdblock","bonsan","bosanowa","box","skyscrapers","castle","cbblock","chocona","cojun","compass","country","creek","curvedata","curvedata-aux","dbchoco","detour","doppelblock","dosufuwa","doubleback","easyasabc","factors","fillmat","fillomino","kanpen2","firefly","fivecells","fourcells","geradeweg","goishi","gokigen","haisu","hakoiri","hanare","hashikake","hebi","old","herugolf","heteromino","heyabon","heyawake","hitori","icebarn","icelom","icelom2","ichimaga","ichimagam","ichimagax","interbd","juosan","kaero","kakuro","kakuru","kazunori","kinkonkan","kouchoku","kramma","kramman","kropki","kurochute","kurodoko","kurotto","kusabi","lightup","lits","lookair","loopsp","loute","makaro","mashu","maxi","meander","mejilink","minarism","mines","midloop","mochikoro","mochinyoro","moonsun","nagare","nagenawa","nanro","nawabari","nikoji","nondango","nonogram","norinori","numlin","nuribou","nurikabe","nurimaze","nurimisaki","onsen","dac1","dac2","dac3","dac4","dac5","dac6","paintarea","pencils","pipelink","pipelinkr","putteria","rectslider","reflect","renban","ringring","ripple","roma","sashigane","satogaeri","scrin","shakashaka","shikaku","shimaguni","shugaku","shwolf","simpleloop","slalom","slither","snake","starbattle","stostone","sudoku","sukoro","sukororoom","symmarea","tapa","tapaloop","tasquare","tatamibari","tateyoko","tawa","tentaisho","tents","tilepaint","toichika","toichika2","triplace","usotatami","usoone","view","wagiri","walllogic","wblink","yajikazu","yajilin","yajilin-regions","yajitatami","yinyang","yosenabe","URLData","FileData","Parser","parser","URL_AUTO","URL_PZPRV3","URL_PZPRAPP","URL_KANPEN","URL_KANPENP","URL_HEYAAPP","URL_PZPRFILE","FILE_AUTO","FILE_PZPR","FILE_PBOX","FILE_PBOX_XML","parseFile","parseURL","url","fstr","mode","qdata","pflag","variant","cols","rows","isurl","isfile","parseURLType","parseURLData","changeProperPid","generate","outputURLType","outputURLData","qs","first","substring","modify","decodeURIComponent","parts","protocol","host","pathname","typ","inp","col","row","shift","isNaN","size","NaN","pzl","out","charAt","len","cc","ca","metadata","MetaData","filever","history","xmldoc","result","parseFileType","parseFileData","outputFileType","outputFileData","lines","firstline","unshift","historypos","str","strs","isinfo","JSON","cnt","count","update","metanode","meta","author","source","hard","commentnode","comment","puzzlenode","sizenode","createXMLNode","empty","stringify","getvaliddata","propnode","value","outputdata","attrs","pzlflag","items","reset","api","eventMouseDown","eventMouseMove","eventMouseUp","eventMouseCancel","dirname","__filename","srcs","currentTime","Date","getTime","unselectable","el","MozUserSelect","KhtmlUserSelect","webkitUserSelect","msUserSelect","userSelect","self","capt","executer","types","removeEventListener","getMouseButton","touches","pointerType","isPrimary","button","which","getPagePos","px","pageX","py","pageY","pos","getRect","scrollLeft","scrollTop","scrollX","scrollY","_html","documentElement","checkpid","matches","isdisp","openExecute","ready","classes","Board","initObjects","painter","suspendAll","Encode","decodeURL","FileIO","filedecode","postCanvasReady","resetTime","board","checker","AnsCheck","Graphic","cursor","TargetCursor","mouse","MouseEvent","KeyEvent","opemgr","OperationManager","faillist","FailCode","setCanvas_main","CanvasRenderingContext2D","pointerEvents","subcanvas","createSubCanvas","pc","opt","preInitCanvasInfo","instancetype","setCanvasEvents","outputImage","canvasWidth","canvasHeight","resizeCanvas","cellsize","resizeCanvasByCellSize","initCanvas","ae","execMouseDown","execMouseMove","execMouseUp","execMouseCancel","oncontextmenu","touchAction","stopPropagation","preventDefault","e_mousedown","e_mousemove","e_mouseup","e_mousecancel","getLocalCanvas","imageopt","imgcanvas","pc2","bgcolor","imgtile","unsuspend","parseImageOption","quality","argv","mimetype","Puzzle","option","modeid","player","viewer","playeronly","editmode","playmode","graphic","listeners","config","Config","setAll","setMode","set","setCanvas","starttime","MODE_EDITOR","MODE_PLAYER","open","eventname","addListener","once","evlist","ev","_div","setCanvasSize","setCanvasSizeByCellSize","redraw","forcemode","paintAll","irowake","irowakeRemake","execConfig","dataurl","blob","getURL","encodeURL","getFileData","fileencode","undo","redo","undoall","redoall","ismodified","isModified","saved","resetModifiedState","enterTrial","acceptTrial","rejectTrial","rejectCurrentTrial","check","activemode","keyreset","mousereset","checknw","checkne","checksw","checkse","ansclear","rebuildInfo","subclear","errclear","isclear","allerase","initBoardSize","newval","edit","play","adjust_modechange","modechange","getConfig","idname","get","setConfig","val","resetConfig","validConfig","getexec","getCurrentConfig","saveConfig","getAll","restoreConfig","init","list","add","volatile","defvalue","extoption","item","defval","getCurrentName","getNormalizedName","argname","splitted","setproper","configevent","conf","getvariant","getVariants","object","settings","EDITOR","exec","linegraph","moveline","irowakeblk","autocmp","initFont","resetCache","revCircleConfig","Position","bx","by","NDIR","UP","DN","LT","RT","equals","getaddr","Address","relcell","dx","dy","getc","relcross","getx","relbd","getb","relexcell","getex","relobj","getobj","reldirbd","dir","dd","movedir","draw","paintRange","drawaround","isinside","bd","minbx","maxbx","minby","maxby","getdir","diff","getvert","getnb","emptyborder","getborderobj","onborder","nullobj","Address:Position","clone","addr","move","oncell","oncross","getDot","RawAddress:Address","Dot:Position","isnull","piece","qnum","setDot","disCombine","setQnum","iserror","error","BoardPiece:Position","group","ques","qdir","qnum2","qnum3","qnum4","qchar","qans","anum","line","qsub","qcmp","snum","qinfo","trial","propques","propans","propsub","propinfo","propnorec","maxnum","minnum","initAdjacent","adjacent","initAdjBorder","adjborder","setQues","setdata","setQans","setQdir","setQnum2","setQchar","setAnum","setLineVal","setQsub","setQcmp","setSnum","setQnumDir","getQnumDir","prop","num","force","prehook","addOpe","trialstage","modifyInfo","posthook","property","ObjectOperation","setdata2","bypassPrehook","getprops","props","proplist","getproplist","compare","array","array1","enableSubNumberArray","getmaxnum","getminnum","seterr","isenableSetError","setinfo","Cell:BoardPiece","lcnt","dirs51","disInputHatena","numberWithMB","numberAsObject","numberAsLetter","numberRemainsUnshaded","supportQnumAnum","temp","anum0","isShade","isUnshade","setShade","clrShade","allowShade","allowUnshade","enablebcolor","isShadeDecided","getNum","setNum","clrSnum","vala","vals","isNum","noNum","isValidNum","isNumberObj","sameNumber","cell","is51cell","set51cell","remove51cell","ice","isDot","isEmpty","isValid","isDeparture","isDestination","isLineStraight","isLine","isLineCurve","isLPobj","1","11","12","14","15","2","16","17","3","13","4","noLPobj","5","21","22","isLP","noLP","countDir4Cell","adc","cells","getdir4clist","getdir4cblist","adb","cblist","bds","getOrthogonalCell","emptycell","eraseMovedLines","path","clist","border","removeLine","Cross:BoardPiece","setCrossBorderError","borderinside","Border:BoardPiece","sidecell","sidecross","sideobj","isvert","inside","enableLineNG","initSideObject","allowexcell","hasborder","hasexcell","borderAsLine","checkStableLine","setLine","setPeke","removeLineAndQsub","isBorder","setBorder","removeBorder","isVert","isHorz","isLineNG","checkFormCurve","isLineEX","cell1","cell2","ExCell:BoardPiece","PieceList","some","filter","cond","notnull","map","changer","include","remove","idx","setnoerr","allclear","isrec","propclear","trialclear","norec","pp","def","CellList:PieceList","x1","x2","y1","y2","getQnumCell","includes","getTopCell","tcell","eraseLines","CrossList:PieceList","BorderList:PieceList","cellinside","CellList","pushed","crossinside","CrossList","cross1","cross2","ExCellList:PieceList","diserror","haserror","hasinfo","cross","BorderList","excell","ExCellList","BoardPiece","Cell","emptycross","Cross","Border","emptyexcell","ExCell","createExtraObject","disrecinfo","infolist","addInfoList","LineGraph","roommgr","AreaRoomGraph","sblkmgr","AreaShadeGraph","ublkmgr","AreaUnshadeGraph","nblkmgr","AreaNumberGraph","addExtraInfo","BoardExec","insex","hascross","0","Klass","instance","enabled","hasflush","disable_subclear","excellRows","excellCols","initGroup","setminmax","setposAll","hasdots","initDots","initExtraObject","initCursor","groups","getGroup","estimateSize","clen","groups2","newObject","exrows","excols","setposCells","setposCrosses","setposBorders","setposExCells","setposGroup","qc","qr","bdinside","extUL","extDR","newOperation","BoardClearOperation","getObjectPos","xr","xc","operate","isBoardOp","execadjust","flushexcell","genericFlush","get_func","set_func","dest","objectinside","excellinside","blist","exlist","disableInfo","disableRecord","enableInfo","enableRecord","isenableInfo","rebuild","relation","coloring","newIrowake","disableSetError","enableSetError","freezecopy","bd2","compareData","dotsmax","dots","Dot","dot","dotinside","dlist","EXPAND","REDUCE","TURN","FLIP","TURNFLIP","EXPANDUP","EXPANDDN","EXPANDLT","EXPANDRT","REDUCEUP","REDUCEDN","REDUCELT","REDUCERT","TURNL","TURNR","FLIPX","FLIPY","boardtype","expandup","expanddn","expandlt","expandrt","reduceup","reducedn","reducelt","reducert","turnl","turnr","flipy","flipx","qnumw","qnumh","execadjust_main","adjustBoardData","hastop","reduceRoomNumber","tmp","expandGroup","reduceGroup","turnflipGroup","adjustBoardData2","ope","BoardFlipOperation","BoardAdjustOperation","margin","isdel","expandborder","reduceborder","undoExec","redoExec","forceRecord","oldcols","oldrows","oldexcols","oldexrows","oldminx","oldminy","distObj","d2","objlist","converted","xx","yy","bdAsLine","group2","dist","outerBorder","innerBorder","copyBorder","border1","border2","qnums","area","room","GraphBase","pointgroup","linkgroup","removeFromArray","setComponentRefs","component","getObjNodeList","nodeobj","resetObjNodeList","isnodevalid","isedgevalidbylinkobj","linkobj","isedgevalidbynodeobj","nodeobj1","nodeobj2","isedgeexistsbylinkobj","sidenodes","getSideNodesBySeparator","nodes","calcNodeCount","rebuildmode","components","modifyNodes","rebuild2","searchGraph","nodeobjs","linkobjs","createNode","addEdgeByLinkObj","setEdgeByNodeObj","createComponent","GraphComponent","deleteComponent","GraphNode","deleteNode","resetExtraData","createNodeIfEmpty","deleteNodeIfEmpty","addEdge","node1","node2","removeEdge","getSideObjByLinkObj","getSideObjByNodeObj","getSideNodesByLinkObj","sidenodeobj","setEdgeByLinkObj","setEdgeBySeparator","modifyOtherInfo","remakeComponent","isset","incdecBorderCount","addEdgeBySeparator","removeEdgeBySeparator","attachNode","setComponentInfo","remakeComponents","getAffectedComponents","checkDividedComponent","remakeMaximalComponents","isremake","pseudoComponent","searchSingle","longColor","getLongColor","newComponents","setLongColor","partslist","newcomponents","setComponentInfoExtra","setExtraData","startparts","stack","setExtra","edges","circuits","getLargeComponent","largeComponent","largeTrial","isTrial","comp","repaintNodes","paths","getNewLineColor","getLinkObjByNodes","bx1","by1","bx2","by2","getnodeobjs","objs","getedgeobjs","checkAutoCmp","iscmp","checkCmp","cmp","setedgeerr","setedgeinfo","LineGraph:GraphBase","border.line","isLineCross","makeClist","pathnodes","iscrossing","incdecLineCount","resetLineCount","borders","ltotal","removeEdgeByLinkObj","enattach","attachnodes","endetach","detachnodes","lcnt1","lcnt2","haspath","nbnodes","vertnode","horiznode","lrnode","edgeobjs","setMovedBase","blist_all","repaintLines","departure","destination","movevalid","before","after","point","AreaGraphBase:GraphBase","removeEdgeByNodeObj","addEdgeByNodeObj","preedges","AreaShadeGraph:AreaGraphBase","cell.qans","sblk","sblknodes","clist_all","repaintBlocks","AreaUnshadeGraph:AreaGraphBase","ublk","ublknodes","AreaNumberGraph:AreaGraphBase","cell.qnum","cell.anum","cell.qsub","nblk","nblknodes","AreaRoomGraph:AreaGraphBase","cell.ques","border.ques","border.qans","getComponentRefs","roomnodes","AreaGraphBase","resetBorderCount","ischassis","setTopOfRoom_combine","merged","keep","tcell1","tcell2","getSideAreaInfo","sides","adjs","room1","room2","gridcolor","gridcolor_list","gridcolor_type","fgcellcolor_func","bgcellcolor_func","bordercolor_func","numbercolor_func","circlefillcolor_func","circlestrokecolor_func","resetRange","subcontext","quescolor","qanscolor","qcmpcolor","qcmpbgcolor","trialcolor","subcolor","shadecolor","errcolor1","errcolor2","fontShadecolor","bcolor","errbcolor1","errbcolor2","qsubcolor1","qsubcolor2","qsubcolor3","icecolor","erricecolor","circlebasecolor","mbcolor","linecolor","errlinecolor","noerrcolor","movelinecolor","movetrialcolor","pekecolor","bbcolor","targetColorEdit","targetColorPlay","targetColorTrial","ttcolor","movecolor","DARK","LIGHT","DLIGHT","SLIGHT","THIN","textoption","fontsizeratio","fontwidth","fontfamily","isSupportMaxWidth","crosssize","circleratio","cw","ch","bw","bh","devicePixelRatio","gw","lw","lwmin","lm","lwratio","addlw","lastHdeg","lastYdeg","minYdeg","maxYdeg","range","useBuffer","pendingResize","suspended","suspendedAll","hideHatena","resize_canvas_main","isgothic","cwid","chgt","insuspend","getCanvasCols","getCanvasRows","setParameter","setOffset","clearObject","min","pxSize","gwdev","max","round","lwdev","g2","getBoardCols","getOffsetCols","getBoardRows","getOffsetRows","suspend","setRange","prepaint","svg","bm","setRangeObject","flushCanvas","paintMain","copyBufferData","paint","paintPost","crosses","excells","sx1","sy1","sx2","sy2","loopcount","Rdeg","random","Gdeg","Bdeg","Cmax","Cmin","Hdeg","Ldeg","Sdeg","Ydeg","drawLines","repaintParts","vinc","fm","bwidth","bheight","layerid","CENTER","BOTTOMLEFT","BOTTOMRIGHT","TOPRIGHT","TOPLEFT","disptext","text","realsize","ratio","maxLength","widtharray","widthratiopos","widthratio","hoffset","voffset","ImageTile","Image","image_canvas","image_svg","onload","imgsrc_dataurl","cwidth","cheight","loaded","putImage","ctx","dw","dh","img","sw","sh","sx","sy","enableMouse","mouseCell","firstCell","inputPoint","RawAddress","firstPoint","prevPos","btn","inputData","firstState","bordermode","mousestart","mousemove","mouseend","inputMode","savedInputMode","RBShadeCell","inputModes","inversion","cell0","setMouseButton","addrtarget","getBoardAddress","inputEnd","buttons","kc","checkmodifiers","isSHIFT","isMETA","pix","offsetX","layerX","layerY","offsetY","pagePos","mouseevent","distance","mx","my","inputPath","step","cancelEvent","updateStarts","newChain","mouseinput","isZ","mouseinput_auto","mouseinput_number","mouseinput_clear","input51_fixed","inputFixedNumber","inputIcebarn","inputBGcolor","inputFixedQsub","inputqcmp","inputDot","inputdirec","inputarrow_cell","inputcrossMark","inputborder","inputQsubLine","inputShade","inputLine","inputpeke","inputTateyoko","dispInfoLine","dispInfoBlk","mouseinput_other","inputqnum","inputclean_cell","notInputted","changeflag","setInputMode","getInputModeList","setInversion","input","getcell","getpos","getcell_excell","getcross","spc","m1","m2","minaxis","extra","getborder","isBorderMode","setcursor","pos0","setaddr","setcursorsnum","targetdir","enableKey","enablemake","enableplay","keyup_event","isCTRL","isALT","isX","isY","keydown","keyup","prev","isenablemode","getchar","checkbutton","keyevent","cancelDefault","shiftKey","ctrlKey","metaKey","altKey","charall","keycode","keyCode","charCode","keylist","inputKeys","keyexec","keyDispInfo","moveTarget","keyinput","key_inputqnum","moveTCell","moveTC","moveTCross","moveTBorder","mv","flag","miny","maxy","minx","maxx","moveExCell","addr0","TargetCursor:Address","mode51","modesnum","targetdirs","crosstype","adjust_init","setminmax_customize","adjust_cell_to_excell","shortest","checksnum","tmpx","tmpy","chtarget","ur","ul","detectTarget","invalidRight","invalidBottom","getNumOfTarget","outpflag","outvariant","outcols","outrows","outbstr","fio","checkpflag","decodePzpr","dataarray","decodeKanpen","decodeHeyaApp","encodePzpr","FILE_PZPRV3","encodeURIComponent","encodeKanpen","datastr","encodeHeyaApp","throwNoImplementation","lineseek","currentType","filetype","decodeData","readLine","decodeTrial","kanpenOpen","kanpenOpenXML","decodeHistory","encodeData","encodeTrial","kanpenSave","kanpenSaveXML","encodeHistory","time","opes","bd1","TrialEnterOperation","trialpos","resumeTrial","stage","writeLine","resumeGoto","getItemList","decodeObj","startbx","startby","endbx","endby","decodeCell","decodeCross","decodeBorder","decodeCellExCell","encodeObj","encodeCell","encodeCross","encodeBorder","encodeCellExCell","decodeFlags","flags","encodeFlags","flagnames","decodeCellXMLBoard","encodeCellXMLBoard","boardnode","PBOX_ADJUST","decodeCellXMLBrow","decodeCellXMLrow_com","encodeCellXMLBrow","encodeCellXMLrow_com","decodeCellXMLArow","encodeCellXMLArow","parentnodename","targetnodename","rownodes","ADJ","rownode","nodename","v","inCheck","checkOnly","makeCheckList","failcodemode","failcode","checklist","order","order_nw","order_ne","order_sw","order_se","prio","checklist_normal","checklist_normal_nw","checklist_normal_ne","checklist_normal_sw","checklist_normal_se","sort","checklist_auto","checkAns","complete","checkAnsNW","completeq","checkAnsNE","checkAnsSW","checkAnsSE","break_if_error","CheckInfo","checkSingleError","gettext","code","undecided","lastcode","textlist","texts","langcode","textitem","invalid","setUndecided","Operation","external","manager","setData","reqReset","decode","toJSON","broadcast","ObjectOperation:Operation","STRGROUP","C","X","B","E","STRPROP","U","N","Z","M","D","A","S","K","L","prefix","isModify","lastope","isNoop","getPiece","BoardClearOperation:Operation","BoardAdjustOperation:Operation","key_undo","key_redo","BoardFlipOperation:Operation","d0","TrialEnterOperation:Operation","emitTrial","TrialFinalizeOperation:Operation","OperationList","disEmitTrial","savedStarts","broken","initpos","disrec","chainflag","enableUndo","enableRedo","limitTrialUndo","enableNetwork","operationlist","TrialFinalizeOperation","addExtraOperation","getStarts","starts","oldstarts","checkexec","checkenable","atStartOfTrial","removeDescendant","newope","historyinfo","datas","opelist","len2","List","ope1","checkReqReset","preproc","undoCore","postproc","redoCore","rejectall","drawTrialStarts","drawQuesCells","drawCells_common","getQuesCellColor","getQuesCellColor_ques","getQuesCellColor_qnum","drawShadedCells","getShadedCellColor","drawBGCells","getBGCellColor","getBGCellColor_error1","getBGCellColor_error2","getBGCellColor_qcmp","getBGCellColor_qcmp1","getBGCellColor_qsub1","getBGCellColor_qsub2","getBGCellColor_qsub3","getBGCellColor_icebarn","getBGCellColor_qsub4","getBGCellColor_qsub5","header","colorfunc","drawBGExCells","getBGExCellColor","drawDotCells","dsize","drawCellArrows","al","aw","tl","tw","getCellArrowColor","drawSlashes","basewidth","addwidth","drawQuesNumbers","drawNumbers_com","getQuesNumberText","getQuesNumberColor","drawAnsNumbers","getAnsNumberText","getAnsNumberColor","drawHatenas","getQuesHatenaText","getQuesNumberColor_qnum","textfunc","getNumberVerticalOffset","getNumberText","getNumberTextCore_letter","getNumberTextCore","toUpperCase","getQuesNumberColor_fixed","getQuesNumberColor_fixed_shaded","getQuesNumberColor_move","getQuesNumberColor_mixed","drawNumbersExCell","drawSubNumbers","posarray","drawArrowNumbers","digit","drawCircledNumbers","drawCircles","drawTapaNumbers","opts","nums","drawCrosses","csize","drawCrossMarks","drawBorders","drawBorders_common","getBorderColor","getBorderColor_ques","getBorderColor_qans","err","isCmp","getBorderColor_ice","drawQuesBorders","getQuesBorderColor","drawQansBorders","getQansBorderColor","drawBorderQsubs","drawBoxBorders","tileflag","isdraw","falling","px0","px1","px2","px3","py0","py1","py2","py3","UPin","DNin","LTin","RTin","isUP","isDN","isLT","isRT","isUL","isUR","isDL","isDR","getLineColor","isIrowake","isDispmove","drawTip","tsize","tplus","drawPekes","drawBaseMarks","drawTriangle","getTriangleColor","drawTriangle1","mgn","drawTriangle2","drawMBs","rsize","drawBorderAuxDir","ssize","ra","rsize_stroke","rsize_fill","getCircleFillColor","getCircleStrokeColor","getCircleStrokeColor_qnum","isdrawmove","getCircleStrokeColor_qnum2","getCircleFillColor_qnum","getCircleFillColor_qnum2","getCircleFillColor_qcmp","drawDepartures","drawLineParts","qu","drawTateyokos","qa","getBarColor","vert","isErr","drawQues51","drawExCellGrid","drawTargetTriangle","drawSlash51Cells","drawSlash51ExCells","drawQuesNumbersOn51","drawQuesNumbersOn51_2","drawQuesNumbersOn51_1","adj","drawTarget","drawCursor","islarge","drawRawCursor","w","drawTargetSubNumber","th","drawStartGoal","startpos","draggingSG","goalpos","getDotFillColor","getDotOutlineColor","getDotRadius","drawDots","outline","drawDashedCenterLines","dasharray","getDashArray","dashCount","stepSize","lengthOn","lengthOff","drawGrid","haschassis","bs","xa","xb","ya","yb","drawDashedGrid","drawChassis","withexcell","exWidth","exHeight","boardWidth","boardHeight","drawChassis_ex1","boldflag","key_inputcross","cur","key_inputqnum_main","snumpos","getNewNumber","key_inputarrow","key_inputdirec_common","key_inputdirec","arrownum","inputnumber51","max_obj","getnum51","setnum51","inputcell","decIC","initFirstCell","inputqnum_main","ishatena","subtype","inputQues","inputQues_main","inputMB","isforceforward","inputarrow_cell_main","inputtile","input51","input51_main","inputqnum_cell51","inputselect_cell51","inputqnum_cross","inputcross_main","inputclean_cross","xlist","inputMoveLine","moving","targetCell","inputpeke_ifborder","inputdiraux_mousedown","inputdiraux_mousemove","clickdiraux","trans","clickTateyoko","plus","-1","dispInfoBlk8","dispInfoUblk","NW","NE","SW","SE","checkAllCell","checkSomeCell","checkNoNumCell","checkIceLines","checkNotCrossOnMark","checkLineOnShadeCell","checkNoLineObject","checkLineOverLetter","checkNumberHasArrow","checkDir4Cell","iscount","checkSideCell","checkAdjacentShadeCell","checkAdjacentDiffNumber","check2x2Block","check2x2ShadeCell","checkSameColorTile","checkSameObjectInRoom","checkConnectShade","checkOneArea","checkConnectUnshade","checkConnectNumber","graph","checkConnectUnshadeRB","errclist","fid","checkShadeCellExist","doneShadingDecided","checkOneLoop","checkOneLineBase","checkOneLine","checkNumberExist","checkConnectAllNumber","checkLineExist","checkCrossLine","checkLineCount","checkBranchLine","checkDeadendLine","checkNoLine","boardcross","checkCrossConnectLine","checkConnectLineCount","checkBranchConnectLine","checkDeadendConnectLine","checkenableLineParts","checkAllArea","evalfunc","checkAllBlock","filterfunc","areas","checkSomeBlock","qdl","accept","idd","checkNumberAndSize","checkRoomRect","checkNoNumber","checkDoubleNumber","checkShadeCellCount","checkNoShadeCellInArea","checkLinesInArea","checkNoMovedObjectInRoom","checkDisconnectLine","checkConnectObjectCount","checkConnectObject","checkTripleObject","checkSideAreaSize","getval","a1","a2","checkSideAreaCell","getvalue","allloop","roomval","checkDifferentNumberInRoom","checkDifferentNumberInRoom_main","isDifferentNumberInClist","isIndividualObject","isDifferentAnsNumberInClist","numfunc","clist2","checkRowsCols","checkDifferentNumberInLine","checkRowsColsPartly","termfunc","keycell","key51num","tx","ty","checkRowsColsFor51cell","checkBorderCross","checkBorderCount","checkBorderDeadend","bp","checkLineShape","pathsegs","getLineShapeInfo","pathseg","checkLineShapeDeadend","passed","dir4bd","firstbd","serachLineShapeInfo","ccnt","dir1","dir2","cs2x2","csNotSquare","csAdjacent","csDivide","cuDivide","cuDivideRB","brNoShade","bkNoNum","bkNumGe2","bkDupNum","bkPlNum","bkSepNum","bkSizeNe","bkShadeNe","bkShadeDivide","bkNoShade","bkMixed","bkWidthGt1","brNoValidNum","brNoLine","bkNotRect","bdDeadEnd","bdCross","lnDeadEnd","lnBranch","lnCross","lnNotCrossMk","lnCrossExIce","lnCurveOnIce","lnPlLine","lnPlLoop","lnOnShade","lcDeadEnd","lcDivided","lcTripleNum","lcIsolate","lcOnNum","nmNoLine","nmConnected","laIsolate","laOnNum","laCurve","laLenNe","ceNoNum","ceNoLine","ceAddLine","anNoArrow","anShadeNe","nmAdjacent","nmDupRow","nmDivide","nmSumViewNe","adjustNumberArrow","adjustCellQdirArrow","adjustCellArrow","adjustCellQnumArrow","getTranslateDir","adjustBorderArrow","adjustQues51_1","adjustQues51_2","reverse","adjustExCellTopLeft_1","rowmin","colmin","adjustExCellTopLeft_2","preserve","getAfterPos","up","decode4Cell","bstr","encode4Cell","cm","pstr","qn","decode1Cell","encode1Cell","have","decode4Cross","encode4Cross","decodeNumber10","maybeEncodeNumber10","encodeNumber10","readNumber16","decodeOneNumber16","res","decodeNumber16","writeNumber16","encodeNumber16","genericEncodeNumber16","decodeNumber10or16","encodeNumber10or16","decodeNumber16ExCell","ec","encodeNumber16ExCell","encodeNumber16ExCellFlushed","ex","decodeRoomNumber16","encodeRoomNumber16","decodeArrowNumber16","ca1","encodeArrowNumber16","pos1","pos2","twi","pass","decodeCrossMark","cp","cp2","encodeCrossMark","decodeCircle","tri","encodeCircle","decodeQues","encodeQues","skipnone","found","decodeIce","encodeIce","decodeEmpty","encodeEmpty","decodecross_old","decodeDot","s","encodeDot","dot2","decodeCellQnum","encodeCellQnum","decodeCellQnumb","encodeCellQnumb","decodeCellQnumAns","encodeCellQnumAns","decodeCellDirecQnum","encodeCellDirecQnum","decodeCellAns","encodeCellAns","decodeCellQanssub","encodeCellQanssub","decodeCellAnumsub","setCellSnum","encodeCellAnumsub","getCellSnum","snumtext","decodeCellQsub","encodeCellQsub","decodeCrossNum","encodeCrossNum","decodeBorderQues","encodeBorderQues","decodeBorderAns","encodeBorderAns","decodeBorderArrowAns","lca","encodeBorderArrowAns","decodeBorderLine","encodeBorderLine","decodeAreaRoom","decodeAreaRoom_com","encodeAreaRoom","encodeAreaRoom_com","isques","rdata2Border","rooms","roomid","rdata","isdiff","decodeCellQnum51","encodeCellQnum51","decodeDotFile","encodeDotFile","decodeCellQnum_kanpen","encodeCellQnum_kanpen","decodeCellAnum_kanpen","encodeCellAnum_kanpen","decodeCellQnumAns_kanpen","encodeCellQnumAns_kanpen","UNDECIDED_NUM_XML","decodeCellQnum_XMLBoard","undecnum","encodeCellQnum_XMLBoard","decodeCellQnum_XMLBoard_Brow","encodeCellQnum_XMLBoard_Brow","decodeCellAnum_XMLAnswer","encodeCellAnum_XMLAnswer","decodeAreaRoom_XMLBoard","encodeAreaRoom_XMLBoard","decodeCellAns_XMLAnswer","encodeCellAns_XMLAnswer","decodeBorderLine_XMLAnswer","bdh","bdv","encodeBorderLine_XMLAnswer","StartGoalOperation:Operation","StartGoalAddress:Address","partner","exchangestartgoal","StartGoalOperation","StartAddress:StartGoalAddress","GoalAddress:StartGoalAddress"],"mappings":"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","file":"pzpr.js","sourcesContent":["// intro.js\r\n\r\n(function(){\r\n","// core.js v3.5.2\r\n\r\n//----------------------------------------------------------------------------\r\n// ★pzprオブジェクト\r\n//---------------------------------------------------------------------------\r\n/* extern */\r\nvar pzpr = {\r\n\tversion: \"\"\r\n};\r\n\r\nif (typeof module === \"object\" && module.exports) {\r\n\tmodule.exports = pzpr;\r\n} else {\r\n\tthis.pzpr = pzpr;\r\n}\r\n","// candle-intro.js\r\n\r\n(function(){\r\n\r\n\r\n//---------------------------------------------------------------------------\r\n// node.js環境向けの対策\r\n//---------------------------------------------------------------------------\r\nvar document = this.document;\r\n\r\nvar module = {exports:{}}, exports = module.exports;\r\n\r\n(function(module,exports){\r\n","/*! @license candle.js v0.8.2 (c) 2011-2017 sabo2, MIT license\r\n *   https://bitbucket.org/sabo2/candle */\r\nvar _doc=\"undefined\"!=typeof document?document:void 0,_2PI=2*Math.PI,_color=[],_hex=function(){for(var a=[],b=256;b<512;b++)a[b-256]=b.toString(16).substr(1);return a}(),Candle={version:\"0.8.2\",env:{node:\"object\"==typeof module&&\"object\"==typeof exports&&\"function\"==typeof require,browser:\"object\"==typeof document&&\"object\"==typeof window&&\"object\"==typeof location},wrapper:{},addWrapper:function(a,b){var c,d=function(){this.initialize&&this.initialize.apply(this,arguments)};for(c in this.wrapperbase)d.prototype[c]=this.wrapperbase[c];for(c in b)d.prototype[c]=b[c];this.wrapper[a]=d.prototype.constructor=d,this.addType(a)},_order:[],enable:{},addType:function(a){this._order.push(a),this.enable[a]=!0,this.current||(this.current=a)},TypeList:function(a){for(var b=0;b<Candle._order.length;b++)this[Candle._order[b]]=Candle._order[b]===a},current:\"\",select:function(a){return!!this.enable[a]&&(this.current=a,!0)},ME:null,initME:function(){var a=_doc.createElement(\"div\");a.style.display=\"inline\",a.style.position=\"absolute\",a.style.top=\"0px\",a.style.left=\"-9000px\",a.innerHTML=\"\",_doc.body.appendChild(a),void 0!==a.offsetHeight?this.ME=a:_doc.body.removeChild(a)},getoffsetHeight:function(a,b){var c;if(b.match(/(.+\\s)?([0-9]+)px (.+)$/))c=+RegExp.$2;else if(this.ME){var d=this.ME;d.style.font=b,d.style.lineHeight=\"100%\",d.innerHTML=a,c=d.offsetHeight}return c},color:_color,parse:function(a){if(!_color[a])if(\"rgb(\"===a.substr(0,4)){var b=a.match(/\\d+/g);_color[a]=[\"#\",_hex[b[0]],_hex[b[1]],_hex[b[2]]].join(\"\")}else _color[a]=a;return _color[a]},getRectSize:function(a){return{width:a.offsetWidth||a.clientWidth||0,height:a.offsetHeight||a.clientHeight||0}},_counter:-1,getcanvasid:function(){return this._counter++,\"_candle_\"+this._counter},start:function(a,b,c){this.ME||\"undefined\"==typeof window||this.initME();var d;if(a.getContext)d=a.getContext(\"2d\");else{var e=b;if(this.enable[e]||(e=this.current),!e||!this.enable[e])throw\"No canvas environment is installed\";d=new this.wrapper[e](a)}c&&c(d)}};\"object\"==typeof module&&\"object\"==typeof exports?module.exports=Candle:this.Candle=Candle,function(){function a(){if(this.parentNode){var a=this.parentNode._children,b=a.indexOf(this);return b>=0?a[b+1]:null}}function b(a){a.parentNode&&a.parentNode.removeChild(a),this._children.push(a),a.parentNode=this}function c(a){var b=this._children.indexOf(a);return b>=0&&(this._children.splice(b,1),a.parentNode=null),a}function d(a,b){a.parentNode&&a.parentNode.removeChild(a);var c=-1;b&&(c=this._children.indexOf(b)),c===-1?this.appendChild(a):this._children.splice(c,0,a)}function e(a,b){a=a.replace(/\\*/g,\"[^/]+\"),a=a.replace(/([\\w#]+|\\*)/g,\"[^/]*$1[^/]*\"),a=a.replace(/\\s+/g,\"/([^/]+/)?\"),a=new RegExp(a+\"[^/]*$\");for(var c=this.firstChild?[this.firstChild]:[],d=[];c.length>0;){var e=c.pop();if(h(e,this).match(a)&&(d.push(e),b))break;e.nextSibling&&c.push(e.nextSibling),e.childNodes.length>0&&c.push(e.firstChild)}return d}function f(a){return e.call(this,a,!1)}function g(a){return e.call(this,a,!0)[0]||null}function h(a,b){for(var c=\"\";a&&a!==b;){var d=\"\";a.createElement||(d=a.tagName+(a._attr.id?\"#\"+a._attr.id:\"\")),c=d+(c?\"/\"+c:\"\"),a=a.parentNode}return c}function i(){return this._children.reduce(function(a,b,c,d){return a+b.outerHTML},\"\")}function j(){var a=this.tagName,b=\"\",c=\"\";for(var d in this._attr)b+=\" \"+d+'=\"'+this._attr[d]+'\"';for(var e in this.style)c+=e+\":\"+this.style[e]+\";\";return c&&(b+=' style=\"'+c+'\"'),0===this._children.length?\"<\"+a+b+\"/>\":\"<\"+a+b+\">\"+this.innerHTML+\"</\"+a+\">\"}function k(a,b){for(;;){var c=b.match(/^\\s*([^:]+?):([^;]+?);?/);if(!c)break;a.style[c[1]]=c[2],b=RegExp[\"$'\"]}}function l(a,b){for(;;){var c=b.match(/^\\s*([\\w\\-\\:]+)(\\=)?(?:['\"](.+?)['\"]|([^\\s]+))?\\s*/);if(!c)break;var d=c[1],e=c[3]||c[4]||\"\";b=RegExp[\"$'\"],d&&(\"=\"===c[2]?\"style\"!==d?a.setAttribute(d,e):a.style=k(a,e):a.setAttribute(d,!0))}}function m(a,b){var c=[a];return b.split(/(<.+?>)/g).forEach(function(a){var b=c[c.length-1],d=null;if(!a.match(/^<\\?xml/))if(a.match(/^<\\w/)){var e=a.match(/<(\\w+)\\s*(.*)\\/?>/);d=new n(e[1]),l(d,e[2]),b.appendChild(d),a.match(/\\/>$/)||c.push(d)}else if(a.match(/^<\\//))c.pop();else{if(a.match(/^[\\s\\t\\r\\n]*$/))return;b.appendChild(new o(a))}}),a}var n=function(a){this.tagName=a,this._attr={},this.style={},this._children=[]};n.prototype={tagName:\"\",style:null,_attr:null,_children:null,parentNode:null,nodeType:1,get nodeName(){return this.tagName},get firstChild(){return this._children[0]},get lastChild(){return this._children[this._children.length-1]},get childNodes(){return this._children},get nextSibling(){return a.call(this)},appendChild:b,removeChild:c,insertBefore:d,setAttribute:function(a,b){this._attr[a]=b},setAttributeNS:function(a,b,c){this._attr[b]=c},getAttribute:function(a){return a in this._attr?this._attr[a]:null},getAttributeNS:function(a,b){return b in this._attr?this._attr[b]:null},removeAttribute:function(a){delete this._attr[a]},get id(){return this._attr.id||\"\"},get innerHTML(){return i.call(this)},get outerHTML(){return j.call(this)},get textContent(){return this.innerHTML.replace(/<.+?>/g,\"\")},set textContent(a){this._children.forEach(function(a){this.removeChild(a)}.bind(this)),this.appendChild(new o(a))},querySelector:g,querySelectorAll:f};var o=function(a){this.data=a};o.prototype={_attr:{},parentNode:null,nodeType:3,nodeName:\"#text\",data:\"\",firstChild:null,chilsNodes:[],get nextSibling(){return a.call(this)},get outerHTML(){return this.data}};var p=Candle.MockDocument=function(){this._children=[]};p.prototype={_children:null,nodeType:9,nodeName:\"#document\",createElement:function(a){return new n(a)},createElementNS:function(a,b){return new n(b)},createTextNode:function(a){return new o(a)},get firstChild(){return this._children[0]},get lastChild(){return this._children[this._children.length-1]},get childNodes(){return this._children},appendChild:b,removeChild:c,insertBefore:d,get innerHTML(){return i.call(this)},get outerHTML(){return i.call(this)},querySelector:g,querySelectorAll:f,getElementById:function(a){return this.querySelector(\"#\"+a)}};var q=Candle.MockXMLSerializer=function(){};q.prototype.serializeToString=function(a){return a.outerHTML};var r=Candle.MockDOMParser=function(){};r.prototype.parseFromString=function(a,b){return m(new p,a)},_doc||(_doc=new p),Candle.document=_doc,Candle.XMLSerializer=q,Candle.DOMParser=r}(),Candle.wrapperbase={initialize:function(a){this.fillStyle=\"black\",this.strokeStyle=\"black\",this.lineWidth=1,this.font=\"14px system\",this.textAlign=\"center\",this.textBaseline=\"middle\",this.canvas=a,this.canvasid=Candle.getcanvasid(),this.child=null,this.enableTextLengthWA=!1,this.initElement(),this.initFunction(),this.initLayer();var b=this;this.canvas.getContext=function(a){return b}},rectcenter:function(a,b,c,d){this.rect(a-c,b-d,2*c,2*d)},fillRectCenter:function(a,b,c,d){this.fillRect(a-c,b-d,2*c,2*d)},strokeRectCenter:function(a,b,c,d){this.strokeRect(a-c,b-d,2*c,2*d)},shapeRectCenter:function(a,b,c,d){this.shapeRect(a-c,b-d,2*c,2*d)},vhide:function(){}},function(){function a(a){return _doc.createElementNS(d,a)}function b(){var a=\"undefined\"!=typeof navigator?navigator.userAgent||\"\":\"\";c=a.match(/Chrome/)?{\"candle-top\":-.72,top:-.95,hanging:-.72,middle:-.35,alphabetic:0,bottom:.25}:a.match(/AppleWebKit/)?{\"candle-top\":-.7,top:-.9,hanging:-.9,middle:-.35,alphabetic:0,bottom:.25}:a.match(/Trident/)?{\"candle-top\":-.74,top:-1.02,hanging:-1.02,middle:-.32,alphabetic:0,bottom:.45}:a.match(/Win/)?{\"candle-top\":-.7,top:-.85,hanging:-.85,middle:-.34,alphabetic:0,bottom:.15}:{\"candle-top\":-.76,top:-.9,hanging:-.9,middle:-.38,alphabetic:0,bottom:.08}}if(void 0!==_doc&&_doc.createElementNS&&(\"object\"!=typeof window||!window.opera)){var c,d=Candle.SVGNS=\"http://www.w3.org/2000/svg\",e=Candle.XLINKNS=\"http://www.w3.org/1999/xlink\",f=function(a){return a.match(/Trident\\//)||a.match(/Safari\\//)&&a.match(/Edge\\//)}(Candle.env.browser&&navigator.userAgent||\"\"),g={left:\"start\",center:\"middle\",right:\"end\"};Candle.addWrapper(\"svg\",{initialize:function(a){this.use=new Candle.TypeList(\"svg\"),c||b(),this.vid=\"\",this.elements={},this._textcache={},this.target=null,this.layers={},this.cpath=[],this.lastpath=\"\",this.freezepath=!1,Candle.wrapperbase.initialize.call(this,a),this.enableTextLengthWA=f},initElement:function(){Candle.env.browser&&(this.canvas.style.overflow=\"hidden\");var a=Candle.getRectSize(this.canvas),b=this.child=_doc.createElementNS(d,\"svg\");b.setAttribute(\"xmlns\",d),b.setAttribute(\"xmlns:xlink\",e),b.setAttribute(\"font-size\",\"10px\"),b.setAttribute(\"font-family\",\"sans-serif\"),b.setAttribute(\"width\",a.width),b.setAttribute(\"height\",a.height),b.setAttribute(\"viewBox\",[0,0,a.width,a.height].join(\" \")),this.canvas.appendChild&&this.canvas.appendChild(b)},initFunction:function(){function a(a){return Candle.env.browser?window.btoa(a):Buffer.isBuffer(a)?a.toString(\"base64\"):new Buffer(a.toString(),\"binary\").toString(\"base64\")}function b(a){return(a.outerHTML||(new Candle.XMLSerializer).serializeToString(a)).replace(/^<\\?xml.+?\\?>[\\r\\n]*/,\"\")}var c='<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n',d=this.child;this.canvas.toDataURL=function(c,e){return\"data:image/svg+xml;base64,\"+a(b(d))},this.canvas.toBlob=function(a,e,f){a(new Blob([c+b(d)],{type:\"image/svg+xml\"}))},this.canvas.toBuffer=function(a,e){return c+b(d)}},initLayer:function(){this.setLayer();var a=Candle.getRectSize(this.canvas);this.rect(0,0,a.width,a.height),this.addVectorElement(!1,!1)},clear:function(){for(var a=this.child,b=a.firstChild;b;)a.removeChild(b),b=a.firstChild;this.vid=\"\",this.elements={},this.layers={},this.target=this.child,this.setLayer(),this._textcache={}},setLayer:function(b,c){if(c=c||{},this.vid=\"\",b){var d=this.layers[b];d||(d=this.layers[b]=a(\"g\"),this.child.appendChild(d)),this.target=d}else this.target=this.child;c.rendering&&this.setRendering(c.rendering),this.freezepath=!!c&&c.freeze},setRendering:function(a){this.target.setAttribute(\"shape-rendering\",a)},changeSize:function(a,b){Candle.env.browser&&(this.canvas.style.width=a+\"px\",this.canvas.style.height=b+\"px\");var c=this.child;c.setAttribute(\"width\",a),c.setAttribute(\"height\",b);var d=c.getAttribute(\"viewBox\").split(/ /);c.setAttribute(\"viewBox\",[d[0],d[1],a,b].join(\" \"))},translate:function(a,b){var c=this.child.getAttribute(\"viewBox\").split(/ /);c[0]=-a,c[1]=-b,this.child.setAttribute(\"viewBox\",c.join(\" \"))},beginPath:function(){this.cpath=[],this.lastpath=\"\"},closePath:function(){this.cpath.push(\"z\"),this.lastpath=\"z\"},moveTo:function(a,b){this.cpath.push(\"M\",a,b),this.lastpath=\"M\"},lineTo:function(a,b){\"L\"!==this.lastpath&&this.cpath.push(\"L\"),this.cpath.push(a,b),this.lastpath=\"L\"},rect:function(a,b,c,d){this.cpath.push(\"M\",a,b,\"L\",a+c,b,a+c,b+d,a,b+d,\"z\"),this.lastpath=\"z\"},arc:function(a,b,c,d,e,f){var g,h,i,j;e-d>=_2PI?(g=a+c,h=b,i=a+c,j=b):(g=a+c*Math.cos(d),h=b+c*Math.sin(d),i=a+c*Math.cos(e),j=b+c*Math.sin(e)),e-d>=_2PI&&(h+=.125);var k=d>e!=Math.abs(e-d)>Math.PI,l=f^k?1:0,m=0===l^k?1:0;this.cpath.push(\"M\",g,h,\"A\",c,c,0,l,m,i,j),this.lastpath=\"A\"},fill:function(){this.addVectorElement(!0,!1)},stroke:function(){this.addVectorElement(!1,!0)},shape:function(){this.addVectorElement(!0,!0)},fillRect:function(a,b,c,d){var e=this.cpath;this.cpath=[],this.rect(a,b,c,d),this.addVectorElement(!0,!1),this.cpath=e},strokeRect:function(a,b,c,d){var e=this.cpath;this.cpath=[],this.rect(a,b,c,d),this.addVectorElement(!1,!0),this.cpath=e},shapeRect:function(a,b,c,d){var e=this.cpath;this.cpath=[],this.rect(a,b,c,d),this.addVectorElement(!0,!0),this.cpath=e},setLinePath:function(){for(var a=arguments,b=a.length,c=b-(1|b?1:2),d=[],e=0;e<c;e+=2)d[e>>1]=[a[e],a[e+1]];this.beginPath(),this.setLinePath_com.call(this,d),a[b-1]&&this.cpath.push(\"z\")},setOffsetLinePath:function(){for(var a=arguments,b=a.length,c=b-(1|b?1:2),d=[],e=0;e<c-2;e+=2)d[e>>1]=[a[e+2]+a[0],a[e+3]+a[1]];this.beginPath(),this.setLinePath_com.call(this,d),a[b-1]&&this.cpath.push(\"z\")},setLinePath_com:function(a){for(var b=0,c=a.length;b<c;b++)this.cpath.push(0===b?\"M\":\"L\"),this.cpath.push(a[b][0],a[b][1])},strokeLine:function(a,b,c,d){var e=this.cpath;this.cpath=[\"M\",a,b,\"L\",c,d],this.addVectorElement(!1,!0),this.cpath=e},strokeDashedLine:function(a,b,c,d,e){var f=this.cpath;this.cpath=[\"M\",a,b,\"L\",c,d],this.addVectorElement(!1,!0).setAttribute(\"stroke-dasharray\",e.join(\" \")),this.cpath=f},strokeCross:function(a,b,c){var d=this.cpath;this.cpath=[\"M\",a-c,b-c,\"L\",a+c,b+c,\"M\",a-c,b+c,\"L\",a+c,b-c],this.addVectorElement(!1,!0),this.cpath=d},fillCircle:function(a,b,c){var d=this.cpath;this.cpath=[],this.arc(a,b,c,0,_2PI,!1),this.cpath.push(\"z\"),this.addVectorElement(!0,!1),this.cpath=d},strokeCircle:function(a,b,c){var d=this.cpath;this.cpath=[],this.arc(a,b,c,0,_2PI,!1),this.cpath.push(\"z\"),this.addVectorElement(!1,!0),this.cpath=d},shapeCircle:function(a,b,c){var d=this.cpath;this.cpath=[],this.arc(a,b,c,0,_2PI,!1),this.cpath.push(\"z\"),this.addVectorElement(!0,!0),this.cpath=d},getDefsElement:function(){var a=this.child.querySelector(\"defs\");return a||(a=_doc.createElementNS(d,\"defs\"),this.child.insertBefore(a,this.child.firstChild||null)),a},getImageElement:function(b){for(var c=this.getDefsElement(),d=null,f=c.querySelectorAll(\"image\"),g=0;g<f.length;g++)if(f[g].getAttributeNS(e,\"href\")===b.src){d=f[g];break}return d||(d=a(\"image\"),d.setAttribute(\"id\",(d.ownerDocument?this.canvasid+\"_\":\"\")+\"img\"+f.length),d.setAttribute(\"width\",b.width),d.setAttribute(\"height\",b.height),d.setAttributeNS(e,\"xlink:href\",b.src),c.appendChild(d)),d},getImageSymbol:function(a,b,c,f,g){for(var h=this.getDefsElement(),i=[b,c,f,g].join(\" \"),j=null,k=h.querySelectorAll(\"symbol\"),l=0;l<k.length;l++)if(k[l].getAttribute(\"viewBox\")===i){j=k[l];break}if(!j){j=_doc.createElementNS(d,\"symbol\"),j.setAttribute(\"id\",(j.ownerDocument?this.canvasid+\"_\":\"\")+\"symimg\"+k.length),j.setAttribute(\"viewBox\",i);var m=_doc.createElementNS(d,\"use\");m.setAttributeNS(e,\"xlink:href\",\"#\"+this.getImageElement(a).getAttribute(\"id\")),j.appendChild(m),h.appendChild(j)}return j},fillText:function(a,b,c,d){var e=this.vid?this.elements[this.vid]:null;if(a&&this.fillStyle&&\"none\"!==this.fillStyle){var f=this.fillText_main(e,a,b,c,d||\"\");!e&&this.vid&&(this.elements[this.vid]=f)}else e&&this.hide(e);this.vid=\"\"},fillText_main:function(b,d,e,h,i){var j=!b,k=this.vid?this._textcache[this.vid]||{}:{};if(j?b=a(\"text\"):this.show(b),b.getAttribute(\"fill\")!==this.fillStyle&&b.setAttribute(\"fill\",this.fillStyle),k.x!==e||k.y!==h||k.ml!==i||k.ta!==this.textAlign||k.tb!==this.textBaseline||k.font!==this.font){var l=h-Candle.getoffsetHeight(d,this.font)*c[this.textBaseline.toLowerCase()],m=g[this.textAlign.toLowerCase()];b.getAttribute(\"x\")!==e&&b.setAttribute(\"x\",e),b.getAttribute(\"y\")!==l&&b.setAttribute(\"y\",l),b.getAttribute(\"text-anchor\")!==m&&b.setAttribute(\"text-anchor\",m),(b.getAttribute(\"textLength\")||\"\")!==i&&(i?(b.setAttribute(\"textLength\",i),b.setAttribute(\"lengthAdjust\",\"spacingAndGlyphs\")):(b.removeAttribute(\"textLength\"),b.removeAttribute(\"lengthAdjust\"))),k.x=e,k.y=h,k.ml=i,k.ta=this.textAlign,k.tb=this.textBaseline}if(k.font!==this.font){if(this.font.match(/(.+\\s)?([0-9]+)px (.+)$/)){var n=RegExp.$1,o=RegExp.$2,p=RegExp.$3;b.setAttribute(\"font-size\",o),p.match(/^sans\\-serif$/i)?b.removeAttribute(\"font-family\"):b.setAttribute(\"font-family\",p),n.match(/(italic|oblique)/)?b.setAttribute(\"font-style\",RegExp.$1):b.removeAttribute(\"font-style\"),n.match(/(bold|bolder|lighter|[1-9]00)/)?b.setAttribute(\"font-weight\",RegExp.$1):b.removeAttribute(\"font-weight\")}else b.setAttribute(\"font\",this.font);k.font=this.font}if(b.textContent!==d&&(b.textContent=d),this.vid&&(this._textcache[this.vid]=k),j&&this.target.appendChild(b),f&&this.enableTextLengthWA&&(\"center\"===k.ta||\"right\"===k.ta)&&i){b.removeAttribute(\"textLength\");var q=b.getBoundingClientRect();b.setAttribute(\"x\",k.x+(q.width-i)/(\"center\"===k.ta?2:1)),b.setAttribute(\"textLength\",i)}return b},drawImage:function(a,b,c,d,e,f,g,h,i){var j=this.vid?this.elements[this.vid]:null;if(a){void 0===d&&(d=a.width,e=a.height),void 0===f&&(f=b,b=0,g=c,c=0,h=d,i=e);var k=this.drawImage_main(j,a,b,c,d,e,f,g,h,i);!j&&this.vid&&(this.elements[this.vid]=k)}else j&&this.hide(j);this.vid=\"\"},drawImage_main:function(b,c,d,f,g,h,i,j,k,l){var m=!b;m?b=a(\"use\"):this.show(b);var n=this.getImageSymbol(c,d,f,g,h).getAttribute(\"id\");return b.getAttribute(\"x\")!==i&&b.setAttribute(\"x\",i),b.getAttribute(\"y\")!==j&&b.setAttribute(\"y\",j),b.getAttribute(\"width\")!==k&&b.setAttribute(\"width\",k),b.getAttribute(\"height\")!==l&&b.setAttribute(\"height\",l),b.getAttributeNS(e,\"xlink:href\")!==\"#\"+n&&b.setAttributeNS(e,\"xlink:href\",\"#\"+n),m&&this.target.appendChild(b),b},addVectorElement:function(a,b){a=a&&!!this.fillStyle&&\"none\"!==this.fillStyle,b=b&&!!this.strokeStyle&&\"none\"!==this.strokeStyle;var c=this.vid?this.elements[this.vid]:null,d=null;return a||b?(d=this.addVectorElement_main(c,a,b),!c&&this.vid&&(this.elements[this.vid]=d)):c&&this.hide(c),this.vid=\"\",d},addVectorElement_main:function(b,c,d){var e=!b;if(e?(b=a(\"path\"),b.setAttribute(\"fill\",\"none\"),b.setAttribute(\"stroke\",\"none\")):this.show(b),!this.freezepath||e){var f=this.cpath.join(\" \"),g=d?this.lineWidth:null;b.getAttribute(\"d\")!==f&&b.setAttribute(\"d\",f),b.getAttribute(\"stroke-width\")!==g&&b.setAttribute(\"stroke-width\",g)}var h=c?this.fillStyle:\"none\",i=d?this.strokeStyle:\"none\";return b.getAttribute(\"fill\")!==h&&b.setAttribute(\"fill\",h),b.getAttribute(\"stroke\")!==i&&b.setAttribute(\"stroke\",i),e&&this.target.appendChild(b),b},vhide:function(a){var b=this.elements[this.vid];b&&this.hide(b)},show:function(a){a.removeAttribute(\"display\")},hide:function(a){a.setAttribute(\"display\",\"none\")}})}}(),function(){function a(){var a=\"undefined\"!=typeof navigator?navigator.userAgent||\"\":\"\";b=0,b=a.match(/Chrome/)?-.72:a.match(/AppleWebKit/)?-.7:a.match(/Trident/)?-.74:a.match(/Win/)?-.7:-.76}if(Candle.env.browser){if(!function(){var a=_doc.createElement(\"canvas\");return!!a.getContext&&(!a.probablySupportsContext||a.probablySupportsContext(\"2d\"))}())return}else try{Candle.Canvas=require(\"canvas\")}catch(a){return}var b;Candle.addWrapper(\"canvas\",{initialize:function(c){this.context=null,this.use=new Candle.TypeList(\"canvas\"),this.currentLayerId=\"_empty\",this.isedgearray={_empty:!1},this.isedge=!1,b||a(),this.x0=0,this.y0=0,Candle.wrapperbase.initialize.call(this,c)},setkey:function(a){return this},hidekey:function(a){return this},release:function(a){return this},initElement:function(){var a=this.child=Candle.env.browser?_doc.createElement(\"canvas\"):new Candle.Canvas;Candle.env.browser&&(this.canvas.style.overflow=\"hidden\");var b=Candle.getRectSize(this.canvas);a.width=b.width,a.height=b.height,Candle.env.browser&&(a.style.width=b.width+\"px\",a.style.height=b.height+\"px\",this.canvas.appendChild(a)),this.context=a.getContext(\"2d\")},initFunction:function(){function a(a){return Candle.env.browser?window.atob(a):new Buffer(RegExp.$2,\"base64\").toString(\"binary\")}var b=this.child;this.canvas.toDataURL=function(a,c){return b.toDataURL(a||void 0,c)},this.canvas.toBlob=function(c,d,e){if(\"function\"==typeof b.toBlob)b.toBlob(c,d,e);else{b.toDataURL(d||void 0,e).match(/data:(.*);base64,(.*)/);for(var f=a(RegExp.$2),g=f.length,h=new Uint8Array(g),i=0;i<g;i++)h[i]=f.charCodeAt(i);c(new Blob([h.buffer],{type:RegExp.$1}))}},this.canvas.toBuffer=function(c,d){var e=b.toDataURL(c||void 0,d).replace(/^data:image\\/\\w+?;base64,/,\"\");if(Candle.env.node)return new Buffer(e,\"base64\");var f;if(\"undefined\"!=typeof Uint8Array){var g=a(e);f=new Uint8Array(g.length);for(var h=0;h<g.length;h++)f[h]=g.charCodeAt(h)}else f=a(e);return f}},initLayer:function(){this.setLayer()},clear:function(){if(this.setProperties(!0,!0),this.context.setTransform(1,0,0,1,0,0),this.context.translate(this.x0,this.y0),Candle.env.browser){var a=Candle.getRectSize(this.canvas);this.context.clearRect(0,0,a.width,a.height)}},setLayer:function(a,b){var c=this.currentLayerId=a?a:\"_empty\";this.isedge=this.isedgearray[void 0!==this.isedgearray[c]?c:\"_empty\"],this.setEdgeStyle(),b=b||{},b.rendering&&this.setRendering(b.rendering)},setEdgeStyle:function(){if(Candle.env.browser){var a=this.canvas.style;\"imageRendering\"in a&&(a.imageRendering=\"\",this.isedge&&(a.imageRendering=\"pixelated\",a.imageRendering||(a.imageRendering=\"-webkit-optimize-contrast\"),a.imageRendering||(a.imageRendering=\"-moz-crisp-edges\"),a.imageRendering||(a.imageRendering=\"-o-crisp-edges\")))}},setRendering:function(a){this.isedge=this.isedgearray[this.currentLayerId]=\"crispEdges\"===a,this.setEdgeStyle()},changeSize:function(a,b){if(Candle.env.browser){var c=this.canvas;c.style.width=a+\"px\",c.style.height=b+\"px\"}var d=this.child;if(Candle.env.browser){var e=parseInt(d.style.left),f=parseInt(d.style.top);a+=e<0?-e:0,b+=f<0?-f:0,d.style.width=a+\"px\",d.style.height=b+\"px\"}d.width=a,d.height=b},translate:function(a,b){this.x0=a,this.y0=b,this.context.translate(a,b)},setProperties:function(a,b){a=a&&!!this.fillStyle&&\"none\"!==this.fillStyle,b=b&&!!this.strokeStyle&&\"none\"!==this.strokeStyle;var c=this.context;return a&&(c.fillStyle=this.fillStyle),b&&(c.strokeStyle=this.strokeStyle),c.lineWidth=this.lineWidth,c.font=this.font,c.textAlign=this.textAlign,c.textBaseline=this.textBaseline,a||b},beginPath:function(){this.context.beginPath()},closePath:function(){this.context.closePath()},moveTo:function(a,b){this.context.moveTo(a,b)},lineTo:function(a,b){this.context.lineTo(a,b)},rect:function(a,b,c,d){this.context.rect(a,b,c,d)},arc:function(a,b,c,d,e,f){this.context.arc(a,b,c,d,e,f)},fill:function(){this.setProperties(!0,!1)&&this.context.fill()},stroke:function(){this.setProperties(!1,!0)&&this.context.stroke()},shape:function(){if(this.setProperties(!0,!0)){var a=this.context;this.fillStyle&&\"none\"!==this.fillStyle&&a.fill(),this.strokeStyle&&\"none\"!==this.strokeStyle&&a.stroke()}},fillRect:function(a,b,c,d){this.setProperties(!0,!1)&&this.context.fillRect(a,b,c,d)},strokeRect:function(a,b,c,d){this.setProperties(!1,!0)&&this.context.strokeRect(a,b,c,d)},shapeRect:function(a,b,c,d){if(this.setProperties(!0,!0)){var e=this.context;this.fillStyle&&\"none\"!==this.fillStyle&&e.fillRect(a,b,c,d),this.strokeStyle&&\"none\"!==this.strokeStyle&&e.strokeRect(a,b,c,d)}},setLinePath:function(){for(var a=arguments,b=a.length,c=b-(1|b?1:2),d=[],e=0;e<c;e+=2)d[e>>1]=[a[e],a[e+1]];this.context.beginPath(),this.setLinePath_com.call(this,d),a[b-1]&&this.context.closePath()},setOffsetLinePath:function(){for(var a=arguments,b=a.length,c=b-(1|b?1:2)-2,d=[],e=0;e<c;e+=2)d[e>>1]=[a[e+2]+a[0],a[e+3]+a[1]];this.context.beginPath(),this.setLinePath_com.call(this,d),a[b-1]&&this.context.closePath()},setLinePath_com:function(a){for(var b=0,c=a.length;b<c;b++){var d=a[b];0===b?this.context.moveTo(d[0],d[1]):this.context.lineTo(d[0],d[1])}},strokeLine:function(a,b,c,d){if(this.setProperties(!1,!0)){var e=this.context;e.beginPath(),e.moveTo(a,b),e.lineTo(c,d),e.stroke()}},strokeDashedLine:function(a,b,c,d,e){this.strokeDashedLine=this.context.setLineDash?function(a,b,c,d,e){var f=this.context;this.setProperties(!1,!0)&&(f.beginPath(),f.moveTo(a,b),f.lineTo(c,d),f.setLineDash(e),f.stroke(),f.setLineDash([]))}:function(a,b,c,d,e){e.length%2===1&&(e=e.concat(e));var f=Math.sqrt((c-a)*(c-a)+(d-b)*(d-b)),g=0,h=0,i=null,j=null;if(a!==c&&(i=(d-b)/(c-a),j=i*i+1),this.setProperties(!1,!0)){var k=this.context;for(k.beginPath(),k.moveTo(a,b);g<f;){var l,m;if(null!==i){var n=Math.sqrt(g*g/j);l=a+n,m=b+i*n}else l=a,m=b+g;0===(1&h)?k.moveTo(l,m):k.lineTo(l,m),g+=e[h],h++,h>=e.length&&(h=0)}k.stroke()}},this.strokeDashedLine(a,b,c,d,e)},strokeCross:function(a,b,c){if(this.setProperties(!1,!0)){var d=this.context;d.beginPath(),d.moveTo(a-c,b-c),d.lineTo(a+c,b+c),d.moveTo(a-c,b+c),d.lineTo(a+c,b-c),d.stroke()}},fillCircle:function(a,b,c){if(this.setProperties(!0,!1)){var d=this.context;d.beginPath(),d.arc(a,b,c,0,_2PI,!1),d.fill()}},strokeCircle:function(a,b,c){if(this.setProperties(!1,!0)){var d=this.context;d.beginPath(),d.arc(a,b,c,0,_2PI,!1),d.stroke()}},shapeCircle:function(a,b,c){if(this.setProperties(!0,!0)){var d=this.context;d.beginPath(),d.arc(a,b,c,0,_2PI,!1),this.fillStyle&&\"none\"!==this.fillStyle&&d.fill(),this.strokeStyle&&\"none\"!==this.strokeStyle&&d.stroke()}},fillText:function(a,c,d,e){a&&this.setProperties(!0,!1)&&(\"candle-top\"===this.textBaseline&&(d-=Candle.getoffsetHeight(a,this.font)*b,this.context.textBaseline=\"alphabetic\"),e?this.context.fillText(a,c,d,e):this.context.fillText(a,c,d))},drawImage:function(){arguments[0]&&this.context.drawImage.apply(this.context,arguments)}})}();","// candle-outro.js\r\n\r\n})(module,exports);\r\n\r\npzpr.Candle = module.exports;\r\n\r\n})();\r\n\r\n//---------------------------------------------------------------------------\r\n// node.js環境向けの対策\r\n//---------------------------------------------------------------------------\r\n    document      = this.document      || pzpr.Candle.document;\r\nvar DOMParser     = this.DOMParser     || pzpr.Candle.DOMParser;\r\nvar XMLSerializer = this.XMLSerializer || pzpr.Candle.XMLSerializer;\r\n","// env.js v3.4.0\r\n\r\n/**************/\r\n/* 環境の取得 */\r\n/**************/\r\npzpr.env = (function() {\r\n\tvar isbrowser = pzpr.Candle.env.browser;\r\n\tvar UA = isbrowser ? navigator.userAgent : \"\";\r\n\r\n\tvar ios = UA.indexOf(\"like Mac OS X\") > -1;\r\n\tvar android = UA.indexOf(\"Android\") > -1;\r\n\tvar os = {\r\n\t\tiOS: ios,\r\n\t\tAndroid: android,\r\n\t\tmobile: ios || android\r\n\t};\r\n\r\n\tvar FireFoxVersion = (function() {\r\n\t\tif (UA.match(/Firefox\\/(\\w+(\\.\\w+)?)/)) {\r\n\t\t\tvar ver = RegExp.$1;\r\n\t\t\tif (UA.match(/rv\\:(\\d+(\\.\\d+)?)/)) {\r\n\t\t\t\tif (RegExp.$1 + 0.0 <= 2.1) {\r\n\t\t\t\t\treturn RegExp.$1 + 0.0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn ver;\r\n\t\t}\r\n\t\treturn null;\r\n\t})();\r\n\tvar ChromeVersion = (function() {\r\n\t\tif (UA.match(/Safari\\/([\\w\\.]+)/) && UA.match(/Chrome\\/(\\w+(\\.\\w+)?)/)) {\r\n\t\t\treturn RegExp.$1;\r\n\t\t}\r\n\t\treturn null;\r\n\t})();\r\n\tvar SafariVersion = (function() {\r\n\t\tif (\r\n\t\t\tChromeVersion === null &&\r\n\t\t\tUA.match(/Safari\\/([\\w\\.]+)/) &&\r\n\t\t\tUA.match(/Version\\/(\\w+(\\.\\w+)?)/)\r\n\t\t) {\r\n\t\t\treturn RegExp.$1;\r\n\t\t}\r\n\t\treturn null;\r\n\t})();\r\n\tvar bz = {\r\n\t\tAndroidBrowser: os.Android && SafariVersion,\r\n\t\tPresto: typeof window === \"object\" && !!window.opera\r\n\t};\r\n\r\n\tvar api = {\r\n\t\ttouchevent: isbrowser && (!!window.ontouchstart || !!document.createTouch),\r\n\t\tpointerevent: isbrowser && !!window.PointerEvent,\r\n\t\tmspointerevent: isbrowser && !!window.MSPointerEvent,\r\n\t\tmaxWidth:\r\n\t\t\tisbrowser &&\r\n\t\t\t(ChromeVersion || 1000) >= 18 &&\r\n\t\t\t(SafariVersion || 1000) >= 6,\r\n\t\tsvgTextLength: !isbrowser || (FireFoxVersion || 1000) >= 25,\r\n\t\tanchor_download:\r\n\t\t\tisbrowser && document.createElement(\"a\").download !== void 0\r\n\t};\r\n\r\n\treturn {\r\n\t\tbz: bz,\r\n\t\tOS: os,\r\n\t\tAPI: api,\r\n\t\tbrowser: isbrowser,\r\n\t\tnode: pzpr.Candle.env.node\r\n\t};\r\n})();\r\n\r\npzpr.lang = (function() {\r\n\tvar userlang = pzpr.env.node\r\n\t\t? process.env.LANG\r\n\t\t: navigator.browserLanguage || navigator.language || navigator.userLanguage;\r\n\treturn !userlang || userlang.substr(0, 2) === \"ja\" ? \"ja\" : \"en\";\r\n})();\r\n","// event.js v3.4.1\r\n\r\n(function() {\r\n\t//---------------------------------------------------------------\r\n\t// 起動時関連関数\r\n\t//---------------------------------------------------------------\r\n\tvar preinit = true;\r\n\tvar loadfun = [];\r\n\tpzpr.on = function(eventtype, func) {\r\n\t\tif (eventtype === \"load\") {\r\n\t\t\tif (preinit) {\r\n\t\t\t\tloadfun.push(func);\r\n\t\t\t} else {\r\n\t\t\t\tfunc();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t//----------------------------------------------------------------------\r\n\t// 起動時処理実行処理\r\n\t//----------------------------------------------------------------------\r\n\tfunction postload(e) {\r\n\t\tif (preinit) {\r\n\t\t\tpreinit = false;\r\n\t\t\tfor (var i = 0; i < loadfun.length; i++) {\r\n\t\t\t\tloadfun[i]();\r\n\t\t\t}\r\n\t\t\tloadfun = [];\r\n\t\t}\r\n\t}\r\n\r\n\tif (!pzpr.env.browser) {\r\n\t} else if (document.readyState === \"complete\") {\r\n\t\tsetTimeout(postload, 10);\r\n\t} else {\r\n\t\tdocument.addEventListener(\"DOMContentLoaded\", postload, false);\r\n\t\twindow.addEventListener(\"load\", postload, false);\r\n\t}\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// addKeyEvents()  キーボード入力発生時に指定されたパズルへ通知する準備を行う\r\n\t// exec????()      各パズルのキー入力へ分岐する\r\n\t//---------------------------------------------------------------------------\r\n\tvar keytarget = null;\r\n\tfunction execKeyDown(e) {\r\n\t\tif (!!keytarget && !!keytarget.key) {\r\n\t\t\tkeytarget.key.e_keydown(e);\r\n\t\t}\r\n\t}\r\n\tfunction execKeyUp(e) {\r\n\t\tif (!!keytarget && !!keytarget.key) {\r\n\t\t\tkeytarget.key.e_keyup(e);\r\n\t\t}\r\n\t}\r\n\tpzpr.on(\"load\", function addKeyEvents() {\r\n\t\t// キー入力イベントの設定\r\n\t\tpzpr.util.addEvent(document, \"keydown\", pzpr, execKeyDown);\r\n\t\tpzpr.util.addEvent(document, \"keyup\", pzpr, execKeyUp);\r\n\t});\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// connectKeyEvents()  キーボード入力に関するイベントを指定したパズルへ通知する準備を行う\r\n\t//---------------------------------------------------------------------------\r\n\tpzpr.connectKeyEvents = function(puzzle) {\r\n\t\tkeytarget = puzzle;\r\n\t};\r\n})();\r\n","// classmgr.js v3.6.0\r\n\r\n//---------------------------------------------------------------\r\n// クラス設定用関数など\r\n//---------------------------------------------------------------\r\npzpr.common = {}; // CoreClass保存用\r\npzpr.custom = { \"\": {} }; // パズル別クラス保存用\r\n\r\n//----------------------------------------------------------------------------\r\n// ★pzpr.classmgrオブジェクト (クラス作成関数等)\r\n//---------------------------------------------------------------------------\r\npzpr.classmgr = {\r\n\t//---------------------------------------------------------------\r\n\t// 共通クラス・パズル別クラスに継承させる親クラスを生成する\r\n\t//---------------------------------------------------------------\r\n\tmakeCommon: function(commonbase) {\r\n\t\tthis.createCommon(commonbase);\r\n\t},\r\n\tcreateCommon: function(commonbase) {\r\n\t\tfor (var key in commonbase) {\r\n\t\t\tvar names = this.searchName(key),\r\n\t\t\t\tNewClass = pzpr.common[names.real];\r\n\t\t\tif (!NewClass) {\r\n\t\t\t\tNewClass = this.createClass(pzpr.common[names.base]);\r\n\t\t\t\tNewClass.prototype.common = NewClass.prototype;\r\n\t\t\t\tNewClass.prototype.pid = \"\";\r\n\t\t\t}\r\n\t\t\tthis.extendPrototype(NewClass.prototype, commonbase[key]);\r\n\t\t\tpzpr.common[names.real] = pzpr.custom[\"\"][names.real] = NewClass;\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------\r\n\t// includeCustomFileでファイルを読み込んだ後の処理\r\n\t//---------------------------------------------------------------\r\n\tmakeCustom: function(pidlist, custombase) {\r\n\t\tfor (var i = 0; i < pidlist.length; i++) {\r\n\t\t\tvar pid = pidlist[i];\r\n\t\t\tpzpr.custom[pid] = this.createCustom(pid, custombase);\r\n\t\t}\r\n\t},\r\n\tgetExtension: function(pid, custombase) {\r\n\t\tvar extension = {};\r\n\t\tfor (var hashkey in custombase) {\r\n\t\t\tvar proto = custombase[hashkey],\r\n\t\t\t\tname = hashkey,\r\n\t\t\t\tpidcond = [],\r\n\t\t\t\tisexist = false;\r\n\t\t\tvar name = !hashkey.match(\"#\")\r\n\t\t\t\t? hashkey\r\n\t\t\t\t: hashkey.substr(0, hashkey.indexOf(\"#\"));\r\n\t\t\tif (name.match(\"@\")) {\r\n\t\t\t\tpidcond = name.substr(name.indexOf(\"@\") + 1).split(/,/);\r\n\t\t\t\tname = name.substr(0, name.indexOf(\"@\"));\r\n\t\t\t\tfor (var n = 0; n < pidcond.length; n++) {\r\n\t\t\t\t\tif (pidcond[n] === pid) {\r\n\t\t\t\t\t\tisexist = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!isexist) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!extension[name]) {\r\n\t\t\t\textension[name] = {};\r\n\t\t\t}\r\n\t\t\tfor (var key in proto) {\r\n\t\t\t\textension[name][key] = proto[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn extension;\r\n\t},\r\n\tcreateCustom: function(pid, custombase) {\r\n\t\tvar custom = {};\r\n\t\tvar extension = this.getExtension(pid, custombase);\r\n\r\n\t\t// 追加プロパティが指定されているクラスを作成する\r\n\t\tfor (var key in extension) {\r\n\t\t\tvar names = this.searchName(key),\r\n\t\t\t\tNewClass = custom[names.real];\r\n\t\t\tif (!NewClass) {\r\n\t\t\t\tNewClass = this.createClass(\r\n\t\t\t\t\tcustom[names.base] || pzpr.common[names.base]\r\n\t\t\t\t);\r\n\t\t\t\tNewClass.prototype.pid = pid;\r\n\t\t\t}\r\n\t\t\tthis.extendPrototype(NewClass.prototype, extension[key]);\r\n\t\t\tcustom[names.real] = NewClass;\r\n\t\t}\r\n\r\n\t\t// 指定がなかった残りの共通クラスを作成(コピー)する\r\n\t\tfor (var classname in pzpr.common) {\r\n\t\t\tif (!custom[classname]) {\r\n\t\t\t\tcustom[classname] = this.createClass(pzpr.common[classname]);\r\n\t\t\t\tcustom[classname].prototype.pid = pid;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn custom;\r\n\t},\r\n\r\n\t//---------------------------------------------------------------\r\n\t// createCommon, createCustomから呼び出される共通処理\r\n\t//---------------------------------------------------------------\r\n\tsearchName: function(key) {\r\n\t\tkey = key.replace(/\\s+/g, \"\");\r\n\t\tvar colon = key.indexOf(\":\"),\r\n\t\t\tbasename = \"\",\r\n\t\t\trealname = key;\r\n\t\tif (colon >= 0) {\r\n\t\t\tbasename = key.substr(colon + 1);\r\n\t\t\trealname = key.substr(0, colon);\r\n\t\t}\r\n\t\treturn { base: basename || realname, real: realname };\r\n\t},\r\n\tcreateClass: function(BaseClass) {\r\n\t\tfunction NewClass() {}\r\n\t\tif (!!BaseClass) {\r\n\t\t\tthis.extendPrototype(NewClass.prototype, BaseClass.prototype);\r\n\t\t}\r\n\t\treturn NewClass;\r\n\t},\r\n\textendPrototype: function(NewProto, proto) {\r\n\t\tproto = proto || {};\r\n\t\tfor (var name in proto) {\r\n\t\t\tif (\r\n\t\t\t\tproto[name] !== null &&\r\n\t\t\t\ttypeof proto[name] === \"object\" &&\r\n\t\t\t\tproto[name].constructor === Object\r\n\t\t\t) {\r\n\t\t\t\tif (!NewProto[name]) {\r\n\t\t\t\t\tNewProto[name] = {};\r\n\t\t\t\t}\r\n\t\t\t\tthis.extendPrototype(NewProto[name], proto[name]);\r\n\t\t\t} else {\r\n\t\t\t\tNewProto[name] = proto[name];\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------\r\n\t// 単体ファイルの読み込み\r\n\t// idを取得して、ファイルを読み込み\r\n\t//---------------------------------------------------------------\r\n\tincludeCustomFile: function(pid) {\r\n\t\tvar scriptid = pzpr.variety(pid).script;\r\n\t\tif (this.includedFile[scriptid]) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.includedFile[scriptid] = true;\r\n\r\n\t\tvar customfile = pzpr.util.getpath() + \"./pzpr-variety/\" + scriptid + \".js\";\r\n\t\tif (pzpr.env.browser && !pzpr.env.node) {\r\n\t\t\tvar _script = document.createElement(\"script\");\r\n\t\t\t_script.type = \"text/javascript\";\r\n\t\t\t_script.src = customfile + \"?\" + pzpr.version;\r\n\t\t\tdocument.getElementsByTagName(\"head\")[0].appendChild(_script);\r\n\t\t} else {\r\n\t\t\tvar exporteddata = require(customfile);\r\n\t\t\tthis.makeCustom(exporteddata[0], exporteddata[1]);\r\n\t\t}\r\n\t},\r\n\tincludedFile: {},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// 新しくパズルのファイルを開く時の処理\r\n\t//---------------------------------------------------------------------------\r\n\tsetPuzzleClass: function(puzzle, newpid, callback) {\r\n\t\tif (!pzpr.variety(newpid).valid) {\r\n\t\t\tpuzzle.emit(\"fail-open\");\r\n\t\t\tthrow \"Invalid Puzzle Variety Selected\";\r\n\t\t}\r\n\r\n\t\t/* 今のパズルと別idの時 */\r\n\t\tif (puzzle.pid !== newpid) {\r\n\t\t\tif (!pzpr.custom[newpid]) {\r\n\t\t\t\tthis.includeCustomFile(newpid);\r\n\t\t\t\tif (!pzpr.custom[newpid]) {\r\n\t\t\t\t\t/* Customファイルが読み込みできるまで待つ */\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tpzpr.classmgr.setPuzzleClass(puzzle, newpid, callback);\r\n\t\t\t\t\t}, 10);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t/* 各クラスをpzpr.customから設定する */\r\n\t\t\tthis.setClasses(puzzle, newpid);\r\n\t\t}\r\n\r\n\t\tcallback();\r\n\t},\r\n\r\n\t//---------------------------------------------------------------\r\n\t// パズル種類別のクラスをパズルのクラス一覧に設定する\r\n\t//      共通クラス        (pzpr.common)\r\n\t//   -> パズル種類別クラス (pzpr.custom)\r\n\t//   -> パズルが保持するクラス (initialize()の呼び出しやthis.puzzle等がつく)\r\n\t// と、ちょっとずつ変わっている状態になります\r\n\t//---------------------------------------------------------------\r\n\tsetClasses: function(puzzle, pid) {\r\n\t\t/* 現在のクラスを消去する */\r\n\t\tpuzzle.klass = {};\r\n\r\n\t\tvar custom = pzpr.custom[pid];\r\n\t\tfor (var classname in custom) {\r\n\t\t\tvar PuzzleClass = (puzzle.klass[classname] = function() {\r\n\t\t\t\tvar args = Array.prototype.slice.apply(arguments);\r\n\t\t\t\tif (!!this.initialize) {\r\n\t\t\t\t\tthis.initialize.apply(this, args);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tvar CustomProto = custom[classname].prototype;\r\n\t\t\tfor (var name in CustomProto) {\r\n\t\t\t\tPuzzleClass.prototype[name] = CustomProto[name];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.setPrototypeRef(puzzle, \"puzzle\", puzzle);\r\n\t\tthis.setPrototypeRef(puzzle, \"klass\", puzzle.klass);\r\n\r\n\t\tpuzzle.pid = pid;\r\n\t\tpuzzle.info = pzpr.variety(pid);\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// パズルオブジェクト下に存在するクラスのprototypeへ一括でプロパティを付加する\r\n\t//---------------------------------------------------------------------------\r\n\tsetPrototypeRef: function(puzzle, name, ref) {\r\n\t\tfor (var klassname in puzzle.klass) {\r\n\t\t\tpuzzle.klass[klassname].prototype[name] = ref;\r\n\t\t}\r\n\t}\r\n};\r\n","// Variety.js v3.4.1\r\n\r\n(function() {\r\n\tvar _info = {},\r\n\t\t_list = [];\r\n\tfunction toPID(name) {\r\n\t\tif (!!_info[name]) {\r\n\t\t\treturn name;\r\n\t\t}\r\n\t\tfor (var pid in _info) {\r\n\t\t\tif (!_info[pid].alias) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tfor (var type in _info[pid].alias) {\r\n\t\t\t\tif (_info[pid].alias[type] === name) {\r\n\t\t\t\t\treturn pid;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tvar variety = (pzpr.variety = pzpr.genre = function(pid) {\r\n\t\treturn _info[toPID(pid)] || { valid: false };\r\n\t});\r\n\tvariety.extend = function(obj) {\r\n\t\tfor (var n in obj) {\r\n\t\t\tthis[n] = obj[n];\r\n\t\t}\r\n\t};\r\n\tvariety.extend({\r\n\t\tinfo: _info,\r\n\t\ttoPID: toPID,\r\n\t\texists: function(name) {\r\n\t\t\treturn variety(name).valid;\r\n\t\t},\r\n\t\teach: function(func) {\r\n\t\t\tfor (var pid in _info) {\r\n\t\t\t\tfunc(pid);\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetList: function() {\r\n\t\t\treturn _list.slice();\r\n\t\t}\r\n\t});\r\n\tdelete variety.extend;\r\n\r\n\t(function(Genre, obj) {\r\n\t\tfor (var pzprid in obj) {\r\n\t\t\t_info[pzprid] = new Genre(pzprid, obj[pzprid]);\r\n\t\t\ttry {\r\n\t\t\t\tObject.freeze(_info[pzprid]);\r\n\t\t\t\tObject.freeze(_info[pzprid].exists);\r\n\t\t\t\tObject.freeze(_info[pzprid].alias);\r\n\t\t\t} catch (e) {}\r\n\t\t}\r\n\t})(\r\n\t\t// eslint-disable-next-line no-unexpected-multiline\r\n\t\tfunction Genre(pzprid, datalist) {\r\n\t\t\tthis.valid = true;\r\n\t\t\tthis.pid = pzprid; /* パズルID */\r\n\t\t\tthis.script = !!datalist[4]\r\n\t\t\t\t? datalist[4]\r\n\t\t\t\t: pzprid; /* スクリプトファイル(クラス) */\r\n\t\t\tthis.ja = datalist[2]; /* 日本語パズル名 */\r\n\t\t\tthis.en = datalist[3]; /* 英語パズル名 */\r\n\t\t\tthis.exists = {\r\n\t\t\t\tpzprapp: !!datalist[0],\r\n\t\t\t\tkanpen: !!datalist[1],\r\n\t\t\t\tpencilbox: !!datalist[1]\r\n\t\t\t};\r\n\t\t\tthis.exists.pencilbox =\r\n\t\t\t\tthis.exists.pencilbox &&\r\n\t\t\t\tpzprid !== \"nanro\" &&\r\n\t\t\t\tpzprid !== \"ayeheya\" &&\r\n\t\t\t\tpzprid !== \"kurochute\";\r\n\t\t\t/* pzprurl : ぱずぷれID(URL出力用) */\r\n\t\t\t/* kanpen  : カンペンID            */\r\n\t\t\t/* kanpen2 : カンペンID(入力のみ)  */\r\n\t\t\tthis.alias = !!datalist[5] ? datalist[5] : {};\r\n\t\t\tthis.urlid = this.alias.pzprurl || pzprid;\r\n\t\t\tthis.kanpenid = !!datalist[1] ? this.alias.kanpen || pzprid : \"\";\r\n\t\t\t_list.push(pzprid);\r\n\t\t},\r\n\t\t{\r\n\t\t\taho: [0, 0, \"アホになり切れ\", \"Aho-ni-Narikire\", \"shikaku\"],\r\n\t\t\tamibo: [0, 0, \"あみぼー\", \"Amibo\", \"amibo\"],\r\n\t\t\tangleloop: [0, 0, \"鋭直鈍ループ\", \"Angle Loop\", \"kouchoku\"],\r\n\t\t\taqre: [0, 0, \"Aqre\", \"Aqre\", \"aqre\"],\r\n\t\t\taquarium: [0, 0, \"アクアプレース\", \"Aquarium\", \"aquarium\"],\r\n\t\t\taraf: [0, 0, \"相ダ部屋\", \"Araf\", \"araf\"],\r\n\t\t\tarmyants: [0, 0, \"ぐんたいあり\", \"Army Ants\", \"kaero\"],\r\n\t\t\tarukone: [0, 0, \"アルコネ\", \"Arukone\", \"numlin\"],\r\n\t\t\tayeheya: [0, 1, \"∀人∃ＨＥＹＡ\", \"ekawayeh\", \"heyawake\"],\r\n\t\t\tbalance: [0, 0, \"Balance Loop\", \"Balance Loop\"],\r\n\t\t\tcave: [\r\n\t\t\t\t1,\r\n\t\t\t\t0,\r\n\t\t\t\t\"バッグ\",\r\n\t\t\t\t\"Cave\",\r\n\t\t\t\t\"kurodoko\",\r\n\t\t\t\t{ alias: \"bag\", alias2: \"corral\", alias3: \"correl\" }\r\n\t\t\t],\r\n\t\t\tbarns: [1, 0, \"バーンズ\", \"Barns\"],\r\n\t\t\tbdblock: [1, 0, \"ボーダーブロック\", \"Border Block\"],\r\n\t\t\tbonsan: [1, 0, \"ぼんさん\", \"Bonsan\", \"bonsan\"],\r\n\t\t\tbosanowa: [1, 0, \"ボサノワ\", \"Bosanowa\", \"\", { alias: \"bossanova\" }],\r\n\t\t\tbox: [0, 0, \"ボックス\", \"Box\"],\r\n\t\t\tskyscrapers: [\r\n\t\t\t\t0,\r\n\t\t\t\t0,\r\n\t\t\t\t\"ビルディングパズル\",\r\n\t\t\t\t\"Skyscrapers\",\r\n\t\t\t\t\"\",\r\n\t\t\t\t{ alias: \"building\", alias2: \"skyscraper\" }\r\n\t\t\t],\r\n\t\t\tcastle: [0, 0, \"Castle Wall\", \"Castle Wall\"],\r\n\t\t\tcbblock: [0, 0, \"コンビブロック\", \"Combi Block\"],\r\n\t\t\tchocona: [0, 0, \"チョコナ\", \"Chocona\", \"shimaguni\"],\r\n\t\t\tcojun: [0, 0, \"コージュン\", \"Cojun\", \"ripple\"],\r\n\t\t\tcompass: [0, 0, \"Compass\", \"Compass\", \"compass\"],\r\n\t\t\tcountry: [1, 0, \"カントリーロード\", \"Country Road\"],\r\n\t\t\tcreek: [1, 0, \"クリーク\", \"Creek\"],\r\n\t\t\tcurvedata: [0, 0, \"カーブデータ\", \"Curve Data\"],\r\n\t\t\t\"curvedata-aux\": [0, 0, \"図形の編集\", \"Edit shape\"],\r\n\t\t\tdbchoco: [0, 0, \"ダブルチョコ\", \"Double Choco\", \"cbblock\"],\r\n\t\t\tdetour: [0, 0, \"Detour\", \"Detour\", \"country\"],\r\n\t\t\tdoppelblock: [0, 0, \"Doppelblock\", \"Doppelblock\", \"doppelblock\"],\r\n\t\t\tdosufuwa: [0, 0, \"ドッスンフワリ\", \"Dosun-Fuwari\"],\r\n\t\t\tdoubleback: [0, 0, \"Double Back\", \"Double Back\", \"country\"],\r\n\t\t\teasyasabc: [0, 0, \"ABCプレース\", \"Easy as ABC\"],\r\n\t\t\tfactors: [0, 0, \"因子の部屋\", \"Rooms of Factors\"],\r\n\t\t\tfillmat: [1, 0, \"フィルマット\", \"Fillmat\", \"fillmat\"],\r\n\t\t\tfillomino: [\r\n\t\t\t\t0,\r\n\t\t\t\t1,\r\n\t\t\t\t\"フィルオミノ\",\r\n\t\t\t\t\"Fillomino\",\r\n\t\t\t\t\"\",\r\n\t\t\t\t{ kanpen2: \"fillomino01\" }\r\n\t\t\t],\r\n\t\t\tfirefly: [1, 0, \"ホタルビーム\", \"Hotaru Beam\"],\r\n\t\t\tfivecells: [0, 0, \"ファイブセルズ\", \"FiveCells\", \"nawabari\"],\r\n\t\t\tfourcells: [0, 0, \"フォーセルズ\", \"FourCells\", \"nawabari\"],\r\n\t\t\tgeradeweg: [0, 0, \"グラーデヴェグ\", \"Geradeweg\"],\r\n\t\t\tgoishi: [0, 1, \"碁石ひろい\", \"Goishi\"],\r\n\t\t\tgokigen: [1, 0, \"ごきげんななめ\", \"Slant\", \"gokigen\"],\r\n\t\t\thaisu: [0, 0, \"Haisu\", \"Haisu\"],\r\n\t\t\thakoiri: [1, 0, \"はこいり○△□\", \"Hakoiri-masashi\"],\r\n\t\t\thanare: [0, 0, \"はなれ組\", \"Hanare-gumi\", \"hanare\"],\r\n\t\t\thashikake: [\r\n\t\t\t\t0,\r\n\t\t\t\t1,\r\n\t\t\t\t\"橋をかけろ\",\r\n\t\t\t\t\"Hashiwokakero\",\r\n\t\t\t\t\"\",\r\n\t\t\t\t{ pzprurl: \"hashi\", kanpen: \"hashi\", alias: \"bridges\" }\r\n\t\t\t],\r\n\t\t\thebi: [1, 0, \"へびいちご\", \"Hebi-Ichigo\", \"\", { old: \"snakes\" }],\r\n\t\t\therugolf: [0, 0, \"ヘルゴルフ\", \"Herugolf\"],\r\n\t\t\theteromino: [0, 0, \"ヘテロミノ\", \"Heteromino\", \"nawabari\"],\r\n\t\t\theyabon: [1, 0, \"へやぼん\", \"Heya-Bon\", \"bonsan\"],\r\n\t\t\theyawake: [\r\n\t\t\t\t0,\r\n\t\t\t\t1,\r\n\t\t\t\t\"へやわけ\",\r\n\t\t\t\t\"Heyawake\",\r\n\t\t\t\t\"heyawake\",\r\n\t\t\t\t{ alias: \"heyawacky\" }\r\n\t\t\t],\r\n\t\t\thitori: [0, 1, \"ひとりにしてくれ\", \"Hitori\"],\r\n\t\t\ticebarn: [1, 0, \"アイスバーン\", \"Icebarn\", \"icebarn\"],\r\n\t\t\ticelom: [0, 0, \"アイスローム\", \"Icelom\", \"icebarn\"],\r\n\t\t\ticelom2: [0, 0, \"アイスローム２\", \"Icelom 2\", \"icebarn\"],\r\n\t\t\tichimaga: [0, 0, \"イチマガ\", \"Ichimaga\", \"ichimaga\"],\r\n\t\t\tichimagam: [0, 0, \"磁石イチマガ\", \"Magnetic Ichimaga\", \"ichimaga\"],\r\n\t\t\tichimagax: [\r\n\t\t\t\t0,\r\n\t\t\t\t0,\r\n\t\t\t\t\"一回曲がって交差もするの\",\r\n\t\t\t\t\"Crossing Ichimaga\",\r\n\t\t\t\t\"ichimaga\"\r\n\t\t\t],\r\n\t\t\tinterbd: [0, 0, \"International Borders\", \"International Borders\"],\r\n\t\t\tjuosan: [0, 0, \"縦横さん\", \"Juosan\"],\r\n\t\t\tkaero: [1, 0, \"お家に帰ろう\", \"Return Home\"],\r\n\t\t\tkakuro: [0, 1, \"カックロ\", \"Kakuro\"],\r\n\t\t\tkakuru: [0, 0, \"カックル\", \"Kakuru\"],\r\n\t\t\tkazunori: [0, 0, \"かずのりのへや\", \"Kazunori Room\"],\r\n\t\t\tkinkonkan: [1, 0, \"キンコンカン\", \"Kin-Kon-Kan\"],\r\n\t\t\tkouchoku: [0, 0, \"交差は直角に限る\", \"Kouchoku\"],\r\n\t\t\tkramma: [0, 0, \"快刀乱麻\", \"KaitoRamma\", \"kramma\"],\r\n\t\t\tkramman: [0, 0, \"新・快刀乱麻\", \"New KaitoRamma\", \"kramma\"],\r\n\t\t\tkropki: [0, 0, \"Kropki\", \"Kropki\", \"minarism\"],\r\n\t\t\tkurochute: [0, 1, \"クロシュート\", \"Kurochute\"],\r\n\t\t\tkurodoko: [0, 1, \"黒どこ(黒マスはどこだ)\", \"Kurodoko\"],\r\n\t\t\tkurotto: [0, 0, \"クロット\", \"Kurotto\"],\r\n\t\t\tkusabi: [0, 0, \"クサビリンク\", \"Kusabi\"],\r\n\t\t\tlightup: [\r\n\t\t\t\t0,\r\n\t\t\t\t1,\r\n\t\t\t\t\"美術館\",\r\n\t\t\t\t\"Akari\",\r\n\t\t\t\t\"\",\r\n\t\t\t\t{ pzprurl: \"akari\", kanpen: \"bijutsukan\" }\r\n\t\t\t],\r\n\t\t\tlits: [1, 1, \"ＬＩＴＳ\", \"LITS\", \"lits\"],\r\n\t\t\tlookair: [0, 0, \"るっくえあ\", \"Look-Air\"],\r\n\t\t\tloopsp: [1, 0, \"環状線スペシャル\", \"Loop Special\", \"pipelink\"],\r\n\t\t\tloute: [0, 0, \"エルート\", \"L-route\"],\r\n\t\t\tmakaro: [0, 0, \"マカロ\", \"Makaro\"],\r\n\t\t\tmashu: [0, 1, \"ましゅ\", \"Masyu\", \"\", { kanpen: \"masyu\", alias: \"pearl\" }],\r\n\t\t\tmaxi: [0, 0, \"Maxi Loop\", \"Maxi Loop\", \"country\"],\r\n\t\t\tmeander: [0, 0, \"にょろにょろナンバー\", \"Meandering Numbers\", \"ripple\"],\r\n\t\t\tmejilink: [0, 0, \"メジリンク\", \"Mejilink\"],\r\n\t\t\tminarism: [1, 0, \"マイナリズム\", \"Minarism\"],\r\n\t\t\tmines: [0, 0, \"マインスイーパ\", \"Minesweeper\", \"kurotto\"],\r\n\t\t\tmidloop: [0, 0, \"ミッドループ\", \"Mid-loop\"],\r\n\t\t\tmochikoro: [1, 0, \"モチコロ\", \"Mochikoro\", \"nurikabe\"],\r\n\t\t\tmochinyoro: [1, 0, \"モチにょろ\", \"Mochinyoro\", \"nurikabe\"],\r\n\t\t\tmoonsun: [0, 0, \"月か太陽\", \"Moon or Sun\", \"country\"],\r\n\t\t\tnagare: [0, 0, \"流れるループ\", \"Nagareru-Loop\"],\r\n\t\t\tnagenawa: [0, 0, \"なげなわ\", \"Nagenawa\", \"nagenawa\"],\r\n\t\t\tnanro: [0, 1, \"ナンロー\", \"Nanro\"],\r\n\t\t\tnawabari: [1, 0, \"なわばり\", \"Territory\", \"nawabari\"],\r\n\t\t\tnikoji: [0, 0, \"NIKOJI\", \"NIKOJI\", \"cbblock\"],\r\n\t\t\tnondango: [0, 0, \"ノンダンゴ\", \"Nondango\"],\r\n\t\t\tnonogram: [0, 0, \"ののぐらむ\", \"Nonogram\"],\r\n\t\t\tnorinori: [0, 1, \"のりのり\", \"Norinori\", \"lits\"],\r\n\t\t\tnumlin: [\r\n\t\t\t\t0,\r\n\t\t\t\t1,\r\n\t\t\t\t\"ナンバーリンク\",\r\n\t\t\t\t\"Numberlink\",\r\n\t\t\t\t\"\",\r\n\t\t\t\t{ kanpen: \"numberlink\" }\r\n\t\t\t],\r\n\t\t\tnuribou: [1, 0, \"ぬりぼう\", \"Nuribou\", \"nurikabe\"],\r\n\t\t\tnurikabe: [0, 1, \"ぬりかべ\", \"Nurikabe\", \"nurikabe\"],\r\n\t\t\tnurimaze: [0, 0, \"ぬりめいず\", \"Nuri-Maze\", \"nurimaze\"],\r\n\t\t\tnurimisaki: [0, 0, \"ぬりみさき\", \"Nurimisaki\", \"kurodoko\"],\r\n\t\t\tonsen: [0, 0, \"温泉めぐり\", \"Onsen-meguri\", \"country\"],\r\n\t\t\tdac1: [0, 0, \"Divide and Conquer\", \"Divide and Conquer\", \"onyourown\"],\r\n\t\t\tdac2: [0, 0, \"Divide and Conquer\", \"Divide and Conquer\", \"onyourown\"],\r\n\t\t\tdac3: [0, 0, \"Divide and Conquer\", \"Divide and Conquer\", \"onyourown\"],\r\n\t\t\tdac4: [0, 0, \"Divide and Conquer\", \"Divide and Conquer\", \"onyourown\"],\r\n\t\t\tdac5: [0, 0, \"Divide and Conquer\", \"Divide and Conquer\", \"onyourown\"],\r\n\t\t\tdac6: [0, 0, \"Divide and Conquer\", \"Divide and Conquer\", \"onyourown2\"],\r\n\t\t\tpaintarea: [1, 0, \"ペイントエリア\", \"Paintarea\"],\r\n\t\t\tpencils: [0, 0, \"ペンシルズ\", \"Pencils\"],\r\n\t\t\tpipelink: [1, 0, \"パイプリンク\", \"Pipelink\", \"pipelink\"],\r\n\t\t\tpipelinkr: [\r\n\t\t\t\t1,\r\n\t\t\t\t0,\r\n\t\t\t\t\"帰ってきたパイプリンク\",\r\n\t\t\t\t\"Pipelink Returns\",\r\n\t\t\t\t\"pipelink\"\r\n\t\t\t],\r\n\t\t\tputteria: [0, 0, \"プッテリア\", \"Putteria\", \"hanare\"],\r\n\t\t\trectslider: [0, 0, \"四角スライダー\", \"Rectangle-Slider\", \"bonsan\"],\r\n\t\t\treflect: [1, 0, \"リフレクトリンク\", \"Reflect Link\"],\r\n\t\t\trenban: [0, 0, \"連番窓口\", \"Renban-Madoguchi\"],\r\n\t\t\tringring: [0, 0, \"リングリング\", \"Ring-ring\", \"nagenawa\"],\r\n\t\t\tripple: [\r\n\t\t\t\t0,\r\n\t\t\t\t1,\r\n\t\t\t\t\"波及効果\",\r\n\t\t\t\t\"Ripple Effect\",\r\n\t\t\t\t\"ripple\",\r\n\t\t\t\t{ kanpen: \"hakyukoka\" }\r\n\t\t\t],\r\n\t\t\troma: [0, 0, \"ろーま\", \"Roma\", \"\", { alias: \"rome\" }],\r\n\t\t\tsashigane: [0, 0, \"さしがね\", \"Sashigane\", \"loute\"],\r\n\t\t\tsatogaeri: [\r\n\t\t\t\t0,\r\n\t\t\t\t1,\r\n\t\t\t\t\"さとがえり\",\r\n\t\t\t\t\"Satogaeri\",\r\n\t\t\t\t\"bonsan\",\r\n\t\t\t\t{ alias: \"sato\", kanpen: \"satogaeri\" }\r\n\t\t\t],\r\n\t\t\tscrin: [0, 0, \"スクリン\", \"Scrin\"],\r\n\t\t\tshakashaka: [0, 1, \"シャカシャカ\", \"Shakashaka\"],\r\n\t\t\tshikaku: [0, 1, \"四角に切れ\", \"Shikaku\", \"shikaku\"],\r\n\t\t\tshimaguni: [1, 0, \"島国\", \"Islands\", \"shimaguni\"],\r\n\t\t\tshugaku: [1, 0, \"修学旅行の夜\", \"School Trip\"],\r\n\t\t\tshwolf: [0, 0, \"ヤギとオオカミ\", \"Goats and Wolves\", \"kramma\"],\r\n\t\t\tsimpleloop: [0, 0, \"Simple Loop\", \"Simple Loop\", \"country\"],\r\n\t\t\tslalom: [1, 1, \"スラローム\", \"Slalom\", \"\", { alias: \"suraromu\" }],\r\n\t\t\tslither: [\r\n\t\t\t\t0,\r\n\t\t\t\t1,\r\n\t\t\t\t\"スリザーリンク\",\r\n\t\t\t\t\"Slitherlink\",\r\n\t\t\t\t\"\",\r\n\t\t\t\t{ kanpen: \"slitherlink\" }\r\n\t\t\t],\r\n\t\t\tsnake: [0, 0, \"Snake\", \"Snake\"],\r\n\t\t\tstarbattle: [0, 0, \"スターバトル\", \"Star Battle\"],\r\n\t\t\tstostone: [0, 0, \"ストストーン\", \"Stostone\", \"shimaguni\"],\r\n\t\t\tsudoku: [0, 1, \"数独\", \"Sudoku\"],\r\n\t\t\tsukoro: [1, 0, \"数コロ\", \"Sukoro\", \"sukoro\"],\r\n\t\t\tsukororoom: [0, 0, \"数コロ部屋\", \"Sukoro-room\", \"sukoro\"],\r\n\t\t\tsymmarea: [0, 0, \"シンメトリーエリア\", \"Symmetry Area\", \"fillomino\"],\r\n\t\t\ttapa: [0, 0, \"Tapa\", \"Tapa\"],\r\n\t\t\ttapaloop: [0, 0, \"Tapa-Like Loop\", \"Tapa-Like Loop\"],\r\n\t\t\ttasquare: [0, 0, \"たすくえあ\", \"Tasquare\"],\r\n\t\t\ttatamibari: [1, 0, \"タタミバリ\", \"Tatamibari\"],\r\n\t\t\ttateyoko: [1, 0, \"タテボーヨコボー\", \"Tatebo-Yokobo\"],\r\n\t\t\ttawa: [0, 0, \"たわむれんが\", \"Tawamurenga\"],\r\n\t\t\ttentaisho: [0, 0, \"天体ショー\", \"Tentaisho\"],\r\n\t\t\ttents: [0, 0, \"Tents\", \"Tents\", \"tents\"],\r\n\t\t\ttilepaint: [1, 0, \"タイルペイント\", \"Tilepaint\"],\r\n\t\t\ttoichika: [0, 0, \"遠い誓い\", \"Toichika\"],\r\n\t\t\ttoichika2: [0, 0, \"遠い誓い２\", \"Toichika 2\", \"toichika\"],\r\n\t\t\ttriplace: [0, 0, \"トリプレイス\", \"Tri-place\"],\r\n\t\t\tusotatami: [0, 0, \"ウソタタミ\", \"Uso-tatami\", \"fillmat\"],\r\n\t\t\tusoone: [0, 0, \"ウソワン\", \"Uso-one\"],\r\n\t\t\tview: [1, 0, \"ヴィウ\", \"View\", \"sukoro\"],\r\n\t\t\twagiri: [0, 0, \"ごきげんななめ・輪切\", \"Wagiri\", \"gokigen\"],\r\n\t\t\twalllogic: [0, 0, \"ウォールロジック\", \"Wall Logic\"],\r\n\t\t\twblink: [0, 0, \"シロクロリンク\", \"Shirokuro-link\"],\r\n\t\t\tyajikazu: [1, 0, \"やじさんかずさん\", \"Yajisan-Kazusan\"],\r\n\t\t\tyajilin: [\r\n\t\t\t\t0,\r\n\t\t\t\t1,\r\n\t\t\t\t\"ヤジリン\",\r\n\t\t\t\t\"Yajilin\",\r\n\t\t\t\t\"\",\r\n\t\t\t\t{ pzprurl: \"yajilin\", kanpen: \"yajilin\", alias: \"yajirin\" }\r\n\t\t\t],\r\n\t\t\t\"yajilin-regions\": [\r\n\t\t\t\t0,\r\n\t\t\t\t0,\r\n\t\t\t\t\"ヘヤジリン\",\r\n\t\t\t\t\"Regional Yajilin\",\r\n\t\t\t\t\"yajilin\",\r\n\t\t\t\t{ alias: \"yajirin-regions\" }\r\n\t\t\t],\r\n\t\t\tyajitatami: [0, 0, \"ヤジタタミ\", \"Yajitatami\"],\r\n\t\t\tyinyang: [0, 0, \"しろまるくろまる\", \"Yin-Yang\"],\r\n\t\t\tyosenabe: [0, 0, \"よせなべ\", \"Yosenabe\"]\r\n\t\t}\r\n\t);\r\n})();\r\n","// Parser.js v3.4.1\r\n\r\n(function() {\r\n\tvar URL_AUTO = 0,\r\n\t\tURL_PZPRV3 = 1,\r\n\t\tURL_PZPRAPP = 2,\r\n\t\tURL_KANPEN = 3,\r\n\t\tURL_KANPENP = 4,\r\n\t\tURL_HEYAAPP = 5,\r\n\t\tURL_PZPRFILE = 6,\r\n\t\tFILE_AUTO = 0,\r\n\t\tFILE_PZPR = 1,\r\n\t\tFILE_PBOX = 2,\r\n\t\tFILE_PBOX_XML = 3;\r\n\r\n\tvar URLData, FileData, Parser;\r\n\r\n\tParser = pzpr.parser = function(data, variety) {\r\n\t\treturn Parser.parse(data, variety);\r\n\t};\r\n\tParser.extend = function(obj) {\r\n\t\tfor (var n in obj) {\r\n\t\t\tthis[n] = obj[n];\r\n\t\t}\r\n\t};\r\n\tParser.extend({\r\n\t\t// 定数(URL形式)\r\n\t\tURL_AUTO: URL_AUTO,\r\n\t\tURL_PZPRV3: URL_PZPRV3,\r\n\t\tURL_PZPRAPP: URL_PZPRAPP,\r\n\t\tURL_KANPEN: URL_KANPEN,\r\n\t\tURL_KANPENP: URL_KANPENP,\r\n\t\tURL_HEYAAPP: URL_HEYAAPP,\r\n\t\tURL_PZPRFILE: URL_PZPRFILE,\r\n\r\n\t\t// 定数(ファイル形式)\r\n\t\tFILE_AUTO: FILE_AUTO,\r\n\t\tFILE_PZPR: FILE_PZPR,\r\n\t\tFILE_PBOX: FILE_PBOX,\r\n\t\tFILE_PBOX_XML: FILE_PBOX_XML,\r\n\r\n\t\t/* 入力された文字列を、URLおよびファイルデータとして解析し返します        */\r\n\t\t/* ただし最初から解析済みのデータが渡された場合は、それをそのまま返します */\r\n\t\tparse: function(data, variety) {\r\n\t\t\tif (data instanceof URLData || data instanceof FileData) {\r\n\t\t\t\treturn data;\r\n\t\t\t}\r\n\r\n\t\t\treturn this.parseFile(data, variety) || this.parseURL(data);\r\n\t\t},\r\n\r\n\t\tparseURL: function(url) {\r\n\t\t\tif (url instanceof URLData) {\r\n\t\t\t\treturn url;\r\n\t\t\t}\r\n\r\n\t\t\turl = url.replace(/(\\r|\\n)/g, \"\"); // textarea上の改行が実際の改行扱いになるUAに対応(Operaとか)\r\n\t\t\treturn new URLData(url).parse();\r\n\t\t},\r\n\t\tparseFile: function(fstr, variety) {\r\n\t\t\tif (fstr instanceof FileData) {\r\n\t\t\t\treturn fstr;\r\n\t\t\t}\r\n\r\n\t\t\tif (!fstr.match(/^\\<\\?xml/)) {\r\n\t\t\t\tfstr = fstr.replace(/[\\t\\r]*\\n/g, \"\\n\").replace(/\\//g, \"\\n\");\r\n\t\t\t}\r\n\t\t\treturn new FileData(fstr, variety).parse();\r\n\t\t}\r\n\t});\r\n\tdelete Parser.extend;\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ★ URLData() URLデータのencode/decodeのためのオブジェクト\r\n\t//---------------------------------------------------------------------------\r\n\tURLData = pzpr.parser.URLData = function(url, mode) {\r\n\t\tthis.url = url;\r\n\t\tif (mode !== void 0) {\r\n\t\t\tthis.mode = mode;\r\n\t\t}\r\n\t};\r\n\tpzpr.parser.URLData.prototype = {\r\n\t\tpid: \"\",\r\n\t\tmode: \"\",\r\n\t\ttype: URL_AUTO /* ==0 */,\r\n\t\turl: \"\",\r\n\t\tqdata: \"\",\r\n\t\tpflag: null,\r\n\t\tvariant: null,\r\n\t\tcols: 0,\r\n\t\trows: 0,\r\n\t\tbody: \"\",\r\n\r\n\t\tisurl: true,\r\n\t\tisfile: false,\r\n\r\n\t\t// 定数(URL形式)\r\n\t\tURL_AUTO: URL_AUTO,\r\n\t\tURL_PZPRV3: URL_PZPRV3,\r\n\t\tURL_PZPRAPP: URL_PZPRAPP,\r\n\t\tURL_KANPEN: URL_KANPEN,\r\n\t\tURL_KANPENP: URL_KANPENP,\r\n\t\tURL_HEYAAPP: URL_HEYAAPP,\r\n\t\tURL_PZPRFILE: URL_PZPRFILE,\r\n\r\n\t\tparse: function() {\r\n\t\t\tthis.parseURLType();\r\n\t\t\tthis.parseURLData();\r\n\t\t\tthis.changeProperPid();\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\tgenerate: function() {\r\n\t\t\treturn this.outputURLType() + this.outputURLData();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ★ parseURLType() 入力されたURLからどのパズルか、およびURLの種類を抽出する\r\n\t\t//                   入力=URL 例:http://pzv.jp/p.html?(pid)/(qdata)\r\n\t\t//                   出力={pid:パズル種類, type:URL種類, qdata:タテヨコ以下のデータ}\r\n\t\t//                         qdata -> [(variant)/][(pflag)/](cols)/(rows)/(bstr)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tparseURLType: function() {\r\n\t\t\t/* URLからパズルの種類・URLの種類を判定する */\r\n\t\t\tvar url = this.url;\r\n\t\t\tdelete this.url;\r\n\t\t\t// カンペンの場合\r\n\t\t\tif (\r\n\t\t\t\turl.match(/www\\.kanpen\\.net/) ||\r\n\t\t\t\turl.match(/www\\.geocities(\\.co)?\\.jp\\/pencil_applet/)\r\n\t\t\t) {\r\n\t\t\t\turl.match(/([0-9a-z]+)\\.html/);\r\n\t\t\t\tthis.pid = RegExp.$1;\r\n\t\t\t\t// カンペンだけどデータ形式はへやわけアプレット\r\n\t\t\t\tif (url.indexOf(\"?heyawake=\") >= 0) {\r\n\t\t\t\t\tthis.qdata = url.substr(url.indexOf(\"?heyawake=\") + 10);\r\n\t\t\t\t\tthis.type = URL_HEYAAPP;\r\n\t\t\t\t}\r\n\t\t\t\t// カンペンだけどデータ形式はぱずぷれ\r\n\t\t\t\telse if (url.indexOf(\"?pzpr=\") >= 0) {\r\n\t\t\t\t\tthis.qdata = url.substr(url.indexOf(\"?pzpr=\") + 6);\r\n\t\t\t\t\tthis.type = URL_KANPENP;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.qdata = url.substr(url.indexOf(\"?problem=\") + 9);\r\n\t\t\t\t\tthis.type = URL_KANPEN;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// へやわけアプレットの場合\r\n\t\t\telse if (url.match(/www\\.geocities(\\.co)?\\.jp\\/heyawake/)) {\r\n\t\t\t\tthis.pid = \"heyawake\";\r\n\t\t\t\tthis.qdata = url.substr(url.indexOf(\"?problem=\") + 9);\r\n\t\t\t\tthis.type = URL_HEYAAPP;\r\n\t\t\t}\r\n\t\t\t// ぱずぷれアプレットの場合\r\n\t\t\telse if (url.match(/indi\\.s58\\.xrea\\.com\\/(.+)\\/(sa|sc)\\//)) {\r\n\t\t\t\tthis.pid = RegExp.$1;\r\n\t\t\t\tthis.qdata = url.substr(url.indexOf(\"?\"));\r\n\t\t\t\tthis.type = URL_PZPRAPP;\r\n\t\t\t}\r\n\t\t\t// ぱずぷれv3の場合\r\n\t\t\telse {\r\n\t\t\t\tvar qs = url.indexOf(\"/\", url.indexOf(\"?\"));\r\n\t\t\t\tvar first = \"\";\r\n\t\t\t\tif (qs > -1) {\r\n\t\t\t\t\tfirst = url.substring(url.indexOf(\"?\") + 1, qs);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfirst = url.substr(url.indexOf(\"?\") + 1);\r\n\t\t\t\t}\r\n\t\t\t\tvar modify = true;\r\n\t\t\t\tswitch (first) {\r\n\t\t\t\t\tcase \"dac1\": this.qdata = \"8/8/h8g2h1h663i8ah4j8i2552i1311g355g4g2g322g2g45i3333\"; break;\r\n\t\t\t\t\tcase \"dac2\": this.qdata = \"8/8/cci454ganam8a444ga88ao8n5g8a46j\"; break;\r\n\t\t\t\t\tcase \"dac3\": this.qdata = \"8/8/g3g2h2g4h06h5j1i23i35g2h1h5g6h5g4h3h63h23h5h1g\"; break;\r\n\t\t\t\t\tcase \"dac4\": this.qdata = \"8/8/43g488g8h1iah0ich3g134gae33g5g5g5g3k62g233j1g21g3g\"; break;\r\n\t\t\t\t\tcase \"dac5\": this.qdata = \"8/8/22g3j2g3gaci4g3ga8g3g34h4g3j552j4j2h9h3i22g3\"; break;\r\n\t\t\t\t\tcase \"dac6\": this.qdata = \"15/20/g3h3jal022h6g4g4cg8g20g323g5g8agcg-16g234h9g4h6gac2h2g5o48g3h7884g3i52g52p4g4g4h4h52g9931g63q2g446243j2i3164g4h8gcg-14g99i534g844h9g2g542135h6j96h434i-10-10c194j4g58geg-103143h7675413223141g7j3i1g241h5g6g32g42g2332j71i1g23354435g23411\"; break;\r\n\t\t\t\t\tdefault: var modify = false;\r\n\t\t\t\t}\r\n\t\t\t\tif (first.match(/^pzprv[0-9.]*$/)) {\r\n\t\t\t\t\t// encoded file; extract pid\r\n\t\t\t\t\turl = decodeURIComponent(url);\r\n\t\t\t\t\tvar parts = url.split(\"/\");\r\n\t\t\t\t\tif (parts.length >= 2) {\r\n\t\t\t\t\t\tthis.pid = parts[1];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!modify) {\r\n\t\t\t\t\t\tthis.qdata = url;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.type = URL_PZPRFILE;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (qs > -1 && !modify) {\r\n\t\t\t\t\t\tthis.qdata = url.substr(qs + 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar pid = first;\r\n\t\t\t\t\tthis.mode = \"player\";\r\n\t\t\t\t\tthis.pid = pid.replace(/(_edit|_play)$/, \"\");\r\n\t\t\t\t\tthis.type = URL_PZPRV3;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.pid = pzpr.variety.toPID(this.pid);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ★ outputURLType() パズル種類, URL種類からURLを生成する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\toutputURLType: function() {\r\n\t\t\tvar url = \"\";\r\n\t\t\tif (pzpr.env.node) {\r\n\t\t\t\turl = \"http://pzv.jp/p.html\";\r\n\t\t\t} else {\r\n\t\t\t\turl = location.protocol + \"//\" + location.host + location.pathname;\r\n\t\t\t}\r\n\t\t\tswitch (this.type) {\r\n\t\t\t\tcase URL_PZPRV3:\r\n\t\t\t\t\turl = url + \"?%PID%/\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase URL_KANPEN:\r\n\t\t\t\t\turl = \"http://www.kanpen.net/%KID%.html?problem=\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase URL_KANPENP:\r\n\t\t\t\t\turl = \"http://www.kanpen.net/%KID%.html?pzpr=\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase URL_HEYAAPP:\r\n\t\t\t\t\turl = \"http://www.geocities.co.jp/heyawake/?problem=\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase URL_PZPRFILE:\r\n\t\t\t\t\turl = url + \"?\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tvar pid = this.pid,\r\n\t\t\t\ttyp = \"\";\r\n\t\t\tswitch (this.mode) {\r\n\t\t\t\tcase \"player\":\r\n\t\t\t\t\tpid = pid + \"_play\";\r\n\t\t\t\t\ttyp = \"type=player&\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"editor\":\r\n\t\t\t\t\tpid = pid + \"_edit\";\r\n\t\t\t\t\ttyp = \"type=editor&\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif (this.type === URL_PZPRFILE) {\r\n\t\t\t\turl = url + typ;\r\n\t\t\t}\r\n\t\t\treturn url\r\n\t\t\t\t.replace(\"%PID%\", pzpr.variety(pid).urlid)\r\n\t\t\t\t.replace(\"%KID%\", pzpr.variety(this.pid).kanpenid);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ★ parseURLData() URLを縦横・問題部分などに分解する\r\n\t\t//                   qdata -> [(variant)/][(pflag)/](cols)/(rows)/(bstr)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tparseURLData: function() {\r\n\t\t\tif (this.type === URL_PZPRFILE) {\r\n\t\t\t\tvar parts = this.qdata.split(\"/\");\r\n\t\t\t\tthis.cols = +parts[2];\r\n\t\t\t\tthis.rows = +parts[3];\r\n\t\t\t\tthis.body = this.qdata.replace(/\\//g, \"\\n\");\r\n\t\t\t\tdelete this.qdata;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar inp = this.qdata.split(\"/\"),\r\n\t\t\t\tcol = 0,\r\n\t\t\t\trow = 0;\r\n\t\t\tdelete this.qdata;\r\n\t\t\t/* URLにつけるオプション */\r\n\t\t\tif (this.type !== URL_KANPEN && this.type !== URL_HEYAAPP) {\r\n\t\t\t\tif (!!inp[0] && inp[0].match(/^v:(.*)/)) {\r\n\t\t\t\t\tthis.variant = RegExp.$1;\r\n\t\t\t\t\tinp.shift();\r\n\t\t\t\t}\r\n\t\t\t\tif (!!inp[0] && isNaN(inp[0])) {\r\n\t\t\t\t\tthis.pflag = inp[0];\r\n\t\t\t\t\tinp.shift();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.pflag = \"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t/* サイズを表す文字列 */\r\n\t\t\tif (this.type === URL_KANPEN) {\r\n\t\t\t\tif (this.pid === \"kakuro\") {\r\n\t\t\t\t\trow = +inp.shift() - 1;\r\n\t\t\t\t\tcol = +inp.shift() - 1;\r\n\t\t\t\t} else if (this.pid === \"sudoku\") {\r\n\t\t\t\t\trow = col = +inp.shift();\r\n\t\t\t\t} else {\r\n\t\t\t\t\trow = +inp.shift();\r\n\t\t\t\t\tcol = +inp.shift();\r\n\t\t\t\t}\r\n\t\t\t} else if (this.type === URL_HEYAAPP) {\r\n\t\t\t\tvar size = inp.shift().split(\"x\");\r\n\t\t\t\tcol = +size[0];\r\n\t\t\t\trow = +size[1];\r\n\t\t\t} else {\r\n\t\t\t\tcol = +inp.shift() || NaN;\r\n\t\t\t\trow = +inp.shift() || NaN;\r\n\t\t\t}\r\n\t\t\tthis.rows = row;\r\n\t\t\tthis.cols = col;\r\n\r\n\t\t\t/* サイズ以降のデータを取得 */\r\n\t\t\tif (!inp[inp.length - 1]) {\r\n\t\t\t\tinp.pop();\r\n\t\t\t}\r\n\t\t\tthis.body = inp.join(\"/\");\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ★ outputURLData() qdataを生成する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\toutputURLData: function() {\r\n\t\t\tvar pzl = this,\r\n\t\t\t\tcol = pzl.cols,\r\n\t\t\t\trow = pzl.rows,\r\n\t\t\t\tout = [];\r\n\r\n\t\t\t/* URLにつけるオプション */\r\n\t\t\tif (pzl.type !== URL_KANPEN && pzl.type !== URL_HEYAAPP) {\r\n\t\t\t\tif (pzl.variant !== null) {\r\n\t\t\t\t\tout.push(\"v:\" + pzl.variant);\r\n\t\t\t\t}\r\n\t\t\t\tif (pzl.type === URL_KANPENP || !!pzl.pflag) {\r\n\t\t\t\t\tout.push(pzl.pflag);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t/* サイズを表す文字列 */\r\n\t\t\tif (pzl.type === URL_KANPEN) {\r\n\t\t\t\tif (pzl.pid === \"kakuro\") {\r\n\t\t\t\t\tout.push(row + 1);\r\n\t\t\t\t\tout.push(col + 1);\r\n\t\t\t\t} else if (pzl.pid === \"sudoku\") {\r\n\t\t\t\t\tout.push(col);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tout.push(row);\r\n\t\t\t\t\tout.push(col);\r\n\t\t\t\t}\r\n\t\t\t} else if (pzl.type === URL_HEYAAPP) {\r\n\t\t\t\tout.push([col, row].join(\"x\"));\r\n\t\t\t} else if (pzl.type !== URL_PZPRFILE) {\r\n\t\t\t\tout.push(col);\r\n\t\t\t\tout.push(row);\r\n\t\t\t}\r\n\r\n\t\t\t/* サイズ以降のデータを設定 */\r\n\t\t\tout.push(pzl.body);\r\n\r\n\t\t\t/* 末尾が0-9,a-z,A-Z以外の時にt.coで情報が欠落しないよう/を追加 */\r\n\t\t\tvar body = out.join(\"/\");\r\n\t\t\tif (!body.charAt(body.length - 1).match(/[a-zA-Z0-9]/)) {\r\n\t\t\t\tbody += \"/\";\r\n\t\t\t}\r\n\t\t\treturn body;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ★ changeProperPid() parse後パズル種類が実際には別だった場合にpidを変更する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tchangeProperPid: function() {\r\n\t\t\t// this.bodyが空の場合はEncode.jsの仕様により対象外\r\n\t\t\t// カンペンには以下のパズルは存在しないのでURL_KANPENPも対象外\r\n\t\t\tif (\r\n\t\t\t\t!this.body ||\r\n\t\t\t\t(this.type !== URL_PZPRV3 && this.type !== URL_PZPRAPP)\r\n\t\t\t) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tswitch (this.pid) {\r\n\t\t\t\tcase \"ichimaga\":\r\n\t\t\t\t\tif (this.pflag.indexOf(\"m\") >= 0) {\r\n\t\t\t\t\t\tthis.pid = \"ichimagam\";\r\n\t\t\t\t\t} else if (this.pflag.indexOf(\"x\") >= 0) {\r\n\t\t\t\t\t\tthis.pid = \"ichimagax\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.pid = \"ichimaga\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"icelom\":\r\n\t\t\t\t\tif (this.pflag.indexOf(\"a\") < 0) {\r\n\t\t\t\t\t\tthis.pid = \"icelom2\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"pipelink\":\r\n\t\t\t\t\tif (this.body.match(/[0-9]/)) {\r\n\t\t\t\t\t\tthis.pid = \"pipelinkr\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"bonsan\":\r\n\t\t\t\t\tif (this.pflag.indexOf(\"c\") < 0) {\r\n\t\t\t\t\t\tvar col = this.cols,\r\n\t\t\t\t\t\t\trow = this.rows;\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tthis.body\r\n\t\t\t\t\t\t\t\t.substr(\r\n\t\t\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t\t\t((((col - 1) * row + 4) / 5) | 0) +\r\n\t\t\t\t\t\t\t\t\t\t(((col * (row - 1) + 4) / 5) | 0) || 0\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t.match(/[^0]/)\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tthis.pid = \"heyabon\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"kramma\":\r\n\t\t\t\t\tif (this.pflag.indexOf(\"c\") < 0) {\r\n\t\t\t\t\t\tvar len = (this.cols - 1) * (this.rows - 1),\r\n\t\t\t\t\t\t\tcc = 0;\r\n\t\t\t\t\t\tfor (var i = 0; i < this.body.length; i++) {\r\n\t\t\t\t\t\t\tvar ca = this.body.charAt(i);\r\n\t\t\t\t\t\t\tif (ca.match(/\\w/)) {\r\n\t\t\t\t\t\t\t\tcc += parseInt(ca, 36);\r\n\t\t\t\t\t\t\t\tif (cc < len) {\r\n\t\t\t\t\t\t\t\t\tthis.pid = \"kramman\";\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if (ca === \".\") {\r\n\t\t\t\t\t\t\t\tcc += 36;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (cc >= len) {\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ★ FileData() ファイルデータのencode/decodeのためのオブジェクト\r\n\t//---------------------------------------------------------------------------\r\n\tFileData = pzpr.parser.FileData = function(fstr, variety) {\r\n\t\tthis.pid = !!variety ? variety : \"\";\r\n\t\tthis.fstr = fstr;\r\n\t\tthis.metadata = new pzpr.MetaData();\r\n\t};\r\n\tpzpr.parser.FileData.prototype = {\r\n\t\tpid: \"\",\r\n\t\ttype: FILE_AUTO /* == 0 */,\r\n\t\tfilever: 0,\r\n\t\tfstr: \"\",\r\n\t\tqdata: \"\",\r\n\t\tcols: 0,\r\n\t\trows: 0,\r\n\t\tbody: \"\",\r\n\t\thistory: \"\",\r\n\t\tmetadata: null,\r\n\t\txmldoc: null,\r\n\r\n\t\tisurl: false,\r\n\t\tisfile: true,\r\n\r\n\t\t// 定数(ファイル形式)\r\n\t\tFILE_AUTO: FILE_AUTO,\r\n\t\tFILE_PZPR: FILE_PZPR,\r\n\t\tFILE_PBOX: FILE_PBOX,\r\n\t\tFILE_PBOX_XML: FILE_PBOX_XML,\r\n\r\n\t\tparse: function() {\r\n\t\t\tvar result = this.parseFileType() && this.parseFileData();\r\n\t\t\tif (result) {\r\n\t\t\t\tthis.changeProperPid();\r\n\t\t\t}\r\n\t\t\treturn result ? this : null;\r\n\t\t},\r\n\t\tgenerate: function() {\r\n\t\t\treturn this.outputFileType() + this.outputFileData();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ★ parseFileType() 入力されたファイルのデータからどのパズルか、およびパズルの種類を抽出する\r\n\t\t//                   出力={pid:パズル種類, type:ファイル種類, fstr:ファイルの内容}\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tparseFileType: function() {\r\n\t\t\tvar lines = this.fstr.split(\"\\n\");\r\n\t\t\tvar firstline = lines.shift();\r\n\t\t\tdelete this.fstr;\r\n\r\n\t\t\t/* ヘッダからパズルの種類・ファイルの種類を判定する */\r\n\t\t\tif (firstline.match(/^pzprv3/)) {\r\n\t\t\t\tthis.type = FILE_PZPR;\r\n\t\t\t\tif (firstline.match(/pzprv3\\.(\\d+)/)) {\r\n\t\t\t\t\tthis.filever = +RegExp.$1;\r\n\t\t\t\t}\r\n\t\t\t\tthis.pid = lines.shift();\r\n\t\t\t\tthis.qdata = lines.join(\"\\n\");\r\n\t\t\t} else if (firstline.match(/^\\<\\?xml/)) {\r\n\t\t\t\tthis.type = FILE_PBOX_XML;\r\n\t\t\t\tlines.unshift(firstline);\r\n\t\t\t\tthis.qdata = lines.join(\"\\n\");\r\n\t\t\t\tif (!!DOMParser) {\r\n\t\t\t\t\tthis.body = new DOMParser().parseFromString(this.qdata, \"text/xml\");\r\n\t\t\t\t\tthis.pid = this.body.querySelector(\"puzzle\").getAttribute(\"type\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.pid = \"\";\r\n\t\t\t\t}\r\n\t\t\t} else if (firstline.match(/^\\d+$/)) {\r\n\t\t\t\tthis.type = FILE_PBOX;\r\n\t\t\t\tlines.unshift(firstline);\r\n\t\t\t\tthis.qdata = lines.join(\"\\n\");\r\n\t\t\t} else {\r\n\t\t\t\tthis.pid = \"\";\r\n\t\t\t}\r\n\t\t\tthis.pid = pzpr.variety.toPID(this.pid);\r\n\r\n\t\t\treturn !!this.pid;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ★ outputFileType() パズル種類, ファイル種類からヘッダを生成する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\toutputFileType: function() {\r\n\t\t\t/* ヘッダの処理 */\r\n\t\t\tif (this.type === FILE_PZPR) {\r\n\t\t\t\treturn [\r\n\t\t\t\t\tthis.filever === 0 ? \"pzprv3\" : \"pzprv3.\" + this.filever,\r\n\t\t\t\t\tthis.pid,\r\n\t\t\t\t\t\"\"\r\n\t\t\t\t].join(\"\\n\");\r\n\t\t\t} else if (this.type === FILE_PBOX_XML) {\r\n\t\t\t\tthis.body\r\n\t\t\t\t\t.querySelector(\"puzzle\")\r\n\t\t\t\t\t.setAttribute(\"type\", pzpr.variety(this.pid).kanpenid);\r\n\t\t\t}\r\n\t\t\treturn \"\";\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ★ parseFileData() ファイルの内容からサイズなどを求める\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tparseFileData: function() {\r\n\t\t\tvar lines = this.qdata.split(\"\\n\"),\r\n\t\t\t\tcol = 0,\r\n\t\t\t\trow = 0;\r\n\t\t\tdelete this.qdata;\r\n\r\n\t\t\t/* サイズを表す文字列 */\r\n\t\t\tif (this.type === FILE_PBOX_XML) {\r\n\t\t\t\trow = +this.body.querySelector(\"size\").getAttribute(\"row\");\r\n\t\t\t\tcol = +this.body.querySelector(\"size\").getAttribute(\"col\");\r\n\t\t\t\tif (this.pid === \"slither\" || this.pid === \"kakuro\") {\r\n\t\t\t\t\trow--;\r\n\t\t\t\t\tcol--;\r\n\t\t\t\t}\r\n\t\t\t} else if (this.type === FILE_PBOX && this.pid === \"kakuro\") {\r\n\t\t\t\trow = +lines.shift() - 1;\r\n\t\t\t\tcol = +lines.shift() - 1;\r\n\t\t\t} else if (this.pid === \"sudoku\") {\r\n\t\t\t\trow = col = +lines.shift();\r\n\t\t\t} else {\r\n\t\t\t\trow = +lines.shift();\r\n\t\t\t\tcol = +lines.shift();\r\n\t\t\t}\r\n\t\t\tif (row <= 0 || col <= 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tthis.rows = row;\r\n\t\t\tthis.cols = col;\r\n\r\n\t\t\t/* サイズ以降のデータを取得 */\r\n\t\t\tif (this.type === FILE_PZPR) {\r\n\t\t\t\tvar historypos = null,\r\n\t\t\t\t\tstr = \"\",\r\n\t\t\t\t\tstrs = [],\r\n\t\t\t\t\tisinfo = false;\r\n\t\t\t\tfor (var i = 0; i < lines.length; i++) {\r\n\t\t\t\t\t/* かなり昔のぱずぷれファイルは最終行にURLがあったので、末尾扱いする */\r\n\t\t\t\t\tif (lines[i].match(/^http\\:\\/\\//)) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t/* info行に到達した場合 */\r\n\t\t\t\t\tif (lines[i].match(/info:\\{/)) {\r\n\t\t\t\t\t\thistorypos = i;\r\n\t\t\t\t\t\tisinfo = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t/* 履歴行に到達した場合 */\r\n\t\t\t\t\tif (lines[i].match(/history:\\{|__HISTORY__/)) {\r\n\t\t\t\t\t\thistorypos = i;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tstrs.push(lines[i]);\r\n\t\t\t\t}\r\n\t\t\t\tthis.body += strs.join(\"\\n\");\r\n\r\n\t\t\t\t/* 履歴部分の読み込み */\r\n\t\t\t\tif (historypos !== null && !!JSON) {\r\n\t\t\t\t\tvar count = 0,\r\n\t\t\t\t\t\tcnt;\r\n\t\t\t\t\tfor (var i = historypos; i < lines.length; i++) {\r\n\t\t\t\t\t\tstr += lines[i];\r\n\r\n\t\t\t\t\t\tcnt = count;\r\n\t\t\t\t\t\tcount += (lines[i].match(/\\{/g) || []).length;\r\n\t\t\t\t\t\tcount -= (lines[i].match(/\\}/g) || []).length;\r\n\t\t\t\t\t\tif (cnt > 0 && count === 0) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t/* 履歴出力があったら入力する */\r\n\t\t\t\tif (!!JSON) {\r\n\t\t\t\t\tif (isinfo && str.substr(0, 5) === \"info:\") {\r\n\t\t\t\t\t\tvar info = JSON.parse(str.substr(5));\r\n\t\t\t\t\t\tthis.metadata.update(info.metadata);\r\n\t\t\t\t\t\tthis.history = info.history || \"\";\r\n\t\t\t\t\t} else if (str.substr(0, 8) === \"history:\") {\r\n\t\t\t\t\t\tthis.history = JSON.parse(str.substr(8));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (this.type === FILE_PBOX) {\r\n\t\t\t\tthis.body = lines.join(\"\\n\");\r\n\t\t\t} else if (this.type === FILE_PBOX_XML) {\r\n\t\t\t\tif (!!this.body) {\r\n\t\t\t\t\tvar metanode = this.body.querySelector(\"property\"),\r\n\t\t\t\t\t\tmeta = this.metadata;\r\n\t\t\t\t\tmeta.author = metanode.querySelector(\"author\").getAttribute(\"value\");\r\n\t\t\t\t\tmeta.source = metanode.querySelector(\"source\").getAttribute(\"value\");\r\n\t\t\t\t\tmeta.hard = metanode\r\n\t\t\t\t\t\t.querySelector(\"difficulty\")\r\n\t\t\t\t\t\t.getAttribute(\"value\");\r\n\t\t\t\t\tvar commentnode = metanode.querySelector(\"comment\");\r\n\t\t\t\t\tmeta.comment = !!commentnode ? commentnode.childNodes[0].data : \"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ★ outputFileData() パズル種類, URL種類, fstrからファイルのデータを生成する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\toutputFileData: function() {\r\n\t\t\tvar pzl = this,\r\n\t\t\t\tcol = pzl.cols,\r\n\t\t\t\trow = pzl.rows,\r\n\t\t\t\tout = [];\r\n\t\t\tvar puzzlenode =\r\n\t\t\t\tthis.type === FILE_PBOX_XML ? this.body.querySelector(\"puzzle\") : null;\r\n\r\n\t\t\t/* サイズを表す文字列 */\r\n\t\t\tif (pzl.type === FILE_PBOX_XML) {\r\n\t\t\t\tvar sizenode = puzzlenode.querySelector(\"size\");\r\n\t\t\t\tif (sizenode) {\r\n\t\t\t\t\tpuzzlenode.removeChild(sizenode);\r\n\t\t\t\t}\r\n\t\t\t\tif (pzl.pid === \"slither\" || pzl.pid === \"kakuro\") {\r\n\t\t\t\t\trow++;\r\n\t\t\t\t\tcol++;\r\n\t\t\t\t}\r\n\t\t\t\tpuzzlenode.appendChild(\r\n\t\t\t\t\tthis.createXMLNode(\"size\", { row: row, col: col })\r\n\t\t\t\t);\r\n\t\t\t} else if (pzl.type === FILE_PBOX && pzl.pid === \"kakuro\") {\r\n\t\t\t\tout.push(row + 1);\r\n\t\t\t\tout.push(col + 1);\r\n\t\t\t} else if (pzl.pid === \"sudoku\") {\r\n\t\t\t\tout.push(col);\r\n\t\t\t} else {\r\n\t\t\t\tout.push(row);\r\n\t\t\t\tout.push(col);\r\n\t\t\t}\r\n\r\n\t\t\t/* サイズ以降のデータを設定 */\r\n\t\t\tif (pzl.type !== FILE_PBOX_XML) {\r\n\t\t\t\tout.push(pzl.body);\r\n\t\t\t}\r\n\r\n\t\t\t/* 履歴・メタデータ出力がある形式ならば出力する */\r\n\t\t\tif (pzl.type === FILE_PZPR && !!JSON) {\r\n\t\t\t\tif (!pzl.metadata.empty()) {\r\n\t\t\t\t\tvar info = { metadata: pzl.metadata.getvaliddata() };\r\n\t\t\t\t\tif (pzl.history) {\r\n\t\t\t\t\t\tinfo.history = pzl.history;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tout.push(\"info:\" + JSON.stringify(info, null, 1));\r\n\t\t\t\t} else if (pzl.history) {\r\n\t\t\t\t\tout.push(\"history:\" + JSON.stringify(pzl.history, null, 1));\r\n\t\t\t\t}\r\n\t\t\t} else if (pzl.type === FILE_PBOX_XML) {\r\n\t\t\t\tvar propnode = puzzlenode.querySelector(\"property\");\r\n\t\t\t\tif (propnode) {\r\n\t\t\t\t\tpuzzlenode.removeChild(propnode);\r\n\t\t\t\t}\r\n\t\t\t\tpropnode = this.createXMLNode(\"property\");\r\n\t\t\t\tvar meta = pzl.metadata;\r\n\t\t\t\tpropnode.appendChild(\r\n\t\t\t\t\tthis.createXMLNode(\"author\", { value: meta.author })\r\n\t\t\t\t);\r\n\t\t\t\tpropnode.appendChild(\r\n\t\t\t\t\tthis.createXMLNode(\"source\", { value: meta.source })\r\n\t\t\t\t);\r\n\t\t\t\tpropnode.appendChild(\r\n\t\t\t\t\tthis.createXMLNode(\"difficulty\", { value: meta.hard })\r\n\t\t\t\t);\r\n\t\t\t\tif (!!meta.comment) {\r\n\t\t\t\t\tvar commentnode = this.createXMLNode(\"comment\");\r\n\t\t\t\t\tcommentnode.appendChild(this.body.createTextNode(meta.comment));\r\n\t\t\t\t\tpropnode.appendChild(commentnode);\r\n\t\t\t\t}\r\n\t\t\t\tpuzzlenode.appendChild(propnode);\r\n\r\n\t\t\t\t// 順番を入れ替え\r\n\t\t\t\tpuzzlenode.appendChild(puzzlenode.querySelector(\"board\"));\r\n\t\t\t\tpuzzlenode.appendChild(puzzlenode.querySelector(\"answer\"));\r\n\t\t\t}\r\n\r\n\t\t\tvar outputdata;\r\n\t\t\tif (pzl.type !== FILE_PBOX_XML) {\r\n\t\t\t\toutputdata = out.join(\"\\n\");\r\n\t\t\t} else {\r\n\t\t\t\toutputdata = new XMLSerializer().serializeToString(this.body);\r\n\t\t\t\tif (!outputdata.match(/^\\<\\?xml/)) {\r\n\t\t\t\t\toutputdata = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n' + outputdata;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn outputdata;\r\n\t\t},\r\n\r\n\t\tcreateXMLNode: function(name, attrs) {\r\n\t\t\tvar node = this.body.createElement(name);\r\n\t\t\tif (!!attrs) {\r\n\t\t\t\tfor (var i in attrs) {\r\n\t\t\t\t\tnode.setAttribute(i, attrs[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn node;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ★ changeProperPid() parse後パズル種類が実際には別だった場合にpidを変更する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tchangeProperPid: function() {\r\n\t\t\tif (this.type !== FILE_PZPR) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tswitch (this.pid) {\r\n\t\t\t\tcase \"ichimaga\":\r\n\t\t\t\t\tvar pzlflag = this.body.split(\"\\n\")[0];\r\n\t\t\t\t\tif (pzlflag === \"mag\") {\r\n\t\t\t\t\t\tthis.pid = \"ichimagam\";\r\n\t\t\t\t\t} else if (pzlflag === \"cross\") {\r\n\t\t\t\t\t\tthis.pid = \"ichimagax\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"icelom\":\r\n\t\t\t\t\tvar pzltype = this.body.split(\"\\n\")[2];\r\n\t\t\t\t\tif (pzltype === \"skipwhite\") {\r\n\t\t\t\t\t\tthis.pid = \"icelom2\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"pipelink\":\r\n\t\t\t\t\tvar lines = this.body.split(\"\\n\"),\r\n\t\t\t\t\t\trow = 1,\r\n\t\t\t\t\t\tlen = this.rows;\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tlines\r\n\t\t\t\t\t\t\t.slice(row, row + len)\r\n\t\t\t\t\t\t\t.join(\"\")\r\n\t\t\t\t\t\t\t.match(/o/)\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tthis.pid = \"pipelinkr\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"bonsan\":\r\n\t\t\t\t\tvar lines = this.body.split(\"\\n\"),\r\n\t\t\t\t\t\trow = 2 * this.rows,\r\n\t\t\t\t\t\tlen = 2 * this.rows - 1;\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tlines\r\n\t\t\t\t\t\t\t.slice(row, row + len)\r\n\t\t\t\t\t\t\t.join(\"\")\r\n\t\t\t\t\t\t\t.match(/1/)\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tthis.pid = \"heyabon\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"kramma\":\r\n\t\t\t\t\tvar lines = this.body.split(\"\\n\"),\r\n\t\t\t\t\t\trow = this.rows,\r\n\t\t\t\t\t\tlen = this.rows + 1;\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tlines\r\n\t\t\t\t\t\t\t.slice(row, row + len)\r\n\t\t\t\t\t\t\t.join(\"\")\r\n\t\t\t\t\t\t\t.match(/1/)\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tthis.pid = \"kramman\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n})();\r\n","// metadata.js v3.5.2\r\n\r\n//---------------------------------------------------------------------------\r\n//  MetaData構造体  作者やコメントなどの情報を保持する\r\n//---------------------------------------------------------------------------\r\npzpr.MetaData = function() {};\r\npzpr.MetaData.prototype = {\r\n\tauthor: \"\",\r\n\tsource: \"\",\r\n\thard: \"\",\r\n\tcomment: \"\",\r\n\titems: { author: \"\", source: \"\", hard: \"\", comment: \"\" },\r\n\r\n\tupdate: function(metadata) {\r\n\t\tif (!metadata) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor (var i in this.items) {\r\n\t\t\tif (typeof metadata[i] === \"string\") {\r\n\t\t\t\tthis[i] = metadata[i];\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tgetvaliddata: function() {\r\n\t\tvar obj = {};\r\n\t\tfor (var i in this.items) {\r\n\t\t\tif (!!this[i]) {\r\n\t\t\t\tobj[i] = this[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn obj;\r\n\t},\r\n\treset: function() {\r\n\t\tfor (var i in this.items) {\r\n\t\t\tthis[i] = \"\";\r\n\t\t}\r\n\t},\r\n\tempty: function() {\r\n\t\tfor (var i in this.items) {\r\n\t\t\tif (!!this[i]) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n};\r\n","// util.js v3.4.0\r\n\r\n(function() {\r\n\tvar api = pzpr.env.API,\r\n\t\teventMouseDown = [\"mousedown\"],\r\n\t\teventMouseMove = [\"mousemove\"],\r\n\t\teventMouseUp = [\"mouseup\"],\r\n\t\teventMouseCancel = [\"\"];\r\n\r\n\tif (pzpr.env.bz.AndroidBrowser) {\r\n\t\teventMouseDown = [\"\"];\r\n\t\teventMouseMove = [\"\"];\r\n\t\teventMouseUp = [\"\"];\r\n\t}\r\n\r\n\tif (api.pointerevent) {\r\n\t\teventMouseDown = [\"pointerdown\"];\r\n\t\teventMouseMove = [\"pointermove\"];\r\n\t\teventMouseUp = [\"pointerup\"];\r\n\t\teventMouseCancel = [\"pointercancel\"];\r\n\t} else if (api.mspointerevent) {\r\n\t\teventMouseDown = [\"MSPointerDown\"];\r\n\t\teventMouseMove = [\"MSPointerMove\"];\r\n\t\teventMouseUp = [\"MSPointerUp\"];\r\n\t\teventMouseCancel = [\"MSPointerCancel\"];\r\n\t} else if (api.touchevent) {\r\n\t\teventMouseDown.push(\"touchstart\");\r\n\t\teventMouseMove.push(\"touchmove\");\r\n\t\teventMouseUp.push(\"touchend\");\r\n\t\teventMouseCancel.push(\"touchcancel\");\r\n\t}\r\n\r\n\t//----------------------------------------------------------------------\r\n\t// EventやDOM関連のツール的関数群\r\n\t//----------------------------------------------------------------------\r\n\tpzpr.util = {\r\n\t\t//---------------------------------------------------------------\r\n\t\t// pzpr.jsが読み込まれているスクリプトのパスを取得する\r\n\t\tgetpath: function() {\r\n\t\t\tif (pzpr.env.browser) {\r\n\t\t\t\tvar srcs = document.getElementsByTagName(\"script\");\r\n\t\t\t\tfor (var i = 0; i < srcs.length; i++) {\r\n\t\t\t\t\tvar result = srcs[i].src.match(/^(.*\\/)pzpr\\.js(?:\\?.*)?$/);\r\n\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\treturn result[1] + (!result[1].match(/\\/$/) ? \"/\" : \"\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn (\r\n\t\t\t\t\trequire(\"path\").dirname(__filename) +\r\n\t\t\t\t\t\"/\" +\r\n\t\t\t\t\t(__filename.match(\"pzpr.js\") ? \"\" : \"../\")\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\treturn \"\";\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------\r\n\t\t// 現在の時間を取得\r\n\t\tcurrentTime: function() {\r\n\t\t\treturn new Date().getTime();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------\r\n\t\t// Elementの生成関連\r\n\t\t//---------------------------------------------------------------\r\n\t\tunselectable: function(el) {\r\n\t\t\tel.style.MozUserSelect = \"none\";\r\n\t\t\tel.style.KhtmlUserSelect = \"none\";\r\n\t\t\tel.style.webkitUserSelect = \"none\";\r\n\t\t\tel.style.msUserSelect = \"none\";\r\n\t\t\tel.style.userSelect = \"none\";\r\n\t\t\tel.unselectable = \"on\";\r\n\t\t\treturn this;\r\n\t\t},\r\n\r\n\t\t//----------------------------------------------------------------------\r\n\t\t// pzpr.util.addEvent()          addEventListener()を呼び出す\r\n\t\t//----------------------------------------------------------------------\r\n\t\taddEvent: function(el, type, self, callback, capt) {\r\n\t\t\tvar types = [type];\r\n\t\t\tif (type === \"mousedown\") {\r\n\t\t\t\ttypes = eventMouseDown;\r\n\t\t\t} else if (type === \"mousemove\") {\r\n\t\t\t\ttypes = eventMouseMove;\r\n\t\t\t} else if (type === \"mouseup\") {\r\n\t\t\t\ttypes = eventMouseUp;\r\n\t\t\t} else if (type === \"mousecancel\") {\r\n\t\t\t\ttypes = eventMouseCancel;\r\n\t\t\t}\r\n\r\n\t\t\tfunction executer(e) {\r\n\t\t\t\tcallback.call(self, e);\r\n\t\t\t}\r\n\t\t\ttypes.forEach(function(type) {\r\n\t\t\t\tel.addEventListener(type, executer, !!capt);\r\n\t\t\t});\r\n\r\n\t\t\treturn function remover() {\r\n\t\t\t\ttypes.forEach(function(type) {\r\n\t\t\t\t\tel.removeEventListener(type, executer, !!capt);\r\n\t\t\t\t});\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pzpr.util.getMouseButton() 左/中/右ボタンが押されているかチェックする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetMouseButton: function(e) {\r\n\t\t\tif (e.touches !== void 0) {\r\n\t\t\t\t/* touchイベントだった場合 */\r\n\t\t\t\treturn e.touches.length === 1 ? \"left\" : \"\";\r\n\t\t\t} else if (!!e.pointerType && e.pointerType !== \"mouse\") {\r\n\t\t\t\t/* pointerイベントだった場合 */\r\n\t\t\t\treturn e.isPrimary ? \"left\" : \"\";\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t[\"left\", \"middle\", \"right\"][\r\n\t\t\t\t\te.button !== void 0 ? e.button : e.which - 1\r\n\t\t\t\t] || \"\"\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t//----------------------------------------------------------------------\r\n\t\t// pzpr.util.getPagePos() イベントが起こったページ上の座標を返す\r\n\t\t// pzpr.util.pageX()      イベントが起こったページ上のX座標を返す\r\n\t\t// pzpr.util.pageY()      イベントが起こったページ上のY座標を返す\r\n\t\t//----------------------------------------------------------------------\r\n\t\tgetPagePos: function(e) {\r\n\t\t\treturn { px: this.pageX(e), py: this.pageY(e) };\r\n\t\t},\r\n\t\tpageX: function(e) {\r\n\t\t\tif (e.touches !== void 0 && e.touches.length > 0) {\r\n\t\t\t\tvar len = e.touches.length,\r\n\t\t\t\t\tpos = 0;\r\n\t\t\t\tif (len > 0) {\r\n\t\t\t\t\tfor (var i = 0; i < len; i++) {\r\n\t\t\t\t\t\tpos += e.touches[i].pageX;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn pos / len;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn e.pageX || 0;\r\n\t\t},\r\n\t\tpageY: function(e) {\r\n\t\t\tif (e.touches !== void 0 && e.touches.length > 0) {\r\n\t\t\t\tvar len = e.touches.length,\r\n\t\t\t\t\tpos = 0;\r\n\t\t\t\tif (len > 0) {\r\n\t\t\t\t\tfor (var i = 0; i < len; i++) {\r\n\t\t\t\t\t\tpos += e.touches[i].pageY;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn pos / len;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn e.pageY || 0;\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// pzpr.util.getRect()   エレメントの四辺の座標を返す\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tgetRect: function(el) {\r\n\t\t\tif (!pzpr.env.browser) {\r\n\t\t\t\treturn { top: 0, bottom: 0, left: 0, right: 0, height: 0, width: 0 };\r\n\t\t\t}\r\n\t\t\tvar rect = el.getBoundingClientRect(),\r\n\t\t\t\tscrollLeft,\r\n\t\t\t\tscrollTop;\r\n\t\t\tif (window.scrollX !== void 0) {\r\n\t\t\t\tscrollLeft = window.scrollX;\r\n\t\t\t\tscrollTop = window.scrollY;\r\n\t\t\t} else {\r\n\t\t\t\t/* IE11以下向け */\r\n\t\t\t\tvar _html = document.documentElement;\r\n\t\t\t\tscrollLeft = _html.scrollLeft;\r\n\t\t\t\tscrollTop = _html.scrollTop;\r\n\t\t\t}\r\n\t\t\tvar left = rect.left + scrollLeft;\r\n\t\t\tvar top = rect.top + scrollTop;\r\n\t\t\tvar right = rect.right + scrollLeft;\r\n\t\t\tvar bottom = rect.bottom + scrollTop;\r\n\t\t\treturn {\r\n\t\t\t\ttop: top,\r\n\t\t\t\tbottom: bottom,\r\n\t\t\t\tleft: left,\r\n\t\t\t\tright: right,\r\n\t\t\t\theight: bottom - top,\r\n\t\t\t\twidth: right - left\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pzpr.util.checkpid()  メニューなどが表示対象のパズルかどうか返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckpid: function(str, pid) {\r\n\t\t\tvar matches = str.match(/!?[a-z0-9-]+/g),\r\n\t\t\t\tisdisp = true;\r\n\t\t\tif (!!matches) {\r\n\t\t\t\tisdisp = false;\r\n\t\t\t\tfor (var i = 0; i < matches.length; i++) {\r\n\t\t\t\t\tif (matches[i].charAt(0) !== \"!\") {\r\n\t\t\t\t\t\tif (matches[i] === pid) {\r\n\t\t\t\t\t\t\tisdisp = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisdisp = matches[i].substr(1) !== pid;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn isdisp;\r\n\t\t}\r\n\t};\r\n})();\r\n","// Puzzle.js v3.6.0\r\n\r\n(function() {\r\n\t//---------------------------------------------------------------------------\r\n\t// ★Puzzleクラス ぱずぷれv3のベース処理やその他の処理を行う\r\n\t//---------------------------------------------------------------------------\r\n\tpzpr.Puzzle = function(canvas, option) {\r\n\t\tthis.pzpr = pzpr;\r\n\r\n\t\tif (option === void 0 && (!canvas || !canvas.parentNode)) {\r\n\t\t\toption = canvas;\r\n\t\t\tcanvas = void 0;\r\n\t\t}\r\n\t\toption = option || {};\r\n\r\n\t\tthis.instancetype = option.type || \"editor\";\r\n\t\tvar modeid = { player: 1, viewer: 2 }[this.instancetype || 0] || 0;\r\n\t\tthis.playeronly = !!modeid; // 回答モードのみで動作する\r\n\t\tthis.editmode = !this.playeronly; // 問題配置モード\r\n\t\tthis.playmode = !this.editmode; // 回答モード\r\n\r\n\t\tthis.resetTime();\r\n\r\n\t\tthis.preInitCanvasInfo = {\r\n\t\t\ttype: option.graphic || \"\",\r\n\t\t\twidth: option.width || null,\r\n\t\t\theight: option.height || null,\r\n\t\t\tcellsize: option.cellsize || null\r\n\t\t};\r\n\r\n\t\tthis.listeners = {};\r\n\r\n\t\tthis.metadata = new pzpr.MetaData();\r\n\r\n\t\tthis.config = new this.Config(this);\r\n\t\tif (option.config !== void 0) {\r\n\t\t\tthis.config.setAll(option.config);\r\n\t\t}\r\n\t\tif (option.mode !== void 0) {\r\n\t\t\tthis.setMode(option.mode);\r\n\t\t}\r\n\t\tif (option.variant !== void 0) {\r\n\t\t\tthis.config.set(\"variant\", true);\r\n\t\t}\r\n\r\n\t\tif (!!canvas) {\r\n\t\t\tthis.setCanvas(canvas);\r\n\t\t}\r\n\r\n\t\tpzpr.classmgr.setClasses(this, \"\");\r\n\t\tinitObjects(this);\r\n\t};\r\n\tpzpr.Puzzle.prototype = {\r\n\t\tpid: null, // パズルのID(\"creek\"など)\r\n\t\tinfo: {}, // VarietyInfoへの参照\r\n\r\n\t\tklass: null,\r\n\r\n\t\tready: false, // 盤面の準備ができたかを示す (Canvas準備完了前にtrueになる)\r\n\t\teditmode: false, // 問題配置モード\r\n\t\tplaymode: false, // 回答モード\r\n\t\tplayeronly: true, // 回答モードのみで動作する\r\n\t\tinstancetype: \"\", // editpr/player/viewerのいずれか\r\n\r\n\t\tstarttime: 0,\r\n\r\n\t\tcanvas: null, // 描画canvas本体\r\n\t\tsubcanvas: null, // 補助canvas\r\n\r\n\t\tlisteners: null,\r\n\r\n\t\tconfig: null,\r\n\r\n\t\tmetadata: null, // 作者やコメントなどの情報\r\n\r\n\t\t// モード設定用定数\r\n\t\tMODE_EDITOR: 1,\r\n\t\tMODE_PLAYER: 3,\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// owner.open()    パズルデータを入力して盤面の初期化を行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\topen: function(data, variety, callback) {\r\n\t\t\topenExecute(this, data, variety, callback);\r\n\t\t\treturn this;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// owner.on()   イベントが発生した時に呼ぶ関数を登録する\r\n\t\t// owner.once() イベントが発生した時に1回だけ呼ぶ関数を登録する\r\n\t\t// owner.addListener() on, onceの共通処理\r\n\t\t// owner.emit() イベントが発生した時に呼ぶ関数を実行する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\ton: function(eventname, func) {\r\n\t\t\tthis.addListener(eventname, func, false);\r\n\t\t},\r\n\t\tonce: function(eventname, func) {\r\n\t\t\tthis.addListener(eventname, func, true);\r\n\t\t},\r\n\t\taddListener: function(eventname, func, once) {\r\n\t\t\tif (!this.listeners[eventname]) {\r\n\t\t\t\tthis.listeners[eventname] = [];\r\n\t\t\t}\r\n\t\t\tthis.listeners[eventname].push({ func: func, once: !!once });\r\n\t\t},\r\n\t\temit: function() {\r\n\t\t\tvar args = Array.prototype.slice.apply(arguments),\r\n\t\t\t\teventname = args.shift();\r\n\t\t\tvar evlist = this.listeners[eventname];\r\n\t\t\tif (!!evlist) {\r\n\t\t\t\targs.unshift(this);\r\n\t\t\t\tfor (var i = 0; i < evlist.length; i++) {\r\n\t\t\t\t\tvar ev = evlist[i];\r\n\t\t\t\t\tif (evlist[i].once) {\r\n\t\t\t\t\t\tevlist.splice(i, 1);\r\n\t\t\t\t\t\ti--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tev.func.apply(this, args);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// owner.setCanvas()  描画キャンバスをセットする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetCanvas: function(el, type) {\r\n\t\t\tif (!el) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar rect = pzpr.util.getRect(el);\r\n\t\t\tvar _div = document.createElement(\"div\");\r\n\t\t\t_div.style.width = rect.width + \"px\";\r\n\t\t\t_div.style.height = rect.height + \"px\";\r\n\t\t\tel.appendChild(_div);\r\n\t\t\tthis.canvas = _div;\r\n\r\n\t\t\tsetCanvas_main(this, type || this.preInitCanvasInfo.type);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// owner.setCanvasSize()           盤面のサイズを設定する\r\n\t\t// owner.setCanvasSizeByCellSize() セルのサイズを指定して盤面のサイズを設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetCanvasSize: function(width, height) {\r\n\t\t\tif (!this.preInitCanvasInfo) {\r\n\t\t\t\tthis.painter.resizeCanvas(width, height);\r\n\t\t\t} else {\r\n\t\t\t\tthis.preInitCanvasInfo.width = width;\r\n\t\t\t\tthis.preInitCanvasInfo.height = height;\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetCanvasSizeByCellSize: function(cellsize) {\r\n\t\t\tif (!this.preInitCanvasInfo) {\r\n\t\t\t\tthis.painter.resizeCanvasByCellSize(cellsize);\r\n\t\t\t} else {\r\n\t\t\t\tthis.preInitCanvasInfo.cellsize = cellsize;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// owner.redraw()      盤面の再描画を行う\r\n\t\t// owner.irowake()     色分けをする場合、色をふり直すルーチンを呼び出す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tredraw: function(forcemode) {\r\n\t\t\tif (!forcemode) {\r\n\t\t\t\tthis.painter.paintAll();\r\n\t\t\t} // 盤面キャッシュを保持して再描画\r\n\t\t\telse {\r\n\t\t\t\tthis.painter.resizeCanvas();\r\n\t\t\t} // 盤面キャッシュを破棄して再描画\r\n\t\t},\r\n\t\tirowake: function() {\r\n\t\t\tthis.board.irowakeRemake();\r\n\t\t\tif (this.execConfig(\"irowake\") || this.execConfig(\"irowakeblk\")) {\r\n\t\t\t\tthis.redraw();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// owner.toDataURL() 盤面画像をDataURLとして出力する\r\n\t\t// owner.toBlob()    盤面画像をBlobとして出力する\r\n\t\t// owner.toBuffer()  盤面画像をファイルデータそのままで出力する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\ttoDataURL: function(type, quality, option) {\r\n\t\t\tvar imageopt = parseImageOption(type, quality, option);\r\n\t\t\tvar canvas = getLocalCanvas(this, imageopt);\r\n\t\t\tvar dataurl = canvas.toDataURL(imageopt.mimetype, imageopt.quality);\r\n\t\t\tif (!!canvas.parentNode) {\r\n\t\t\t\tcanvas.parentNode.removeChild(canvas);\r\n\t\t\t}\r\n\t\t\treturn dataurl;\r\n\t\t},\r\n\t\ttoBlob: function(callback, type, quality, option) {\r\n\t\t\tvar imageopt = parseImageOption(type, quality, option);\r\n\t\t\tvar canvas = getLocalCanvas(this, imageopt);\r\n\t\t\tcanvas.toBlob(\r\n\t\t\t\tfunction(blob) {\r\n\t\t\t\t\tcallback(blob);\r\n\t\t\t\t\tif (!!canvas.parentNode) {\r\n\t\t\t\t\t\tcanvas.parentNode.removeChild(canvas);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\timageopt.mimetype,\r\n\t\t\t\timageopt.quality\r\n\t\t\t);\r\n\t\t},\r\n\t\ttoBuffer: function(type, quality, option) {\r\n\t\t\tvar imageopt = parseImageOption(type, quality, option);\r\n\t\t\tvar canvas = getLocalCanvas(this, imageopt);\r\n\t\t\tvar data = canvas.toBuffer(imageopt.mimetype, imageopt.quality);\r\n\t\t\tif (!!canvas.parentNode) {\r\n\t\t\t\tcanvas.parentNode.removeChild(canvas);\r\n\t\t\t}\r\n\t\t\treturn data;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// owner.getURL()      URLを取得する\r\n\t\t// owner.getFileData() ファイルデータを取得する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetURL: function(type, mode) {\r\n\t\t\treturn new this.klass.Encode().encodeURL(type, mode);\r\n\t\t},\r\n\t\tgetFileData: function(type, option) {\r\n\t\t\treturn new this.klass.FileIO().fileencode(type, option);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// owner.resetTime()      開始時間をリセットする\r\n\t\t// owner.getTime()        開始からの時間をミリ秒単位で取得する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tresetTime: function() {\r\n\t\t\tthis.starttime = pzpr.util.currentTime();\r\n\t\t},\r\n\t\tgetTime: function() {\r\n\t\t\treturn pzpr.util.currentTime() - this.starttime;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// owner.undo()  Undoを実行する\r\n\t\t// owner.redo()  Redoを実行する\r\n\t\t// owner.undoall()  Undoを最後まで実行する\r\n\t\t// owner.redoall()  Redoを最後まで実行する\r\n\t\t// owner.isModified() ファイルに保存されていない操作がある時にtrueを返す\r\n\t\t// owner.saved()      ismodifiedで返す値をfalseに戻す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tundo: function() {\r\n\t\t\treturn this.opemgr.undo();\r\n\t\t},\r\n\t\tredo: function() {\r\n\t\t\treturn this.opemgr.redo();\r\n\t\t},\r\n\t\tundoall: function() {\r\n\t\t\twhile (this.opemgr.undo()) {}\r\n\t\t},\r\n\t\tredoall: function() {\r\n\t\t\twhile (this.opemgr.redo()) {}\r\n\t\t},\r\n\t\tismodified: function() {\r\n\t\t\treturn this.opemgr.isModified();\r\n\t\t},\r\n\t\tsaved: function() {\r\n\t\t\treturn this.opemgr.resetModifiedState();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// puzzle.enterTrial()      TrialModeに設定する (多重設定可能)\r\n\t\t// puzzle.acceptTrial()     TrialModeを確定する\r\n\t\t// puzzle.rejectTrial()     TrialModeの履歴をすべて破棄する\r\n\t\t// puzzle.rejectCurrentTrial() TrialModeの現在の履歴を破棄して一つ前のTrial mode stageに戻る\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tenterTrial: function() {\r\n\t\t\tthis.opemgr.enterTrial();\r\n\t\t},\r\n\t\tacceptTrial: function() {\r\n\t\t\tthis.opemgr.acceptTrial();\r\n\t\t},\r\n\t\trejectTrial: function() {\r\n\t\t\tthis.opemgr.rejectTrial(true);\r\n\t\t},\r\n\t\trejectCurrentTrial: function() {\r\n\t\t\tthis.opemgr.rejectTrial(false);\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t// owner.check()          正答判定処理を行う\r\n\t\t//------------------------------------------------------------------------------\r\n\t\tcheck: function(activemode) {\r\n\t\t\tif (!!activemode) {\r\n\t\t\t\tthis.key.keyreset();\r\n\t\t\t\tthis.mouse.mousereset();\r\n\t\t\t}\r\n\t\t\treturn this.checker.check(activemode);\r\n\t\t},\r\n\t\tchecknw: function(activemode) {\r\n\t\t\tif (!!activemode) {\r\n\t\t\t\tthis.key.keyreset();\r\n\t\t\t\tthis.mouse.mousereset();\r\n\t\t\t}\r\n\t\t\treturn this.checker.checknw(activemode);\r\n\t\t},\r\n\t\tcheckne: function(activemode) {\r\n\t\t\tif (!!activemode) {\r\n\t\t\t\tthis.key.keyreset();\r\n\t\t\t\tthis.mouse.mousereset();\r\n\t\t\t}\r\n\t\t\treturn this.checker.checkne(activemode);\r\n\t\t},\r\n\t\tchecksw: function(activemode) {\r\n\t\t\tif (!!activemode) {\r\n\t\t\t\tthis.key.keyreset();\r\n\t\t\t\tthis.mouse.mousereset();\r\n\t\t\t}\r\n\t\t\treturn this.checker.checksw(activemode);\r\n\t\t},\r\n\t\tcheckse: function(activemode) {\r\n\t\t\tif (!!activemode) {\r\n\t\t\t\tthis.key.keyreset();\r\n\t\t\t\tthis.mouse.mousereset();\r\n\t\t\t}\r\n\t\t\treturn this.checker.checkse(activemode);\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t// owner.ansclear()       回答を消去する\r\n\t\t// owner.subclear()       補助記号を消去する\r\n\t\t// owner.errclear()       エラー表示を消去する\r\n\t\t// owner.clear()          回答・履歴を消去する\r\n\t\t//------------------------------------------------------------------------------\r\n\t\tansclear: function() {\r\n\t\t\tthis.board.ansclear();\r\n\t\t\tthis.board.rebuildInfo();\r\n\t\t\tthis.redraw();\r\n\t\t},\r\n\t\tsubclear: function() {\r\n\t\t\tthis.board.subclear();\r\n\t\t\tthis.redraw();\r\n\t\t},\r\n\t\terrclear: function() {\r\n\t\t\tvar isclear = this.board.errclear();\r\n\t\t\tif (isclear) {\r\n\t\t\t\tthis.redraw(true); /* 描画キャッシュを破棄して描画し直す */\r\n\t\t\t}\r\n\t\t\treturn isclear;\r\n\t\t},\r\n\t\tclear: function() {\r\n\t\t\tif (this.playeronly) {\r\n\t\t\t\tthis.ansclear();\r\n\t\t\t\tthis.opemgr.allerase();\r\n\t\t\t} else {\r\n\t\t\t\tthis.board.initBoardSize();\r\n\t\t\t\tthis.redraw();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t// owner.setMode() モード変更時の処理を行う\r\n\t\t//------------------------------------------------------------------------------\r\n\t\tsetMode: function(newval) {\r\n\t\t\tif (this.playeronly) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (typeof newval === \"string\") {\r\n\t\t\t\tnewval = { edit: 1, play: 3 }[newval.substr(0, 4)];\r\n\t\t\t\tif (newval === void 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.editmode = newval === this.MODE_EDITOR;\r\n\t\t\tthis.playmode = !this.editmode;\r\n\r\n\t\t\tif (!!this.klass) {\r\n\t\t\t\tthis.cursor.adjust_modechange();\r\n\t\t\t\tthis.key.keyreset();\r\n\t\t\t\tthis.mouse.modechange();\r\n\t\t\t\tthis.board.errclear();\r\n\t\t\t\tthis.redraw();\r\n\t\t\t}\r\n\r\n\t\t\tthis.emit(\"config\", \"mode\", newval);\r\n\t\t\tthis.emit(\"mode\");\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t// owner.getConfig()  設定値の取得を行う\r\n\t\t// owner.setConfig()  設定値の設定を行う\r\n\t\t// owner.resetConfig()設定値を初期値に戻す\r\n\t\t// owner.validConfig() 設定値が現在のパズルで有効な設定値かどうか返す\r\n\t\t// owner.execConfig() 設定値と、パズルごとに有効かどうかの条件をANDして返す\r\n\t\t//------------------------------------------------------------------------------\r\n\t\tgetConfig: function(idname) {\r\n\t\t\treturn this.config.get(idname);\r\n\t\t},\r\n\t\tsetConfig: function(idname, val) {\r\n\t\t\treturn this.config.set(idname, val);\r\n\t\t},\r\n\t\tresetConfig: function(idname) {\r\n\t\t\treturn this.config.reset(idname);\r\n\t\t},\r\n\t\tvalidConfig: function(idname) {\r\n\t\t\treturn this.config.getexec(idname);\r\n\t\t},\r\n\t\texecConfig: function(idname) {\r\n\t\t\treturn this.config.get(idname) && this.config.getexec(idname);\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t// owner.getCurrentConfig() 現在有効な設定と設定値を返す\r\n\t\t// owner.saveConfig()     設定値の保存を行う\r\n\t\t// owner.restoreConfig()  設定値の復帰を行う\r\n\t\t//------------------------------------------------------------------------------\r\n\t\tgetCurrentConfig: function() {\r\n\t\t\treturn this.config.getList();\r\n\t\t},\r\n\t\tsaveConfig: function() {\r\n\t\t\treturn this.config.getAll();\r\n\t\t},\r\n\t\trestoreConfig: function(obj) {\r\n\t\t\tthis.config.setAll(obj);\r\n\t\t}\r\n\t};\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t//  openExecute()      各オブジェクトの生成などの処理\r\n\t//---------------------------------------------------------------------------\r\n\tfunction openExecute(puzzle, data, variety, callback) {\r\n\t\tif (typeof variety !== \"string\" && !callback) {\r\n\t\t\tcallback = variety;\r\n\t\t\tvariety = void 0;\r\n\t\t}\r\n\r\n\t\tpuzzle.ready = false;\r\n\r\n\t\tvar classes = puzzle.klass;\r\n\t\tvar Board = !!classes && !!classes.Board ? classes.Board : null;\r\n\t\tvar pzl = pzpr.parser(data, variety || puzzle.pid);\r\n\r\n\t\tpzpr.classmgr.setPuzzleClass(puzzle, pzl.pid, function() {\r\n\t\t\t/* パズルの種類が変わっていればオブジェクトを設定しなおす */\r\n\t\t\tif (Board !== puzzle.klass.Board) {\r\n\t\t\t\tinitObjects(puzzle);\r\n\t\t\t} else {\r\n\t\t\t\tpuzzle.painter.suspendAll();\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\tpuzzle.metadata.reset();\r\n\t\t\t\tif (pzl.isurl) {\r\n\t\t\t\t\tnew puzzle.klass.Encode().decodeURL(pzl);\r\n\t\t\t\t} else if (pzl.isfile) {\r\n\t\t\t\t\tnew puzzle.klass.FileIO().filedecode(pzl);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tpuzzle.ready = true;\r\n\t\t\t\tpuzzle.emit(\"ready\");\r\n\t\t\t\tpuzzle.emit(\"mode\");\r\n\r\n\t\t\t\tif (!!puzzle.canvas) {\r\n\t\t\t\t\tpostCanvasReady(puzzle);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tpuzzle.resetTime();\r\n\r\n\t\t\t\tif (!!callback) {\r\n\t\t\t\t\tcallback(puzzle);\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tpuzzle.emit(\"fail-open\");\r\n\t\t\t\tthrow e;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t//  initObjects()      各オブジェクトの生成などの処理\r\n\t//---------------------------------------------------------------------------\r\n\tfunction initObjects(puzzle) {\r\n\t\tvar classes = puzzle.klass;\r\n\r\n\t\t// クラス初期化\r\n\t\tpuzzle.board = new classes.Board(); // 盤面オブジェクト\r\n\t\tpzpr.classmgr.setPrototypeRef(puzzle, \"board\", puzzle.board);\r\n\r\n\t\tpuzzle.checker = new classes.AnsCheck(); // 正解判定オブジェクト\r\n\t\tpuzzle.painter = new classes.Graphic(); // 描画系オブジェクト\r\n\r\n\t\tpuzzle.cursor = new classes.TargetCursor(); // 入力用カーソルオブジェクト\r\n\t\tpuzzle.mouse = new classes.MouseEvent(); // マウス入力オブジェクト\r\n\t\tpuzzle.key = new classes.KeyEvent(); // キーボード入力オブジェクト\r\n\r\n\t\tpuzzle.opemgr = new classes.OperationManager(); // 操作情報管理オブジェクト\r\n\r\n\t\tpuzzle.faillist = new classes.FailCode(); // 正答判定文字列を保持するオブジェクト\r\n\t}\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t//  setCanvas_main()  描画キャンバスをセットする\r\n\t//  createSubCanvas() 補助キャンバスを作成する\r\n\t//---------------------------------------------------------------------------\r\n\tfunction setCanvas_main(puzzle, type) {\r\n\t\t/* fillTextが使えない場合は強制的にSVG描画に変更する */\r\n\t\tif (\r\n\t\t\ttype === \"canvas\" &&\r\n\t\t\t!!pzpr.Candle.enable.canvas &&\r\n\t\t\t!CanvasRenderingContext2D.prototype.fillText\r\n\t\t) {\r\n\t\t\ttype = \"svg\";\r\n\t\t}\r\n\r\n\t\tpzpr.Candle.start(puzzle.canvas, type, function(g) {\r\n\t\t\tpzpr.util.unselectable(g.canvas);\r\n\t\t\tg.child.style.pointerEvents = \"none\";\r\n\t\t\tif (g.use.canvas && !puzzle.subcanvas) {\r\n\t\t\t\tvar canvas = (puzzle.subcanvas = createSubCanvas(\"canvas\"));\r\n\t\t\t\tif (!!document.body) {\r\n\t\t\t\t\tcanvas.id =\r\n\t\t\t\t\t\t\"_\" + new Date().getTime() + type; /* 何か他とかぶらないようなID */\r\n\t\t\t\t\tcanvas.style.position = \"absolute\";\r\n\t\t\t\t\tcanvas.style.left = \"-10000px\";\r\n\t\t\t\t\tcanvas.style.top = \"0px\";\r\n\t\t\t\t\tdocument.body.appendChild(canvas);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (puzzle.ready) {\r\n\t\t\t\tpostCanvasReady(puzzle);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tfunction createSubCanvas(type) {\r\n\t\tif (!pzpr.Candle.enable[type]) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar el = document.createElement(\"div\");\r\n\t\tpzpr.Candle.start(el, type);\r\n\t\treturn el;\r\n\t}\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t//  postCanvasReady()  Canvas設定＆ready後の初期化処理を行う\r\n\t//---------------------------------------------------------------------------\r\n\tfunction postCanvasReady(puzzle) {\r\n\t\tvar pc = puzzle.painter,\r\n\t\t\topt = puzzle.preInitCanvasInfo;\r\n\r\n\t\tif (puzzle.preInitCanvasInfo) {\r\n\t\t\tif (puzzle.instancetype !== \"viewer\") {\r\n\t\t\t\tsetCanvasEvents(puzzle);\r\n\t\t\t} else {\r\n\t\t\t\tpc.outputImage = true;\r\n\t\t\t}\r\n\t\t\tif (!pc.canvasWidth || !pc.canvasHeight) {\r\n\t\t\t\tif (!!opt.width && !!opt.height) {\r\n\t\t\t\t\tpc.resizeCanvas(opt.width, opt.height);\r\n\t\t\t\t} else if (!!opt.cellsize) {\r\n\t\t\t\t\tpc.resizeCanvasByCellSize(opt.cellsize);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdelete puzzle.preInitCanvasInfo;\r\n\t\t}\r\n\r\n\t\tpc.initCanvas();\r\n\t}\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t//  setCanvasEvents() マウス入力に関するイベントを設定する\r\n\t//  exec????()        マウス入力へ分岐する(puzzle.mouseが不変でないためバイパスする)\r\n\t//---------------------------------------------------------------------------\r\n\tfunction setCanvasEvents(puzzle) {\r\n\t\tfunction ae(type, func) {\r\n\t\t\tpzpr.util.addEvent(puzzle.canvas, type, puzzle, func);\r\n\t\t}\r\n\r\n\t\t// マウス入力イベントの設定\r\n\t\tae(\"mousedown\", execMouseDown);\r\n\t\tae(\"mousemove\", execMouseMove);\r\n\t\tae(\"mouseup\", execMouseUp);\r\n\t\tae(\"mousecancel\", execMouseCancel);\r\n\t\tpuzzle.canvas.oncontextmenu = function() {\r\n\t\t\treturn false;\r\n\t\t};\r\n\t\tpuzzle.canvas.style.touchAction = \"pinch-zoom\";\r\n\r\n\t\t// キー入力イベントの設定\r\n\t\tae(\"keydown\", execKeyDown);\r\n\t\tae(\"keyup\", execKeyUp);\r\n\r\n\t\tae(\"click\", function(e) {\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t});\r\n\t}\r\n\tfunction execMouseDown(e) {\r\n\t\tif (!!this.mouse) {\r\n\t\t\tthis.mouse.e_mousedown(e);\r\n\t\t}\r\n\t}\r\n\tfunction execMouseMove(e) {\r\n\t\tif (!!this.mouse) {\r\n\t\t\tthis.mouse.e_mousemove(e);\r\n\t\t}\r\n\t}\r\n\tfunction execMouseUp(e) {\r\n\t\tif (!!this.mouse) {\r\n\t\t\tthis.mouse.e_mouseup(e);\r\n\t\t}\r\n\t}\r\n\tfunction execMouseCancel(e) {\r\n\t\tif (!!this.mouse) {\r\n\t\t\tthis.mouse.e_mousecancel(e);\r\n\t\t}\r\n\t}\r\n\tfunction execKeyDown(e) {\r\n\t\tif (!!this.key) {\r\n\t\t\tthis.key.e_keydown(e);\r\n\t\t}\r\n\t}\r\n\tfunction execKeyUp(e) {\r\n\t\tif (!!this.key) {\r\n\t\t\tthis.key.e_keyup(e);\r\n\t\t}\r\n\t}\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t//  generateLocalCanvas()  toDataURL, toBlobの共通処理\r\n\t//---------------------------------------------------------------------------\r\n\tfunction getLocalCanvas(puzzle, imageopt) {\r\n\t\tvar imgcanvas = createSubCanvas(imageopt.type);\r\n\r\n\t\tvar pc2 = new puzzle.klass.Graphic();\r\n\t\tpc2.context = imgcanvas.getContext(\"2d\");\r\n\t\tpc2.context.enableTextLengthWA = false;\r\n\t\tpc2.outputImage = true; /* 一部画像出力時に描画しないオブジェクトがあるパズル向け設定 */\r\n\t\tif (\"bgcolor\" in imageopt) {\r\n\t\t\tpc2.bgcolor = imageopt.bgcolor;\r\n\t\t}\r\n\t\tif (puzzle.pid === \"kramma\") {\r\n\t\t\tpc2.imgtile = puzzle.painter.imgtile;\r\n\t\t}\r\n\r\n\t\t// canvasの設定を適用して、再描画\r\n\t\tpc2.resizeCanvasByCellSize(imageopt.cellsize);\r\n\t\tpc2.unsuspend();\r\n\r\n\t\treturn imgcanvas;\r\n\t}\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t//  generateLocalCanvas()  toDataURL, toBlobの入力オプション解析処理\r\n\t//---------------------------------------------------------------------------\r\n\tfunction parseImageOption() {\r\n\t\t// (type,quality,option)のはず\r\n\t\tvar imageopt = {};\r\n\t\tvar type = pzpr.Candle.current;\r\n\t\tvar cellsize = null,\r\n\t\t\tbgcolor = null,\r\n\t\t\tquality = null;\r\n\t\tfor (var i = 0; i < arguments.length; i++) {\r\n\t\t\tvar argv = arguments[i];\r\n\t\t\tswitch (typeof argv) {\r\n\t\t\t\tcase \"string\":\r\n\t\t\t\t\ttype = argv;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"number\":\r\n\t\t\t\t\tif (argv > 1.01) {\r\n\t\t\t\t\t\tcellsize = argv;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tquality = argv;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"object\":\r\n\t\t\t\t\tif (\"cellsize\" in argv) {\r\n\t\t\t\t\t\tcellsize = argv.cellsize;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (\"bgcolor\" in argv) {\r\n\t\t\t\t\t\tbgcolor = argv.bgcolor;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\timageopt.type = (type || pzpr.Candle.current).match(/svg/)\r\n\t\t\t? \"svg\"\r\n\t\t\t: \"canvas\";\r\n\t\timageopt.mimetype =\r\n\t\t\timageopt.type !== \"svg\" ? \"image/\" + type : \"image/svg+xml\";\r\n\t\tif (quality !== null && quality !== void 0) {\r\n\t\t\timageopt.quality = quality;\r\n\t\t}\r\n\r\n\t\tif (cellsize !== null) {\r\n\t\t\timageopt.cellsize = cellsize;\r\n\t\t}\r\n\t\tif (bgcolor !== null) {\r\n\t\t\timageopt.bgcolor = bgcolor;\r\n\t\t}\r\n\r\n\t\treturn imageopt;\r\n\t}\r\n})();\r\n","// Config.js v3.4.1\r\n\r\n(function() {\r\n\t//---------------------------------------------------------------------------\r\n\t// ★Configクラス 設定値の値などを保持する\r\n\t//---------------------------------------------------------------------------\r\n\tvar Config = (pzpr.Puzzle.prototype.Config = function(puzzle) {\r\n\t\tthis.puzzle = puzzle;\r\n\t\tthis.init();\r\n\t});\r\n\tConfig.prototype = {\r\n\t\tlist: null /* 設定値 */,\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// config.init()        各設定値を初期化する\r\n\t\t// config.add()         初期化時に設定を追加する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinit: function() {\r\n\t\t\tthis.list = {};\r\n\r\n\t\t\t/* 盤面表示設定 */\r\n\t\t\tthis.add(\"font\", 1, {\r\n\t\t\t\toption: [1, 2]\r\n\t\t\t}); /* 文字の描画 1:ゴシック 2:明朝 */\r\n\t\t\tthis.add(\"cursor\", true); /* カーソルの表示 */\r\n\t\t\tthis.add(\"trialmarker\", true); /* show trial marker */\r\n\t\t\tthis.add(\"irowake\", false, { variety: true }); /* 線の色分け */\r\n\t\t\tthis.add(\"irowakeblk\", false, { variety: true }); /* 黒マスの色分け */\r\n\r\n\t\t\tthis.add(\"dispmove\", true); /* 線で動かすパズルで実際に動いたように描画 */\r\n\t\t\tthis.add(\"disptype_yajilin\", 1, {\r\n\t\t\t\toption: [1, 2]\r\n\t\t\t}); /* yajilin: 表示形式 */\r\n\t\t\tthis.add(\"disptype_bosanowa\", 1, {\r\n\t\t\t\toption: [1, 2, 3]\r\n\t\t\t}); /* bosanowa: 表示形式 */\r\n\t\t\tthis.add(\"disptype_interbd\", 3, {\r\n\t\t\t\toption: [1, 2, 3]\r\n\t\t\t}); /* interbd: Clue display mode */\r\n\t\t\tthis.add(\"snakebd\", false); /* hebi: へびの境界線を表示する */\r\n\t\t\tthis.add(\"dispqnumbg\", false); /* yinyang: 問題のまるに背景色をつける */\r\n\t\t\tthis.add(\"undefcell\", true); /* shugaku: 未確定マスはグレー表示にする */\r\n\r\n\t\t\tthis.add(\"squarecell\", true); /* セルは正方形にする */\r\n\r\n\t\t\t/* 入力方法設定 */\r\n\t\t\tthis.add(\"use\", !pzpr.env.API.touchevent ? 1 : 2, {\r\n\t\t\t\toption: [1, 2]\r\n\t\t\t}); /* 黒マスの入力方法 */\r\n\t\t\tthis.add(\"use_tri\", 1, {\r\n\t\t\t\toption: [1, 2, 3]\r\n\t\t\t}); /* shakashaka: 三角形の入力方法 */\r\n\t\t\tthis.add(\r\n\t\t\t\t\"support_tri\",\r\n\t\t\t\ttrue\r\n\t\t\t); /* shakashaka: 三角形の入力補助 (for 2つ以上の壁に接したCell) */\r\n\r\n\t\t\tthis.add(\"bgcolor\", false); /* slither 背景色入力 */\r\n\t\t\tthis.add(\r\n\t\t\t\t\"singlenum\",\r\n\t\t\t\t!pzpr.env.API.touchevent\r\n\t\t\t); /* hanare: 部屋に回答数字を一つだけ入力 */\r\n\t\t\tthis.add(\"enline\", true); /* kouchoku: 線は点の間のみ引ける */\r\n\t\t\tthis.add(\"lattice\", true); /* kouchoku: 格子点チェック */\r\n\r\n\t\t\t/* 回答お助け機能 */\r\n\t\t\tthis.add(\"autocmp\", true, {\r\n\t\t\t\tvariety: true\r\n\t\t\t}); /* 数字 or kouchokuの正解の点をグレーにする */\r\n\t\t\tthis.add(\"autoerr\", false, {\r\n\t\t\t\tvariety: true\r\n\t\t\t}); /* hitori:ひとくれの重複した数字を表示, gokigen,wagiri:斜線の色分け */\r\n\r\n\t\t\t/* 正解判定 */\r\n\t\t\tthis.add(\"multierr\", false); /* エラー判定で複数エラーを出力する */\r\n\t\t\tthis.add(\r\n\t\t\t\t\"forceallcell\",\r\n\t\t\t\tfalse\r\n\t\t\t); /* fillomino: すべての数字が入っている時のみ正解とする */\r\n\r\n\t\t\t/* puzzle variant rules; must defaut to false */\r\n\t\t\tthis.add(\"dontpassallcell\", false, {\r\n\t\t\t\tvariant: true,\r\n\t\t\t\tvolatile: true\r\n\t\t\t}); /* arukone: don't require passing all cells */\r\n\t\t\tthis.add(\"aquarium_regions\", false, {\r\n\t\t\t\tvariant: true,\r\n\t\t\t\tvolatile: true\r\n\t\t\t}); /* aquarium: Rule variation for disconnected cells in one region */\r\n\t\t\tthis.add(\"country_empty\", false, { variant: true, volatile: true });\r\n\t\t\t/* generic variant */\r\n\t\t\tthis.add(\"variant\", false, { variant: true, volatile: true });\r\n\t\t\tthis.add(\"variantid\", \"\", { volatile: true });\r\n\r\n\t\t\t/* EDITORのみ */\r\n\t\t\tthis.add(\"discolor\", false); /* tentaisho: 色分け無効化 */\r\n\t\t\t/* その他の特殊項目(保存なし) */\r\n\t\t\tthis.add(\"uramashu\", false, { volatile: true }); /* 裏ましゅにする */\r\n\t\t},\r\n\t\tadd: function(name, defvalue, extoption) {\r\n\t\t\tif (!extoption) {\r\n\t\t\t\textoption = {};\r\n\t\t\t}\r\n\t\t\tvar item = {\r\n\t\t\t\tval: defvalue,\r\n\t\t\t\tdefval: defvalue,\r\n\t\t\t\tvolatile: !!extoption.volatile,\r\n\t\t\t\textoption: extoption // stored for the benefit of ui.MenuConfig\r\n\t\t\t};\r\n\t\t\tif (!!extoption.option) {\r\n\t\t\t\titem.option = extoption.option;\r\n\t\t\t}\r\n\t\t\tif (!!extoption.variety) {\r\n\t\t\t\titem.variety = {};\r\n\t\t\t}\r\n\t\t\tif (!!extoption.variant) {\r\n\t\t\t\titem.variant = true;\r\n\t\t\t}\r\n\t\t\tthis.list[name] = item;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// config.getCurrentName() 以前のconfig名から現在使用している名称を取得する\r\n\t\t// config.getNormalizedName() Config名が@付きだった場合varietyのpidを返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetCurrentName: function(name) {\r\n\t\t\tswitch (name) {\r\n\t\t\t\tcase \"color_qanscolor\":\r\n\t\t\t\t\tname = \"color_shadecolor\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"autocmp_area\":\r\n\t\t\t\t\tif (this.getexec(\"autocmp\")) {\r\n\t\t\t\t\t\tname = \"autocmp\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"autocmp_border\":\r\n\t\t\t\t\tif (this.getexec(\"autocmp\")) {\r\n\t\t\t\t\t\tname = \"autocmp\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\treturn name;\r\n\t\t},\r\n\t\tgetNormalizedName: function(argname) {\r\n\t\t\tvar info = { name: argname };\r\n\t\t\tif (argname.match(/\\@/)) {\r\n\t\t\t\tvar splitted = argname.split(/\\@/);\r\n\t\t\t\tinfo.name = splitted[0];\r\n\t\t\t\tvar pid = pzpr.variety.toPID(splitted[1]);\r\n\t\t\t\tif (!!pid) {\r\n\t\t\t\t\tinfo.pid = pid;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tinfo.name = this.getCurrentName(info.name);\r\n\t\t\treturn info;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// config.get()  各フラグの設定値を返す\r\n\t\t// config.set()  各フラグの設定値を設定する\r\n\t\t// config.reset()各フラグの設定値を初期値に戻す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tget: function(argname) {\r\n\t\t\tvar names = this.getNormalizedName(argname),\r\n\t\t\t\tname = names.name;\r\n\t\t\tvar item = this.list[name];\r\n\t\t\tif (!item) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tif (!!item.variety) {\r\n\t\t\t\tvar pid = names.pid !== void 0 ? names.pid : this.puzzle.pid;\r\n\t\t\t\tif (item.variety[pid] !== void 0) {\r\n\t\t\t\t\treturn item.variety[pid];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn item.val;\r\n\t\t},\r\n\t\tset: function(argname, newval) {\r\n\t\t\tvar names = this.getNormalizedName(argname),\r\n\t\t\t\tname = names.name;\r\n\t\t\tif (!this.list[name]) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tnewval = this.setproper(names, newval);\r\n\t\t\tthis.configevent(name, newval);\r\n\t\t\tthis.puzzle.emit(\"config\", name, newval);\r\n\t\t},\r\n\t\treset: function(argname) {\r\n\t\t\tvar names = this.getNormalizedName(argname);\r\n\t\t\tvar item = this.list[names.name];\r\n\t\t\tif (!item) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!!item.variety && !names.pid) {\r\n\t\t\t\titem.variety = {};\r\n\t\t\t\tthis.set(names.name, item.defval);\r\n\t\t\t} else {\r\n\t\t\t\tthis.set(argname, item.defval);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// config.getList()  現在有効な設定値のリストを返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetList: function() {\r\n\t\t\tvar conf = {};\r\n\t\t\tfor (var idname in this.list) {\r\n\t\t\t\tif (this.getexec(idname)) {\r\n\t\t\t\t\tconf[idname] = this.get(idname);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn conf;\r\n\t\t},\r\n\r\n\t\tgetvariant: function(name) {\r\n\t\t\tvar item = this.list[name];\r\n\t\t\tif (!item) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\treturn item.variant;\r\n\t\t},\r\n\t\tgetVariants: function() {\r\n\t\t\tvar conf = {};\r\n\t\t\tfor (var key in this.list) {\r\n\t\t\t\tvar item = this.list[key];\r\n\t\t\t\tif (!item.variant) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.getexec(key)) {\r\n\t\t\t\t\tconf[key] = this.get(key);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn conf;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// config.getAll()  全フラグの設定値を返す\r\n\t\t// config.setAll()  全フラグの設定値を設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetAll: function() {\r\n\t\t\tvar object = {};\r\n\t\t\tfor (var key in this.list) {\r\n\t\t\t\tvar item = this.list[key];\r\n\t\t\t\tif (item.volatile) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (item.val !== item.defval) {\r\n\t\t\t\t\tobject[key] = item.val;\r\n\t\t\t\t}\r\n\t\t\t\tif (!item.variety) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tfor (var pid in item.variety) {\r\n\t\t\t\t\tif (item.variety[pid] !== item.defval) {\r\n\t\t\t\t\t\tobject[key + \"@\" + pid] = item.variety[pid];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn object;\r\n\t\t},\r\n\t\tsetAll: function(settings) {\r\n\t\t\tthis.init();\r\n\t\t\tfor (var key in settings) {\r\n\t\t\t\tthis.set(key, settings[key]);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// config.setproper()    設定値の型を正しいものに変換して設定変更する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetproper: function(names, newval) {\r\n\t\t\tvar name = names.name;\r\n\t\t\tvar item = this.list[name];\r\n\t\t\tswitch (typeof item.defval) {\r\n\t\t\t\tcase \"boolean\":\r\n\t\t\t\t\tnewval = !!newval;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"number\":\r\n\t\t\t\t\tnewval = +newval;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"string\":\r\n\t\t\t\t\tnewval = \"\" + newval;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif (!item.option || item.option.indexOf(newval) >= 0) {\r\n\t\t\t\tif (!!item.variety) {\r\n\t\t\t\t\tvar pid = names.pid !== void 0 ? names.pid : this.puzzle.pid;\r\n\t\t\t\t\tif (!!pid) {\r\n\t\t\t\t\t\titem.variety[pid] = newval;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\titem.val = newval;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn newval;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// config.getexec()  設定値を現在のパズルで有効かどうか返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetexec: function(name) {\r\n\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\tpid = puzzle.pid,\r\n\t\t\t\tEDITOR = !puzzle.playeronly,\r\n\t\t\t\texec = false;\r\n\t\t\tswitch (name) {\r\n\t\t\t\tcase \"use\":\r\n\t\t\t\t\texec = puzzle.mouse.use;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"use_tri\":\r\n\t\t\t\t\texec = pid === \"shakashaka\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"support_tri\":\r\n\t\t\t\t\texec = pid === \"shakashaka\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"dispmove\":\r\n\t\t\t\t\texec = puzzle.board.linegraph.moveline;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"disptype_bosanowa\":\r\n\t\t\t\t\texec = pid === \"bosanowa\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"disptype_yajilin\":\r\n\t\t\t\t\texec = pid === \"yajilin\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"disptype_interbd\":\r\n\t\t\t\t\texec = pid === \"interbd\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"bgcolor\":\r\n\t\t\t\t\texec = pid === \"slither\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"irowake\":\r\n\t\t\t\t\texec = puzzle.painter.irowake;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"irowakeblk\":\r\n\t\t\t\t\texec = puzzle.painter.irowakeblk;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"snakebd\":\r\n\t\t\t\t\texec = pid === \"hebi\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"dispqnumbg\":\r\n\t\t\t\t\texec = pid === \"yinyang\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"undefcell\":\r\n\t\t\t\t\texec = pid === \"shugaku\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"autocmp\":\r\n\t\t\t\t\texec = !!puzzle.painter.autocmp;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"autoerr\":\r\n\t\t\t\t\texec = pid === \"hitori\" || pid === \"gokigen\" || pid === \"wagiri\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"singlenum\":\r\n\t\t\t\t\texec = pid === \"hanare\" || pid === \"putteria\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"enline\":\r\n\t\t\t\tcase \"lattice\":\r\n\t\t\t\t\texec = pid === \"kouchoku\" || pid === \"angleloop\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"discolor\":\r\n\t\t\t\t\texec = EDITOR && pid === \"tentaisho\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"uramashu\":\r\n\t\t\t\t\texec = pid === \"mashu\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"forceallcell\":\r\n\t\t\t\t\texec = pid === \"fillomino\" || pid === \"symmarea\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"dontpassallcell\":\r\n\t\t\t\t\texec = pid === \"arukone\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"aquarium_regions\":\r\n\t\t\t\t\texec = pid === \"aquarium\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"country_empty\":\r\n\t\t\t\t\texec = pid === \"country\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\texec = !!this.list[name];\r\n\t\t\t}\r\n\t\t\treturn exec;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// config.configevent()  設定変更時の動作を記述する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tconfigevent: function(name, newval) {\r\n\t\t\tvar puzzle = this.puzzle;\r\n\t\t\tif (!puzzle.klass || !this.getexec(name)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tswitch (name) {\r\n\t\t\t\tcase \"irowake\":\r\n\t\t\t\tcase \"irowakeblk\":\r\n\t\t\t\tcase \"dispmove\":\r\n\t\t\t\tcase \"cursor\":\r\n\t\t\t\tcase \"trialmarker\":\r\n\t\t\t\tcase \"undefcell\":\r\n\t\t\t\tcase \"autocmp\":\r\n\t\t\t\tcase \"autoerr\":\r\n\t\t\t\tcase \"aquarium_regions\":\r\n\t\t\t\tcase \"snakebd\":\r\n\t\t\t\tcase \"disptype_yajilin\":\r\n\t\t\t\tcase \"disptype_interbd\":\r\n\t\t\t\tcase \"dispqnumbg\":\r\n\t\t\t\t\tpuzzle.redraw();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"font\":\r\n\t\t\t\t\tpuzzle.painter.initFont();\r\n\t\t\t\t\tpuzzle.redraw();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"multierr\":\r\n\t\t\t\t\tpuzzle.checker.resetCache();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"disptype_bosanowa\":\r\n\t\t\t\t\tpuzzle.setCanvasSizeByCellSize(); /* セルのサイズを変えないために、この関数を引数なしで呼び出す */\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"uramashu\":\r\n\t\t\t\t\tpuzzle.board.revCircleConfig(newval);\r\n\t\t\t\t\tpuzzle.redraw();\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n})();\r\n","// Address.js v3.4.1\r\n\r\npzpr.classmgr.makeCommon({\r\n\t//----------------------------------------------------------------------------\r\n\t// ★Positionクラス Address, Pieceクラスのベースクラス\r\n\t//---------------------------------------------------------------------------\r\n\tPosition: {\r\n\t\tbx: null,\r\n\t\tby: null,\r\n\r\n\t\t// 方向を表す定数\r\n\t\tNDIR: 0, // 方向なし\r\n\t\tUP: 1, // up, top\r\n\t\tDN: 2, // down, bottom\r\n\t\tLT: 3, // left\r\n\t\tRT: 4, // right\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pos.equals() 同じ位置にあるかどうか判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tequals: function(pos) {\r\n\t\t\treturn this.bx === pos.bx && this.by === pos.by;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pos.getaddr() 位置をAddressクラスのオブジェクトで取得する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetaddr: function() {\r\n\t\t\treturn new this.klass.Address(this.bx, this.by);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// relcell(), relcross(), relbd(), relexcell(), relobj() 相対位置に存在するオブジェクトを返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\trelcell: function(dx, dy) {\r\n\t\t\treturn this.board.getc(this.bx + dx, this.by + dy);\r\n\t\t},\r\n\t\trelcross: function(dx, dy) {\r\n\t\t\treturn this.board.getx(this.bx + dx, this.by + dy);\r\n\t\t},\r\n\t\trelbd: function(dx, dy) {\r\n\t\t\treturn this.board.getb(this.bx + dx, this.by + dy);\r\n\t\t},\r\n\t\trelexcell: function(dx, dy) {\r\n\t\t\treturn this.board.getex(this.bx + dx, this.by + dy);\r\n\t\t},\r\n\t\trelobj: function(dx, dy) {\r\n\t\t\treturn this.board.getobj(this.bx + dx, this.by + dy);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// reldirbd()  指定された方向にいるオブジェクトを返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\treldirbd: function(dir, dd) {\r\n\t\t\treturn this.getaddr()\r\n\t\t\t\t.movedir(dir, dd)\r\n\t\t\t\t.getb();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pos.draw() 盤面に自分の周囲を描画する\r\n\t\t// pos.drawaround() 盤面に自分の周囲1マスを含めて描画する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdraw: function() {\r\n\t\t\tthis.puzzle.painter.paintRange(\r\n\t\t\t\tthis.bx - 1,\r\n\t\t\t\tthis.by - 1,\r\n\t\t\t\tthis.bx + 1,\r\n\t\t\t\tthis.by + 1\r\n\t\t\t);\r\n\t\t},\r\n\t\tdrawaround: function() {\r\n\t\t\tthis.puzzle.painter.paintRange(\r\n\t\t\t\tthis.bx - 3,\r\n\t\t\t\tthis.by - 3,\r\n\t\t\t\tthis.bx + 3,\r\n\t\t\t\tthis.by + 3\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pos.isinside() この場所が盤面内かどうか判断する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tisinside: function() {\r\n\t\t\tvar bd = this.board;\r\n\t\t\treturn (\r\n\t\t\t\tthis.bx >= bd.minbx &&\r\n\t\t\t\tthis.bx <= bd.maxbx &&\r\n\t\t\t\tthis.by >= bd.minby &&\r\n\t\t\t\tthis.by <= bd.maxby\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pos.getdir() 指定されたPositionがどの方向にいるか判定する\r\n\t\t// pos.getvert() 指定されたPositionが縦か横か判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetdir: function(pos, diff) {\r\n\t\t\tvar dx = pos.bx - this.bx,\r\n\t\t\t\tdy = pos.by - this.by;\r\n\t\t\tif (dx === 0 && dy === -diff) {\r\n\t\t\t\treturn this.UP;\r\n\t\t\t} else if (dx === 0 && dy === diff) {\r\n\t\t\t\treturn this.DN;\r\n\t\t\t} else if (dx === -diff && dy === 0) {\r\n\t\t\t\treturn this.LT;\r\n\t\t\t} else if (dx === diff && dy === 0) {\r\n\t\t\t\treturn this.RT;\r\n\t\t\t}\r\n\t\t\treturn this.NDIR;\r\n\t\t},\r\n\t\tgetvert: function(pos, diff) {\r\n\t\t\tvar dir = this.getdir(pos, diff);\r\n\t\t\tif (dir === this.UP || dir === this.DN) {\r\n\t\t\t\treturn true;\r\n\t\t\t} else if (dir === this.LT || dir === this.RT) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn void 0;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pos.getnb()         上下左右に隣接する境界線のIDを取得する\r\n\t\t// pos.getborderobj()  入力対象となる境界線オブジェクトを取得する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetnb: function(pos) {\r\n\t\t\tif (pos.bx - this.bx === 0 && pos.by - this.by === -2) {\r\n\t\t\t\treturn this.relbd(0, -1);\r\n\t\t\t} else if (pos.bx - this.bx === 0 && pos.by - this.by === 2) {\r\n\t\t\t\treturn this.relbd(0, 1);\r\n\t\t\t} else if (pos.bx - this.bx === -2 && pos.by - this.by === 0) {\r\n\t\t\t\treturn this.relbd(-1, 0);\r\n\t\t\t} else if (pos.bx - this.bx === 2 && pos.by - this.by === 0) {\r\n\t\t\t\treturn this.relbd(1, 0);\r\n\t\t\t}\r\n\t\t\treturn this.board.emptyborder;\r\n\t\t},\r\n\t\tgetborderobj: function(pos) {\r\n\t\t\tif (\r\n\t\t\t\t((pos.bx & 1) === 0 &&\r\n\t\t\t\t\tthis.bx === pos.bx &&\r\n\t\t\t\t\tMath.abs(this.by - pos.by) === 1) ||\r\n\t\t\t\t((pos.by & 1) === 0 &&\r\n\t\t\t\t\tthis.by === pos.by &&\r\n\t\t\t\t\tMath.abs(this.bx - pos.bx) === 1)\r\n\t\t\t) {\r\n\t\t\t\treturn (this.onborder() ? this : pos).getb();\r\n\t\t\t}\r\n\t\t\treturn this.board.nullobj;\r\n\t\t}\r\n\t},\r\n\r\n\t//----------------------------------------------------------------------------\r\n\t// ★Addressクラス (bx,by)座標を扱う\r\n\t//---------------------------------------------------------------------------\r\n\t\"Address:Position\": {\r\n\t\tinitialize: function(bx, by) {\r\n\t\t\tif (arguments.length >= 2) {\r\n\t\t\t\tthis.init(bx, by);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\treset: function() {\r\n\t\t\tthis.bx = null;\r\n\t\t\tthis.by = null;\r\n\t\t},\r\n\t\tclone: function() {\r\n\t\t\treturn new this.constructor(this.bx, this.by);\r\n\t\t},\r\n\r\n\t\tset: function(addr) {\r\n\t\t\tthis.bx = addr.bx;\r\n\t\t\tthis.by = addr.by;\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\tinit: function(bx, by) {\r\n\t\t\tthis.bx = bx;\r\n\t\t\tthis.by = by;\r\n\t\t\treturn this;\r\n\t\t},\r\n\t\tmove: function(dx, dy) {\r\n\t\t\tthis.bx += dx;\r\n\t\t\tthis.by += dy;\r\n\t\t\treturn this;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// oncell(), oncross(), onborder()  オブジェクトが存在する位置にいるかどうかを返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\toncell: function() {\r\n\t\t\treturn !!(this.bx & 1 && this.by & 1);\r\n\t\t},\r\n\t\toncross: function() {\r\n\t\t\treturn !!(!(this.bx & 1) && !(this.by & 1));\r\n\t\t},\r\n\t\tonborder: function() {\r\n\t\t\treturn !!((this.bx + this.by) & 1);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// getc(), getx(), getb(), getex(), getobj() Positionに存在するオブジェクトを返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetc: function() {\r\n\t\t\treturn this.board.getc(this.bx, this.by);\r\n\t\t},\r\n\t\tgetx: function() {\r\n\t\t\treturn this.board.getx(this.bx, this.by);\r\n\t\t},\r\n\t\tgetb: function() {\r\n\t\t\treturn this.board.getb(this.bx, this.by);\r\n\t\t},\r\n\t\tgetex: function() {\r\n\t\t\treturn this.board.getex(this.bx, this.by);\r\n\t\t},\r\n\t\tgetobj: function() {\r\n\t\t\treturn this.board.getobj(this.bx, this.by);\r\n\t\t},\r\n\t\tgetDot: function() {\r\n\t\t\treturn this.board.getDot(this.bx, this.by);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// addr.movedir() 指定した方向に指定した数移動する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tmovedir: function(dir, dd) {\r\n\t\t\tswitch (dir) {\r\n\t\t\t\tcase this.UP:\r\n\t\t\t\t\tthis.by -= dd;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase this.DN:\r\n\t\t\t\t\tthis.by += dd;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase this.LT:\r\n\t\t\t\t\tthis.bx -= dd;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase this.RT:\r\n\t\t\t\t\tthis.bx += dd;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\t},\r\n\r\n\t//----------------------------------------------------------------------------\r\n\t// ★RawAddressクラス (bx,by)座標を扱う ※端数あり\r\n\t//---------------------------------------------------------------------------\r\n\t\"RawAddress:Address\": {},\r\n\r\n\t//----------------------------------------------------------------------------\r\n\t// ★Dot class: Puzzle element using multiple underlying Piece subclasses\r\n\t//----------------------------------------------------------------------------\r\n\t\"Dot:Position\": {\r\n\t\tisnull: true,\r\n\t\tid: null,\r\n\r\n\t\tpiece: null,\r\n\r\n\t\tgetDot: function() {\r\n\t\t\treturn this.piece.qnum;\r\n\t\t},\r\n\t\tsetDot: function(val) {\r\n\t\t\tthis.puzzle.opemgr.disCombine = true;\r\n\t\t\tthis.piece.setQnum(val);\r\n\t\t\tthis.puzzle.opemgr.disCombine = false;\r\n\t\t},\r\n\t\tiserror: function() {\r\n\t\t\treturn this.piece.error > 0;\r\n\t\t},\r\n\r\n\t\tgetaddr: function() {\r\n\t\t\treturn new this.klass.Address(this.bx, this.by);\r\n\t\t}\r\n\t}\r\n});\r\n","// Piece.js v3.4.1\r\n\r\npzpr.classmgr.makeCommon({\r\n\t//---------------------------------------------------------------------------\r\n\t// ★BoardPieceクラス Cell, Cross, Border, ExCellクラスのベース\r\n\t//---------------------------------------------------------------------------\r\n\t\"BoardPiece:Position\": {\r\n\t\tgroup: \"none\",\r\n\t\tid: null,\r\n\t\tisnull: true,\r\n\r\n\t\t// デフォルト値\r\n\t\t/* 問題データを保持するプロパティ */\r\n\t\tques: 0, // cell  :(1:黒マス 2-5:三角形 6:アイス・なべ等 7:盤面外 8:盤面内だが入力不可\r\n\t\t//         11-17:十字型パーツ 21-22:旗門 31:Hole 41-42:ぬりめいずの○△ 51:カックロ)\r\n\t\t// cross :(交点の黒点)\r\n\t\t// border:(問題の境界線)\r\n\t\tqdir: 0, // cell  :(数字につく矢印の向き)\r\n\t\t// border:(アイスバーンの矢印/マイナリズムの不等号)\r\n\t\tqnum: -1, // cell  :(セルの数字/○△□/マカロ以外の単体矢印/白丸黒丸/カックロの右側)\r\n\t\t// cross :(交点の数字)\r\n\t\t// border:(マイナリズムの数字/天体ショーの星)\r\n\t\tqnum2: -1, // cell  :(カックロの下側/よせなべの丸無し数字)\r\n\t\tqnum3: -1,\r\n\t\tqnum4: -1,\r\n\r\n\t\tqchar: 0, // excell:キンコンカンの文字\r\n\r\n\t\t/* 回答データを保持するプロパティ */\r\n\t\tqans: 0, // cell  :(1:黒マス/あかり 2-5:三角形 11-13:棒 31-32:斜線 41-50:ふとん)\r\n\t\t// border:(回答の境界線)\r\n\t\tanum: -1, // cell  :(セルの数字/○△□/単体矢印)\r\n\t\tline: 0, // border:(ましゅやスリリンなどの線)\r\n\r\n\t\t/* 補助データを保持するプロパティ */\r\n\t\tqsub: 0, // cell  :(1:白マス 1-2:背景色/○× 3:絵になる部分)\r\n\t\t// border:(1:補助線 2:× 11-14:方向記号)\r\n\t\tqcmp: 0, // cell  :(1:cmpマス 1-2:○×)\r\n\t\tsnum: -1, // cell  :補助数字を保持する\r\n\r\n\t\t/* 履歴保存しないプロパティ */\r\n\t\terror: 0,\r\n\t\tqinfo: 0,\r\n\t\ttrial: 0, // TrialModeのstateを保持する変数\r\n\r\n\t\tpropques: [\"ques\", \"qdir\", \"qnum\", \"qnum2\", \"qchar\"],\r\n\t\tpropans: [\"qans\", \"anum\", \"line\", \"trial\"],\r\n\t\tpropsub: [\"qsub\", \"qcmp\", \"snum\"],\r\n\t\tpropinfo: [\"error\", \"qinfo\"],\r\n\t\tpropnorec: { color: 1, error: 1, qinfo: 1 },\r\n\r\n\t\t// 入力できる最大・最小の数字\r\n\t\tmaxnum: 999,\r\n\t\tminnum: 1,\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// initAdjacent()   隣接セルの情報を設定する\r\n\t\t// initAdjBorder()  隣接境界線の情報を設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinitAdjacent: function() {\r\n\t\t\tthis.adjacent = {\r\n\t\t\t\ttop: this.relobj(0, -2),\r\n\t\t\t\tbottom: this.relobj(0, 2),\r\n\t\t\t\tleft: this.relobj(-2, 0),\r\n\t\t\t\tright: this.relobj(2, 0)\r\n\t\t\t};\r\n\t\t},\r\n\t\tinitAdjBorder: function() {\r\n\t\t\tthis.adjborder = {\r\n\t\t\t\ttop: this.relbd(0, -1),\r\n\t\t\t\tbottom: this.relbd(0, 1),\r\n\t\t\t\tleft: this.relbd(-1, 0),\r\n\t\t\t\tright: this.relbd(1, 0)\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// オブジェクト設定値のgetter/setter\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetQues: function(val) {\r\n\t\t\tthis.setdata(\"ques\", val);\r\n\t\t},\r\n\t\tsetQans: function(val) {\r\n\t\t\tthis.setdata(\"qans\", val);\r\n\t\t},\r\n\t\tsetQdir: function(val) {\r\n\t\t\tthis.setdata(\"qdir\", val);\r\n\t\t},\r\n\t\tsetQnum: function(val) {\r\n\t\t\tthis.setdata(\"qnum\", val);\r\n\t\t},\r\n\t\tsetQnum2: function(val) {\r\n\t\t\tthis.setdata(\"qnum2\", val);\r\n\t\t},\r\n\t\tsetQchar: function(val) {\r\n\t\t\tthis.setdata(\"qchar\", val);\r\n\t\t},\r\n\t\tsetAnum: function(val) {\r\n\t\t\tthis.setdata(\"anum\", val);\r\n\t\t},\r\n\t\tsetLineVal: function(val) {\r\n\t\t\tthis.setdata(\"line\", val);\r\n\t\t},\r\n\t\tsetQsub: function(val) {\r\n\t\t\tthis.setdata(\"qsub\", val);\r\n\t\t},\r\n\t\tsetQcmp: function(val) {\r\n\t\t\tthis.setdata(\"qcmp\", val);\r\n\t\t},\r\n\t\tsetSnum: function(val) {\r\n\t\t\tthis.setdata(\"snum\", val);\r\n\t\t},\r\n\r\n\t\tsetQnumDir: function(dir, val) {\r\n\t\t\tswitch (dir) {\r\n\t\t\t\tcase this.RT:\r\n\t\t\t\t\tthis.setdata(\"qnum\", val);\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase this.DN:\r\n\t\t\t\t\tthis.setdata(\"qnum2\", val);\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase this.LT:\r\n\t\t\t\t\tthis.setdata(\"qnum3\", val);\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase this.UP:\r\n\t\t\t\t\tthis.setdata(\"qnum4\", val);\r\n\t\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetQnumDir: function(dir) {\r\n\t\t\tswitch (dir) {\r\n\t\t\t\tcase this.RT:\r\n\t\t\t\t\treturn this.qnum;\r\n\t\t\t\tcase this.DN:\r\n\t\t\t\t\treturn this.qnum2;\r\n\t\t\t\tcase this.LT:\r\n\t\t\t\t\treturn this.qnum3;\r\n\t\t\t\tcase this.UP:\r\n\t\t\t\t\treturn this.qnum4;\r\n\t\t\t}\r\n\t\t\treturn -1;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// setdata() Cell,Cross,Border,ExCellの値を設定する\r\n\t\t// addOpe()  履歴情報にプロパティの変更を通知する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetdata: function(prop, num, force) {\r\n\t\t\tif (this[prop] === num) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!!this.prehook[prop]) {\r\n\t\t\t\t// when force is set (undo, redo), bypass the check\r\n\t\t\t\t// but still execute the prehook for side-effects\r\n\t\t\t\tif (this.prehook[prop].call(this, num) && !force) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.addOpe(prop, this[prop], num);\r\n\t\t\tthis[prop] = num;\r\n\r\n\t\t\tvar trialstage = this.board.trialstage;\r\n\t\t\tif (trialstage > 0) {\r\n\t\t\t\tthis.trial = trialstage;\r\n\t\t\t}\r\n\r\n\t\t\tthis.board.modifyInfo(this, this.group + \".\" + prop);\r\n\r\n\t\t\tif (!!this.posthook[prop]) {\r\n\t\t\t\tthis.posthook[prop].call(this, num);\r\n\t\t\t}\r\n\t\t},\r\n\t\taddOpe: function(property, old, num) {\r\n\t\t\tif (old === num) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.puzzle.opemgr.add(\r\n\t\t\t\tnew this.klass.ObjectOperation(this, property, old, num)\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// setdata2() Cell,Cross,Border,ExCellのpos付きの値を設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetdata2: function(prop, pos, num, bypassPrehook) {\r\n\t\t\tif (this[prop][pos] === num) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!!this.prehook[prop]) {\r\n\t\t\t\tif (this.prehook[prop].call(this, pos, num) && !bypassPrehook) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.addOpe(prop + pos, this[prop][pos], num);\r\n\t\t\tthis[prop][pos] = num;\r\n\r\n\t\t\tvar trialstage = this.board.trialstage;\r\n\t\t\tif (trialstage > 0) {\r\n\t\t\t\tthis.trial = trialstage;\r\n\t\t\t}\r\n\r\n\t\t\tif (!!this.posthook[prop]) {\r\n\t\t\t\tthis.posthook[prop].call(this, pos, num);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// getprops() プロパティの値のみを取得する\r\n\t\t// compare()  プロパティの値を比較し違っていたらcallback関数を呼びだす\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetprops: function() {\r\n\t\t\tvar props = {};\r\n\t\t\tvar proplist = this.getproplist([\"ques\", \"ans\", \"sub\"]);\r\n\t\t\tfor (var i = 0; i < proplist.length; i++) {\r\n\t\t\t\tvar a = proplist[i];\r\n\t\t\t\tprops[a] = this[a];\r\n\t\t\t}\r\n\t\t\treturn props;\r\n\t\t},\r\n\t\tcompare: function(props, callback) {\r\n\t\t\tvar proplist = this.getproplist([\"ques\", \"ans\", \"sub\"]);\r\n\t\t\tfor (var i = 0; i < proplist.length; i++) {\r\n\t\t\t\tvar a = proplist[i];\r\n\t\t\t\tif (props[a] !== this[a]) {\r\n\t\t\t\t\tcallback(this.group, this.id, a);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// getproplist() ansclear等で使用するプロパティの配列を取得する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetproplist: function(types) {\r\n\t\t\tvar array = [];\r\n\t\t\tfor (var i = 0; i < types.length; i++) {\r\n\t\t\t\tvar array1 = [];\r\n\t\t\t\tswitch (types[i]) {\r\n\t\t\t\t\tcase \"ques\":\r\n\t\t\t\t\t\tarray1 = this.propques;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"ans\":\r\n\t\t\t\t\t\tarray1 = this.propans;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"sub\":\r\n\t\t\t\t\t\tarray1 = this.propsub;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"info\":\r\n\t\t\t\t\t\tarray1 = this.propinfo;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"trial\":\r\n\t\t\t\t\t\tarray1 = [\"trial\"];\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tarray = array.concat(array1);\r\n\t\t\t}\r\n\t\t\tif (array.indexOf(\"snum\") >= 0 && this.enableSubNumberArray) {\r\n\t\t\t\tarray.splice(\r\n\t\t\t\t\tarray.indexOf(\"snum\"),\r\n\t\t\t\t\t1,\r\n\t\t\t\t\t\"snum0\",\r\n\t\t\t\t\t\"snum1\",\r\n\t\t\t\t\t\"snum2\",\r\n\t\t\t\t\t\"snum3\"\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\treturn array;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// getmaxnum() 入力できる数字の最大値を返す\r\n\t\t// getminnum() 入力できる数字の最小値を返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetmaxnum: function() {\r\n\t\t\treturn typeof this.maxnum === \"function\" ? this.maxnum() : this.maxnum;\r\n\t\t},\r\n\t\tgetminnum: function() {\r\n\t\t\treturn typeof this.minnum === \"function\" ? this.minnum() : this.minnum;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// prehook  値の設定前にやっておく処理や、設定禁止処理を行う\r\n\t\t// posthook 値の設定後にやっておく処理を行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tprehook: {},\r\n\t\tposthook: {},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// seterr()  error値を設定する\r\n\t\t// setinfo() qinfo値を設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tseterr: function(num) {\r\n\t\t\tif (this.board.isenableSetError()) {\r\n\t\t\t\tthis.error = num;\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetinfo: function(num) {\r\n\t\t\tthis.qinfo = num;\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ★Cellクラス BoardクラスがCellの数だけ保持する\r\n\t//---------------------------------------------------------------------------\r\n\t// ボードメンバデータの定義(1)\r\n\t// Cellクラスの定義\r\n\t\"Cell:BoardPiece\": {\r\n\t\tgroup: \"cell\",\r\n\r\n\t\tlcnt: 0, // セルに存在する線の本数\r\n\t\tbase: null, // 丸数字やアルファベットが移動してきた場合の移動元のセルを示す (移動なし時は自分自身を指す)\r\n\t\tdirs51: 2,\r\n\r\n\t\tdisInputHatena: false, // qnum==-2を入力できないようにする\r\n\r\n\t\tnumberWithMB: false, // 回答の数字と○×が入るパズル(○は数字が入っている扱いされる)\r\n\t\tnumberAsObject: false, // 数字以外でqnum/anumを使用する(同じ値を入力で消去できたり、回答で・が入力できる)\r\n\t\tnumberAsLetter: false, // 数字の代わりにアルファベットを入力する\r\n\r\n\t\tnumberRemainsUnshaded: false, // 数字のあるマスが黒マスにならないパズル\r\n\t\tenableSubNumberArray: false, // 補助数字の配列を作るパズル\r\n\t\tsupportQnumAnum: false, // True if qnum and anum can appear at the same time.\r\n\r\n\t\tadjacent: {}, // 四方向に隣接するセルを保持する\r\n\t\tadjborder: {}, // 四方向に隣接する境界線を保持する\r\n\r\n\t\tinitialize: function() {\r\n\t\t\tthis.temp = this.constructor.prototype;\r\n\t\t\tif (this.enableSubNumberArray) {\r\n\t\t\t\tvar anum0 = this.temp.anum;\r\n\t\t\t\tthis.snum = [anum0, anum0, anum0, anum0];\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// prehook  値の設定前にやっておく処理や、設定禁止処理を行う\r\n\t\t// posthook 値の設定後にやっておく処理を行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tprehook: {\r\n\t\t\tqnum: function(num) {\r\n\t\t\t\treturn this.getminnum() > 0 && num === 0;\r\n\t\t\t},\r\n\t\t\tqnum2: function(num) {\r\n\t\t\t\treturn this.getminnum() > 0 && num === 0;\r\n\t\t\t},\r\n\t\t\tanum: function(num) {\r\n\t\t\t\treturn this.getminnum() > 0 && num === 0;\r\n\t\t\t}\r\n\t\t},\r\n\t\tposthook: {},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// cell.isShade()   該当するCellが黒マスかどうか返す\r\n\t\t// cell.isUnshade() 該当するCellが白マスかどうか返す\r\n\t\t// cell.setShade()  該当するCellに黒マスをセットする\r\n\t\t// cell.clrShade()  該当するCellに白マスをセットする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tisShade: function() {\r\n\t\t\treturn !this.isnull && this.qans === 1;\r\n\t\t},\r\n\t\tisUnshade: function() {\r\n\t\t\treturn !this.isnull && this.qans !== 1;\r\n\t\t},\r\n\t\tsetShade: function() {\r\n\t\t\tthis.setQans(1);\r\n\t\t},\r\n\t\tclrShade: function() {\r\n\t\t\tthis.setQans(0);\r\n\t\t},\r\n\r\n\t\t// disallow certain inputs\r\n\t\tallowShade: function() {\r\n\t\t\tif (this.numberRemainsUnshaded) {\r\n\t\t\t\treturn this.qnum === -1;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tallowUnshade: function() {\r\n\t\t\tif (this.numberRemainsUnshaded) {\r\n\t\t\t\treturn this.qnum === -1 || this.puzzle.painter.enablebcolor;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\t// is cell shading status decided for the purpose of auto-answer check\r\n\t\tisShadeDecided: function() {\r\n\t\t\tif (this.isnull) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif (this.isShade()) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif (this.qsub > 0) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif (!this.allowShade() || !this.allowUnshade()) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\t//-----------------------------------------------------------------------\r\n\t\t// cell.getNum()     該当するCellの数字を返す\r\n\t\t// cell.setNum()     該当するCellに数字を設定する\r\n\t\t//-----------------------------------------------------------------------\r\n\t\tgetNum: function() {\r\n\t\t\treturn this.qnum !== -1 ? this.qnum : this.anum;\r\n\t\t},\r\n\t\tsetNum: function(val) {\r\n\t\t\tif (this.getminnum() > 0 && val === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// editmode時 val>=0は数字 val=-1は消去 val=-2は？など\r\n\t\t\tif (this.puzzle.editmode) {\r\n\t\t\t\tval =\r\n\t\t\t\t\t(this.numberAsObject || val === -2) && this.qnum === val ? -1 : val;\r\n\t\t\t\tthis.setQnum(val);\r\n\t\t\t\tthis.setAnum(-1);\r\n\t\t\t\tif (this.numberRemainsUnshaded) {\r\n\t\t\t\t\tthis.setQans(0);\r\n\t\t\t\t}\r\n\t\t\t\tif (!this.puzzle.painter.enablebcolor) {\r\n\t\t\t\t\tthis.setQsub(0);\r\n\t\t\t\t}\r\n\t\t\t\tthis.setQcmp(0);\r\n\t\t\t\tthis.clrSnum();\r\n\t\t\t}\r\n\t\t\t// playmode時 val>=0は数字 val=-1は消去 numberAsObjectの・はval=-2 numberWithMBの○×はval=-2,-3\r\n\t\t\telse if (this.qnum === -1) {\r\n\t\t\t\tvar vala =\r\n\t\t\t\t\tval > -1 && !(this.numberAsObject && this.anum === val) ? val : -1;\r\n\t\t\t\tvar vals =\r\n\t\t\t\t\tval < -1 && !(this.numberAsObject && this.qsub === -val - 1)\r\n\t\t\t\t\t\t? -val - 1\r\n\t\t\t\t\t\t: 0;\r\n\t\t\t\tthis.setAnum(vala);\r\n\t\t\t\tthis.setQsub(vals);\r\n\t\t\t\tthis.setQdir(0);\r\n\t\t\t\tthis.setQcmp(0);\r\n\t\t\t\tif (!(this.numberWithMB && vala === -1)) {\r\n\t\t\t\t\tthis.clrSnum();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//-----------------------------------------------------------------------\r\n\t\t// cell.isNum()       該当するCellに数字があるか返す\r\n\t\t// cell.noNum()       該当するCellに数字がないか返す\r\n\t\t// cell.isValidNum()  該当するCellに0以上の数字があるか返す\r\n\t\t// cell.isNumberObj() 該当するCellに数字or○があるか返す\r\n\t\t// cell.sameNumber()  ２つのCellに同じ有効な数字があるか返す\r\n\t\t//-----------------------------------------------------------------------\r\n\t\tisNum: function() {\r\n\t\t\treturn (\r\n\t\t\t\t!this.isnull &&\r\n\t\t\t\t(this.qnum !== this.temp.qnum || this.anum !== this.temp.anum)\r\n\t\t\t);\r\n\t\t},\r\n\t\tnoNum: function() {\r\n\t\t\treturn (\r\n\t\t\t\t!this.isnull &&\r\n\t\t\t\tthis.qnum === this.temp.qnum &&\r\n\t\t\t\tthis.anum === this.temp.anum\r\n\t\t\t);\r\n\t\t},\r\n\t\tisValidNum: function() {\r\n\t\t\treturn (\r\n\t\t\t\t!this.isnull &&\r\n\t\t\t\t(this.qnum >= 0 || (this.anum >= 0 && this.qnum === this.temp.qnum))\r\n\t\t\t);\r\n\t\t},\r\n\t\tisNumberObj: function() {\r\n\t\t\treturn (\r\n\t\t\t\tthis.qnum !== this.temp.qnum ||\r\n\t\t\t\tthis.anum !== this.temp.anum ||\r\n\t\t\t\t(this.numberWithMB && this.qsub === 1)\r\n\t\t\t);\r\n\t\t},\r\n\t\tsameNumber: function(cell) {\r\n\t\t\treturn this.isValidNum() && this.getNum() === cell.getNum();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// cell.setSnum() Cellの補助数字を設定する\r\n\t\t// cell.clrSnum() Cellの補助数字を消去する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetSnum: function(pos, num) {\r\n\t\t\tif (this.isNum() && num !== -1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!this.enableSubNumberArray) {\r\n\t\t\t\tthis.setdata(\"snum\", num); // 1つ目の数字のみ\r\n\t\t\t} else {\r\n\t\t\t\tthis.setdata2(\"snum\", pos, num);\r\n\t\t\t}\r\n\t\t},\r\n\t\tclrSnum: function() {\r\n\t\t\tif (!this.enableSubNumberArray) {\r\n\t\t\t\tthis.setSnum(-1);\r\n\t\t\t} else {\r\n\t\t\t\tthis.setSnum(0, -1);\r\n\t\t\t\tthis.setSnum(1, -1);\r\n\t\t\t\tthis.setSnum(2, -1);\r\n\t\t\t\tthis.setSnum(3, -1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// cell.is51cell()     [＼]のセルかチェックする(カックロ以外はオーバーライドされる)\r\n\t\t// cell.set51cell()    [＼]を作成する(カックロ以外はオーバーライドされる)\r\n\t\t// cell.remove51cell() [＼]を消去する(カックロ以外はオーバーライドされる)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ※とりあえずカックロ用\r\n\t\tis51cell: function() {\r\n\t\t\treturn this.ques === 51;\r\n\t\t},\r\n\t\tset51cell: function(val) {\r\n\t\t\tthis.setQues(51);\r\n\t\t\tfor (var dir = 1; dir <= 4; dir++) {\r\n\t\t\t\tthis.setQnumDir(dir, -1);\r\n\t\t\t}\r\n\t\t\tthis.setAnum(-1);\r\n\t\t},\r\n\t\tremove51cell: function(val) {\r\n\t\t\tthis.setQues(0);\r\n\t\t\tfor (var dir = 1; dir <= 4; dir++) {\r\n\t\t\t\tthis.setQnumDir(dir, -1);\r\n\t\t\t}\r\n\t\t\tthis.setAnum(-1);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// cell.ice() アイスのマスかどうか判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tice: function() {\r\n\t\t\treturn this.ques === 6;\r\n\t\t},\r\n\r\n\t\tisDot: function() {\r\n\t\t\treturn this.qsub === 1;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// cell.isEmpty() / cell.isValid() 不定形盤面などで、入力できるマスか判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tisEmpty: function() {\r\n\t\t\treturn this.isnull || this.ques === 7;\r\n\t\t},\r\n\t\tisValid: function() {\r\n\t\t\treturn !this.isnull && this.ques !== 7;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// cell.isDeparture()   オブジェクトを動かすパズルで移動元セルかどうか判定する\r\n\t\t// cell.isDestination() オブジェクトを動かすパズルで移動先セルかどうか判定する\r\n\t\t// ※動いていない場合は、isDestinationのみtrueを返します\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tisDeparture: function() {\r\n\t\t\treturn !this.isnull && !!this.base && this.isNum();\r\n\t\t},\r\n\t\tisDestination: function() {\r\n\t\t\treturn !this.isnull && !!this.base && !this.base.isnull;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// cell.isLineStraight()   セルの上で線が直進しているか判定する\r\n\t\t// cell.isLineCurve()      セルの上で線がカーブしているか判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tisLineStraight: function() {\r\n\t\t\t// 0:直進ではない 1:縦に直進 2:横に直進\r\n\t\t\tif (\r\n\t\t\t\tthis.lcnt === 2 &&\r\n\t\t\t\tthis.adjborder.top.isLine() &&\r\n\t\t\t\tthis.adjborder.bottom.isLine()\r\n\t\t\t) {\r\n\t\t\t\treturn 1;\r\n\t\t\t} else if (\r\n\t\t\t\tthis.lcnt === 2 &&\r\n\t\t\t\tthis.adjborder.left.isLine() &&\r\n\t\t\t\tthis.adjborder.right.isLine()\r\n\t\t\t) {\r\n\t\t\t\treturn 2;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t},\r\n\t\tisLineCurve: function() {\r\n\t\t\treturn this.lcnt === 2 && !this.isLineStraight();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// cell.isLP()  線が必ず存在するセルの条件を判定する\r\n\t\t// cell.noLP()  線が引けないセルの条件を判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// 下記の関数で用いる定数\r\n\t\tisLPobj: {\r\n\t\t\t1: { 11: 1, 12: 1, 14: 1, 15: 1 } /* UP */,\r\n\t\t\t2: { 11: 1, 12: 1, 16: 1, 17: 1 } /* DN */,\r\n\t\t\t3: { 11: 1, 13: 1, 15: 1, 16: 1 } /* LT */,\r\n\t\t\t4: { 11: 1, 13: 1, 14: 1, 17: 1 } /* RT */\r\n\t\t},\r\n\t\tnoLPobj: {\r\n\t\t\t1: { 1: 1, 4: 1, 5: 1, 13: 1, 16: 1, 17: 1, 21: 1 } /* UP */,\r\n\t\t\t2: { 1: 1, 2: 1, 3: 1, 13: 1, 14: 1, 15: 1, 21: 1 } /* DN */,\r\n\t\t\t3: { 1: 1, 2: 1, 5: 1, 12: 1, 14: 1, 17: 1, 22: 1 } /* LT */,\r\n\t\t\t4: { 1: 1, 3: 1, 4: 1, 12: 1, 15: 1, 16: 1, 22: 1 } /* RT */\r\n\t\t},\r\n\r\n\t\tisLP: function(dir) {\r\n\t\t\treturn !!this.isLPobj[dir][this.ques];\r\n\t\t},\r\n\t\t// ans.checkenableLinePartsからnoLP()関数が直接呼ばれている\r\n\t\tnoLP: function(dir) {\r\n\t\t\treturn !!this.noLPobj[dir][this.ques];\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// cell.countDir4Cell()  上下左右4方向で条件func==trueになるマスの数をカウントする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcountDir4Cell: function(func) {\r\n\t\t\tvar adc = this.adjacent,\r\n\t\t\t\tcnt = 0;\r\n\t\t\tvar cells = [adc.top, adc.bottom, adc.left, adc.right];\r\n\t\t\tfor (var i = 0; i < 4; i++) {\r\n\t\t\t\tif (cells[i].group === \"cell\" && !cells[i].isnull && func(cells[i])) {\r\n\t\t\t\t\tcnt++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn cnt;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// cell.getdir4clist()   上下左右4方向の存在するセルを返す\r\n\t\t// cell.getdir4cblist()  上下左右4方向のセル＆境界線＆方向を返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetdir4clist: function() {\r\n\t\t\tvar adc = this.adjacent,\r\n\t\t\t\tlist = [];\r\n\t\t\tvar cells = [adc.top, adc.bottom, adc.left, adc.right];\r\n\t\t\tfor (var i = 0; i < 4; i++) {\r\n\t\t\t\tif (cells[i].group === \"cell\" && !cells[i].isnull) {\r\n\t\t\t\t\tlist.push([cells[i], i + 1]);\r\n\t\t\t\t} /* i+1==dir */\r\n\t\t\t}\r\n\t\t\treturn list;\r\n\t\t},\r\n\t\tgetdir4cblist: function() {\r\n\t\t\tvar adc = this.adjacent,\r\n\t\t\t\tadb = this.adjborder,\r\n\t\t\t\tcblist = [];\r\n\t\t\tvar cells = [adc.top, adc.bottom, adc.left, adc.right];\r\n\t\t\tvar bds = [adb.top, adb.bottom, adb.left, adb.right];\r\n\t\t\tfor (var i = 0; i < 4; i++) {\r\n\t\t\t\tif ((cells[i].group === \"cell\" && !cells[i].isnull) || !bds[i].isnull) {\r\n\t\t\t\t\tcblist.push([cells[i], bds[i], i + 1]);\r\n\t\t\t\t} /* i+1==dir */\r\n\t\t\t}\r\n\t\t\treturn cblist;\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------------------------------------------\r\n\t\t// cell.getOrthogonalCell()  Get an adjacent cell in the direction of the target cell.\r\n\t\t//------------------------------------------------------------------------------------\r\n\t\tgetOrthogonalCell: function(target) {\r\n\t\t\tif (this.bx === target.bx) {\r\n\t\t\t\tif (this.by === target.by) {\r\n\t\t\t\t\treturn this.board.emptycell;\r\n\t\t\t\t}\r\n\t\t\t\treturn this.by > target.by ? this.adjacent.top : this.adjacent.bottom;\r\n\t\t\t} else if (this.by === target.by) {\r\n\t\t\t\treturn this.bx > target.bx ? this.adjacent.left : this.adjacent.right;\r\n\t\t\t}\r\n\r\n\t\t\treturn this.board.emptycell;\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// cell.eraseMovedLines()  移動系パズルの丸が消えたとき等、領域に含まれる線を消去する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\teraseMovedLines: function() {\r\n\t\t\tif (this.path === null) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar clist = this.path.clist,\r\n\t\t\t\tcount = 0;\r\n\t\t\tfor (var i = 0, len = clist.length; i < len; i++) {\r\n\t\t\t\tfor (var j = i + 1; j < len; j++) {\r\n\t\t\t\t\tvar border = clist[i].getnb(clist[j]);\r\n\t\t\t\t\tif (!border.isnull) {\r\n\t\t\t\t\t\tborder.removeLine();\r\n\t\t\t\t\t\tcount++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tclist.draw();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ★Crossクラス BoardクラスがCrossの数だけ保持する(hascross>=1の時)\r\n\t//---------------------------------------------------------------------------\r\n\t// ボードメンバデータの定義(2)\r\n\t// Crossクラスの定義\r\n\t\"Cross:BoardPiece\": {\r\n\t\tgroup: \"cross\",\r\n\r\n\t\tlcnt: 0, // 交点に存在する線の本数\r\n\r\n\t\tadjborder: {}, // 四方向に隣接する境界線を保持する\r\n\r\n\t\t//-----------------------------------------------------------------------\r\n\t\t// cross.getNum()     該当するCrossの数字を返す\r\n\t\t// cross.setNum()     該当するCrossに数字を設定する\r\n\t\t// cross.noNum()      該当するCrossに数字がないか返す\r\n\t\t//-----------------------------------------------------------------------\r\n\t\tgetNum: function() {\r\n\t\t\treturn this.qnum;\r\n\t\t},\r\n\t\tsetNum: function(val) {\r\n\t\t\tval = val === -2 && this.qnum === val ? -1 : val;\r\n\t\t\tthis.setQnum(val);\r\n\t\t},\r\n\t\tnoNum: function() {\r\n\t\t\treturn !this.isnull && this.qnum === -1;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// cross.setCrossBorderError() 交点とその周り四方向のBorderにエラーフラグを設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetCrossBorderError: function() {\r\n\t\t\tthis.seterr(1);\r\n\t\t\tthis.board\r\n\t\t\t\t.borderinside(this.bx - 1, this.by - 1, this.bx + 1, this.by + 1)\r\n\t\t\t\t.seterr(1);\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ★Borderクラス BoardクラスがBorderの数だけ保持する(hasborder>0の時)\r\n\t//---------------------------------------------------------------------------\r\n\t// ボードメンバデータの定義(3)\r\n\t// Borderクラスの定義\r\n\t\"Border:BoardPiece\": {\r\n\t\tinitialize: function() {\r\n\t\t\tthis.sidecell = [null, null]; // 隣接セルのオブジェクト\r\n\t\t\tthis.sidecross = [null, null]; // 隣接交点のオブジェクト\r\n\t\t\tthis.sideobj = []; // LineManager用\r\n\t\t},\r\n\t\tgroup: \"border\",\r\n\r\n\t\tisvert: false, // true:境界線が垂直(縦) false:境界線が水平(横)\r\n\t\tinside: false, // true:盤面内 false:外枠上or盤面外\r\n\r\n\t\tpath: null, // このLineを含む線情報への参照\r\n\r\n\t\t// isLineNG関連の変数など\r\n\t\tenableLineNG: false,\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// initSideObject() 隣接オブジェクトの情報を設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinitSideObject: function() {\r\n\t\t\tvar allowexcell =\r\n\t\t\t\tthis.board.hasborder === 2 && this.board.hasexcell === 2;\r\n\t\t\tif (this.isvert) {\r\n\t\t\t\tthis.sidecell[0] =\r\n\t\t\t\t\t!allowexcell || this.bx > 0\r\n\t\t\t\t\t\t? this.relcell(-1, 0)\r\n\t\t\t\t\t\t: this.relexcell(-1, 0);\r\n\t\t\t\tthis.sidecell[1] =\r\n\t\t\t\t\t!allowexcell || this.bx < this.board.cols * 2\r\n\t\t\t\t\t\t? this.relcell(1, 0)\r\n\t\t\t\t\t\t: this.relexcell(1, 0);\r\n\t\t\t\tthis.sidecross[0] = this.relcross(0, -1);\r\n\t\t\t\tthis.sidecross[1] = this.relcross(0, 1);\r\n\t\t\t} else {\r\n\t\t\t\tthis.sidecell[0] =\r\n\t\t\t\t\t!allowexcell || this.by > 0\r\n\t\t\t\t\t\t? this.relcell(0, -1)\r\n\t\t\t\t\t\t: this.relexcell(0, -1);\r\n\t\t\t\tthis.sidecell[1] =\r\n\t\t\t\t\t!allowexcell || this.by < this.board.rows * 2\r\n\t\t\t\t\t\t? this.relcell(0, 1)\r\n\t\t\t\t\t\t: this.relexcell(0, 1);\r\n\t\t\t\tthis.sidecross[0] = this.relcross(-1, 0);\r\n\t\t\t\tthis.sidecross[1] = this.relcross(1, 0);\r\n\t\t\t}\r\n\r\n\t\t\t// LineManager用\r\n\t\t\tthis.sideobj = !this.board.borderAsLine ? this.sidecell : this.sidecross;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// prehook  値の設定前にやっておく処理や、設定禁止処理を行う\r\n\t\t// posthook 値の設定後にやっておく処理を行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tprehook: {\r\n\t\t\tqans: function(num) {\r\n\t\t\t\treturn this.ques !== 0;\r\n\t\t\t},\r\n\t\t\tline: function(num) {\r\n\t\t\t\treturn this.checkStableLine(num);\r\n\t\t\t}\r\n\t\t},\r\n\t\tposthook: {},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// border.draw() 盤面に自分の周囲を描画する (Borderはちょっと範囲が広い)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdraw: function() {\r\n\t\t\tthis.puzzle.painter.paintRange(\r\n\t\t\t\tthis.bx - 2,\r\n\t\t\t\tthis.by - 2,\r\n\t\t\t\tthis.bx + 2,\r\n\t\t\t\tthis.by + 2\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t//-----------------------------------------------------------------------\r\n\t\t// border.isLine()      該当するBorderにlineが引かれているか判定する\r\n\t\t// border.setLine()     該当するBorderに線を引く\r\n\t\t// border.setPeke()     該当するBorderに×印をつける\r\n\t\t// border.removeLine()  該当するBorderから線を消す\r\n\t\t// border.removeLineAndQsub()  removes line and qsub\r\n\t\t//-----------------------------------------------------------------------\r\n\t\tisLine: function() {\r\n\t\t\treturn this.line > 0;\r\n\t\t},\r\n\t\tsetLine: function(id) {\r\n\t\t\tthis.setLineVal(1);\r\n\t\t\tif (this.qsub === 2) {\r\n\t\t\t\tthis.setQsub(0);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetPeke: function(id) {\r\n\t\t\tthis.setLineVal(0);\r\n\t\t\tthis.setQsub(2);\r\n\t\t},\r\n\t\tremoveLine: function(id) {\r\n\t\t\tthis.setLineVal(0);\r\n\t\t\tif (this.qsub === 2) {\r\n\t\t\t\tthis.setQsub(0);\r\n\t\t\t}\r\n\t\t},\r\n\t\tremoveLineAndQsub: function(id) {\r\n\t\t\tthis.setLineVal(0);\r\n\t\t\tthis.setQsub(0);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// border.isBorder()     該当するBorderに境界線が引かれているか判定する\r\n\t\t// border.setBorder()    該当するBorderに境界線を引く\r\n\t\t// border.removeBorder() 該当するBorderから線を消す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tisBorder: function() {\r\n\t\t\treturn this.ques > 0 || this.qans > 0;\r\n\t\t},\r\n\t\tsetBorder: function() {\r\n\t\t\tif (this.puzzle.editmode) {\r\n\t\t\t\tthis.setQues(1);\r\n\t\t\t\tthis.setQans(0);\r\n\t\t\t} else if (this.ques !== 1) {\r\n\t\t\t\tthis.setQans(1);\r\n\t\t\t}\r\n\t\t},\r\n\t\tremoveBorder: function() {\r\n\t\t\tif (this.puzzle.editmode) {\r\n\t\t\t\tthis.setQues(0);\r\n\t\t\t\tthis.setQans(0);\r\n\t\t\t} else if (this.ques !== 1) {\r\n\t\t\t\tthis.setQans(0);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// border.isVert()  該当するBorderが垂直(縦)かどうか返す\r\n\t\t// border.isHorz()  該当するBorderに水平(横)かどうか返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tisVert: function() {\r\n\t\t\treturn this.isvert;\r\n\t\t},\r\n\t\tisHorz: function() {\r\n\t\t\treturn !this.isvert;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// border.checkStableLine() 線が引けない or 必ず存在する状態になっているか判定する\r\n\t\t// border.isLineEX() 線が必ず存在するborderの条件を判定する\r\n\t\t// border.isLineNG() 線が引けないborderの条件を判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// [pipelink, loopsp], [barns, slalom, reflect, yajirin]で呼ばれる関数\r\n\t\tcheckStableLine: function(num) {\r\n\t\t\t// border.setLineから呼ばれる\r\n\t\t\tif (this.enableLineNG) {\r\n\t\t\t\treturn num !== 0 && this.isLineNG();\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\t// Check if adding a line would create a corner in the side cells.\r\n\t\tcheckFormCurve: function(num) {\r\n\t\t\tif (num === 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i <= 1; i++) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tthis.isVert() &&\r\n\t\t\t\t\t(this.sidecell[i].adjborder.top.isLine() ||\r\n\t\t\t\t\t\tthis.sidecell[i].adjborder.bottom.isLine())\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tif (\r\n\t\t\t\t\t!this.isVert() &&\r\n\t\t\t\t\t(this.sidecell[i].adjborder.left.isLine() ||\r\n\t\t\t\t\t\tthis.sidecell[i].adjborder.right.isLine())\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\t// cell.setQues => setCombinedLineから呼ばれる関数 (exist->ex)\r\n\t\t//  -> cellidの片方がnullになっていることを考慮していません\r\n\t\tisLineEX: function() {\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\t// border.setLineCal => checkStableLineから呼ばれる関数\r\n\t\t//  -> cellidの片方がnullになっていることを考慮していません\r\n\t\tisLineNG: function() {\r\n\t\t\tvar cell1 = this.sidecell[0],\r\n\t\t\t\tcell2 = this.sidecell[1];\r\n\t\t\treturn this.isVert()\r\n\t\t\t\t? cell1.noLP(cell1.RT) || cell2.noLP(cell2.LT)\r\n\t\t\t\t: cell1.noLP(cell1.DN) || cell2.noLP(cell2.UP);\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ★ExCellクラス BoardクラスがExCellの数だけ保持する\r\n\t//---------------------------------------------------------------------------\r\n\t// ボードメンバデータの定義(4)\r\n\t// ExCellクラスの定義\r\n\t\"ExCell:BoardPiece\": {\r\n\t\tgroup: \"excell\",\r\n\r\n\t\tadjacent: {}, // 四方向に隣接するセルを保持する\r\n\r\n\t\t//-----------------------------------------------------------------------\r\n\t\t// excell.getNum()     該当するCellの数字を返す\r\n\t\t// excell.setNum()     該当するCellに数字を設定する\r\n\t\t// excell.noNum()      該当するCellに数字がないか返す\r\n\t\t//-----------------------------------------------------------------------\r\n\t\tgetNum: function() {\r\n\t\t\treturn this.qnum;\r\n\t\t},\r\n\t\tsetNum: function(val) {\r\n\t\t\tthis.setQnum(val);\r\n\t\t},\r\n\t\tnoNum: function() {\r\n\t\t\treturn !this.isnull && this.qnum === -1;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// excell.is51cell()   [＼]のセルかチェックする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tis51cell: function() {\r\n\t\t\treturn this.ques === 51;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// excell.ice() アイスのマスかどうか判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tice: function() {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n});\r\n","// PieceList.js v3.4.1\r\n\r\npzpr.classmgr.makeCommon({\r\n\t//----------------------------------------------------------------------------\r\n\t// ★PieceListクラス オブジェクトの配列を扱う\r\n\t//---------------------------------------------------------------------------\r\n\tPieceList: {\r\n\t\tinitialize: function(list) {\r\n\t\t\tif (!!list) {\r\n\t\t\t\tthis.extend(list);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tlength: 0,\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// ☆Arrayオブジェクト関連の関数\r\n\t\t// list.add()      与えられたオブジェクトを配列の末尾に追加する(push()相当)\r\n\t\t// list.extend()   与えられたPieceListを配列の末尾に追加する\r\n\t\t// list.pop()      配列の最後のオブジェクトを取り除いて返す\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tadd: Array.prototype.push,\r\n\t\textend: function(list) {\r\n\t\t\tvar len = list.length,\r\n\t\t\t\tn = this.length;\r\n\t\t\tthis.length += len;\r\n\t\t\tfor (var i = 0; i < len; i++) {\r\n\t\t\t\tthis[n + i] = list[i];\r\n\t\t\t}\r\n\t\t},\r\n\t\tpop: Array.prototype.pop,\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// ☆Arrayオブジェクトiterator関連の関数\r\n\t\t// list.each()     全てのオブジェクトに指定された関数を実行する\r\n\t\t// list.some()     条件がtrueとなるオブジェクトが存在するか判定する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\teach: Array.prototype.forEach,\r\n\t\tsome: Array.prototype.some,\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// list.filter()   条件がtrueとなるオブジェクトを抽出したclistを新たに作成する\r\n\t\t// list.notnull()  nullではないオブジェクトを抽出したclistを新たに作成する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t/* constructorが変わってしまうので、Array.prototypeが使用できない */\r\n\t\tfilter: function(cond) {\r\n\t\t\tvar list = new this.constructor(),\r\n\t\t\t\tlen = this.length,\r\n\t\t\t\tn = 0;\r\n\t\t\tfor (var i = 0; i < len; i++) {\r\n\t\t\t\tif (cond(this[i])) {\r\n\t\t\t\t\tlist[n] = this[i];\r\n\t\t\t\t\tn++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlist.length = n;\r\n\t\t\treturn list;\r\n\t\t},\r\n\t\tnotnull: function(cond) {\r\n\t\t\treturn this.filter(function(piece) {\r\n\t\t\t\treturn !piece.isnull;\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// list.map()      clistの各要素に指定された関数を適用したclistを新たに作成する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t/* constructorが変わってしまうので、Array.prototypeが使用できない */\r\n\t\tmap: function(changer) {\r\n\t\t\tvar list = new this.constructor(),\r\n\t\t\t\tlen = (list.length = this.length);\r\n\t\t\tfor (var i = 0; i < len; i++) {\r\n\t\t\t\tlist[i] = changer(this[i]);\r\n\t\t\t}\r\n\t\t\treturn list;\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// list.indexOf()  与えられたオブジェクトの配列上の位置を取得する\r\n\t\t// list.include()  与えられたオブジェクトが配列に存在するか判定する\r\n\t\t// list.remove()   与えられたオブジェクトを配列から取り除く\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tindexOf: Array.prototype.indexOf,\r\n\t\tinclude: function(target) {\r\n\t\t\treturn this.indexOf(target) >= 0;\r\n\t\t},\r\n\t\tremove: function(piece) {\r\n\t\t\tvar idx = this.indexOf(piece);\r\n\t\t\tif (idx >= 0) {\r\n\t\t\t\tArray.prototype.splice.call(this, idx, 1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// list.seterr()   保持しているオブジェクトにerror値を設定する\r\n\t\t// list.setnoerr() エラー値が設定されていないオブジェクトにerror=-1を設定する\r\n\t\t// list.setinfo()  保持しているオブジェクトにqinfo値を設定する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tseterr: function(num) {\r\n\t\t\tif (!this.board.isenableSetError()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < this.length; i++) {\r\n\t\t\t\tthis[i].error = num;\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetnoerr: function() {\r\n\t\t\tif (!this.board.isenableSetError()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < this.length; i++) {\r\n\t\t\t\tif (this[i].error === 0) {\r\n\t\t\t\t\tthis[i].error = -1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetinfo: function(num) {\r\n\t\t\tfor (var i = 0; i < this.length; i++) {\r\n\t\t\t\tthis[i].qinfo = num;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// list.allclear() 位置,描画情報以外をクリアする\r\n\t\t// list.ansclear() qans,anum,line,qsub,error情報をクリアする\r\n\t\t// list.subclear() qsub,error情報をクリアする\r\n\t\t// list.errclear() error情報をクリアする\r\n\t\t// list.trialclear() Trial情報をクリアする\r\n\t\t// list.propclear() 4つの共通処理\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t/* undo,redo以外で盤面縮小やったときは, isrec===true */\r\n\t\tallclear: function(isrec) {\r\n\t\t\tthis.propclear([\"ques\", \"ans\", \"sub\", \"info\"], isrec);\r\n\t\t},\r\n\t\tansclear: function() {\r\n\t\t\tthis.propclear([\"ans\", \"sub\", \"info\"], true);\r\n\t\t},\r\n\t\tsubclear: function() {\r\n\t\t\tthis.propclear([\"sub\", \"info\"], true);\r\n\t\t},\r\n\t\terrclear: function() {\r\n\t\t\tthis.propclear([\"info\"], false);\r\n\t\t},\r\n\t\ttrialclear: function() {\r\n\t\t\tthis.propclear([\"trial\"], false);\r\n\t\t},\r\n\t\tpropclear: function(target, isrec) {\r\n\t\t\tvar props = [],\r\n\t\t\t\tnorec = {};\r\n\t\t\tif (this.length > 0) {\r\n\t\t\t\tprops = this[0].getproplist(target);\r\n\t\t\t\tnorec = this[0].propnorec;\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < this.length; i++) {\r\n\t\t\t\tvar piece = this[i];\r\n\t\t\t\tfor (var j = 0; j < props.length; j++) {\r\n\t\t\t\t\tvar pp = props[j],\r\n\t\t\t\t\t\tpos = \"\";\r\n\t\t\t\t\tif (pp.length > 4 && pp.substr(0, 4) === \"snum\") {\r\n\t\t\t\t\t\tpos = pp.charAt(4);\r\n\t\t\t\t\t\tpp = pp.substr(0, 4);\r\n\t\t\t\t\t\tvar def = piece.constructor.prototype[pp];\r\n\t\t\t\t\t\tif (piece[pp][pos] !== def) {\r\n\t\t\t\t\t\t\tif (isrec && !norec[pp]) {\r\n\t\t\t\t\t\t\t\tpiece.addOpe(pp + pos, piece[pp][pos], def);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tpiece[pp][pos] = def;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar def = piece.constructor.prototype[pp];\r\n\t\t\t\t\t\tif (piece[pp] !== def) {\r\n\t\t\t\t\t\t\tif (isrec && !norec[pp]) {\r\n\t\t\t\t\t\t\t\tpiece.addOpe(pp, piece[pp], def);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tpiece[pp] = def;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t//----------------------------------------------------------------------------\r\n\t// ★CellListクラス Cellの配列を扱う\r\n\t//---------------------------------------------------------------------------\r\n\t\"CellList:PieceList\": {\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// clist.getRectSize()  指定されたCellのリストの上下左右の端と、セルの数を返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetRectSize: function() {\r\n\t\t\tvar bd = this.board;\r\n\t\t\tvar d = {\r\n\t\t\t\tx1: bd.maxbx + 1,\r\n\t\t\t\tx2: bd.minbx - 1,\r\n\t\t\t\ty1: bd.maxby + 1,\r\n\t\t\t\ty2: bd.minby - 1,\r\n\t\t\t\tcols: 0,\r\n\t\t\t\trows: 0,\r\n\t\t\t\tcnt: 0\r\n\t\t\t};\r\n\t\t\tfor (var i = 0; i < this.length; i++) {\r\n\t\t\t\tvar cell = this[i];\r\n\t\t\t\tif (d.x1 > cell.bx) {\r\n\t\t\t\t\td.x1 = cell.bx;\r\n\t\t\t\t}\r\n\t\t\t\tif (d.x2 < cell.bx) {\r\n\t\t\t\t\td.x2 = cell.bx;\r\n\t\t\t\t}\r\n\t\t\t\tif (d.y1 > cell.by) {\r\n\t\t\t\t\td.y1 = cell.by;\r\n\t\t\t\t}\r\n\t\t\t\tif (d.y2 < cell.by) {\r\n\t\t\t\t\td.y2 = cell.by;\r\n\t\t\t\t}\r\n\t\t\t\td.cnt++;\r\n\t\t\t}\r\n\t\t\td.cols = (d.x2 - d.x1 + 2) / 2;\r\n\t\t\td.rows = (d.y2 - d.y1 + 2) / 2;\r\n\t\t\treturn d;\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// clist.getQnumCell()  指定されたClistの中で一番左上にある数字のあるセルを返す\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tgetQnumCell: function() {\r\n\t\t\tfor (var i = 0, len = this.length; i < len; i++) {\r\n\t\t\t\tif (this[i].isNum()) {\r\n\t\t\t\t\treturn this[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this.board.emptycell;\r\n\t\t},\r\n\r\n\t\tincludes: function(cell) {\r\n\t\t\tfor (var i = 0, len = this.length; i < len; i++) {\r\n\t\t\t\tif (this[i] === cell) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// clist.getTopCell()  指定されたClistの中で一番左上にあるセルを返す\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tgetTopCell: function() {\r\n\t\t\tvar bd = this.board,\r\n\t\t\t\ttcell = null,\r\n\t\t\t\tbx = bd.maxbx,\r\n\t\t\t\tby = bd.maxby;\r\n\t\t\tfor (var i = 0; i < this.length; i++) {\r\n\t\t\t\tvar cell = this[i];\r\n\t\t\t\tif (cell.bx > bx || (cell.bx === bx && cell.by >= by)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\ttcell = this[i];\r\n\t\t\t\tbx = cell.bx;\r\n\t\t\t\tby = cell.by;\r\n\t\t\t}\r\n\t\t\treturn tcell;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// clist.eraseLines()  Clistに含まれるlineを消去します\r\n\t\t//---------------------------------------------------------------------------\r\n\t\teraseLines: function() {\r\n\t\t\tvar count = 0;\r\n\t\t\tfor (var i = 0, len = this.length; i < len; i++) {\r\n\t\t\t\tfor (var j = i + 1; j < len; j++) {\r\n\t\t\t\t\tvar border = this.puzzle.mouse.getnb(\r\n\t\t\t\t\t\tthis[i].getaddr(),\r\n\t\t\t\t\t\tthis[j].getaddr()\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (!border.isnull) {\r\n\t\t\t\t\t\tborder.removeLine();\r\n\t\t\t\t\t\tcount++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tthis.draw();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// clist.draw()   盤面に自分の周囲を描画する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdraw: function() {\r\n\t\t\tvar d = this.getRectSize();\r\n\t\t\tthis.puzzle.painter.paintRange(d.x1 - 1, d.y1 - 1, d.x2 + 1, d.y2 + 1);\r\n\t\t}\r\n\t},\r\n\r\n\t//----------------------------------------------------------------------------\r\n\t// ★CrossListクラス Crossの配列を扱う\r\n\t//---------------------------------------------------------------------------\r\n\t\"CrossList:PieceList\": {},\r\n\r\n\t//----------------------------------------------------------------------------\r\n\t// ★BorderListクラス Borderの配列を扱う\r\n\t//---------------------------------------------------------------------------\r\n\t\"BorderList:PieceList\": {\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// blist.cellinside()  線が重なるセルのリストを取得する\r\n\t\t// blist.crossinside() 線が重なる交点のリストを取得する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcellinside: function() {\r\n\t\t\tvar clist = new this.klass.CellList(),\r\n\t\t\t\tpushed = [];\r\n\t\t\tfor (var i = 0; i < this.length; i++) {\r\n\t\t\t\tvar border = this[i],\r\n\t\t\t\t\tcell1 = border.sidecell[0],\r\n\t\t\t\t\tcell2 = border.sidecell[1];\r\n\t\t\t\tif (!cell1.isnull && pushed[cell1.id] !== true) {\r\n\t\t\t\t\tclist.add(cell1);\r\n\t\t\t\t\tpushed[cell1.id] = true;\r\n\t\t\t\t}\r\n\t\t\t\tif (!cell2.isnull && pushed[cell2.id] !== true) {\r\n\t\t\t\t\tclist.add(cell2);\r\n\t\t\t\t\tpushed[cell2.id] = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn clist;\r\n\t\t},\r\n\t\tcrossinside: function() {\r\n\t\t\tvar clist = new this.klass.CrossList(),\r\n\t\t\t\tpushed = [];\r\n\t\t\tfor (var i = 0; i < this.length; i++) {\r\n\t\t\t\tvar border = this[i],\r\n\t\t\t\t\tcross1 = border.sidecross[0],\r\n\t\t\t\t\tcross2 = border.sidecross[1];\r\n\t\t\t\tif (!cross1.isnull && pushed[cross1.id] !== true) {\r\n\t\t\t\t\tclist.add(cross1);\r\n\t\t\t\t\tpushed[cross1.id] = true;\r\n\t\t\t\t}\r\n\t\t\t\tif (!cross2.isnull && pushed[cross2.id] !== true) {\r\n\t\t\t\t\tclist.add(cross2);\r\n\t\t\t\t\tpushed[cross2.id] = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn clist;\r\n\t\t}\r\n\t},\r\n\r\n\t//----------------------------------------------------------------------------\r\n\t// ★ExCellListクラス ExCellの配列を扱う\r\n\t//---------------------------------------------------------------------------\r\n\t\"ExCellList:PieceList\": {}\r\n});\r\n","// Board.js v3.4.1\r\n\r\n//---------------------------------------------------------------------------\r\n// ★Boardクラス 盤面の情報を保持する。Cell, Cross, Borderのオブジェクトも保持する\r\n//---------------------------------------------------------------------------\r\n// Boardクラスの定義\r\npzpr.classmgr.makeCommon({\r\n\t//---------------------------------------------------------\r\n\tBoard: {\r\n\t\tinitialize: function() {\r\n\t\t\tvar classes = this.klass;\r\n\r\n\t\t\t// 盤面の範囲\r\n\t\t\tthis.minbx = 0;\r\n\t\t\tthis.minby = 0;\r\n\t\t\tthis.maxbx = 0;\r\n\t\t\tthis.maxby = 0;\r\n\r\n\t\t\t// エラー設定可能状態かどうか\r\n\t\t\tthis.diserror = 0;\r\n\r\n\t\t\t// エラー表示中かどうか\r\n\t\t\tthis.haserror = false;\r\n\r\n\t\t\t// Info表示中かどうか\r\n\t\t\tthis.hasinfo = false;\r\n\r\n\t\t\t// 盤面上にあるセル・境界線等のオブジェクト\r\n\t\t\tthis.cell = new classes.CellList();\r\n\t\t\tthis.cross = new classes.CrossList();\r\n\t\t\tthis.border = new classes.BorderList();\r\n\t\t\tthis.excell = new classes.ExCellList();\r\n\r\n\t\t\t// 空オブジェクト\r\n\t\t\tthis.nullobj = new classes.BoardPiece();\r\n\t\t\tthis.emptycell = new classes.Cell();\r\n\t\t\tthis.emptycross = new classes.Cross();\r\n\t\t\tthis.emptyborder = new classes.Border();\r\n\t\t\tthis.emptyexcell = new classes.ExCell();\r\n\t\t\ttry {\r\n\t\t\t\tObject.freeze(this.nullobj);\r\n\t\t\t\tObject.freeze(this.emptycell);\r\n\t\t\t\tObject.freeze(this.emptycross);\r\n\t\t\t\tObject.freeze(this.emptyborder);\r\n\t\t\t\tObject.freeze(this.emptyexcell);\r\n\t\t\t} catch (e) {}\r\n\r\n\t\t\tthis.createExtraObject();\r\n\r\n\t\t\t// 補助オブジェクト\r\n\t\t\tthis.disrecinfo = 0;\r\n\t\t\tthis.infolist = [];\r\n\r\n\t\t\tthis.linegraph = this.addInfoList(classes.LineGraph); // 交差なし線のグラフ\r\n\t\t\tthis.roommgr = this.addInfoList(classes.AreaRoomGraph); // 部屋情報を保持する\r\n\t\t\tthis.sblkmgr = this.addInfoList(classes.AreaShadeGraph); // 黒マス情報を保持する\r\n\t\t\tthis.ublkmgr = this.addInfoList(classes.AreaUnshadeGraph); // 白マス情報を保持する\r\n\t\t\tthis.nblkmgr = this.addInfoList(classes.AreaNumberGraph); // 数字情報を保持する\r\n\r\n\t\t\tthis.addExtraInfo();\r\n\r\n\t\t\tthis.exec = new classes.BoardExec();\r\n\t\t\tthis.exec.insex.cross = this.hascross === 1 ? { 2: true } : { 0: true };\r\n\r\n\t\t\tthis.trialstage = 0; // TrialMode\r\n\t\t},\r\n\t\taddInfoList: function(Klass) {\r\n\t\t\tvar instance = new Klass();\r\n\t\t\tif (instance.enabled) {\r\n\t\t\t\tthis.infolist.push(instance);\r\n\t\t\t}\r\n\t\t\treturn instance;\r\n\t\t},\r\n\t\taddExtraInfo: function() {},\r\n\r\n\t\tcols: 10 /* 盤面の横幅(デフォルト) */,\r\n\t\trows: 10 /* 盤面の縦幅(デフォルト) */,\r\n\r\n\t\thascross: 2, // 1:盤面内側のCrossが操作可能なパズル 2:外枠上を含めてCrossが操作可能なパズル (どちらもCrossは外枠上に存在します)\r\n\t\thasborder: 0, // 1:Border/Lineが操作可能なパズル 2:外枠上も操作可能なパズル\r\n\t\thasexcell: 0, // 1:上・左側にセルを用意するパズル 2:四方にセルを用意するパズル\r\n\t\thasflush: 0,\r\n\t\tborderAsLine: false, // 境界線をlineとして扱う\r\n\t\tdisable_subclear: false, // \"補助消去\"ボタン不要\r\n\r\n\t\texcellRows: function(cols, rows) {\r\n\t\t\treturn 1;\r\n\t\t},\r\n\t\texcellCols: function(cols, rows) {\r\n\t\t\treturn 1;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// bd.initBoardSize() 指定されたサイズで盤面の初期化を行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinitBoardSize: function(col, row) {\r\n\t\t\tif (col === void 0 || isNaN(col)) {\r\n\t\t\t\tcol = this.cols;\r\n\t\t\t\trow = this.rows;\r\n\t\t\t}\r\n\r\n\t\t\tthis.allclear(false); // initGroupで、新Objectに対しては別途allclearが呼ばれます\r\n\r\n\t\t\tthis.initGroup(\"cell\", col, row);\r\n\t\t\tthis.initGroup(\"cross\", col, row);\r\n\t\t\tthis.initGroup(\"border\", col, row);\r\n\t\t\tthis.initGroup(\"excell\", col, row);\r\n\r\n\t\t\tthis.cols = col;\r\n\t\t\tthis.rows = row;\r\n\t\t\tthis.setminmax();\r\n\t\t\tthis.setposAll();\r\n\r\n\t\t\tif (this.hasdots === 1) {\r\n\t\t\t\tthis.initDots(this.cols, this.rows);\r\n\t\t\t}\r\n\r\n\t\t\tthis.initExtraObject(col, row);\r\n\r\n\t\t\tthis.rebuildInfo();\r\n\r\n\t\t\tthis.puzzle.cursor.initCursor();\r\n\t\t\tthis.puzzle.opemgr.allerase();\r\n\t\t},\r\n\t\tcreateExtraObject: function() {},\r\n\t\tinitExtraObject: function(col, row) {},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// bd.initGroup()     数を比較して、オブジェクトの追加か削除を行う\r\n\t\t// bd.getGroup()      指定したタイプのオブジェクト配列を返す\r\n\t\t// bd.estimateSize()  指定したオブジェクトがいくつになるか計算を行う\r\n\t\t// bd.newObject()     指定されたタイプの新しいオブジェクトを返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinitGroup: function(group, col, row) {\r\n\t\t\tvar groups = this.getGroup(group);\r\n\t\t\tvar len = this.estimateSize(group, col, row),\r\n\t\t\t\tclen = groups.length;\r\n\t\t\t// 既存のサイズより小さくなるならdeleteする\r\n\t\t\tif (clen > len) {\r\n\t\t\t\tfor (var id = clen - 1; id >= len; id--) {\r\n\t\t\t\t\tgroups.pop();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// 既存のサイズより大きくなるなら追加する\r\n\t\t\telse if (clen < len) {\r\n\t\t\t\tvar groups2 = new groups.constructor();\r\n\t\t\t\tfor (var id = clen; id < len; id++) {\r\n\t\t\t\t\tvar piece = this.newObject(group, id);\r\n\t\t\t\t\tgroups.add(piece);\r\n\t\t\t\t\tgroups2.add(piece);\r\n\t\t\t\t}\r\n\t\t\t\tgroups2.allclear(false);\r\n\t\t\t}\r\n\t\t\tgroups.length = len;\r\n\t\t\treturn len - clen;\r\n\t\t},\r\n\t\tgetGroup: function(group) {\r\n\t\t\tif (group === \"cell\") {\r\n\t\t\t\treturn this.cell;\r\n\t\t\t} else if (group === \"cross\") {\r\n\t\t\t\treturn this.cross;\r\n\t\t\t} else if (group === \"border\") {\r\n\t\t\t\treturn this.border;\r\n\t\t\t} else if (group === \"excell\") {\r\n\t\t\t\treturn this.excell;\r\n\t\t\t}\r\n\t\t\treturn new this.klass.PieceList();\r\n\t\t},\r\n\t\testimateSize: function(group, col, row) {\r\n\t\t\tif (group === \"cell\") {\r\n\t\t\t\treturn col * row;\r\n\t\t\t} else if (group === \"cross\") {\r\n\t\t\t\treturn (col + 1) * (row + 1);\r\n\t\t\t} else if (group === \"border\") {\r\n\t\t\t\tif (this.hasborder === 1) {\r\n\t\t\t\t\treturn 2 * col * row - (col + row);\r\n\t\t\t\t} else if (this.hasborder === 2) {\r\n\t\t\t\t\treturn 2 * col * row + (col + row);\r\n\t\t\t\t}\r\n\t\t\t} else if (group === \"excell\") {\r\n\t\t\t\tif (this.hasexcell === 1) {\r\n\t\t\t\t\tvar exrows = this.excellRows(col, row);\r\n\t\t\t\t\tvar excols = this.excellCols(col, row);\r\n\t\t\t\t\tcol *= exrows;\r\n\t\t\t\t\trow *= excols;\r\n\t\t\t\t\treturn col + row + (this.emptyexcell.ques === 51 ? 1 : 0);\r\n\t\t\t\t} /* 左上角のExCellを追加 */ else if (this.hasexcell === 2) {\r\n\t\t\t\t\treturn 2 * (col + row);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t},\r\n\t\tnewObject: function(group, id) {\r\n\t\t\tvar piece = this.nullobj,\r\n\t\t\t\tclasses = this.klass;\r\n\t\t\tif (group === \"cell\") {\r\n\t\t\t\tpiece = new classes.Cell();\r\n\t\t\t} else if (group === \"cross\") {\r\n\t\t\t\tpiece = new classes.Cross();\r\n\t\t\t} else if (group === \"border\") {\r\n\t\t\t\tpiece = new classes.Border();\r\n\t\t\t} else if (group === \"excell\") {\r\n\t\t\t\tpiece = new classes.ExCell();\r\n\t\t\t}\r\n\t\t\tif (piece !== this.nullobj && id !== void 0) {\r\n\t\t\t\tpiece.id = id;\r\n\t\t\t}\r\n\t\t\treturn piece;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// bd.setposAll()    全てのCell, Cross, BorderオブジェクトのsetposCell()等を呼び出す\r\n\t\t//                   盤面の新規作成や、拡大/縮小/回転/反転時などに呼び出される\r\n\t\t// bd.setposGroup()  指定されたタイプのsetpos関数を呼び出す\r\n\t\t// bd.setposCell()   該当するidのセルのbx,byプロパティを設定する\r\n\t\t// bd.setposCross()  該当するidの交差点のbx,byプロパティを設定する\r\n\t\t// bd.setposBorder() 該当するidの境界線/Lineのbx,byプロパティを設定する\r\n\t\t// bd.setposExCell() 該当するidのExtendセルのbx,byプロパティを設定する\r\n\t\t// bd.set_xnum()     crossは存在しないが、bd._xnumだけ設定したい場合に呼び出す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t/* setpos関連関数 */\r\n\t\tsetposAll: function() {\r\n\t\t\tthis.setposCells();\r\n\t\t\tthis.setposCrosses();\r\n\t\t\tthis.setposBorders();\r\n\t\t\tthis.setposExCells();\r\n\t\t},\r\n\t\tsetposGroup: function(group) {\r\n\t\t\tif (group === \"cell\") {\r\n\t\t\t\tthis.setposCells();\r\n\t\t\t} else if (group === \"cross\") {\r\n\t\t\t\tthis.setposCrosses();\r\n\t\t\t} else if (group === \"border\") {\r\n\t\t\t\tthis.setposBorders();\r\n\t\t\t} else if (group === \"excell\") {\r\n\t\t\t\tthis.setposExCells();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tsetposCells: function() {\r\n\t\t\tvar qc = this.cols;\r\n\t\t\tfor (var id = 0; id < this.cell.length; id++) {\r\n\t\t\t\tvar cell = this.cell[id];\r\n\t\t\t\tcell.id = id;\r\n\t\t\t\tcell.isnull = false;\r\n\r\n\t\t\t\tcell.bx = (id % qc) * 2 + 1;\r\n\t\t\t\tcell.by = ((id / qc) << 1) + 1;\r\n\r\n\t\t\t\tcell.initAdjacent();\r\n\t\t\t\tcell.initAdjBorder();\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetposCrosses: function() {\r\n\t\t\tvar qc = this.cols;\r\n\t\t\tfor (var id = 0; id < this.cross.length; id++) {\r\n\t\t\t\tvar cross = this.cross[id];\r\n\t\t\t\tcross.id = id;\r\n\t\t\t\tcross.isnull = false;\r\n\r\n\t\t\t\tcross.bx = (id % (qc + 1)) * 2;\r\n\t\t\t\tcross.by = (id / (qc + 1)) << 1;\r\n\r\n\t\t\t\tcross.initAdjBorder();\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetposBorders: function() {\r\n\t\t\tvar qc = this.cols,\r\n\t\t\t\tqr = this.rows;\r\n\t\t\tvar bdinside = 2 * qc * qr - qc - qr;\r\n\t\t\tfor (var id = 0; id < this.border.length; id++) {\r\n\t\t\t\tvar border = this.border[id],\r\n\t\t\t\t\ti = id;\r\n\t\t\t\tborder.id = id;\r\n\t\t\t\tborder.isnull = false;\r\n\r\n\t\t\t\tif (i >= 0 && i < (qc - 1) * qr) {\r\n\t\t\t\t\tborder.bx = (i % (qc - 1)) * 2 + 2;\r\n\t\t\t\t\tborder.by = ((i / (qc - 1)) << 1) + 1;\r\n\t\t\t\t}\r\n\t\t\t\ti -= (qc - 1) * qr;\r\n\t\t\t\tif (i >= 0 && i < qc * (qr - 1)) {\r\n\t\t\t\t\tborder.bx = (i % qc) * 2 + 1;\r\n\t\t\t\t\tborder.by = ((i / qc) << 1) + 2;\r\n\t\t\t\t}\r\n\t\t\t\ti -= qc * (qr - 1);\r\n\t\t\t\tif (this.hasborder === 2) {\r\n\t\t\t\t\tif (i >= 0 && i < qc) {\r\n\t\t\t\t\t\tborder.bx = i * 2 + 1;\r\n\t\t\t\t\t\tborder.by = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ti -= qc;\r\n\t\t\t\t\tif (i >= 0 && i < qc) {\r\n\t\t\t\t\t\tborder.bx = i * 2 + 1;\r\n\t\t\t\t\t\tborder.by = 2 * qr;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ti -= qc;\r\n\t\t\t\t\tif (i >= 0 && i < qr) {\r\n\t\t\t\t\t\tborder.bx = 0;\r\n\t\t\t\t\t\tborder.by = i * 2 + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ti -= qr;\r\n\t\t\t\t\tif (i >= 0 && i < qr) {\r\n\t\t\t\t\t\tborder.bx = 2 * qc;\r\n\t\t\t\t\t\tborder.by = i * 2 + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ti -= qr;\r\n\t\t\t\t}\r\n\t\t\t\tborder.isvert = !(border.bx & 1);\r\n\t\t\t\tborder.inside = id < bdinside;\r\n\r\n\t\t\t\tborder.initSideObject();\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetposExCells: function() {\r\n\t\t\tvar exrows = this.excellRows(this.cols, this.rows),\r\n\t\t\t\texcols = this.excellCols(this.cols, this.rows),\r\n\t\t\t\tqc = this.cols * exrows,\r\n\t\t\t\tqr = this.rows * excols;\r\n\t\t\tfor (var id = 0; id < this.excell.length; id++) {\r\n\t\t\t\tvar excell = this.excell[id],\r\n\t\t\t\t\ti = id;\r\n\t\t\t\texcell.id = id;\r\n\t\t\t\texcell.isnull = false;\r\n\r\n\t\t\t\tif (this.hasexcell === 1) {\r\n\t\t\t\t\tif (i >= 0 && i < qc) {\r\n\t\t\t\t\t\texcell.bx = ((i / exrows) | 0) * 2 + 1;\r\n\t\t\t\t\t\texcell.by = (i % exrows) * -2 - 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ti -= qc;\r\n\t\t\t\t\tif (i >= 0 && i < qr) {\r\n\t\t\t\t\t\texcell.bx = (i % excols) * -2 - 1;\r\n\t\t\t\t\t\texcell.by = ((i / excols) | 0) * 2 + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ti -= qr;\r\n\t\t\t\t\tif (i === 0 && excell.ques === 51) {\r\n\t\t\t\t\t\texcell.bx = -1;\r\n\t\t\t\t\t\texcell.by = -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ti--; /* 左上角のExCellを追加 */\r\n\t\t\t\t} else if (this.hasexcell === 2) {\r\n\t\t\t\t\tif (i >= 0 && i < qc) {\r\n\t\t\t\t\t\texcell.bx = i * 2 + 1;\r\n\t\t\t\t\t\texcell.by = -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ti -= qc;\r\n\t\t\t\t\tif (i >= 0 && i < qc) {\r\n\t\t\t\t\t\texcell.bx = i * 2 + 1;\r\n\t\t\t\t\t\texcell.by = 2 * qr + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ti -= qc;\r\n\t\t\t\t\tif (i >= 0 && i < qr) {\r\n\t\t\t\t\t\texcell.bx = -1;\r\n\t\t\t\t\t\texcell.by = i * 2 + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ti -= qr;\r\n\t\t\t\t\tif (i >= 0 && i < qr) {\r\n\t\t\t\t\t\texcell.bx = 2 * qc + 1;\r\n\t\t\t\t\t\texcell.by = i * 2 + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ti -= qr;\r\n\t\t\t\t}\r\n\r\n\t\t\t\texcell.initAdjacent();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// bd.setminmax()   盤面のbx,byの最小値/最大値をセットする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetminmax: function() {\r\n\t\t\tvar extUL = this.hasexcell > 0;\r\n\t\t\tvar extDR = this.hasexcell === 2;\r\n\t\t\tthis.minbx = !extUL ? 0 : -2 * this.excellCols(this.cols, this.rows);\r\n\t\t\tthis.minby = !extUL ? 0 : -2 * this.excellRows(this.cols, this.rows);\r\n\t\t\tthis.maxbx = !extDR ? 2 * this.cols : 2 * this.cols + 2;\r\n\t\t\tthis.maxby = !extDR ? 2 * this.rows : 2 * this.rows + 2;\r\n\r\n\t\t\tthis.puzzle.cursor.setminmax();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// bd.allclear() 全てのCell, Cross, Borderオブジェクトのallclear()を呼び出す\r\n\t\t// bd.ansclear() 全てのCell, Cross, Borderオブジェクトのansclear()を呼び出す\r\n\t\t// bd.subclear() 全てのCell, Cross, Borderオブジェクトのsubclear()を呼び出す\r\n\t\t// bd.errclear() 全てのCell, Cross, Borderオブジェクトのerrorプロパティを0にして、Canvasを再描画する\r\n\t\t// bd.trialclear() 全てのCell, Cross, Borderオブジェクトのtrialプロパティを0にして、Canvasを再描画する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// 呼び出し元：this.initBoardSize()\r\n\t\tallclear: function(isrec) {\r\n\t\t\tthis.cell.allclear(isrec);\r\n\t\t\tthis.cross.allclear(isrec);\r\n\t\t\tthis.border.allclear(isrec);\r\n\t\t\tthis.excell.allclear(isrec);\r\n\t\t\tif (isrec) {\r\n\t\t\t\tthis.puzzle.opemgr.rejectTrial(true);\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 呼び出し元：回答消去ボタン押した時\r\n\t\tansclear: function() {\r\n\t\t\tvar opemgr = this.puzzle.opemgr;\r\n\t\t\topemgr.rejectTrial(true);\r\n\t\t\topemgr.newOperation();\r\n\t\t\topemgr.add(new this.puzzle.klass.BoardClearOperation());\r\n\r\n\t\t\tthis.cell.ansclear();\r\n\t\t\tthis.cross.ansclear();\r\n\t\t\tthis.border.ansclear();\r\n\t\t\tthis.excell.ansclear();\r\n\t\t\tthis.rebuildInfo();\r\n\t\t},\r\n\t\t// 呼び出し元：補助消去ボタン押した時\r\n\t\tsubclear: function() {\r\n\t\t\tthis.puzzle.opemgr.newOperation();\r\n\r\n\t\t\tthis.cell.subclear();\r\n\t\t\tthis.cross.subclear();\r\n\t\t\tthis.border.subclear();\r\n\t\t\tthis.excell.subclear();\r\n\t\t},\r\n\r\n\t\terrclear: function() {\r\n\t\t\tvar isclear = this.haserror || this.hasinfo;\r\n\t\t\tif (isclear) {\r\n\t\t\t\tthis.cell.errclear();\r\n\t\t\t\tthis.cross.errclear();\r\n\t\t\t\tthis.border.errclear();\r\n\t\t\t\tthis.excell.errclear();\r\n\t\t\t\tthis.haserror = false;\r\n\t\t\t\tthis.hasinfo = false;\r\n\t\t\t}\r\n\t\t\treturn isclear;\r\n\t\t},\r\n\r\n\t\ttrialclear: function(forcemode) {\r\n\t\t\tif (this.trialstage > 0 || !!forcemode) {\r\n\t\t\t\tthis.cell.trialclear();\r\n\t\t\t\tthis.cross.trialclear();\r\n\t\t\t\tthis.border.trialclear();\r\n\t\t\t\tthis.excell.trialclear();\r\n\t\t\t\tthis.puzzle.redraw();\r\n\t\t\t\tthis.trialstage = 0;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// bd.getObjectPos()  (X,Y)の位置にあるオブジェクトを計算して返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetObjectPos: function(group, bx, by) {\r\n\t\t\tvar obj = this.nullobj;\r\n\t\t\tif (group === \"cell\") {\r\n\t\t\t\tobj = this.getc(bx, by);\r\n\t\t\t} else if (group === \"cross\") {\r\n\t\t\t\tobj = this.getx(bx, by);\r\n\t\t\t} else if (group === \"border\") {\r\n\t\t\t\tobj = this.getb(bx, by);\r\n\t\t\t} else if (group === \"excell\") {\r\n\t\t\t\tobj = this.getex(bx, by);\r\n\t\t\t} else if (group === \"obj\") {\r\n\t\t\t\tobj = this.getobj(bx, by);\r\n\t\t\t}\r\n\t\t\treturn obj;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// bd.getc()  (X,Y)の位置にあるCellオブジェクトを返す\r\n\t\t// bd.getx()  (X,Y)の位置にあるCrossオブジェクトを返す\r\n\t\t// bd.getb()  (X,Y)の位置にあるBorderオブジェクトを返す\r\n\t\t// bd.getex() (X,Y)の位置にあるextendCellオブジェクトを返す\r\n\t\t// bd.getobj() (X,Y)の位置にある何らかのオブジェクトを返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetc: function(bx, by) {\r\n\t\t\tvar id = null,\r\n\t\t\t\tqc = this.cols,\r\n\t\t\t\tqr = this.rows;\r\n\t\t\tif (\r\n\t\t\t\tbx < 0 ||\r\n\t\t\t\tbx > qc << 1 ||\r\n\t\t\t\tby < 0 ||\r\n\t\t\t\tby > qr << 1 ||\r\n\t\t\t\t!(bx & 1) ||\r\n\t\t\t\t!(by & 1)\r\n\t\t\t) {\r\n\t\t\t} else {\r\n\t\t\t\tid = (bx >> 1) + (by >> 1) * qc;\r\n\t\t\t}\r\n\r\n\t\t\treturn id !== null ? this.cell[id] : this.emptycell;\r\n\t\t},\r\n\t\tgetx: function(bx, by) {\r\n\t\t\tvar id = null,\r\n\t\t\t\tqc = this.cols,\r\n\t\t\t\tqr = this.rows;\r\n\t\t\tif (\r\n\t\t\t\tbx < 0 ||\r\n\t\t\t\tbx > qc << 1 ||\r\n\t\t\t\tby < 0 ||\r\n\t\t\t\tby > qr << 1 ||\r\n\t\t\t\t!!(bx & 1) ||\r\n\t\t\t\t!!(by & 1)\r\n\t\t\t) {\r\n\t\t\t} else {\r\n\t\t\t\tid = (bx >> 1) + (by >> 1) * (qc + 1);\r\n\t\t\t}\r\n\r\n\t\t\tif (this.hascross !== 0) {\r\n\t\t\t\treturn id !== null ? this.cross[id] : this.emptycross;\r\n\t\t\t}\r\n\t\t\treturn this.emptycross;\r\n\t\t},\r\n\t\tgetb: function(bx, by) {\r\n\t\t\tvar id = null,\r\n\t\t\t\tqc = this.cols,\r\n\t\t\t\tqr = this.rows;\r\n\t\t\tif (\r\n\t\t\t\t!!this.hasborder &&\r\n\t\t\t\tbx >= 1 &&\r\n\t\t\t\tbx <= 2 * qc - 1 &&\r\n\t\t\t\tby >= 1 &&\r\n\t\t\t\tby <= 2 * qr - 1\r\n\t\t\t) {\r\n\t\t\t\tif (!(bx & 1) && by & 1) {\r\n\t\t\t\t\tid = (bx >> 1) - 1 + (by >> 1) * (qc - 1);\r\n\t\t\t\t} else if (bx & 1 && !(by & 1)) {\r\n\t\t\t\t\tid = (bx >> 1) + ((by >> 1) - 1) * qc + (qc - 1) * qr;\r\n\t\t\t\t}\r\n\t\t\t} else if (this.hasborder === 2) {\r\n\t\t\t\tif (by === 0 && bx & 1 && bx >= 1 && bx <= 2 * qc - 1) {\r\n\t\t\t\t\tid = (qc - 1) * qr + qc * (qr - 1) + (bx >> 1);\r\n\t\t\t\t} else if (by === 2 * qr && bx & 1 && bx >= 1 && bx <= 2 * qc - 1) {\r\n\t\t\t\t\tid = (qc - 1) * qr + qc * (qr - 1) + qc + (bx >> 1);\r\n\t\t\t\t} else if (bx === 0 && by & 1 && by >= 1 && by <= 2 * qr - 1) {\r\n\t\t\t\t\tid = (qc - 1) * qr + qc * (qr - 1) + 2 * qc + (by >> 1);\r\n\t\t\t\t} else if (bx === 2 * qc && by & 1 && by >= 1 && by <= 2 * qr - 1) {\r\n\t\t\t\t\tid = (qc - 1) * qr + qc * (qr - 1) + 2 * qc + qr + (by >> 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn id !== null ? this.border[id] : this.emptyborder;\r\n\t\t},\r\n\t\tgetex: function(bx, by) {\r\n\t\t\tvar xr = this.excellRows(this.cols, this.rows);\r\n\t\t\tvar xc = this.excellCols(this.cols, this.rows);\r\n\t\t\tvar id = null,\r\n\t\t\t\tqc = this.cols * xr,\r\n\t\t\t\tqr = this.rows * xc;\r\n\r\n\t\t\tif (this.hasexcell === 1) {\r\n\t\t\t\tif (this.emptyexcell.ques === 51 && bx === -1 && by === -1) {\r\n\t\t\t\t\tid = qc + qr; /* 左上角のExCellを追加 */\r\n\t\t\t\t} else if (by >= this.minby && by < 0 && bx > 0 && bx < 2 * qc) {\r\n\t\t\t\t\tid = (-by >> 1) + (bx >> 1) * xr;\r\n\t\t\t\t} else if (bx >= this.minbx && bx < 0 && by > 0 && by < 2 * qr) {\r\n\t\t\t\t\tid = (-bx >> 1) + qc + (by >> 1) * xc;\r\n\t\t\t\t}\r\n\t\t\t} else if (this.hasexcell === 2) {\r\n\t\t\t\tif (by === -1 && bx > 0 && bx < 2 * qc) {\r\n\t\t\t\t\tid = bx >> 1;\r\n\t\t\t\t} else if (by === 2 * qr + 1 && bx > 0 && bx < 2 * qc) {\r\n\t\t\t\t\tid = qc + (bx >> 1);\r\n\t\t\t\t} else if (bx === -1 && by > 0 && by < 2 * qr) {\r\n\t\t\t\t\tid = 2 * qc + (by >> 1);\r\n\t\t\t\t} else if (bx === 2 * qc + 1 && by > 0 && by < 2 * qr) {\r\n\t\t\t\t\tid = 2 * qc + qr + (by >> 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn id !== null ? this.excell[id] : this.emptyexcell;\r\n\t\t},\r\n\r\n\t\tgetobj: function(bx, by) {\r\n\t\t\tif ((bx + by) & 1) {\r\n\t\t\t\treturn this.getb(bx, by);\r\n\t\t\t} else if (!(bx & 1) && !(by & 1)) {\r\n\t\t\t\treturn this.getx(bx, by);\r\n\t\t\t}\r\n\r\n\t\t\tvar cell = this.getc(bx, by);\r\n\t\t\treturn cell !== this.emptycell || !this.hasexcell\r\n\t\t\t\t? cell\r\n\t\t\t\t: this.getex(bx, by);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// bd.operate()  BoardExecの拡大縮小・回転反転処理を実行する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\toperate: function(type) {\r\n\t\t\tif (this.trialstage > 0 && this.exec.isBoardOp(type)) {\r\n\t\t\t\tthrow \"board operations are not possible in trial mode\";\r\n\t\t\t}\r\n\t\t\tthis.exec.execadjust(type);\r\n\t\t},\r\n\r\n\t\tflushexcell: function() {\r\n\t\t\tthis.puzzle.opemgr.newOperation();\r\n\t\t\tvar cols = this.cols,\r\n\t\t\t\trows = this.rows,\r\n\t\t\t\texcell = this.excell;\r\n\t\t\tthis.genericFlush(\r\n\t\t\t\tthis.excellCols(cols, rows),\r\n\t\t\t\tthis.excellRows(cols, rows),\r\n\t\t\t\tcols,\r\n\t\t\t\trows,\r\n\t\t\t\tfunction(i) {\r\n\t\t\t\t\treturn excell[i].qnum;\r\n\t\t\t\t},\r\n\t\t\t\tfunction(i, num) {\r\n\t\t\t\t\texcell[i].setQnum(num);\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t\tthis.puzzle.redraw();\r\n\t\t},\r\n\r\n\t\tgenericFlush: function(excols, exrows, cols, rows, get_func, set_func) {\r\n\t\t\tvar qc = cols * exrows,\r\n\t\t\t\tqr = rows * excols,\r\n\t\t\t\tdest = 0;\r\n\r\n\t\t\tfor (var id = 0; id < qc + qr; id++) {\r\n\t\t\t\tif (get_func(id) !== -1) {\r\n\t\t\t\t\tif (id !== dest - 1) {\r\n\t\t\t\t\t\tset_func(dest, get_func(id));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdest++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\t(id < qc && id % exrows === exrows - 1) ||\r\n\t\t\t\t\t(id >= qc && (id - qc) % excols === excols - 1)\r\n\t\t\t\t) {\r\n\t\t\t\t\tfor (var b = dest; b <= id; b++) {\r\n\t\t\t\t\t\tset_func(b, -1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdest = id + 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// bd.objectinside() 座標(x1,y1)-(x2,y2)に含まれるオブジェクトのリストを取得する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tobjectinside: function(group, x1, y1, x2, y2) {\r\n\t\t\tif (group === \"cell\") {\r\n\t\t\t\treturn this.cellinside(x1, y1, x2, y2);\r\n\t\t\t} else if (group === \"cross\") {\r\n\t\t\t\treturn this.crossinside(x1, y1, x2, y2);\r\n\t\t\t} else if (group === \"border\") {\r\n\t\t\t\treturn this.borderinside(x1, y1, x2, y2);\r\n\t\t\t} else if (group === \"excell\") {\r\n\t\t\t\treturn this.excellinside(x1, y1, x2, y2);\r\n\t\t\t}\r\n\t\t\treturn new this.klass.PieceList();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// bd.cellinside()   座標(x1,y1)-(x2,y2)に含まれるCellのリストを取得する\r\n\t\t// bd.crossinside()  座標(x1,y1)-(x2,y2)に含まれるCrossのリストを取得する\r\n\t\t// bd.borderinside() 座標(x1,y1)-(x2,y2)に含まれるBorderのリストを取得する\r\n\t\t// bd.excellinside() 座標(x1,y1)-(x2,y2)に含まれるExCellのリストを取得する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcellinside: function(x1, y1, x2, y2) {\r\n\t\t\tvar clist = new this.klass.CellList();\r\n\t\t\tfor (var by = y1 | 1; by <= y2; by += 2) {\r\n\t\t\t\tfor (var bx = x1 | 1; bx <= x2; bx += 2) {\r\n\t\t\t\t\tvar cell = this.getc(bx, by);\r\n\t\t\t\t\tif (!cell.isnull) {\r\n\t\t\t\t\t\tclist.add(cell);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn clist;\r\n\t\t},\r\n\t\tcrossinside: function(x1, y1, x2, y2) {\r\n\t\t\tvar clist = new this.klass.CrossList();\r\n\t\t\tif (!!this.hascross) {\r\n\t\t\t\tfor (var by = y1 + (y1 & 1); by <= y2; by += 2) {\r\n\t\t\t\t\tfor (var bx = x1 + (x1 & 1); bx <= x2; bx += 2) {\r\n\t\t\t\t\t\tvar cross = this.getx(bx, by);\r\n\t\t\t\t\t\tif (!cross.isnull) {\r\n\t\t\t\t\t\t\tclist.add(cross);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn clist;\r\n\t\t},\r\n\t\tborderinside: function(x1, y1, x2, y2) {\r\n\t\t\tvar blist = new this.klass.BorderList();\r\n\t\t\tif (!!this.hasborder) {\r\n\t\t\t\tfor (var by = y1; by <= y2; by++) {\r\n\t\t\t\t\tfor (var bx = x1 + (((x1 + by) & 1) ^ 1); bx <= x2; bx += 2) {\r\n\t\t\t\t\t\tvar border = this.getb(bx, by);\r\n\t\t\t\t\t\tif (!border.isnull) {\r\n\t\t\t\t\t\t\tblist.add(border);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn blist;\r\n\t\t},\r\n\t\texcellinside: function(x1, y1, x2, y2) {\r\n\t\t\tvar exlist = new this.klass.ExCellList();\r\n\t\t\tif (!!this.hasexcell) {\r\n\t\t\t\tfor (var by = y1 | 1; by <= y2; by += 2) {\r\n\t\t\t\t\tfor (var bx = x1 | 1; bx <= x2; bx += 2) {\r\n\t\t\t\t\t\tvar excell = this.getex(bx, by);\r\n\t\t\t\t\t\tif (excell && !excell.isnull) {\r\n\t\t\t\t\t\t\texlist.add(excell);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn exlist;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// bd.disableInfo()  Area/LineManagerへの登録を禁止する\r\n\t\t// bd.enableInfo()   Area/LineManagerへの登録を許可する\r\n\t\t// bd.isenableInfo() 操作の登録できるかを返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdisableInfo: function() {\r\n\t\t\tthis.puzzle.opemgr.disableRecord();\r\n\t\t\tthis.disrecinfo++;\r\n\t\t},\r\n\t\tenableInfo: function() {\r\n\t\t\tthis.puzzle.opemgr.enableRecord();\r\n\t\t\tif (this.disrecinfo > 0) {\r\n\t\t\t\tthis.disrecinfo--;\r\n\t\t\t}\r\n\t\t},\r\n\t\tisenableInfo: function() {\r\n\t\t\treturn this.disrecinfo === 0;\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// bd.rebuildInfo()      部屋、黒マス、白マスの情報を再生成する\r\n\t\t// bd.modifyInfo()       黒マス・白マス・境界線や線が入力されたり消された時に情報を変更する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\trebuildInfo: function() {\r\n\t\t\tthis.infolist.forEach(function(info) {\r\n\t\t\t\tinfo.rebuild();\r\n\t\t\t});\r\n\t\t},\r\n\t\tmodifyInfo: function(obj, type) {\r\n\t\t\tif (!this.isenableInfo()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < this.infolist.length; ++i) {\r\n\t\t\t\tvar info = this.infolist[i];\r\n\t\t\t\tif (!!info.relation[type]) {\r\n\t\t\t\t\tinfo.modifyInfo(obj, type);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// bd.irowakeRemake() 「色分けしなおす」ボタンを押した時などに色分けしなおす\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tirowakeRemake: function() {\r\n\t\t\tfor (var i = 0; i < this.infolist.length; ++i) {\r\n\t\t\t\tvar info = this.infolist[i];\r\n\t\t\t\tif (info.coloring) {\r\n\t\t\t\t\tinfo.newIrowake();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// bd.disableSetError()  盤面のオブジェクトにエラーフラグを設定できないようにする\r\n\t\t// bd.enableSetError()   盤面のオブジェクトにエラーフラグを設定できるようにする\r\n\t\t// bd.isenableSetError() 盤面のオブジェクトにエラーフラグを設定できるかどうかを返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdisableSetError: function() {\r\n\t\t\tthis.diserror++;\r\n\t\t},\r\n\t\tenableSetError: function() {\r\n\t\t\tthis.diserror--;\r\n\t\t},\r\n\t\tisenableSetError: function() {\r\n\t\t\treturn this.diserror <= 0;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// bd.freezecopy()  盤面のオブジェクト値のみを取得する\r\n\t\t// bd.compareData() 盤面のオブジェクト値のみを比較し異なる場合にcallback関数を呼ぶ\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tfreezecopy: function() {\r\n\t\t\tvar bd2 = { cell: [], cross: [], border: [], excell: [] };\r\n\t\t\tfor (var group in bd2) {\r\n\t\t\t\tfor (var c = 0; c < this[group].length; c++) {\r\n\t\t\t\t\tbd2[group][c] = this[group][c].getprops();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn bd2;\r\n\t\t},\r\n\t\tcompareData: function(bd2, callback) {\r\n\t\t\tfor (var group in bd2) {\r\n\t\t\t\tif (!this[group]) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tfor (var c = 0; c < bd2[group].length; c++) {\r\n\t\t\t\t\tif (!this[group][c]) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis[group][c].compare(bd2[group][c], callback);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdotsmax: 0,\r\n\t\tdots: [],\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinitDots: function(col, row) {\r\n\t\t\tthis.dotsmax = (2 * col - 1) * (2 * row - 1);\r\n\t\t\tthis.dots = [];\r\n\t\t\tfor (var id = 0; id < this.dotsmax; id++) {\r\n\t\t\t\tthis.dots[id] = new this.klass.Dot();\r\n\t\t\t\tvar dot = this.dots[id];\r\n\t\t\t\tdot.id = id;\r\n\r\n\t\t\t\tdot.bx = (id % (2 * col - 1)) + 1;\r\n\t\t\t\tdot.by = ((id / (2 * col - 1)) | 0) + 1;\r\n\r\n\t\t\t\tdot.isnull = false;\r\n\t\t\t\tdot.piece = dot.getaddr().getobj();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgetDot: function(bx, by) {\r\n\t\t\tvar qc = this.cols,\r\n\t\t\t\tqr = this.rows;\r\n\t\t\tif (bx <= 0 || bx >= qc << 1 || by <= 0 || by >= qr << 1) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tvar id = bx - 1 + (by - 1) * (2 * qc - 1);\r\n\t\t\tvar dot = this.dots[id];\r\n\t\t\treturn dot.isnull ? null : dot;\r\n\t\t},\r\n\r\n\t\tdotinside: function(x1, y1, x2, y2) {\r\n\t\t\tvar dlist = new this.klass.PieceList();\r\n\t\t\tfor (var by = y1; by <= y2; by++) {\r\n\t\t\t\tfor (var bx = x1; bx <= x2; bx++) {\r\n\t\t\t\t\tvar dot = this.getDot(bx, by);\r\n\t\t\t\t\tif (!!dot) {\r\n\t\t\t\t\t\tdlist.add(dot);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn dlist;\r\n\t\t}\r\n\t}\r\n});\r\n","// BoardExec.js v3.4.1\r\n\r\n(function() {\r\n\t// 拡大縮小・回転反転用定数\r\n\tvar UP = 0x01,\r\n\t\tDN = 0x02,\r\n\t\tLT = 0x03,\r\n\t\tRT = 0x04,\r\n\t\tEXPAND = 0x10,\r\n\t\tREDUCE = 0x20,\r\n\t\tTURN = 0x40,\r\n\t\tFLIP = 0x80;\r\n\r\n\tpzpr.classmgr.makeCommon({\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ★BoardExecクラス 盤面の拡大縮小、反転回転等を行う (MenuExec.js, Board.jsから移動)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tBoardExec: {\r\n\t\t\t// 拡大縮小・回転反転用定数\r\n\t\t\tUP: UP,\r\n\t\t\tDN: DN,\r\n\t\t\tLT: LT,\r\n\t\t\tRT: RT,\r\n\r\n\t\t\tEXPAND: EXPAND,\r\n\t\t\tREDUCE: REDUCE,\r\n\t\t\tTURN: TURN,\r\n\t\t\tFLIP: FLIP,\r\n\t\t\tTURNFLIP: TURN | FLIP,\r\n\r\n\t\t\tEXPANDUP: EXPAND | UP,\r\n\t\t\tEXPANDDN: EXPAND | DN,\r\n\t\t\tEXPANDLT: EXPAND | LT,\r\n\t\t\tEXPANDRT: EXPAND | RT,\r\n\r\n\t\t\tREDUCEUP: REDUCE | UP,\r\n\t\t\tREDUCEDN: REDUCE | DN,\r\n\t\t\tREDUCELT: REDUCE | LT,\r\n\t\t\tREDUCERT: REDUCE | RT,\r\n\r\n\t\t\tTURNL: TURN | 1,\r\n\t\t\tTURNR: TURN | 2,\r\n\r\n\t\t\tFLIPX: FLIP | 1,\r\n\t\t\tFLIPY: FLIP | 2,\r\n\r\n\t\t\tboardtype: {\r\n\t\t\t\texpandup: [REDUCE | UP, EXPAND | UP],\r\n\t\t\t\texpanddn: [REDUCE | DN, EXPAND | DN],\r\n\t\t\t\texpandlt: [REDUCE | LT, EXPAND | LT],\r\n\t\t\t\texpandrt: [REDUCE | RT, EXPAND | RT],\r\n\t\t\t\treduceup: [EXPAND | UP, REDUCE | UP],\r\n\t\t\t\treducedn: [EXPAND | DN, REDUCE | DN],\r\n\t\t\t\treducelt: [EXPAND | LT, REDUCE | LT],\r\n\t\t\t\treducert: [EXPAND | RT, REDUCE | RT],\r\n\t\t\t\tturnl: [TURN | 2, TURN | 1],\r\n\t\t\t\tturnr: [TURN | 1, TURN | 2],\r\n\t\t\t\tflipy: [FLIP | 2, FLIP | 2],\r\n\t\t\t\tflipx: [FLIP | 1, FLIP | 1]\r\n\t\t\t},\r\n\r\n\t\t\t// expand/reduce処理用\r\n\t\t\tqnumw: [], // ques==51の回転･反転用\r\n\t\t\tqnumh: [], // ques==51の回転･反転用\r\n\r\n\t\t\t// expand/reduce処理で消える/増えるオブジェクトの判定用\r\n\t\t\tinsex: {\r\n\t\t\t\tcell: { 1: true },\r\n\t\t\t\tcross: {} /* Board初期化時に設定します */,\r\n\t\t\t\tborder: { 1: true, 2: true },\r\n\t\t\t\texcell: { 1: true }\r\n\t\t\t},\r\n\r\n\t\t\tisBoardOp: function(name) {\r\n\t\t\t\treturn !!this.boardtype[name];\r\n\t\t\t},\r\n\r\n\t\t\t//------------------------------------------------------------------------------\r\n\t\t\t// bd.exec.execadjust()   盤面の調整、回転、反転で対応する関数へジャンプする\r\n\t\t\t// bd.exec.execadjust_main() 盤面の調整、回転、反転処理の実行部\r\n\t\t\t//------------------------------------------------------------------------------\r\n\t\t\texecadjust: function(name) {\r\n\t\t\t\tif (!this.isBoardOp(name)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\t\tbd = this.board;\r\n\t\t\t\tif (name.indexOf(\"reduce\") === 0) {\r\n\t\t\t\t\tif (name === \"reduceup\" || name === \"reducedn\") {\r\n\t\t\t\t\t\tif (bd.rows <= 1) {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (name === \"reducelt\" || name === \"reducert\") {\r\n\t\t\t\t\t\tif (bd.cols <= 1) {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tpuzzle.opemgr.newOperation();\r\n\r\n\t\t\t\tpuzzle.painter.suspendAll();\r\n\r\n\t\t\t\t// undo/redo時はexecadjust_mainを直接呼びます\r\n\t\t\t\tvar d = { x1: 0, y1: 0, x2: 2 * bd.cols, y2: 2 * bd.rows }; // TURNFLIPには範囲が必要\r\n\t\t\t\tthis.execadjust_main(this.boardtype[name][1], d);\r\n\t\t\t\tthis.addOpe(d, name);\r\n\r\n\t\t\t\tbd.setminmax();\r\n\t\t\t\tbd.rebuildInfo();\r\n\r\n\t\t\t\t// Canvasを更新する\r\n\t\t\t\tpuzzle.painter.resizeCanvas();\r\n\t\t\t\tpuzzle.emit(\"adjust\");\r\n\t\t\t\tpuzzle.painter.unsuspend();\r\n\t\t\t},\r\n\t\t\texecadjust_main: function(key, d) {\r\n\t\t\t\tvar bd = this.board;\r\n\t\t\t\tthis.adjustBoardData(key, d);\r\n\t\t\t\tif (bd.roommgr.hastop && key & REDUCE) {\r\n\t\t\t\t\tthis.reduceRoomNumber(key, d);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (key & TURN) {\r\n\t\t\t\t\tvar tmp = bd.cols;\r\n\t\t\t\t\tbd.cols = bd.rows;\r\n\t\t\t\t\tbd.rows = tmp;\r\n\t\t\t\t\td = { x1: 0, y1: 0, x2: 2 * bd.cols, y2: 2 * bd.rows };\r\n\t\t\t\t} else if (key & EXPAND) {\r\n\t\t\t\t\tif (key === this.EXPANDUP || key === this.EXPANDDN) {\r\n\t\t\t\t\t\tbd.rows++;\r\n\t\t\t\t\t} else if (key === this.EXPANDLT || key === this.EXPANDRT) {\r\n\t\t\t\t\t\tbd.cols++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// main operation\r\n\t\t\t\t[\"cell\", \"cross\", \"border\", \"excell\"].forEach(function(group) {\r\n\t\t\t\t\tif (key & EXPAND) {\r\n\t\t\t\t\t\tbd.exec.expandGroup(group, key);\r\n\t\t\t\t\t} else if (key & REDUCE) {\r\n\t\t\t\t\t\tbd.exec.reduceGroup(group, key);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbd.exec.turnflipGroup(group, key, d);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (key & REDUCE) {\r\n\t\t\t\t\tif (key === this.REDUCEUP || key === this.REDUCEDN) {\r\n\t\t\t\t\t\tbd.rows--;\r\n\t\t\t\t\t} else if (key === this.REDUCELT || key === this.REDUCERT) {\r\n\t\t\t\t\t\tbd.cols--;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tbd.setminmax();\r\n\t\t\t\tbd.setposAll();\r\n\r\n\t\t\t\tif (bd.hasdots === 1) {\r\n\t\t\t\t\tbd.initDots(bd.cols, bd.rows);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.adjustBoardData2(key, d);\r\n\t\t\t},\r\n\r\n\t\t\t//------------------------------------------------------------------------------\r\n\t\t\t// bd.exec.addOpe() 指定された盤面(拡大・縮小, 回転・反転)操作を追加する\r\n\t\t\t//------------------------------------------------------------------------------\r\n\t\t\taddOpe: function(d, name) {\r\n\t\t\t\tvar key = this.boardtype[name][1],\r\n\t\t\t\t\tpuzzle = this.puzzle,\r\n\t\t\t\t\tope;\r\n\t\t\t\tif (key & this.TURNFLIP) {\r\n\t\t\t\t\tope = new puzzle.klass.BoardFlipOperation(d, name);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tope = new puzzle.klass.BoardAdjustOperation(name);\r\n\t\t\t\t}\r\n\t\t\t\tpuzzle.opemgr.add(ope);\r\n\t\t\t},\r\n\r\n\t\t\t//------------------------------------------------------------------------------\r\n\t\t\t// bd.exec.expandGroup()  オブジェクトの追加を行う\r\n\t\t\t// bd.exec.reduceGroup()  オブジェクトの消去を行う\r\n\t\t\t// bd.exec.isdel()        消去されるオブジェクトかどうか判定する\r\n\t\t\t//------------------------------------------------------------------------------\r\n\t\t\texpandGroup: function(group, key) {\r\n\t\t\t\tvar bd = this.board;\r\n\t\t\t\tvar margin = bd.initGroup(group, bd.cols, bd.rows);\r\n\t\t\t\tvar groups = bd.getGroup(group);\r\n\t\t\t\tvar groups2 = new groups.constructor();\r\n\t\t\t\tbd.setposGroup(group);\r\n\t\t\t\tfor (var i = groups.length - 1; i >= 0; i--) {\r\n\t\t\t\t\tvar piece = groups[i];\r\n\t\t\t\t\tif (this.isdel(key, piece)) {\r\n\t\t\t\t\t\tpiece = bd.newObject(group, i);\r\n\t\t\t\t\t\tgroups[i] = piece;\r\n\t\t\t\t\t\tgroups2.add(piece);\r\n\t\t\t\t\t\tmargin--;\r\n\t\t\t\t\t} else if (margin > 0) {\r\n\t\t\t\t\t\tgroups[i] = groups[i - margin];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tgroups2.allclear(false);\r\n\r\n\t\t\t\tif (group === \"border\") {\r\n\t\t\t\t\tthis.expandborder(key);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\treduceGroup: function(group, key) {\r\n\t\t\t\tvar bd = this.board;\r\n\t\t\t\tif (group === \"border\") {\r\n\t\t\t\t\tthis.reduceborder(key);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar margin = 0,\r\n\t\t\t\t\tgroups = bd.getGroup(group),\r\n\t\t\t\t\tgroups2 = new groups.constructor();\r\n\t\t\t\tfor (var i = 0; i < groups.length; i++) {\r\n\t\t\t\t\tvar piece = groups[i];\r\n\t\t\t\t\tif (this.isdel(key, piece)) {\r\n\t\t\t\t\t\tpiece.id = i;\r\n\t\t\t\t\t\tgroups2.add(piece);\r\n\t\t\t\t\t\tmargin++;\r\n\t\t\t\t\t} else if (margin > 0) {\r\n\t\t\t\t\t\tgroups[i - margin] = groups[i];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar opemgr = this.puzzle.opemgr;\r\n\t\t\t\tif (!opemgr.undoExec && !opemgr.redoExec) {\r\n\t\t\t\t\topemgr.forceRecord = true;\r\n\t\t\t\t\tgroups2.allclear(true);\r\n\t\t\t\t\topemgr.forceRecord = false;\r\n\t\t\t\t}\r\n\t\t\t\tfor (var i = 0; i < margin; i++) {\r\n\t\t\t\t\tgroups.pop();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tisdel: function(key, piece) {\r\n\t\t\t\tif (piece.group === \"excell\" && key & (this.EXPAND | this.REDUCE)) {\r\n\t\t\t\t\tvar bd = this.board,\r\n\t\t\t\t\t\toldcols = bd.cols,\r\n\t\t\t\t\t\toldrows = bd.rows;\r\n\r\n\t\t\t\t\tif ((key & 7) === this.UP || (key & 7) === this.DN) {\r\n\t\t\t\t\t\toldrows--;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toldcols--;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar oldexcols = bd.excellCols(oldcols, oldrows);\r\n\t\t\t\t\tvar oldexrows = bd.excellRows(oldcols, oldrows);\r\n\r\n\t\t\t\t\tvar oldminx = oldexcols * -2 + 1;\r\n\t\t\t\t\tvar oldminy = oldexrows * -2 + 1;\r\n\r\n\t\t\t\t\tif (piece.bx < oldminx || piece.by < oldminy) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn !!this.insex[piece.group][this.distObj(key, piece)];\r\n\t\t\t},\r\n\r\n\t\t\t//------------------------------------------------------------------------------\r\n\t\t\t// bd.exec.turnflipGroup() execadjust_main()から内部的に呼ばれる回転反転実行部\r\n\t\t\t//------------------------------------------------------------------------------\r\n\t\t\tturnflipGroup: function(group, key, d) {\r\n\t\t\t\tvar bd = this.board;\r\n\t\t\t\tif (group === \"excell\") {\r\n\t\t\t\t\tif (bd.hasexcell === 1 && key & this.FLIP) {\r\n\t\t\t\t\t\tvar d2 = { x1: d.x1, y1: d.y1, x2: d.x2, y2: d.y2 };\r\n\t\t\t\t\t\tif (key === this.FLIPY) {\r\n\t\t\t\t\t\t\td2.x1 = bd.excellCols(bd.cols, bd.rows) * -2 + 1;\r\n\t\t\t\t\t\t\td2.x2 = -1;\r\n\t\t\t\t\t\t} else if (key === this.FLIPX) {\r\n\t\t\t\t\t\t\td2.y1 = bd.excellRows(bd.cols, bd.rows) * -2 + 1;\r\n\t\t\t\t\t\t\td2.y2 = -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\td = d2;\r\n\t\t\t\t\t} else if (bd.hasexcell === 2) {\r\n\t\t\t\t\t\td = { x1: -1, y1: -1, x2: d.x2 + 1, y2: d.y2 + 1 };\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar objlist = bd.objectinside(group, d.x1, d.y1, d.x2, d.y2);\r\n\t\t\t\tvar converted = {},\r\n\t\t\t\t\txx = d.x1 + d.x2,\r\n\t\t\t\t\tyy = d.y1 + d.y2;\r\n\t\t\t\tfor (var i = 0; i < objlist.length; i++) {\r\n\t\t\t\t\tvar obj = objlist[i],\r\n\t\t\t\t\t\tid = null;\r\n\t\t\t\t\tswitch (key) {\r\n\t\t\t\t\t\tcase this.FLIPY:\r\n\t\t\t\t\t\t\tid = bd.getObjectPos(group, obj.bx, yy - obj.by).id;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase this.FLIPX:\r\n\t\t\t\t\t\t\tid = bd.getObjectPos(group, xx - obj.bx, obj.by).id;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase this.TURNL:\r\n\t\t\t\t\t\t\tid = bd.getObjectPos(group, obj.by, yy - obj.bx).id;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase this.TURNR:\r\n\t\t\t\t\t\t\tid = bd.getObjectPos(group, xx - obj.by, obj.bx).id;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconverted[id] = obj;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar groups = bd.getGroup(group);\r\n\t\t\t\tfor (var n in converted) {\r\n\t\t\t\t\tgroups[+n] = converted[n];\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// bd.exec.distObj()      上下左右いずれかの外枠との距離を求める\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tdistObj: function(key, piece) {\r\n\t\t\t\tvar bd = this.board;\r\n\t\t\t\tif (piece.isnull) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tkey &= 0x0f;\r\n\t\t\t\tif (key === this.UP) {\r\n\t\t\t\t\treturn piece.by;\r\n\t\t\t\t} else if (key === this.DN) {\r\n\t\t\t\t\treturn 2 * bd.rows - piece.by;\r\n\t\t\t\t} else if (key === this.LT) {\r\n\t\t\t\t\treturn piece.bx;\r\n\t\t\t\t} else if (key === this.RT) {\r\n\t\t\t\t\treturn 2 * bd.cols - piece.bx;\r\n\t\t\t\t}\r\n\t\t\t\treturn -1;\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// bd.exec.expandborder() 盤面の拡大時、境界線を伸ばす\r\n\t\t\t// bd.exec.reduceborder() 盤面の縮小時、線を移動する\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\texpandborder: function(key) {\r\n\t\t\t\tvar bd = this.board,\r\n\t\t\t\t\tbdAsLine = bd.borderAsLine;\r\n\t\t\t\t// borderAsLineじゃないUndo時は、後でオブジェクトを代入するので下の処理はパス\r\n\t\t\t\tif (bdAsLine || !bd.puzzle.opemgr.undoExec) {\r\n\t\t\t\t\tvar group2 = new this.klass.BorderList();\r\n\t\t\t\t\t// 直前のexpandGroupで、bx,byプロパティが不定なままなので設定する\r\n\t\t\t\t\tbd.setposBorders();\r\n\r\n\t\t\t\t\tvar dist = bdAsLine ? 2 : 1;\r\n\t\t\t\t\tfor (var id = 0; id < bd.border.length; id++) {\r\n\t\t\t\t\t\tvar border = bd.border[id];\r\n\t\t\t\t\t\tif (this.distObj(key, border) !== dist) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar source = bdAsLine\r\n\t\t\t\t\t\t\t? this.outerBorder(id, key)\r\n\t\t\t\t\t\t\t: this.innerBorder(id, key);\r\n\t\t\t\t\t\tthis.copyBorder(border, source);\r\n\t\t\t\t\t\tgroup2.add(source);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (bdAsLine) {\r\n\t\t\t\t\t\tgroup2.allclear(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\treduceborder: function(key) {\r\n\t\t\t\tvar bd = this.board;\r\n\t\t\t\tif (bd.borderAsLine) {\r\n\t\t\t\t\tfor (var id = 0; id < bd.border.length; id++) {\r\n\t\t\t\t\t\tvar border = bd.border[id];\r\n\t\t\t\t\t\tif (this.distObj(key, border) !== 0) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar source = this.innerBorder(id, key);\r\n\t\t\t\t\t\tthis.copyBorder(border, source);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// bd.exec.copyBorder()   (expand/reduceBorder用) 指定したデータをコピーする\r\n\t\t\t// bd.exec.innerBorder()  (expand/reduceBorder用) ひとつ内側に入ったborderのidを返す\r\n\t\t\t// bd.exec.outerBorder()  (expand/reduceBorder用) ひとつ外側に行ったborderのidを返す\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tcopyBorder: function(border1, border2) {\r\n\t\t\t\tborder1.ques = border2.ques;\r\n\t\t\t\tborder1.qans = border2.qans;\r\n\t\t\t\tif (this.board.borderAsLine) {\r\n\t\t\t\t\tborder1.line = border2.line;\r\n\t\t\t\t\tborder1.qsub = border2.qsub;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tinnerBorder: function(id, key) {\r\n\t\t\t\tvar border = this.board.border[id];\r\n\t\t\t\tkey &= 0x0f;\r\n\t\t\t\tif (key === this.UP) {\r\n\t\t\t\t\treturn border.relbd(0, 2);\r\n\t\t\t\t} else if (key === this.DN) {\r\n\t\t\t\t\treturn border.relbd(0, -2);\r\n\t\t\t\t} else if (key === this.LT) {\r\n\t\t\t\t\treturn border.relbd(2, 0);\r\n\t\t\t\t} else if (key === this.RT) {\r\n\t\t\t\t\treturn border.relbd(-2, 0);\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t},\r\n\t\t\touterBorder: function(id, key) {\r\n\t\t\t\tvar border = this.board.border[id];\r\n\t\t\t\tkey &= 0x0f;\r\n\t\t\t\tif (key === this.UP) {\r\n\t\t\t\t\treturn border.relbd(0, -2);\r\n\t\t\t\t} else if (key === this.DN) {\r\n\t\t\t\t\treturn border.relbd(0, 2);\r\n\t\t\t\t} else if (key === this.LT) {\r\n\t\t\t\t\treturn border.relbd(-2, 0);\r\n\t\t\t\t} else if (key === this.RT) {\r\n\t\t\t\t\treturn border.relbd(2, 0);\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// bd.exec.reduceRoomNumber()   盤面縮小時に数字つき部屋の処理を行う\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\treduceRoomNumber: function(key, d) {\r\n\t\t\t\tvar qnums = [];\r\n\t\t\t\tvar bd = this.board;\r\n\t\t\t\tfor (var c = 0; c < bd.cell.length; c++) {\r\n\t\t\t\t\tvar cell = bd.cell[c];\r\n\t\t\t\t\tif (!!this.insex.cell[this.distObj(key, cell)]) {\r\n\t\t\t\t\t\tif (cell.qnum !== -1) {\r\n\t\t\t\t\t\t\tqnums.push({\r\n\t\t\t\t\t\t\t\tcell: cell,\r\n\t\t\t\t\t\t\t\tarea: cell.room,\r\n\t\t\t\t\t\t\t\tpos: [cell.bx, cell.by],\r\n\t\t\t\t\t\t\t\tval: cell.qnum\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tcell.qnum = -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcell.room.clist.remove(cell);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfor (var i = 0; i < qnums.length; i++) {\r\n\t\t\t\t\tvar data = qnums[i],\r\n\t\t\t\t\t\tarea = data.area;\r\n\t\t\t\t\tvar tcell = area.clist.getTopCell();\r\n\t\t\t\t\tif (tcell.isnull) {\r\n\t\t\t\t\t\tvar opemgr = this.puzzle.opemgr;\r\n\t\t\t\t\t\tif (!opemgr.undoExec && !opemgr.redoExec) {\r\n\t\t\t\t\t\t\topemgr.forceRecord = true;\r\n\t\t\t\t\t\t\tdata.cell.addOpe(\"qnum\", data.val, -1);\r\n\t\t\t\t\t\t\topemgr.forceRecord = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttcell.qnum = data.val;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t//------------------------------------------------------------------------------\r\n\t\t\t// bd.exec.adjustBoardData()    回転・反転開始前に各セルの調節を行う(共通処理)\r\n\t\t\t// bd.exec.adjustBoardData2()   回転・反転終了後に各セルの調節を行う(共通処理)\r\n\t\t\t//------------------------------------------------------------------------------\r\n\t\t\tadjustBoardData: function(key, d) {},\r\n\t\t\tadjustBoardData2: function(key, d) {}\r\n\t\t}\r\n\t});\r\n})();\r\n","// GraphBase.js\r\n\r\n//---------------------------------------------------------------------------\r\n// ★GraphBaseクラス 線や領域情報を管理する\r\n//---------------------------------------------------------------------------\r\n// GraphBaseクラスの定義\r\npzpr.classmgr.makeCommon({\r\n\tGraphBase: {\r\n\t\tenabled: false,\r\n\t\trelation: {},\r\n\r\n\t\tpointgroup: \"\",\r\n\t\tlinkgroup: \"\",\r\n\r\n\t\tcoloring: false,\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// graph.removeFromArray()    Arrayからitemを取り除く\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tremoveFromArray: function(array, item) {\r\n\t\t\tvar idx = array.indexOf(item);\r\n\t\t\tif (idx >= 0) {\r\n\t\t\t\tArray.prototype.splice.call(array, idx, 1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// graph.setComponentRefs()    objにcomponentの設定を行う (性能対策)\r\n\t\t//\r\n\t\t// graph.getObjNodeList()      objにあるnodeを取得する\r\n\t\t// graph.resetObjNodeList()    objからnodeをクリアする\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tsetComponentRefs: function(obj, component) {},\r\n\r\n\t\tgetObjNodeList: function(nodeobj) {\r\n\t\t\treturn [];\r\n\t\t},\r\n\t\tresetObjNodeList: function(nodeobj) {},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// graph.isnodevalid()           そのセルにNodeが存在すべきかどうか返す\r\n\t\t// graph.isedgevalidbylinkobj()  そのborderにEdgeが存在すべきかどうか返す\r\n\t\t// graph.isedgevalidbynodeobj()  接続してはいけないかどうか判定する\r\n\t\t// graph.isedgeexistsbylinkobj() linkobjにedgeが存在するか判定する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tisnodevalid: function(nodeobj) {\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tisedgevalidbylinkobj: function(linkobj) {\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tisedgevalidbynodeobj: function(nodeobj1, nodeobj2) {\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tisedgeexistsbylinkobj: function(linkobj) {\r\n\t\t\tvar sidenodes = this.getSideNodesBySeparator(linkobj);\r\n\t\t\tif (!sidenodes) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn sidenodes[0].nodes.indexOf(sidenodes[1]) >= 0;\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// graph.calcNodeCount()    そのセルにあるべきNode数を返す\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tcalcNodeCount: function(cell) {\r\n\t\t\treturn this.isnodevalid(cell) ? 1 : 0;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// graph.rebuild()  既存の情報からデータを再設定する\r\n\t\t// graph.rebuild2() 継承先に固有のデータを設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\trebuildmode: false,\r\n\t\trebuild: function() {\r\n\t\t\tif (!this.enabled) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.rebuildmode = true;\r\n\r\n\t\t\tthis.components = [];\r\n\t\t\tthis.modifyNodes = [];\r\n\r\n\t\t\tthis.rebuild2();\r\n\r\n\t\t\tthis.searchGraph();\r\n\r\n\t\t\tthis.rebuildmode = false;\r\n\t\t},\r\n\t\trebuild2: function() {\r\n\t\t\tvar nodeobjs = this.board[this.pointgroup],\r\n\t\t\t\tlinkobjs = this.board[this.linkgroup];\r\n\t\t\tfor (var c = 0; c < nodeobjs.length; c++) {\r\n\t\t\t\tthis.setComponentRefs(nodeobjs[c], null);\r\n\t\t\t\tthis.resetObjNodeList(nodeobjs[c]);\r\n\t\t\t\tif (this.isnodevalid(nodeobjs[c])) {\r\n\t\t\t\t\tthis.createNode(nodeobjs[c]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.linkgroup) {\r\n\t\t\t\tfor (var id = 0; id < linkobjs.length; id++) {\r\n\t\t\t\t\tthis.setComponentRefs(linkobjs[id], null);\r\n\t\t\t\t\tif (this.isedgevalidbylinkobj(linkobjs[id])) {\r\n\t\t\t\t\t\tthis.addEdgeByLinkObj(linkobjs[id]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfor (var c = 0; c < nodeobjs.length; c++) {\r\n\t\t\t\t\tif (this.isnodevalid(nodeobjs[c])) {\r\n\t\t\t\t\t\tthis.setEdgeByNodeObj(nodeobjs[c]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// graph.createComponent()  GraphComponentオブジェクトを作成する\r\n\t\t// graph.deleteComponent()  GraphComponentオブジェクトを削除してNodeをmodifyNodesに戻す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcreateComponent: function() {\r\n\t\t\tvar component = new this.klass.GraphComponent();\r\n\t\t\tthis.components.push(component);\r\n\t\t\treturn component;\r\n\t\t},\r\n\t\tdeleteComponent: function(component) {\r\n\t\t\tfor (var i = 0; i < component.nodes.length; i++) {\r\n\t\t\t\tthis.modifyNodes.push(component.nodes[i]);\r\n\t\t\t\tthis.setComponentRefs(component.nodes[i].obj, null);\r\n\t\t\t\tcomponent.nodes[i].component = null;\r\n\t\t\t}\r\n\t\t\tthis.removeFromArray(this.components, component);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// graph.createNode()    GraphNodeオブジェクトを生成する\r\n\t\t// graph.deleteNode()    GraphNodeオブジェクトをグラフから削除する (先にEdgeを0本にしてください)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcreateNode: function(cell) {\r\n\t\t\tvar node = new this.klass.GraphNode(cell);\r\n\t\t\tthis.getObjNodeList(cell).push(node);\r\n\t\t\tthis.modifyNodes.push(node);\r\n\t\t\treturn node;\r\n\t\t},\r\n\t\tdeleteNode: function(node) {\r\n\t\t\tvar cell = node.obj;\r\n\t\t\tthis.setComponentRefs(cell, null);\r\n\t\t\tthis.removeFromArray(this.getObjNodeList(cell), node);\r\n\r\n\t\t\t// rebuildmode中にはこの関数は呼ばれません\r\n\t\t\tthis.removeFromArray(this.modifyNodes, node);\r\n\t\t\tvar component = node.component;\r\n\t\t\tif (component !== null) {\r\n\t\t\t\tthis.removeFromArray(component.nodes, node);\r\n\t\t\t\tthis.resetExtraData(cell);\r\n\t\t\t\tif (component.nodes.length === 0) {\r\n\t\t\t\t\tthis.deleteComponent(component);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// linegraph.createNodeIfEmpty()  指定されたオブジェクトの場所にNodeを生成する\r\n\t\t// linegraph.deleteNodeIfEmpty()  指定されたオブジェクトの場所からNodeを除去する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcreateNodeIfEmpty: function(nodeobj) {\r\n\t\t\t// 周囲のNode生成が必要かもしれないのでチェック＆create\r\n\t\t\tif (this.getObjNodeList(nodeobj).length === 0) {\r\n\t\t\t\tthis.createNode(nodeobj);\r\n\t\t\t}\r\n\t\t},\r\n\t\tdeleteNodeIfEmpty: function(nodeobj) {\r\n\t\t\tvar nodes = this.getObjNodeList(nodeobj);\r\n\r\n\t\t\t// 周囲のNodeが消えるかもしれないのでチェック＆remove\r\n\t\t\tif (nodes[0].nodes.length === 0 && !this.isnodevalid(nodeobj)) {\r\n\t\t\t\tthis.deleteNode(nodes[0]);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// graph.addEdge()    Node間にEdgeを追加する\r\n\t\t// graph.removeEdge() Node間からEdgeを除外する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\taddEdge: function(node1, node2) {\r\n\t\t\tif (node1.nodes.indexOf(node2) >= 0) {\r\n\t\t\t\treturn;\r\n\t\t\t} // 多重辺にしないため\r\n\t\t\tnode1.nodes.push(node2);\r\n\t\t\tnode2.nodes.push(node1);\r\n\r\n\t\t\tif (!this.rebuildmode) {\r\n\t\t\t\tif (this.modifyNodes.indexOf(node1) < 0) {\r\n\t\t\t\t\tthis.modifyNodes.push(node1);\r\n\t\t\t\t}\r\n\t\t\t\tif (this.modifyNodes.indexOf(node2) < 0) {\r\n\t\t\t\t\tthis.modifyNodes.push(node2);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tremoveEdge: function(node1, node2) {\r\n\t\t\tif (node1.nodes.indexOf(node2) < 0) {\r\n\t\t\t\treturn;\r\n\t\t\t} // 存在しない辺を削除しない\r\n\t\t\tthis.removeFromArray(node1.nodes, node2);\r\n\t\t\tthis.removeFromArray(node2.nodes, node1);\r\n\r\n\t\t\tif (!this.rebuildmode) {\r\n\t\t\t\tif (this.modifyNodes.indexOf(node1) < 0) {\r\n\t\t\t\t\tthis.modifyNodes.push(node1);\r\n\t\t\t\t}\r\n\t\t\t\tif (this.modifyNodes.indexOf(node2) < 0) {\r\n\t\t\t\t\tthis.modifyNodes.push(node2);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// graph.getSideObjByLinkObj()   borderから接続するNodeにあるobjを取得する\r\n\t\t// graph.getSideObjByNodeObj()   cellから接続するNodeにあるobjを取得する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetSideObjByLinkObj: function(border) {\r\n\t\t\treturn border.sideobj;\r\n\t\t},\r\n\t\tgetSideObjByNodeObj: function(cell) {\r\n\t\t\tvar list = cell.getdir4clist(),\r\n\t\t\t\tcells = [];\r\n\t\t\tfor (var i = 0; i < list.length; i++) {\r\n\t\t\t\tvar cell2 = list[i][0];\r\n\t\t\t\tif (this.isnodevalid(cell2)) {\r\n\t\t\t\t\tcells.push(cell2);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn cells;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// graph.getSideNodesByLinkObj()   borderからEdgeに接続するNodeを取得する\r\n\t\t// graph.getSideNodesBySeparator() borderからEdgeに接続するNodeを取得する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetSideNodesByLinkObj: function(border) {\r\n\t\t\tvar sidenodes = [],\r\n\t\t\t\tsidenodeobj = this.getSideObjByLinkObj(border);\r\n\t\t\tfor (var i = 0; i < sidenodeobj.length; i++) {\r\n\t\t\t\tvar cell = sidenodeobj[i],\r\n\t\t\t\t\tnodes = this.getObjNodeList(cell),\r\n\t\t\t\t\tnode = nodes[0];\r\n\t\t\t\t// 交差あり盤面の特殊処理 border.isvertはfalseの時タテヨコ線\r\n\t\t\t\tif (!!nodes[1] && border.isvert) {\r\n\t\t\t\t\tnode = nodes[1];\r\n\t\t\t\t}\r\n\t\t\t\tsidenodes.push(node);\r\n\t\t\t}\r\n\t\t\treturn sidenodes;\r\n\t\t},\r\n\t\tgetSideNodesBySeparator: function(border) {\r\n\t\t\tvar sidenodes = [],\r\n\t\t\t\tsidenodeobj = border.sideobj;\r\n\t\t\tfor (var i = 0; i < sidenodeobj.length; i++) {\r\n\t\t\t\tvar nodes = this.getObjNodeList(sidenodeobj[i]);\r\n\t\t\t\tif (!!nodes && !!nodes[0]) {\r\n\t\t\t\t\tsidenodes.push(nodes[0]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn sidenodes.length >= 2 ? sidenodes : null;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// graph.modifyInfo() 黒マスや線が引かれたり消された時に、lcnt変数や線の情報を生成しなおす\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tmodifyInfo: function(obj, type) {\r\n\t\t\tif (!this.enabled) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar relation = this.relation[type];\r\n\t\t\tif (!relation) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.modifyNodes = [];\r\n\r\n\t\t\tswitch (relation) {\r\n\t\t\t\tcase \"node\":\r\n\t\t\t\t\tthis.setEdgeByNodeObj(obj);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"link\":\r\n\t\t\t\t\tthis.setEdgeByLinkObj(obj);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"separator\":\r\n\t\t\t\t\tthis.setEdgeBySeparator(obj);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthis.modifyOtherInfo(obj, relation);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.modifyNodes.length > 0) {\r\n\t\t\t\tthis.remakeComponent();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// graph.setEdgeBySeparator() 境界線が引かれたり消された時に、lcnt変数や線の情報を生成しなおす\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetEdgeBySeparator: function(border) {\r\n\t\t\tvar isset = this.isedgevalidbylinkobj(border);\r\n\t\t\tif (isset === this.isedgeexistsbylinkobj(border)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!!this.incdecBorderCount) {\r\n\t\t\t\tthis.incdecBorderCount(border, !isset);\r\n\t\t\t}\r\n\r\n\t\t\tif (isset) {\r\n\t\t\t\tthis.addEdgeBySeparator(border);\r\n\t\t\t} else {\r\n\t\t\t\tthis.removeEdgeBySeparator(border);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// graph.addEdgeBySeparator()    指定されたオブジェクトの場所にEdgeを生成する\r\n\t\t// graph.removeEdgeBySeparator() 指定されたオブジェクトの場所からEdgeを除去する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\taddEdgeBySeparator: function(border) {\r\n\t\t\t// 境界線を消した時の処理\r\n\t\t\tvar sidenodes = this.getSideNodesBySeparator(border);\r\n\t\t\tif (!sidenodes) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.addEdge(sidenodes[0], sidenodes[1]);\r\n\t\t},\r\n\t\tremoveEdgeBySeparator: function(border) {\r\n\t\t\t// 境界線を引いた時の処理\r\n\t\t\tvar sidenodes = this.getSideNodesBySeparator(border);\r\n\t\t\tif (!sidenodes) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.removeEdge(sidenodes[0], sidenodes[1]);\r\n\t\t\tif (this.linkgroup) {\r\n\t\t\t\tthis.setComponentRefs(border, null);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// graph.attachNode()    指定されたオブジェクトを別Componentにくっつけて終了する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tattachNode: function(node, component) {\r\n\t\t\tnode.component = component;\r\n\t\t\tcomponent.nodes.push(node);\r\n\t\t\tthis.setComponentInfo(component);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// graph.remakeComponent() modifyNodesに含まれるsubgraph成分からremakeしたりします\r\n\t\t// graph.getAffectedComponents() modifyNodesを含むcomponentsを取得します\r\n\t\t// graph.checkDividedComponent() 指定されたComponentがひとつながりかどうか探索します\r\n\t\t// graph.remakeMaximalComponents()指定されたcomponentsを探索し直します\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tremakeComponent: function() {\r\n\t\t\t// subgraph中にcomponentが何種類あるか調べる\r\n\t\t\tvar remakeComponents = this.getAffectedComponents();\r\n\r\n\t\t\t// Component数が1ならsubgraphが分断していないかどうかチェック\r\n\t\t\tif (remakeComponents.length === 1) {\r\n\t\t\t\tthis.checkDividedComponent(remakeComponents[0]);\r\n\t\t\t}\r\n\r\n\t\t\t// Component数が0なら現在のmodifyNodesに新規IDを割り振り終了\r\n\t\t\t// Component数が2以上ならmodifyNodesに極大部分グラフを取り込んで再探索\r\n\t\t\tif (!!this.modifyNodes && this.modifyNodes.length > 0) {\r\n\t\t\t\tthis.remakeMaximalComponents(remakeComponents);\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetAffectedComponents: function() {\r\n\t\t\tvar remakeComponents = [];\r\n\t\t\tfor (var i = 0; i < this.modifyNodes.length; i++) {\r\n\t\t\t\tvar component = this.modifyNodes[i].component;\r\n\t\t\t\tif (component !== null) {\r\n\t\t\t\t\tif (!component.isremake) {\r\n\t\t\t\t\t\tremakeComponents.push(component);\r\n\t\t\t\t\t\tcomponent.isremake = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn remakeComponents;\r\n\t\t},\r\n\t\tcheckDividedComponent: function(component) {\r\n\t\t\t// 1つだけsubgraphを生成してみる\r\n\t\t\tfor (var i = 0, len = this.modifyNodes.length; i < len; i++) {\r\n\t\t\t\tvar node = this.modifyNodes[i];\r\n\t\t\t\tnode.component = null;\r\n\t\t\t\tthis.setComponentRefs(node.obj, null);\r\n\t\t\t\tthis.removeFromArray(component.nodes, node);\r\n\t\t\t}\r\n\t\t\tvar pseudoComponent = new this.klass.GraphComponent();\r\n\t\t\tthis.searchSingle(this.modifyNodes[0], pseudoComponent);\r\n\t\t\t// subgraphがひとつながりならComponentに属していないNodeをそのComponentに割り当てる\r\n\t\t\tif (pseudoComponent.nodes.length === this.modifyNodes.length) {\r\n\t\t\t\tfor (var i = 0; i < this.modifyNodes.length; i++) {\r\n\t\t\t\t\tvar node = this.modifyNodes[i];\r\n\t\t\t\t\tnode.component = component;\r\n\t\t\t\t\tcomponent.nodes.push(node);\r\n\t\t\t\t}\r\n\t\t\t\tthis.modifyNodes = [];\r\n\t\t\t\tthis.setComponentInfo(component);\r\n\t\t\t\tcomponent.isremake = false;\r\n\t\t\t}\r\n\t\t\t// subgraphがひとつながりでないなら再探索ルーチンを回す\r\n\t\t},\r\n\t\tremakeMaximalComponents: function(remakeComponents) {\r\n\t\t\tvar longColor = this.coloring\r\n\t\t\t\t? this.getLongColor(remakeComponents)\r\n\t\t\t\t: null;\r\n\t\t\tfor (var p = 0; p < remakeComponents.length; p++) {\r\n\t\t\t\tthis.deleteComponent(remakeComponents[p]);\r\n\t\t\t}\r\n\t\t\tvar newComponents = this.searchGraph();\r\n\t\t\tif (this.coloring) {\r\n\t\t\t\tthis.setLongColor(newComponents, longColor);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// graph.searchGraph()  ひとつながりの線にlineidを設定する\r\n\t\t// graph.searchSingle() 初期idを含む一つの領域内のareaidを指定されたものにする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsearchGraph: function() {\r\n\t\t\tvar partslist = this.modifyNodes;\r\n\t\t\tvar newcomponents = [];\r\n\t\t\tfor (var i = 0, len = partslist.length; i < len; i++) {\r\n\t\t\t\tpartslist[i].component = null;\r\n\t\t\t}\r\n\t\t\tfor (var i = 0, len = partslist.length; i < len; i++) {\r\n\t\t\t\tif (partslist[i].component !== null) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t} // 既にidがついていたらスルー\r\n\t\t\t\tvar component = this.createComponent();\r\n\t\t\t\tthis.searchSingle(partslist[i], component);\r\n\r\n\t\t\t\t// defer setExtraData to avoid problems with half-built graph, compare #117\r\n\t\t\t\tthis.setComponentInfoExtra(component, false);\r\n\r\n\t\t\t\tnewcomponents.push(component);\r\n\t\t\t}\r\n\t\t\tthis.modifyNodes = [];\r\n\r\n\t\t\tfor (var i = 0; i < newcomponents.length; i++) {\r\n\t\t\t\tthis.setExtraData(newcomponents[i]);\r\n\t\t\t}\r\n\t\t\treturn newcomponents;\r\n\t\t},\r\n\t\tsearchSingle: function(startparts, component) {\r\n\t\t\tvar stack = [startparts];\r\n\t\t\twhile (stack.length > 0) {\r\n\t\t\t\tvar node = stack.pop();\r\n\t\t\t\tif (node.component !== null) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tnode.component = component;\r\n\t\t\t\tcomponent.nodes.push(node);\r\n\r\n\t\t\t\tfor (var i = 0; i < node.nodes.length; i++) {\r\n\t\t\t\t\tstack.push(node.nodes[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// graph.setComponentInfo() Componentオブジェクトのデータを設定する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tsetComponentInfo: function(component) {\r\n\t\t\tthis.setComponentInfoExtra(component, true);\r\n\t\t},\r\n\t\tsetComponentInfoExtra: function(component, setExtra) {\r\n\t\t\tvar edges = 0;\r\n\t\t\tfor (var i = 0; i < component.nodes.length; i++) {\r\n\t\t\t\tvar node = component.nodes[i];\r\n\t\t\t\tedges += node.nodes.length;\r\n\r\n\t\t\t\tthis.setComponentRefs(node.obj, component);\r\n\t\t\t}\r\n\t\t\tcomponent.circuits = (edges >> 1) - component.nodes.length + 1;\r\n\r\n\t\t\tif (setExtra) {\r\n\t\t\t\tthis.setExtraData(component);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// graph.resetExtraData() 指定されたオブジェクトの拡張データをリセットする\r\n\t\t// graph.setExtraData()   指定された領域の拡張データを設定する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tresetExtraData: function(nodeobj) {},\r\n\t\tsetExtraData: function(component) {},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// graph.getLargeComponent()\r\n\t\t// graph.getLongColor() ブロックを設定した時、ブロックにつける色を取得する\r\n\t\t// graph.setLongColor() ブロックに色をつけなおす\r\n\t\t// graph.repaintNodes() ブロックを再描画する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tgetLargeComponent: function(components) {\r\n\t\t\tif (components.length === 0) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tvar largeComponent = components[0];\r\n\t\t\tvar largeTrial = largeComponent.isTrial();\r\n\t\t\tfor (var i = 1; i < components.length; i++) {\r\n\t\t\t\tvar comp = components[i],\r\n\t\t\t\t\ttrial = comp.isTrial();\r\n\t\t\t\tif (trial === largeTrial) {\r\n\t\t\t\t\tif (largeComponent.nodes.length < comp.nodes.length) {\r\n\t\t\t\t\t\tlargeComponent = comp;\r\n\t\t\t\t\t\tlargeTrial = trial;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (!trial) {\r\n\t\t\t\t\tlargeComponent = comp;\r\n\t\t\t\t\tlargeTrial = trial;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn largeComponent;\r\n\t\t},\r\n\t\tgetLongColor: function(components) {\r\n\t\t\tvar largeComponent = this.getLargeComponent(components);\r\n\t\t\treturn !!largeComponent ? largeComponent.color : null;\r\n\t\t},\r\n\t\tsetLongColor: function(components, longColor) {\r\n\t\t\tif (components.length === 0 || !longColor) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar puzzle = this.puzzle;\r\n\r\n\t\t\t// できた線の中でもっとも長いものを取得する\r\n\t\t\tvar largeComponent = this.getLargeComponent(components);\r\n\t\t\tif (!!largeComponent) {\r\n\t\t\t\tlargeComponent.color = longColor;\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tthis.coloring &&\r\n\t\t\t\t(puzzle.execConfig(\"irowake\") || puzzle.execConfig(\"irowakeblk\"))\r\n\t\t\t) {\r\n\t\t\t\tthis.repaintNodes(components);\r\n\t\t\t}\r\n\t\t},\r\n\t\trepaintNodes: function(components) {},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// graph.newIrowake()  線の情報が再構築された際、線に色をつける\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tnewIrowake: function() {\r\n\t\t\tvar paths = this.components;\r\n\t\t\tfor (var i = 0; i < paths.length; i++) {\r\n\t\t\t\tpaths[i].color = this.puzzle.painter.getNewLineColor();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tGraphComponent: {\r\n\t\tinitialize: function() {\r\n\t\t\tthis.nodes = [];\r\n\t\t\tthis.color = \"\";\r\n\t\t\tthis.circuits = -1;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// component.getLinkObjByNodes()  node間のオブジェクトを取得する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetLinkObjByNodes: function(node1, node2) {\r\n\t\t\tvar bx1 = node1.obj.bx,\r\n\t\t\t\tby1 = node1.obj.by,\r\n\t\t\t\tbx2 = node2.obj.bx,\r\n\t\t\t\tby2 = node2.obj.by;\r\n\t\t\tif (bx1 > bx2 || (bx1 === bx2 && by1 > by2)) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\treturn this.board.getobj((bx1 + bx2) >> 1, (by1 + by2) >> 1);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// component.getnodeobjs()  nodeのオブジェクトリストを取得する\r\n\t\t// component.getedgeobjs()  edgeのオブジェクトリストを取得する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetnodeobjs: function() {\r\n\t\t\tvar objs = new (this.board.getGroup(\r\n\t\t\t\tthis.nodes[0].obj.group\r\n\t\t\t).constructor)();\r\n\t\t\tfor (var i = 0; i < this.nodes.length; i++) {\r\n\t\t\t\tobjs.add(this.nodes[i].obj);\r\n\t\t\t}\r\n\t\t\treturn objs;\r\n\t\t},\r\n\t\tgetedgeobjs: function() {\r\n\t\t\tvar objs = [];\r\n\t\t\tfor (var i = 0; i < this.nodes.length; i++) {\r\n\t\t\t\tvar node = this.nodes[i];\r\n\t\t\t\tfor (var n = 0; n < node.nodes.length; n++) {\r\n\t\t\t\t\tvar obj = this.getLinkObjByNodes(node, node.nodes[n]);\r\n\t\t\t\t\tif (!!obj) {\r\n\t\t\t\t\t\tobjs.push(obj);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn objs;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// component.checkAutoCmp()  autocmp設定有効時に条件を満たしているかチェックして背景を描画する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckAutoCmp: function() {\r\n\t\t\tvar iscmp = !!this.clist.checkCmp ? this.clist.checkCmp() : false;\r\n\t\t\tif (this.cmp !== iscmp) {\r\n\t\t\t\tthis.cmp = iscmp;\r\n\t\t\t\tif (this.puzzle.execConfig(\"autocmp\")) {\r\n\t\t\t\t\tthis.clist.draw();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// component.isTrial()  check whether this component is entirely made up of trial edges (irowake)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tisTrial: function() {\r\n\t\t\tvar edges = this.getedgeobjs();\r\n\t\t\tfor (var i = 0; i < edges.length; i++) {\r\n\t\t\t\tif (!edges[i].trial) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// component.setedgeerr()   edgeにerror値を設定する\r\n\t\t// component.setedgeinfo()  edgeにqinfo値を設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetedgeerr: function(val) {\r\n\t\t\tvar objs = this.getedgeobjs();\r\n\t\t\tfor (var i = 0; i < objs.length; i++) {\r\n\t\t\t\tobjs[i].seterr(val);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetedgeinfo: function(val) {\r\n\t\t\tvar objs = this.getedgeobjs();\r\n\t\t\tfor (var i = 0; i < objs.length; i++) {\r\n\t\t\t\tobjs[i].setinfo(val);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tGraphNode: {\r\n\t\tinitialize: function(obj) {\r\n\t\t\tthis.obj = obj;\r\n\t\t\tthis.nodes = []; // Array of Linked GraphNode\r\n\t\t\tthis.component = null;\r\n\t\t}\r\n\t}\r\n});\r\n","// LineManager.js\r\n\r\n//---------------------------------------------------------------------------\r\n// ★LineGraphクラス 主に線や色分けの情報を管理する\r\n//---------------------------------------------------------------------------\r\npzpr.classmgr.makeCommon({\r\n\t\"LineGraph:GraphBase\": {\r\n\t\tinitialize: function() {\r\n\t\t\tif (this.moveline) {\r\n\t\t\t\tthis.relation[\"cell.qnum\"] = \"move\";\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tenabled: false,\r\n\t\trelation: { \"border.line\": \"link\" },\r\n\r\n\t\tpointgroup: \"cell\",\r\n\t\tlinkgroup: \"border\",\r\n\r\n\t\tisLineCross: false, // 線が交差するパズル\r\n\r\n\t\tmakeClist: false, // 線が存在するclistを生成する\r\n\t\tmoveline: false, // 丸数字などを動かすパズル\r\n\r\n\t\tcoloring: true,\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// linegraph.setComponentRefs()    objにcomponentの設定を行う (性能対策)\r\n\t\t// linegraph.isedgeexistsbylinkobj() linkobjにedgeが存在するか判定する\r\n\t\t//\r\n\t\t// linegraph.getObjNodeList()      objにあるnodeを取得する\r\n\t\t// linegraph.resetObjNodeList()    objからnodeをクリアする\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tsetComponentRefs: function(obj, component) {\r\n\t\t\tobj.path = component;\r\n\t\t},\r\n\t\tisedgeexistsbylinkobj: function(linkobj) {\r\n\t\t\treturn linkobj.path !== null;\r\n\t\t},\r\n\r\n\t\tgetObjNodeList: function(nodeobj) {\r\n\t\t\treturn nodeobj.pathnodes;\r\n\t\t},\r\n\t\tresetObjNodeList: function(nodeobj) {\r\n\t\t\tnodeobj.pathnodes = [];\r\n\t\t\tif (this.moveline) {\r\n\t\t\t\tthis.resetExtraData(nodeobj);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// linegraph.isnodevalid()           そのセルにNodeが存在すべきかどうか返す\r\n\t\t// linegraph.isedgevalidbylinkobj()  そのborderにEdgeが存在すべきかどうか返す\r\n\t\t// linegraph.iscrossing()            そのセルで交差するかどうか返す\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tisnodevalid: function(cell) {\r\n\t\t\treturn cell.lcnt > 0 || (this.moveline && cell.isNum());\r\n\t\t},\r\n\t\tisedgevalidbylinkobj: function(border) {\r\n\t\t\treturn border.isLine();\r\n\t\t},\r\n\t\tiscrossing: function(cell) {\r\n\t\t\treturn this.isLineCross;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// linegraph.rebuild()  既存の情報からデータを再設定する\r\n\t\t// linegraph.rebuild2() 継承先に固有のデータを設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\trebuild: function() {\r\n\t\t\tif (this.board.borderAsLine) {\r\n\t\t\t\tthis.pointgroup = \"cross\";\r\n\t\t\t}\r\n\t\t\tpzpr.common.GraphBase.prototype.rebuild.call(this);\r\n\t\t},\r\n\t\trebuild2: function() {\r\n\t\t\tif (!!this.incdecLineCount) {\r\n\t\t\t\tthis.resetLineCount();\r\n\t\t\t}\r\n\t\t\tpzpr.common.GraphBase.prototype.rebuild2.call(this);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// linegraph.resetLineCount()  初期化時に、lcnt情報を初期化する\r\n\t\t// linegraph.incdecLineCount() 線が引かれたり消された時に、lcnt変数を生成し直す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tresetLineCount: function() {\r\n\t\t\tvar cells = this.board[this.pointgroup],\r\n\t\t\t\tborders = this.board[this.linkgroup];\r\n\t\t\tthis.ltotal = [cells.length];\r\n\t\t\tfor (var c = 0; c < cells.length; c++) {\r\n\t\t\t\tcells[c].lcnt = 0;\r\n\t\t\t}\r\n\t\t\tfor (var id = 0; id < borders.length; id++) {\r\n\t\t\t\tif (this.isedgevalidbylinkobj(borders[id])) {\r\n\t\t\t\t\tthis.incdecLineCount(borders[id], true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tincdecLineCount: function(border, isset) {\r\n\t\t\tif (border.group !== this.linkgroup) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < 2; i++) {\r\n\t\t\t\tvar cell = border.sideobj[i];\r\n\t\t\t\tif (!cell.isnull) {\r\n\t\t\t\t\tthis.ltotal[cell.lcnt]--;\r\n\t\t\t\t\tif (isset) {\r\n\t\t\t\t\t\tcell.lcnt++;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcell.lcnt--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.ltotal[cell.lcnt] = (this.ltotal[cell.lcnt] || 0) + 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// linegraph.setEdgeByLinkObj() 線が引かれたり消された時に、lcnt変数や線の情報を生成しなおす\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetEdgeByLinkObj: function(linkobj) {\r\n\t\t\tvar isset = this.isedgevalidbylinkobj(linkobj);\r\n\t\t\tif (isset === this.isedgeexistsbylinkobj(linkobj)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!!this.incdecLineCount) {\r\n\t\t\t\tthis.incdecLineCount(linkobj, isset);\r\n\t\t\t}\r\n\r\n\t\t\tif (isset) {\r\n\t\t\t\tthis.addEdgeByLinkObj(linkobj);\r\n\t\t\t} else {\r\n\t\t\t\tthis.removeEdgeByLinkObj(linkobj);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// graph.addEdgeByLinkObj()    指定されたオブジェクトの場所にEdgeを生成する\r\n\t\t// graph.removeEdgeByLinkObj() 指定されたオブジェクトの場所からEdgeを除去する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\taddEdgeByLinkObj: function(linkobj) {\r\n\t\t\t// 線(など)を引いた時の処理\r\n\t\t\tvar enattach = this.modifyNodes.length === 0;\r\n\t\t\tvar sidenodeobj = this.getSideObjByLinkObj(linkobj);\r\n\r\n\t\t\t// 周囲のNodeをグラフに追加するかどうか確認する\r\n\t\t\tthis.createNodeIfEmpty(sidenodeobj[0]);\r\n\t\t\tthis.createNodeIfEmpty(sidenodeobj[1]);\r\n\r\n\t\t\t// linkするNodeを取得する\r\n\t\t\tvar sidenodes = this.getSideNodesByLinkObj(linkobj);\r\n\r\n\t\t\t// 周囲のNodeとlink\r\n\t\t\tthis.addEdge(sidenodes[0], sidenodes[1]);\r\n\r\n\t\t\t// 周囲のComponentにくっついただけの場合は情報を更新して終了\r\n\t\t\tif (this.rebuildmode || !enattach) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar attachnodes = null,\r\n\t\t\t\tnode1 = sidenodes[0],\r\n\t\t\t\tnode2 = sidenodes[1];\r\n\t\t\tif (\r\n\t\t\t\tnode1.obj.lcnt === 1 &&\r\n\t\t\t\tnode1.component === null &&\r\n\t\t\t\tnode2.component !== null\r\n\t\t\t) {\r\n\t\t\t\tattachnodes = [sidenodes[0], sidenodes[1]];\r\n\t\t\t} else if (\r\n\t\t\t\tnode2.obj.lcnt === 1 &&\r\n\t\t\t\tnode2.component === null &&\r\n\t\t\t\tnode1.component !== null\r\n\t\t\t) {\r\n\t\t\t\tattachnodes = [sidenodes[1], sidenodes[0]];\r\n\t\t\t}\r\n\t\t\tif (!!attachnodes) {\r\n\t\t\t\tthis.attachNode(attachnodes[0], attachnodes[1].component);\r\n\t\t\t\tthis.modifyNodes = [];\r\n\t\t\t}\r\n\t\t},\r\n\t\tremoveEdgeByLinkObj: function(linkobj) {\r\n\t\t\t// 線(など)を消した時の処理\r\n\t\t\t// unlinkするNodeを取得する\r\n\t\t\tvar endetach = this.modifyNodes.length === 0;\r\n\t\t\tvar sidenodes = this.getSideNodesByLinkObj(linkobj);\r\n\r\n\t\t\t// 周囲のNodeとunlink\r\n\t\t\tthis.removeEdge(sidenodes[0], sidenodes[1]);\r\n\r\n\t\t\t// 周囲のNodeをグラフから取り除くかどうか確認する\r\n\t\t\tthis.deleteNodeIfEmpty(sidenodes[0].obj);\r\n\t\t\tthis.deleteNodeIfEmpty(sidenodes[1].obj);\r\n\r\n\t\t\tthis.setComponentRefs(linkobj, null);\r\n\r\n\t\t\t// 周囲のComponent末端から切り離されただけの場合は情報を更新して終了\r\n\t\t\tif (!endetach) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar detachnodes = null,\r\n\t\t\t\tnode1 = sidenodes[0],\r\n\t\t\t\tnode2 = sidenodes[1];\r\n\t\t\tvar lcnt1 = node1.obj.lcnt,\r\n\t\t\t\tlcnt2 = node2.obj.lcnt;\r\n\t\t\tif (\r\n\t\t\t\tlcnt1 === 0 &&\r\n\t\t\t\t(lcnt2 === 1 || (!this.isLineCross && lcnt2 > 1)) &&\r\n\t\t\t\tnode2.component !== null\r\n\t\t\t) {\r\n\t\t\t\tdetachnodes = [sidenodes[0], sidenodes[1]];\r\n\t\t\t} else if (\r\n\t\t\t\tlcnt2 === 0 &&\r\n\t\t\t\t(lcnt1 === 1 || (!this.isLineCross && lcnt1 > 1)) &&\r\n\t\t\t\tnode1.component !== null\r\n\t\t\t) {\r\n\t\t\t\tdetachnodes = [sidenodes[1], sidenodes[0]];\r\n\t\t\t}\r\n\t\t\tif (!!detachnodes) {\r\n\t\t\t\tthis.setComponentInfo(detachnodes[1].component);\r\n\t\t\t\tthis.modifyNodes = [];\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// linegraph.setOtherInformation() 移動系パズルで数字などが入力された時に線の情報を生成しなおす\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tmodifyOtherInfo: function(cell, relation) {\r\n\t\t\tvar haspath = !!cell.path;\r\n\t\t\tif (haspath !== this.isnodevalid(cell)) {\r\n\t\t\t\tif (haspath) {\r\n\t\t\t\t\tthis.deleteNodeIfEmpty(cell);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.createNodeIfEmpty(cell);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (haspath) {\r\n\t\t\t\t\tthis.setComponentInfo(cell.path);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.resetExtraData(cell);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// linegraph.createNodeIfEmpty()  指定されたオブジェクトの場所にNodeを生成する\r\n\t\t// linegraph.deleteNodeIfEmpty()  指定されたオブジェクトの場所からNodeを除去する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcreateNodeIfEmpty: function(cell) {\r\n\t\t\tvar nodes = this.getObjNodeList(cell);\r\n\r\n\t\t\t// 周囲のNode生成が必要かもしれないのでチェック＆create\r\n\t\t\tif (nodes.length === 0) {\r\n\t\t\t\tthis.createNode(cell);\r\n\t\t\t}\r\n\t\t\t// 交差あり盤面の処理\r\n\t\t\telse if (\r\n\t\t\t\t!nodes[1] &&\r\n\t\t\t\tnodes[0].nodes.length === 2 &&\r\n\t\t\t\tthis.iscrossing(cell)\r\n\t\t\t) {\r\n\t\t\t\t// 2本->3本になる時はNodeを追加して分離します\r\n\t\t\t\t// 上下/左右の線が1本ずつだった場合は左右の線をnodes[1]に付加し直します\r\n\t\t\t\tvar nbnodes = nodes[0].nodes;\r\n\t\t\t\tvar isvert = [\r\n\t\t\t\t\tcell.getvert(nbnodes[0].obj, 2),\r\n\t\t\t\t\tcell.getvert(nbnodes[1].obj, 2)\r\n\t\t\t\t];\r\n\t\t\t\tif (isvert[0] !== isvert[1]) {\r\n\t\t\t\t\t// breaking up a corner; we create two new nodes to ensure\r\n\t\t\t\t\t// that the graph gets rebuilt correctly\r\n\t\t\t\t\tvar vertnode = nbnodes[isvert[0] ? 0 : 1];\r\n\t\t\t\t\tvar horiznode = nbnodes[isvert[0] ? 1 : 0];\r\n\t\t\t\t\tthis.removeEdge(nodes[0], vertnode);\r\n\t\t\t\t\tthis.removeEdge(nodes[0], horiznode);\r\n\t\t\t\t\tthis.deleteNode(nodes[0]);\r\n\t\t\t\t\tthis.createNode(cell);\r\n\t\t\t\t\tthis.createNode(cell);\r\n\t\t\t\t\tthis.addEdge(nodes[0], vertnode);\r\n\t\t\t\t\tthis.addEdge(nodes[1], horiznode);\r\n\t\t\t\t}\r\n\t\t\t\t// 両方左右線の場合はnodes[0], nodes[1]を交換してnodes[0]に0本、nodes[1]に2本付加する\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.createNode(cell);\r\n\t\t\t\t\tif (!isvert[0] && !isvert[1]) {\r\n\t\t\t\t\t\tnodes.push(nodes.shift());\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tdeleteNodeIfEmpty: function(cell) {\r\n\t\t\tvar nodes = this.getObjNodeList(cell);\r\n\r\n\t\t\t// 周囲のNodeが消えるかもしれないのでチェック＆remove\r\n\t\t\tif (\r\n\t\t\t\tnodes.length === 1 &&\r\n\t\t\t\tnodes[0].nodes.length === 0 &&\r\n\t\t\t\t!this.isnodevalid(cell)\r\n\t\t\t) {\r\n\t\t\t\tthis.deleteNode(nodes[0]);\r\n\t\t\t}\r\n\t\t\t// 交差あり盤面の処理\r\n\t\t\telse if (\r\n\t\t\t\t!!nodes[1] &&\r\n\t\t\t\tnodes[0].nodes.length + nodes[1].nodes.length === 2 &&\r\n\t\t\t\tthis.iscrossing(cell)\r\n\t\t\t) {\r\n\t\t\t\t// 3本->2本になってnodes[0], nodes[1]に1本ずつEdgeが存在する場合はnodes[0]に統合\r\n\t\t\t\tif (nodes[1].nodes.length === 1) {\r\n\t\t\t\t\tvar lrnode = nodes[1].nodes[0];\r\n\t\t\t\t\tthis.removeEdge(nodes[1], lrnode);\r\n\t\t\t\t\tthis.addEdge(nodes[0], lrnode);\r\n\t\t\t\t}\r\n\t\t\t\t// 両方左右線の場合はnodes[0], nodes[1]を交換してnodes[0]に2本、nodes[1]に0本にする\r\n\t\t\t\telse if (nodes[1].nodes.length === 2) {\r\n\t\t\t\t\tnodes.push(nodes.shift());\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 不要になったNodeを削除\r\n\t\t\t\tthis.deleteNode(nodes[1]);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// linegraph.resetExtraData() 指定されたオブジェクトの拡張データをリセットする\r\n\t\t// linegraph.setExtraData()   指定された領域の拡張データを設定する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tresetExtraData: function(nodeobj) {\r\n\t\t\tif (this.moveline) {\r\n\t\t\t\tnodeobj.base = nodeobj.isNum() ? nodeobj : this.board.emptycell;\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetExtraData: function(component) {\r\n\t\t\tif (this.coloring && !component.color) {\r\n\t\t\t\tcomponent.color = this.puzzle.painter.getNewLineColor();\r\n\t\t\t}\r\n\r\n\t\t\tvar edgeobjs = component.getedgeobjs();\r\n\t\t\tfor (var i = 0; i < edgeobjs.length; i++) {\r\n\t\t\t\tthis.setComponentRefs(edgeobjs[i], component);\r\n\t\t\t}\r\n\r\n\t\t\tif (this.makeClist || this.moveline) {\r\n\t\t\t\tcomponent.clist = new this.klass.CellList(component.getnodeobjs());\r\n\t\t\t\tif (this.moveline) {\r\n\t\t\t\t\tthis.setMovedBase(component);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// linegraph.repaintNodes() ブロックを再描画する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\trepaintNodes: function(components) {\r\n\t\t\tvar blist_all = new this.klass.BorderList();\r\n\t\t\tfor (var i = 0; i < components.length; i++) {\r\n\t\t\t\tblist_all.extend(components[i].getedgeobjs());\r\n\t\t\t}\r\n\t\t\tthis.puzzle.painter.repaintLines(blist_all);\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// linemgr.setMovedBase()    指定された領域の移動情報を設定する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tsetMovedBase: function(component) {\r\n\t\t\tvar emptycell = this.board.emptycell;\r\n\t\t\tcomponent.departure = component.destination = emptycell;\r\n\t\t\tcomponent.movevalid = false;\r\n\r\n\t\t\tvar clist = component.clist;\r\n\t\t\tif (clist.length < 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i];\r\n\t\t\t\tcell.base = cell.isNum() ? cell : emptycell;\r\n\t\t\t}\r\n\r\n\t\t\tvar before = null,\r\n\t\t\t\tafter = null,\r\n\t\t\t\tpoint = 0;\r\n\t\t\tif (clist.length === 1) {\r\n\t\t\t\tbefore = after = clist[0];\r\n\t\t\t\tpoint = 2;\r\n\t\t\t} else {\r\n\t\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\t\tvar cell = clist[i];\r\n\t\t\t\t\tif (cell.lcnt === 1) {\r\n\t\t\t\t\t\tpoint++;\r\n\t\t\t\t\t\tif (cell.isNum()) {\r\n\t\t\t\t\t\t\tbefore = cell;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tafter = cell;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (before !== null && after !== null && point === 2) {\r\n\t\t\t\tbefore.base = emptycell;\r\n\t\t\t\tcomponent.departure = after.base = before;\r\n\t\t\t\tcomponent.destination = after;\r\n\t\t\t\tcomponent.movevalid = true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n","// AreaManager.js\r\n\r\npzpr.classmgr.makeCommon({\r\n\t//--------------------------------------------------------------------------------\r\n\t// ★AreaGraphBaseクラス セルの部屋情報などを保持するクラス\r\n\t//   ※このクラスで管理しているroomsは左上からの順番に並ばないので\r\n\t//     回答チェックやURL出力前には一旦resetRoomNumber()等が必要です。\r\n\t//--------------------------------------------------------------------------------\r\n\t\"AreaGraphBase:GraphBase\": {\r\n\t\tpointgroup: \"cell\",\r\n\r\n\t\tisedgevalidbynodeobj: function(cell1, cell2) {\r\n\t\t\treturn this.isedgevalidbylinkobj(\r\n\t\t\t\tthis.board.getb((cell1.bx + cell2.bx) >> 1, (cell1.by + cell2.by) >> 1)\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// areagraph.setEdgeByNodeObj() 黒マスになったりした時にブロックの情報を生成しなおす\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetEdgeByNodeObj: function(nodeobj) {\r\n\t\t\t// 一度Edgeを取り外す\r\n\t\t\tif (this.getObjNodeList(nodeobj).length > 0) {\r\n\t\t\t\tthis.removeEdgeByNodeObj(nodeobj);\r\n\t\t\t}\r\n\r\n\t\t\t// Edgeを付け直す\r\n\t\t\tif (this.calcNodeCount(nodeobj) > 0) {\r\n\t\t\t\tthis.addEdgeByNodeObj(nodeobj);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// areagraph.removeEdgeByNodeObj() 黒マスになったりした時にブロックの情報を消去する\r\n\t\t// areagraph.addEdgeByNodeObj()    黒マスになったりした時にブロックの情報を生成する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tremoveEdgeByNodeObj: function(cell) {\r\n\t\t\t// Edgeの除去\r\n\t\t\tvar sidenodeobj = this.getSideObjByNodeObj(cell);\r\n\t\t\tvar node1 = this.getObjNodeList(cell)[0];\r\n\t\t\tvar preedges = node1.nodes.length,\r\n\t\t\t\tcomponent = node1.component,\r\n\t\t\t\tendetach = this.modifyNodes.length === 0;\r\n\t\t\tfor (var i = 0; i < sidenodeobj.length; i++) {\r\n\t\t\t\tvar node2 = this.getObjNodeList(sidenodeobj[i])[0];\r\n\t\t\t\tif (!!node1 && !!node2) {\r\n\t\t\t\t\tthis.removeEdge(node1, node2);\r\n\r\n\t\t\t\t\tif (!!this.incdecBorderCount) {\r\n\t\t\t\t\t\tthis.incdecBorderCount(\r\n\t\t\t\t\t\t\tthis.board.getb(\r\n\t\t\t\t\t\t\t\t(node1.obj.bx + node2.obj.bx) >> 1,\r\n\t\t\t\t\t\t\t\t(node1.obj.by + node2.obj.by) >> 1\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\ttrue\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Nodeを一旦取り除く\r\n\t\t\tif (!!node1) {\r\n\t\t\t\tthis.deleteNode(node1);\r\n\t\t\t}\r\n\r\n\t\t\t// 周囲のComponent末端から切り離されただけの場合は情報を更新して終了\r\n\t\t\tif (!this.rebuildmode && preedges === 1 && endetach) {\r\n\t\t\t\tthis.setComponentInfo(component);\r\n\t\t\t\tthis.modifyNodes = [];\r\n\t\t\t}\r\n\t\t},\r\n\t\taddEdgeByNodeObj: function(cell) {\r\n\t\t\t// Nodeを付加する\r\n\t\t\tfor (var i = 0, len = this.calcNodeCount(cell); i < len; i++) {\r\n\t\t\t\tthis.createNode(cell);\r\n\t\t\t}\r\n\r\n\t\t\t// Edgeの付加\r\n\t\t\tvar sidenodeobj = this.getSideObjByNodeObj(cell);\r\n\t\t\tvar node1 = this.getObjNodeList(cell)[0];\r\n\t\t\tvar enattach = this.modifyNodes.length === 0;\r\n\t\t\tfor (var i = 0; i < sidenodeobj.length; i++) {\r\n\t\t\t\tif (!this.isedgevalidbynodeobj(cell, sidenodeobj[i])) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tvar node2 = this.getObjNodeList(sidenodeobj[i])[0];\r\n\t\t\t\tif (!!node1 && !!node2) {\r\n\t\t\t\t\tthis.addEdge(node1, node2);\r\n\r\n\t\t\t\t\tif (!!this.incdecBorderCount) {\r\n\t\t\t\t\t\tthis.incdecBorderCount(\r\n\t\t\t\t\t\t\tthis.board.getb(\r\n\t\t\t\t\t\t\t\t(node1.obj.bx + node2.obj.bx) >> 1,\r\n\t\t\t\t\t\t\t\t(node1.obj.by + node2.obj.by) >> 1\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\tfalse\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// 周囲のComponentに1か所くっついただけの場合は情報を更新して終了\r\n\t\t\tif (!this.rebuildmode && node1.nodes.length === 1 && enattach) {\r\n\t\t\t\tthis.attachNode(node1, node1.nodes[0].component);\r\n\t\t\t\tthis.modifyNodes = [];\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// areagraph.setExtraData()   指定された領域の拡張データを設定する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tsetExtraData: function(component) {\r\n\t\t\tcomponent.clist = new this.klass.CellList(component.getnodeobjs());\r\n\t\t}\r\n\t},\r\n\r\n\t//--------------------------------------------------------------------------------\r\n\t// ☆AreaShadeGraphクラス  黒マス情報オブジェクトのクラス\r\n\t// ☆AreaUnshadeGraphクラス  白マス情報オブジェクトのクラス\r\n\t// ☆AreaNumberGraphクラス 数字情報オブジェクトのクラス\r\n\t//--------------------------------------------------------------------------------\r\n\t\"AreaShadeGraph:AreaGraphBase\": {\r\n\t\trelation: { \"cell.qans\": \"node\" },\r\n\t\tsetComponentRefs: function(obj, component) {\r\n\t\t\tobj.sblk = component;\r\n\t\t},\r\n\t\tgetObjNodeList: function(nodeobj) {\r\n\t\t\treturn nodeobj.sblknodes;\r\n\t\t},\r\n\t\tresetObjNodeList: function(nodeobj) {\r\n\t\t\tnodeobj.sblknodes = [];\r\n\t\t},\r\n\r\n\t\tisnodevalid: function(cell) {\r\n\t\t\treturn cell.isShade();\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// sblkmgr.setExtraData()   指定された領域の拡張データを設定する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tsetExtraData: function(component) {\r\n\t\t\tcomponent.clist = new this.klass.CellList(component.getnodeobjs());\r\n\t\t\tif (this.coloring && !component.color) {\r\n\t\t\t\tcomponent.color = this.puzzle.painter.getNewLineColor();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// sblkmgr.repaintNodes() ブロックを再描画する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\trepaintNodes: function(components) {\r\n\t\t\tvar clist_all = new this.klass.CellList();\r\n\t\t\tfor (var i = 0; i < components.length; i++) {\r\n\t\t\t\tclist_all.extend(components[i].getnodeobjs());\r\n\t\t\t}\r\n\t\t\tthis.puzzle.painter.repaintBlocks(clist_all);\r\n\t\t}\r\n\t},\r\n\r\n\t\"AreaUnshadeGraph:AreaGraphBase\": {\r\n\t\trelation: { \"cell.qans\": \"node\" },\r\n\t\tsetComponentRefs: function(obj, component) {\r\n\t\t\tobj.ublk = component;\r\n\t\t},\r\n\t\tgetObjNodeList: function(nodeobj) {\r\n\t\t\treturn nodeobj.ublknodes;\r\n\t\t},\r\n\t\tresetObjNodeList: function(nodeobj) {\r\n\t\t\tnodeobj.ublknodes = [];\r\n\t\t},\r\n\r\n\t\tisnodevalid: function(cell) {\r\n\t\t\treturn cell.isUnshade();\r\n\t\t}\r\n\t},\r\n\r\n\t\"AreaNumberGraph:AreaGraphBase\": {\r\n\t\trelation: { \"cell.qnum\": \"node\", \"cell.anum\": \"node\", \"cell.qsub\": \"node\" },\r\n\t\tsetComponentRefs: function(obj, component) {\r\n\t\t\tobj.nblk = component;\r\n\t\t},\r\n\t\tgetObjNodeList: function(nodeobj) {\r\n\t\t\treturn nodeobj.nblknodes;\r\n\t\t},\r\n\t\tresetObjNodeList: function(nodeobj) {\r\n\t\t\tnodeobj.nblknodes = [];\r\n\t\t},\r\n\r\n\t\tisnodevalid: function(cell) {\r\n\t\t\treturn cell.isNumberObj();\r\n\t\t}\r\n\t},\r\n\r\n\t//--------------------------------------------------------------------------------\r\n\t// ☆AreaRoomGraphクラス 部屋情報オブジェクトのクラス\r\n\t//--------------------------------------------------------------------------------\r\n\t\"AreaRoomGraph:AreaGraphBase\": {\r\n\t\trelation: {\r\n\t\t\t\"cell.ques\": \"node\",\r\n\t\t\t\"border.ques\": \"separator\",\r\n\t\t\t\"border.qans\": \"separator\"\r\n\t\t},\r\n\r\n\t\thastop: false,\r\n\r\n\t\tgetComponentRefs: function(obj) {\r\n\t\t\treturn obj.room;\r\n\t\t}, // getSideAreaInfo用\r\n\t\tsetComponentRefs: function(obj, component) {\r\n\t\t\tobj.room = component;\r\n\t\t},\r\n\t\tgetObjNodeList: function(nodeobj) {\r\n\t\t\treturn nodeobj.roomnodes;\r\n\t\t},\r\n\t\tresetObjNodeList: function(nodeobj) {\r\n\t\t\tnodeobj.roomnodes = [];\r\n\t\t},\r\n\r\n\t\tisnodevalid: function(cell) {\r\n\t\t\treturn cell.ques !== 7;\r\n\t\t},\r\n\t\tisedgevalidbylinkobj: function(border) {\r\n\t\t\treturn !border.isBorder();\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// roomgraph.rebuild2() 部屋情報の再設定を行う\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\trebuild2: function() {\r\n\t\t\tthis.klass.AreaGraphBase.prototype.rebuild2.call(this);\r\n\t\t\tthis.resetBorderCount();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// roomgraph.resetBorderCount()  初期化時に、lcnt情報を初期化する\r\n\t\t// roomgraph.incdecBorderCount() 線が引かれたり消された時に、lcnt変数を生成し直す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tresetBorderCount: function() {\r\n\t\t\tvar bd = this.board,\r\n\t\t\t\tborders = bd.border;\r\n\t\t\t/* 外枠のカウントをあらかじめ足しておく */\r\n\t\t\tfor (var c = 0; c < bd.cross.length; c++) {\r\n\t\t\t\tvar cross = bd.cross[c],\r\n\t\t\t\t\tbx = cross.bx,\r\n\t\t\t\t\tby = cross.by;\r\n\t\t\t\tvar ischassis =\r\n\t\t\t\t\tbd.hasborder === 1\r\n\t\t\t\t\t\t? bx === 0 || bx === bd.cols * 2 || by === 0 || by === bd.rows * 2\r\n\t\t\t\t\t\t: false;\r\n\t\t\t\tcross.lcnt = ischassis ? 2 : 0;\r\n\t\t\t}\r\n\t\t\tfor (var id = 0; id < borders.length; id++) {\r\n\t\t\t\tif (!this.isedgevalidbylinkobj(borders[id])) {\r\n\t\t\t\t\tthis.incdecBorderCount(borders[id], true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tincdecBorderCount: function(border, isset) {\r\n\t\t\tfor (var i = 0; i < 2; i++) {\r\n\t\t\t\tvar cross = border.sidecross[i];\r\n\t\t\t\tif (!cross.isnull) {\r\n\t\t\t\t\tif (isset) {\r\n\t\t\t\t\t\tcross.lcnt++;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcross.lcnt--;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// roommgr.addEdgeBySeparator()    指定されたオブジェクトの場所にEdgeを生成する\r\n\t\t// roommgr.removeEdgeBySeparator() 指定されたオブジェクトの場所からEdgeを除去する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\taddEdgeBySeparator: function(border) {\r\n\t\t\t// 境界線を消した時の処理\r\n\t\t\tvar sidenodes = this.getSideNodesBySeparator(border);\r\n\t\t\tif (!sidenodes) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.addEdge(sidenodes[0], sidenodes[1]);\r\n\t\t\tif (border.sidecross[0].lcnt === 0 || border.sidecross[1].lcnt === 0) {\r\n\t\t\t\tthis.modifyNodes = [];\r\n\t\t\t} else if (this.hastop && sidenodes.length >= 2) {\r\n\t\t\t\tthis.setTopOfRoom_combine(sidenodes[0].obj, sidenodes[1].obj);\r\n\t\t\t}\r\n\t\t},\r\n\t\tremoveEdgeBySeparator: function(border) {\r\n\t\t\t// 境界線を引いた時の処理\r\n\t\t\tvar sidenodes = this.getSideNodesBySeparator(border);\r\n\t\t\tif (!sidenodes) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.removeEdge(sidenodes[0], sidenodes[1]);\r\n\t\t\tif (border.sidecross[0].lcnt === 1 || border.sidecross[1].lcnt === 1) {\r\n\t\t\t\tthis.modifyNodes = [];\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// roommgr.setTopOfRoom_combine()  部屋が繋がったとき、部屋のTOPを設定する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tsetTopOfRoom_combine: function(cell1, cell2) {\r\n\t\t\tif (!cell1.room || !cell2.room || cell1.room === cell2.room) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar merged, keep;\r\n\t\t\tvar tcell1 = cell1.room.top;\r\n\t\t\tvar tcell2 = cell2.room.top;\r\n\t\t\tif (\r\n\t\t\t\ttcell1.bx > tcell2.bx ||\r\n\t\t\t\t(tcell1.bx === tcell2.bx && tcell1.by > tcell2.by)\r\n\t\t\t) {\r\n\t\t\t\tmerged = tcell1;\r\n\t\t\t\tkeep = tcell2;\r\n\t\t\t} else {\r\n\t\t\t\tmerged = tcell2;\r\n\t\t\t\tkeep = tcell1;\r\n\t\t\t}\r\n\r\n\t\t\t// 消える部屋のほうの数字を消す\r\n\t\t\tif (merged.isNum()) {\r\n\t\t\t\t// 数字が消える部屋にしかない場合 -> 残るほうに移動させる\r\n\t\t\t\tif (keep.noNum()) {\r\n\t\t\t\t\tkeep.setQnum(merged.qnum);\r\n\t\t\t\t\tkeep.draw();\r\n\t\t\t\t}\r\n\t\t\t\tmerged.setQnum(-1);\r\n\t\t\t\tmerged.draw();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// roommgr.setExtraData()   指定された領域の拡張データを設定する\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tsetExtraData: function(component) {\r\n\t\t\tvar clist = (component.clist = new this.klass.CellList(\r\n\t\t\t\tcomponent.getnodeobjs()\r\n\t\t\t));\r\n\t\t\tif (this.hastop) {\r\n\t\t\t\tcomponent.top = clist.getTopCell();\r\n\r\n\t\t\t\tif (this.rebuildmode) {\r\n\t\t\t\t\tvar val = -1,\r\n\t\t\t\t\t\tclist = clist,\r\n\t\t\t\t\t\ttop = component.top;\r\n\t\t\t\t\tfor (var i = 0, len = clist.length; i < len; i++) {\r\n\t\t\t\t\t\tvar cell = clist[i];\r\n\t\t\t\t\t\tif (cell.room === component && cell.qnum !== -1) {\r\n\t\t\t\t\t\t\tif (val === -1) {\r\n\t\t\t\t\t\t\t\tval = cell.qnum;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (top !== cell) {\r\n\t\t\t\t\t\t\t\tcell.qnum = -1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (val !== -1 && top.qnum === -1) {\r\n\t\t\t\t\t\ttop.qnum = val;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.puzzle.validConfig(\"autocmp\")) {\r\n\t\t\t\tcomponent.checkAutoCmp();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// roommgr.getSideAreaInfo()  接しているが異なる領域部屋の情報を取得する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetSideAreaInfo: function() {\r\n\t\t\tvar sides = [],\r\n\t\t\t\tlen = this.components.length,\r\n\t\t\t\tadjs = {},\r\n\t\t\t\tbd = this.board;\r\n\t\t\tfor (var r = 0; r < this.components.length; r++) {\r\n\t\t\t\tthis.components[r].id = r;\r\n\t\t\t}\r\n\t\t\tfor (var id = 0; id < bd.border.length; id++) {\r\n\t\t\t\tvar room1 = this.getComponentRefs(bd.border[id].sidecell[0]);\r\n\t\t\t\tvar room2 = this.getComponentRefs(bd.border[id].sidecell[1]);\r\n\t\t\t\tif (room1 === room2 || !room1 || !room2) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar key =\r\n\t\t\t\t\troom1.id < room2.id\r\n\t\t\t\t\t\t? room1.id * len + room2.id\r\n\t\t\t\t\t\t: room2.id * len + room1.id;\r\n\t\t\t\tif (!!adjs[key]) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tadjs[key] = true;\r\n\r\n\t\t\t\tsides.push([room1, room2]);\r\n\t\t\t}\r\n\t\t\treturn sides;\r\n\t\t}\r\n\t}\r\n});\r\n","// Graphic.js v3.4.1\r\n\r\n(function() {\r\n\tvar CENTER = 1,\r\n\t\tBOTTOMLEFT = 2,\r\n\t\tBOTTOMRIGHT = 3,\r\n\t\tTOPRIGHT = 4,\r\n\t\tTOPLEFT = 5,\r\n\t\tUP = 6,\r\n\t\tDN = 7,\r\n\t\tLT = 8,\r\n\t\tRT = 9;\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ★Graphicクラス Canvasに描画する\r\n\t//---------------------------------------------------------------------------\r\n\t// パズル共通 Canvas/DOM制御部\r\n\t// Graphicクラスの定義\r\n\tpzpr.classmgr.makeCommon({\r\n\t\t//---------------------------------------------------------\r\n\t\tGraphic: {\r\n\t\t\tinitialize: function() {\r\n\t\t\t\tthis.gridcolor =\r\n\t\t\t\t\tthis.gridcolor_list[this.gridcolor_type] || this.gridcolor;\r\n\r\n\t\t\t\tvar pc = this;\r\n\t\t\t\t[\r\n\t\t\t\t\t[\"getQuesCellColor\", this.fgcellcolor_func],\r\n\t\t\t\t\t[\"getBGCellColor\", this.bgcellcolor_func],\r\n\t\t\t\t\t[\"getBorderColor\", this.bordercolor_func],\r\n\t\t\t\t\t[\"getQuesNumberColor\", this.numbercolor_func],\r\n\t\t\t\t\t[\"getCircleFillColor\", this.circlefillcolor_func],\r\n\t\t\t\t\t[\"getCircleStrokeColor\", this.circlestrokecolor_func]\r\n\t\t\t\t].forEach(function(item) {\r\n\t\t\t\t\tif (pc[item[0]] !== pzpr.common.Graphic.prototype[item[0]]) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t} // パズル個別の関数が定義されている場合はそのまま使用\r\n\t\t\t\t\tpc[item[0]] = pc[item[0] + \"_\" + item[1]] || pc[item[0]];\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.resetRange();\r\n\r\n\t\t\t\tthis.initFont();\r\n\t\t\t},\r\n\r\n\t\t\tcontext: null,\r\n\t\t\tsubcontext: null,\r\n\r\n\t\t\tfgcellcolor_func: \"ques\", // getQuesCellColor()の種類\r\n\t\t\tbgcellcolor_func: \"error1\", // getBGCellColor()の種類\r\n\t\t\tbordercolor_func: \"ques\", // getBorderColor()の種類\r\n\t\t\tnumbercolor_func: \"mixed\", // getQuesNumberColor()の種類\r\n\r\n\t\t\tcirclefillcolor_func: \"qnum\", // getCircleFillColor()の種類\r\n\t\t\tcirclestrokecolor_func: \"qnum\", // getCircleStrokeColor()の種類\r\n\r\n\t\t\t// 標準の色設定\r\n\t\t\tquescolor: \"black\",\r\n\t\t\tqanscolor: \"rgb(0, 160, 0)\",\r\n\t\t\tqcmpcolor: \"silver\",\r\n\t\t\tqcmpbgcolor: \"rgb(224, 224, 255)\",\r\n\t\t\ttrialcolor: \"rgb(160, 160, 160)\",\r\n\t\t\tsubcolor: \"rgb(127, 127, 255)\",\r\n\r\n\t\t\t// 黒マスの色\r\n\t\t\tshadecolor: \"black\",\r\n\t\t\terrcolor1: \"rgb(192, 0, 0)\",\r\n\t\t\terrcolor2: \"rgb(32, 32, 255)\",\r\n\t\t\tfontShadecolor: \"rgb(224, 224, 224)\",\r\n\r\n\t\t\t// 白マス確定マスの背景色\r\n\t\t\tenablebcolor: false,\r\n\t\t\tbcolor: \"rgb(160, 255, 160)\",\r\n\t\t\terrbcolor1: \"rgb(255, 160, 160)\",\r\n\t\t\terrbcolor2: \"rgb(64, 255, 64)\",\r\n\r\n\t\t\tqsubcolor1: \"rgb(160,255,160)\",\r\n\t\t\tqsubcolor2: \"rgb(255,255,127)\",\r\n\t\t\tqsubcolor3: \"rgb(192,192,192)\", // 絵が出るパズルの背景入力\r\n\r\n\t\t\ticecolor: \"rgb(192, 224, 255)\",\r\n\t\t\terricecolor: \"rgb(224,  96, 160)\",\r\n\r\n\t\t\t// セルの丸数字内部の背景色\r\n\t\t\tcirclebasecolor: \"white\",\r\n\r\n\t\t\t// セルの○×の色(補助記号)\r\n\t\t\tmbcolor: \"rgb(0, 160, 0)\",\r\n\r\n\t\t\t// 線・×の色\r\n\t\t\tlinecolor: \"rgb(0, 160, 0)\", // 色分けなしの場合\r\n\t\t\terrlinecolor: \"rgb(255, 0, 0)\",\r\n\t\t\tnoerrcolor: \"rgb(160, 160, 160)\", // エラー表示時, エラーでない線/境界線の描画色\r\n\r\n\t\t\tmovelinecolor: \"silver\",\r\n\t\t\tmovetrialcolor: \"rgb(255, 160, 0)\",\r\n\r\n\t\t\tpekecolor: \"rgb(0, 127, 0)\",\r\n\r\n\t\t\t// 境界線と黒マスを分ける色(BoxBorder)\r\n\t\t\tbbcolor: \"rgb(160, 160, 160)\",\r\n\r\n\t\t\t// 入力ターゲットの色\r\n\t\t\ttargetColorEdit: \"rgb(255, 64,  64)\",\r\n\t\t\ttargetColorPlay: \"rgb(64,  64, 255)\",\r\n\t\t\ttargetColorTrial: \"rgb(255,  64, 255)\",\r\n\t\t\tttcolor: \"rgb(127,255,127)\", // ques=51の入力ターゲット(TargetTriangle)\r\n\r\n\t\t\tmovecolor: \"red\",\r\n\r\n\t\t\t// 盤面のCellを分ける色\r\n\t\t\tgridcolor: \"black\",\r\n\t\t\tgridcolor_type: \"\",\r\n\t\t\tgridcolor_list: {\r\n\t\t\t\t// 色々なパズルで定義してた固定色\r\n\t\t\t\tDARK: \"rgb( 48,  48,  48)\" /* LITSでの指定 */,\r\n\t\t\t\tLIGHT: \"rgb(127, 127, 127)\" /* ほとんどはこの色を指定している */,\r\n\t\t\t\tDLIGHT: \"rgb(160, 160, 160)\" /* 領域分割系で使ってることが多い */,\r\n\t\t\t\tSLIGHT: \"rgb(191, 191, 191)\" /* 部屋＋線を引くパズル           */,\r\n\t\t\t\tTHIN: \"rgb(224, 224, 224)\" /* 問題入力時のみGrid表示のパズル */\r\n\t\t\t},\r\n\r\n\t\t\t// 盤面(枠の中)の背景色\r\n\t\t\tbgcolor: \"white\",\r\n\r\n\t\t\t// その他サイズ指定\r\n\t\t\ttextoption: null,\r\n\t\t\tfontsizeratio: 0.8, // Fontサイズのcellsizeとの比率\r\n\t\t\tfontwidth: [0.5, 0.4, 0.33], // 2文字以上のTextの横幅 (2文字〜の文字単位横幅を指定する)\r\n\t\t\tfontfamily: \"\",\r\n\t\t\tisSupportMaxWidth: true, // maxWidthサポートブラウザ\r\n\t\t\tcrosssize: 0.4,\r\n\t\t\tcircleratio: [0.4, 0.35],\r\n\r\n\t\t\t// 枠外の一辺のmargin(セル数換算)\r\n\t\t\tmargin: 0.15,\r\n\r\n\t\t\t// canvasの大きさを保持する\r\n\t\t\tcanvasWidth: null,\r\n\t\t\tcanvasHeight: null,\r\n\r\n\t\t\t// canvas内での盤面の左上座標\r\n\t\t\tx0: 0,\r\n\t\t\ty0: 0,\r\n\r\n\t\t\t// 描画単位(デフォルト値)\r\n\t\t\tcw: 36, // セルの横幅\r\n\t\t\tch: 36, // セルの縦幅\r\n\t\t\tbw: 18, // セルの横幅/2\r\n\t\t\tbh: 18, // セルの縦幅/2\r\n\r\n\t\t\tdevicePixelRatio: 1,\r\n\t\t\tgw: 1, // grid width\r\n\t\t\tlw: 1, // LineWidth 境界線・Lineの太さ\r\n\t\t\tlwmin: 3,\r\n\t\t\tlm: 1, // LineMargin\r\n\t\t\tlwratio: 10, // onresize_processでlwの値の算出に用いる\r\n\t\t\taddlw: 0, // エラー時に線の太さを広げる\r\n\r\n\t\t\t// getNewColorの設定\r\n\t\t\tlastHdeg: 0,\r\n\t\t\tlastYdeg: 0,\r\n\t\t\tminYdeg: 0.18,\r\n\t\t\tmaxYdeg: 0.7,\r\n\r\n\t\t\t// その他の描画設定\r\n\t\t\trange: null, // 描画領域を保持するオブジェクト\r\n\r\n\t\t\tuseBuffer: false, // Buffer描画を行うか\r\n\t\t\toutputImage: false, // 画像保存中\r\n\r\n\t\t\t// resize関数が呼ばれたが、初期化されていない等でresizeしていないことを示すフラグ\r\n\t\t\tpendingResize: false,\r\n\r\n\t\t\t// 初期化前、およびsuspend呼び出し中を示すフラグ\r\n\t\t\tsuspended: true,\r\n\t\t\tsuspendedAll: true,\r\n\r\n\t\t\t// Cellのqnumが-2のときに？を表示しないパズルごとの設定\r\n\t\t\thideHatena: false,\r\n\r\n\t\t\t// 正解条件を満たしたオブジェクトを描画するかどうかの設定\r\n\t\t\tautocmp: \"\",\r\n\r\n\t\t\t// 色分け設定\r\n\t\t\tirowake: false,\r\n\t\t\tirowakeblk: false,\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// pc.initCanvas()       このオブジェクトで使用するキャンバスを設定する\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tinitCanvas: function() {\r\n\t\t\t\tvar puzzle = this.puzzle;\r\n\t\t\t\tvar g = (this.context = !!puzzle.canvas\r\n\t\t\t\t\t? puzzle.canvas.getContext(\"2d\")\r\n\t\t\t\t\t: null);\r\n\t\t\t\tif (g.use.canvas) {\r\n\t\t\t\t\tthis.subcontext = !!puzzle.subcanvas\r\n\t\t\t\t\t\t? puzzle.subcanvas.getContext(\"2d\")\r\n\t\t\t\t\t\t: null;\r\n\t\t\t\t\tthis.useBuffer = !!this.subcontext;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.canvasWidth === null || this.canvasHeight === null) {\r\n\t\t\t\t\tvar rect = pzpr.util.getRect(puzzle.canvas);\r\n\t\t\t\t\tthis.resizeCanvas(rect.width, rect.height);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.pendingResize = true;\r\n\t\t\t\tthis.resize_canvas_main();\r\n\t\t\t\tpuzzle.emit(\"canvasReady\");\r\n\r\n\t\t\t\tthis.unsuspend();\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// pc.initFont()  数字を記入するためのフォントを設定する\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tinitFont: function() {\r\n\t\t\t\tvar isgothic = this.puzzle.getConfig(\"font\") === 1;\r\n\t\t\t\tif (this.puzzle.pzpr.env.OS.Android) {\r\n\t\t\t\t\tthis.fontfamily = isgothic\r\n\t\t\t\t\t\t? \"Helvetica, Verdana, Arial, \"\r\n\t\t\t\t\t\t: '\"Times New Roman\", ';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.fontfamily = \"\";\r\n\t\t\t\t}\r\n\t\t\t\tthis.fontfamily += isgothic ? \"sans-serif\" : \"serif\";\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// pc.resizeCanvas()    キャンバスのサイズを設定する\r\n\t\t\t//                      (指定なしの場合は、前のキャンバスのサイズを用いる)\r\n\t\t\t// pc.resizeCanvasByCellSize() セルのサイズを指定してキャンバスのサイズを変える\r\n\t\t\t//                             (指定なしの場合は、前のセルのサイズを用いる)\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tresizeCanvas: function(cwid, chgt) {\r\n\t\t\t\tvar insuspend = this.suspended;\r\n\t\t\t\tthis.suspendAll();\r\n\r\n\t\t\t\tthis.canvasWidth = cwid || this.canvasWidth;\r\n\t\t\t\tthis.canvasHeight = chgt || this.canvasHeight;\r\n\r\n\t\t\t\tthis.pendingResize = true;\r\n\t\t\t\tif (!insuspend) {\r\n\t\t\t\t\tthis.unsuspend();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tresizeCanvasByCellSize: function(cellsize) {\r\n\t\t\t\tvar insuspend = this.suspended;\r\n\t\t\t\tthis.suspendAll();\r\n\r\n\t\t\t\tthis.cw = cellsize || this.cw;\r\n\t\t\t\tthis.ch = cellsize || this.ch;\r\n\t\t\t\tthis.canvasWidth = this.cw * this.getCanvasCols();\r\n\t\t\t\tthis.canvasHeight = this.ch * this.getCanvasRows();\r\n\r\n\t\t\t\tthis.pendingResize = true;\r\n\t\t\t\tif (!insuspend) {\r\n\t\t\t\t\tthis.unsuspend();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// pc.resize_canvas_main() ウィンドウのLoad/Resize時の処理。\r\n\t\t\t//                         Canvas/表示するマス目の大きさを設定する。\r\n\t\t\t// pc.setParameter()       cw, ch等の変数を大きさに応じて再設定する\r\n\t\t\t// pc.setOffset()          盤面のサイズや大きさを再設定する\r\n\t\t\t// pc.setPagePos()         盤面のページ内座標を設定する\r\n\t\t\t// pc.clearObject()        contextのclearなどを呼び出す関数\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tresize_canvas_main: function() {\r\n\t\t\t\tif (!this.pendingResize) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.pendingResize = false;\r\n\r\n\t\t\t\t// セルのサイズなどを取得・設定\r\n\t\t\t\tthis.setParameter();\r\n\r\n\t\t\t\t// Canvasのサイズ、オフセット位置の変更\r\n\t\t\t\tthis.setOffset();\r\n\r\n\t\t\t\t// Listener呼び出し\r\n\t\t\t\tthis.puzzle.emit(\"resize\");\r\n\r\n\t\t\t\t// contextのclear等を呼び出す\r\n\t\t\t\tthis.clearObject();\r\n\t\t\t},\r\n\r\n\t\t\tsetParameter: function() {\r\n\t\t\t\tvar cwid = this.canvasWidth,\r\n\t\t\t\t\tchgt = this.canvasHeight;\r\n\t\t\t\tvar cols = this.getCanvasCols(),\r\n\t\t\t\t\trows = this.getCanvasRows();\r\n\t\t\t\tvar cw = (cwid / cols) | 0,\r\n\t\t\t\t\tch = (chgt / rows) | 0;\r\n\r\n\t\t\t\tthis.devicePixelRatio = this.puzzle.pzpr.env.browser\r\n\t\t\t\t\t? window.devicePixelRatio || 1\r\n\t\t\t\t\t: 1;\r\n\r\n\t\t\t\tif (this.puzzle.getConfig(\"squarecell\")) {\r\n\t\t\t\t\tthis.cw = this.ch = Math.min(cw, ch);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.cw = cw;\r\n\t\t\t\t\tthis.ch = ch;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.bw = this.cw / 2;\r\n\t\t\t\tthis.bh = this.ch / 2;\r\n\r\n\t\t\t\tvar gwmax = 1,\r\n\t\t\t\t\tgwratio = 40;\r\n\t\t\t\tvar gw = Math.min(this.cw / gwratio, gwmax);\r\n\t\t\t\tvar pxSize = 1 / this.devicePixelRatio;\r\n\t\t\t\tvar gwdev = Math.max(1, Math.round(gw / pxSize));\r\n\t\t\t\tthis.gw = gwdev * pxSize;\r\n\r\n\t\t\t\tvar lw = Math.max(this.cw / this.lwratio, this.lwmin);\r\n\t\t\t\tvar lwdev = Math.max(1, Math.round(lw / pxSize));\r\n\t\t\t\tthis.lw = lwdev * pxSize;\r\n\t\t\t\tthis.lm = this.lw / 2;\r\n\t\t\t},\r\n\t\t\tsetOffset: function() {\r\n\t\t\t\tvar g = this.context,\r\n\t\t\t\t\tg2 = this.subcontext;\r\n\t\t\t\tvar cwid = this.canvasWidth,\r\n\t\t\t\t\tchgt = this.canvasHeight;\r\n\r\n\t\t\t\t// canvas要素のサイズを変更する\r\n\t\t\t\tg.changeSize(cwid | 0, chgt | 0);\r\n\t\t\t\tif (!!g2) {\r\n\t\t\t\t\tg2.changeSize(cwid | 0, chgt | 0);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 盤面のセルID:0が描画される左上の位置の設定 (Canvas左上からのオフセット)\r\n\t\t\t\tvar x0 = (this.x0 =\r\n\t\t\t\t\t(((cwid - this.cw * this.getBoardCols()) / 2 +\r\n\t\t\t\t\t\tthis.cw * this.getOffsetCols()) |\r\n\t\t\t\t\t\t0) +\r\n\t\t\t\t\t0.5);\r\n\t\t\t\tvar y0 = (this.y0 =\r\n\t\t\t\t\t(((chgt - this.ch * this.getBoardRows()) / 2 +\r\n\t\t\t\t\t\tthis.ch * this.getOffsetRows()) |\r\n\t\t\t\t\t\t0) +\r\n\t\t\t\t\t0.5);\r\n\r\n\t\t\t\t// CanvasのOffset位置変更 (SVGの時、小数点以下の端数調整を行う)\r\n\t\t\t\tif (!g.use.canvas) {\r\n\t\t\t\t\tvar rect = pzpr.util.getRect(g.canvas);\r\n\t\t\t\t\tg.translate(x0 - (rect.left % 1), y0 - (rect.top % 1));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.translate(x0, y0);\r\n\t\t\t\t\tif (!!g2) {\r\n\t\t\t\t\t\tg2.translate(x0, y0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tclearObject: function() {\r\n\t\t\t\tthis.context.clear();\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// pc.getCanvasCols()  Canvasの横幅としてセル何個分が必要か返す\r\n\t\t\t// pc.getCanvasRows()  Canvasの縦幅としてセル何個分が必要か返す\r\n\t\t\t// pc.getBoardCols()   マージンを除いた盤面の横幅としてセル何個分が必要か返す\r\n\t\t\t// pc.getBoardRows()   マージンを除いた盤面の縦幅としてセル何個分が必要か返す\r\n\t\t\t// pc.getOffsetCols()  有効範囲が(0,0)-(C,R)からずれているパズルで、左右の中心位置を調整する\r\n\t\t\t// pc.getOffsetRows()  有効範囲が(0,0)-(C,R)からずれているパズルで、上下の中心位置を調整する\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tgetCanvasCols: function() {\r\n\t\t\t\treturn this.getBoardCols() + 2 * this.margin;\r\n\t\t\t},\r\n\t\t\tgetCanvasRows: function() {\r\n\t\t\t\treturn this.getBoardRows() + 2 * this.margin;\r\n\t\t\t},\r\n\r\n\t\t\tgetBoardCols: function() {\r\n\t\t\t\tvar bd = this.board;\r\n\t\t\t\treturn (bd.maxbx - bd.minbx) / 2;\r\n\t\t\t},\r\n\t\t\tgetBoardRows: function() {\r\n\t\t\t\tvar bd = this.board;\r\n\t\t\t\treturn (bd.maxby - bd.minby) / 2;\r\n\t\t\t},\r\n\r\n\t\t\tgetOffsetCols: function() {\r\n\t\t\t\t/* 右にずらしたい分プラス、左にずらしたい分マイナス */\r\n\t\t\t\treturn (0 - this.board.minbx) / 2;\r\n\t\t\t},\r\n\t\t\tgetOffsetRows: function() {\r\n\t\t\t\t/* 下にずらしたい分プラス、上にずらしたい分マイナス */\r\n\t\t\t\treturn (0 - this.board.minby) / 2;\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// pc.suspend()     描画処理を一時停止する\r\n\t\t\t// pc.suspendAll()  全盤面の描画処理を一時停止する\r\n\t\t\t// pc.unsuspend()   描画処理を再開する\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tsuspend: function() {\r\n\t\t\t\tthis.suspended = true;\r\n\t\t\t},\r\n\t\t\tsuspendAll: function() {\r\n\t\t\t\tthis.suspendedAll = true;\r\n\t\t\t\tthis.suspended = true;\r\n\t\t\t},\r\n\t\t\tunsuspend: function() {\r\n\t\t\t\tif (!this.context) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.resize_canvas_main();\r\n\r\n\t\t\t\tif (this.suspendedAll) {\r\n\t\t\t\t\tvar bd = this.board;\r\n\t\t\t\t\tthis.setRange(bd.minbx - 2, bd.minby - 2, bd.maxbx + 2, bd.maxby + 2);\r\n\t\t\t\t\tthis.suspendedAll = false;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.suspended) {\r\n\t\t\t\t\tthis.suspended = false;\r\n\t\t\t\t\tthis.prepaint();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// pc.prepaint()    paint関数を呼び出す\r\n\t\t\t// pc.paint()       座標(x1,y1)-(x2,y2)を再描画する。各パズルのファイルでオーバーライドされる。\r\n\t\t\t//\r\n\t\t\t// pc.setRange()       rangeオブジェクトを設定する\r\n\t\t\t// pc.setRangeObject() 描画対象となるオブジェクトを取得する\r\n\t\t\t// pc.resetRange()     rangeオブジェクトを初期化する\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tprepaint: function() {\r\n\t\t\t\tif (this.suspended || !this.context) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.isSupportMaxWidth =\r\n\t\t\t\t\t(this.context.use.svg && pzpr.env.API.svgTextLength) ||\r\n\t\t\t\t\t(this.context.use.canvas && pzpr.env.API.maxWidth);\r\n\r\n\t\t\t\tvar bd = this.board,\r\n\t\t\t\t\tbm = 2 * this.margin,\r\n\t\t\t\t\tx1 = this.range.x1,\r\n\t\t\t\t\ty1 = this.range.y1,\r\n\t\t\t\t\tx2 = this.range.x2,\r\n\t\t\t\t\ty2 = this.range.y2;\r\n\t\t\t\tif (\r\n\t\t\t\t\tx1 > x2 ||\r\n\t\t\t\t\ty1 > y2 ||\r\n\t\t\t\t\tx1 >= bd.maxbx + bm ||\r\n\t\t\t\t\ty1 >= bd.maxby + bm ||\r\n\t\t\t\t\tx2 <= bd.minbx - bm ||\r\n\t\t\t\t\ty2 <= bd.minby - (bm + (this.pid === \"starbattle\" ? 2 : 0))\r\n\t\t\t\t) {\r\n\t\t\t\t\t/* 入力が範囲外ならば何もしない */\r\n\t\t\t\t} else if (!this.useBuffer) {\r\n\t\t\t\t\tthis.setRangeObject(x1, y1, x2, y2);\r\n\t\t\t\t\tthis.flushCanvas();\r\n\t\t\t\t\tthis.paintMain();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar g = this.context,\r\n\t\t\t\t\t\tg2 = this.subcontext;\r\n\t\t\t\t\tthis.context = g2;\r\n\t\t\t\t\tthis.setRangeObject(x1 - 1, y1 - 1, x2 + 1, y2 + 1);\r\n\t\t\t\t\tthis.flushCanvas();\r\n\t\t\t\t\tthis.paintMain();\r\n\t\t\t\t\tthis.context = g;\r\n\t\t\t\t\tthis.copyBufferData(g, g2, x1, y1, x2, y2);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.resetRange();\r\n\t\t\t},\r\n\t\t\tpaintMain: function() {\r\n\t\t\t\tthis.paint();\r\n\t\t\t\tthis.paintPost();\r\n\t\t\t},\r\n\t\t\tpaint: function() {}, //オーバーライド用\r\n\t\t\tpaintPost: function() {},\r\n\r\n\t\t\tsetRange: function(x1, y1, x2, y2) {\r\n\t\t\t\tif (this.range.x1 > x1) {\r\n\t\t\t\t\tthis.range.x1 = x1;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.range.y1 > y1) {\r\n\t\t\t\t\tthis.range.y1 = y1;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.range.x2 < x2) {\r\n\t\t\t\t\tthis.range.x2 = x2;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.range.y2 < y2) {\r\n\t\t\t\t\tthis.range.y2 = y2;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tsetRangeObject: function(x1, y1, x2, y2) {\r\n\t\t\t\tvar bd = this.board;\r\n\t\t\t\tthis.range.cells = bd.cellinside(x1, y1, x2, y2);\r\n\t\t\t\tthis.range.crosses = bd.crossinside(x1, y1, x2, y2);\r\n\t\t\t\tthis.range.borders = bd.borderinside(x1, y1, x2, y2);\r\n\t\t\t\tthis.range.excells = bd.excellinside(x1, y1, x2, y2);\r\n\t\t\t},\r\n\t\t\tresetRange: function() {\r\n\t\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\t\tbd = puzzle.board,\r\n\t\t\t\t\tclasses = puzzle.klass;\r\n\t\t\t\tthis.range = {\r\n\t\t\t\t\tx1: bd.maxbx + 1,\r\n\t\t\t\t\ty1: bd.maxby + 1,\r\n\t\t\t\t\tx2: bd.minbx - 1,\r\n\t\t\t\t\ty2: bd.minby - 1,\r\n\t\t\t\t\tcells: new classes.CellList(),\r\n\t\t\t\t\tcrosses: new classes.CrossList(),\r\n\t\t\t\t\tborders: new classes.BorderList(),\r\n\t\t\t\t\texcells: new classes.ExCellList()\r\n\t\t\t\t};\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// pc.copyBufferData()    Bufferに描画したデータを盤面へコピーする\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tcopyBufferData: function(g, g2, x1, y1, x2, y2) {\r\n\t\t\t\t// source側はtaranslateのぶん足されていないので、加算しておきます\r\n\t\t\t\tvar sx1 = this.x0 + x1 * this.bw - 1,\r\n\t\t\t\t\tsy1 = this.y0 + y1 * this.bh - 1,\r\n\t\t\t\t\tsx2 = this.x0 + x2 * this.bw + 2,\r\n\t\t\t\t\tsy2 = this.y0 + y2 * this.bh + 2;\r\n\t\t\t\tif (sx1 < 0) {\r\n\t\t\t\t\tsx1 = 0;\r\n\t\t\t\t}\r\n\t\t\t\tif (sx2 > g2.child.width) {\r\n\t\t\t\t\tsx2 = g2.child.width;\r\n\t\t\t\t}\r\n\t\t\t\tif (sy1 < 0) {\r\n\t\t\t\t\tsy1 = 0;\r\n\t\t\t\t}\r\n\t\t\t\tif (sy2 > g2.child.height) {\r\n\t\t\t\t\tsy2 = g2.child.height;\r\n\t\t\t\t}\r\n\t\t\t\tg.drawImage(\r\n\t\t\t\t\tg2.child,\r\n\t\t\t\t\tsx1,\r\n\t\t\t\t\tsy1,\r\n\t\t\t\t\tsx2 - sx1,\r\n\t\t\t\t\tsy2 - sy1,\r\n\t\t\t\t\tsx1 - this.x0,\r\n\t\t\t\t\tsy1 - this.y0,\r\n\t\t\t\t\tsx2 - sx1,\r\n\t\t\t\t\tsy2 - sy1\r\n\t\t\t\t);\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// pc.paintRange()  座標(x1,y1)-(x2,y2)を再描画する\r\n\t\t\t// pc.paintAll()    全体を再描画する\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tpaintRange: function(x1, y1, x2, y2) {\r\n\t\t\t\tthis.setRange(x1, y1, x2, y2);\r\n\t\t\t\tthis.prepaint();\r\n\t\t\t},\r\n\t\t\tpaintAll: function() {\r\n\t\t\t\tif (this.suspended) {\r\n\t\t\t\t\tthis.suspendedAll = true;\r\n\t\t\t\t}\r\n\t\t\t\tvar bd = this.board;\r\n\t\t\t\tthis.paintRange(bd.minbx - 2, bd.minby - 2, bd.maxbx + 2, bd.maxby + 2);\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// pc.getNewLineColor() 新しい色を返す\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tgetNewLineColor: function() {\r\n\t\t\t\tvar loopcount = 0;\r\n\r\n\t\t\t\twhile (1) {\r\n\t\t\t\t\tvar Rdeg = ((Math.random() * 384) | 0) - 64;\r\n\t\t\t\t\tif (Rdeg < 0) {\r\n\t\t\t\t\t\tRdeg = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (Rdeg > 255) {\r\n\t\t\t\t\t\tRdeg = 255;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar Gdeg = ((Math.random() * 384) | 0) - 64;\r\n\t\t\t\t\tif (Gdeg < 0) {\r\n\t\t\t\t\t\tGdeg = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (Gdeg > 255) {\r\n\t\t\t\t\t\tGdeg = 255;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar Bdeg = ((Math.random() * 384) | 0) - 64;\r\n\t\t\t\t\tif (Bdeg < 0) {\r\n\t\t\t\t\t\tBdeg = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (Bdeg > 255) {\r\n\t\t\t\t\t\tBdeg = 255;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// HLSの各組成値を求める\r\n\t\t\t\t\tvar Cmax = Math.max(Rdeg, Math.max(Gdeg, Bdeg));\r\n\t\t\t\t\tvar Cmin = Math.min(Rdeg, Math.min(Gdeg, Bdeg));\r\n\r\n\t\t\t\t\tvar Hdeg = 0;\r\n\t\t\t\t\tvar Ldeg = ((Cmax + Cmin) * 0.5) / 255;\r\n\t\t\t\t\tvar Sdeg =\r\n\t\t\t\t\t\tCmax === Cmin\r\n\t\t\t\t\t\t\t? 0\r\n\t\t\t\t\t\t\t: (Cmax - Cmin) /\r\n\t\t\t\t\t\t\t  (Ldeg <= 0.5 ? Cmax + Cmin : 2 * 255 - Cmax - Cmin);\r\n\r\n\t\t\t\t\tif (Cmax === Cmin) {\r\n\t\t\t\t\t\tHdeg = 0;\r\n\t\t\t\t\t} else if (Rdeg >= Gdeg && Rdeg >= Bdeg) {\r\n\t\t\t\t\t\tHdeg = ((60 * (Gdeg - Bdeg)) / (Cmax - Cmin) + 360) % 360;\r\n\t\t\t\t\t} else if (Gdeg >= Rdeg && Gdeg >= Bdeg) {\r\n\t\t\t\t\t\tHdeg = (120 + (60 * (Bdeg - Rdeg)) / (Cmax - Cmin) + 360) % 360;\r\n\t\t\t\t\t} else if (Bdeg >= Gdeg && Bdeg >= Rdeg) {\r\n\t\t\t\t\t\tHdeg = (240 + (60 * (Rdeg - Gdeg)) / (Cmax - Cmin) + 360) % 360;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// YCbCrのYを求める\r\n\t\t\t\t\tvar Ydeg = (0.29891 * Rdeg + 0.58661 * Gdeg + 0.11448 * Bdeg) / 255;\r\n\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tthis.minYdeg < Ydeg &&\r\n\t\t\t\t\t\tYdeg < this.maxYdeg &&\r\n\t\t\t\t\t\tMath.abs(this.lastYdeg - Ydeg) > 0.15 &&\r\n\t\t\t\t\t\t(Sdeg < 0.02 || 0.4 < Sdeg) &&\r\n\t\t\t\t\t\t(360 + this.lastHdeg - Hdeg) % 360 >= 45 &&\r\n\t\t\t\t\t\t(360 + this.lastHdeg - Hdeg) % 360 <= 315\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tthis.lastHdeg = Hdeg;\r\n\t\t\t\t\t\tthis.lastYdeg = Ydeg;\r\n\t\t\t\t\t\t//alert(\"rgb(\"+Rdeg+\", \"+Gdeg+\", \"+Bdeg+\")\\nHLS(\"+(Hdeg|0)+\", \"+(\"\"+((Ldeg*1000)|0)*0.001).slice(0,5)+\", \"+(\"\"+((Sdeg*1000|0))*0.001).slice(0,5)+\")\\nY(\"+(\"\"+((Ydeg*1000)|0)*0.001).slice(0,5)+\")\");\r\n\t\t\t\t\t\treturn \"rgb(\" + Rdeg + \",\" + Gdeg + \",\" + Bdeg + \")\";\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tloopcount++;\r\n\t\t\t\t\tif (loopcount > 100) {\r\n\t\t\t\t\t\treturn \"rgb(\" + Rdeg + \",\" + Gdeg + \",\" + Bdeg + \")\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// pc.repaintBlocks()  色分け時にブロックを再描画する\r\n\t\t\t// pc.repaintLines()   ひとつながりの線を再描画する\r\n\t\t\t// pc.repaintParts()   repaintLine()関数で、さらに上から描画しなおしたい処理を書く\r\n\t\t\t//                     canvas描画時のみ呼ばれます(他は描画しなおす必要なし)\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\trepaintBlocks: function(clist) {\r\n\t\t\t\tclist.draw();\r\n\t\t\t},\r\n\t\t\trepaintLines: function(blist) {\r\n\t\t\t\tthis.range.borders = blist;\r\n\t\t\t\tthis.drawLines();\r\n\r\n\t\t\t\tif (this.context.use.canvas) {\r\n\t\t\t\t\tthis.repaintParts(blist);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\trepaintParts: function(blist) {}, // オーバーライド用\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// pc.flushCanvas()    指定された領域を白で塗りつぶす\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tflushCanvas: function() {\r\n\t\t\t\tvar g = this.vinc(\"background\", \"crispEdges\", true);\r\n\t\t\t\tvar bw = this.bw,\r\n\t\t\t\t\tbh = this.bh,\r\n\t\t\t\t\tfm = this.margin > 0.15 ? this.margin : 0;\r\n\t\t\t\tvar bd = this.board;\r\n\t\t\t\tvar minbx = bd.minbx - fm;\r\n\t\t\t\tvar minby = bd.minby - fm;\r\n\t\t\t\tvar bwidth = bd.maxbx + fm - minbx;\r\n\t\t\t\tvar bheight = bd.maxby + fm - minby;\r\n\r\n\t\t\t\tg.vid = \"BG\";\r\n\t\t\t\tg.fillStyle = this.bgcolor;\r\n\t\t\t\tg.fillRect(\r\n\t\t\t\t\tminbx * bw - 0.5,\r\n\t\t\t\t\tminby * bh - 0.5,\r\n\t\t\t\t\tbwidth * bw + 1,\r\n\t\t\t\t\tbheight * bh + 1\r\n\t\t\t\t);\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// pc.vinc()  レイヤーを返す\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tvinc: function(layerid, rendering, freeze) {\r\n\t\t\t\tvar g = this.context,\r\n\t\t\t\t\toption = { freeze: !!freeze };\r\n\t\t\t\toption.rendering = rendering;\r\n\t\t\t\tg.setLayer(layerid, option);\r\n\t\t\t\treturn g;\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// pc.disptext()  数字を記入するための共通関数\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tCENTER: CENTER,\r\n\t\t\tBOTTOMLEFT: BOTTOMLEFT,\r\n\t\t\tBOTTOMRIGHT: BOTTOMRIGHT,\r\n\t\t\tTOPRIGHT: TOPRIGHT,\r\n\t\t\tTOPLEFT: TOPLEFT,\r\n\t\t\tUP: UP,\r\n\t\t\tDN: DN,\r\n\t\t\tRT: RT,\r\n\t\t\tLT: LT,\r\n\r\n\t\t\tdisptext: function(text, px, py, option) {\r\n\t\t\t\toption = option || {};\r\n\t\t\t\tvar g = this.context;\r\n\r\n\t\t\t\tvar realsize = (this.cw * (option.ratio || this.fontsizeratio)) | 0;\r\n\t\t\t\tvar maxLength = void 0;\r\n\t\t\t\tvar widtharray = option.width || this.fontwidth;\r\n\t\t\t\tvar widthratiopos =\r\n\t\t\t\t\ttext.length <= widtharray.length + 1\r\n\t\t\t\t\t\t? text.length - 2\r\n\t\t\t\t\t\t: widtharray.length - 1;\r\n\t\t\t\tvar widthratio =\r\n\t\t\t\t\twidthratiopos >= 0 ? widtharray[widthratiopos] * text.length : null;\r\n\t\t\t\tif (this.isSupportMaxWidth) {\r\n\t\t\t\t\t// maxLengthサポートブラウザ\r\n\t\t\t\t\tmaxLength = !!widthratio ? realsize * widthratio : void 0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// maxLength非サポートブラウザ\r\n\t\t\t\t\tif (!!widthratio) {\r\n\t\t\t\t\t\trealsize = ((realsize * widthratio * 1.5) / text.length) | 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar style = option.style ? option.style + \" \" : \"\";\r\n\t\t\t\tg.font = style + realsize + \"px \" + this.fontfamily;\r\n\r\n\t\t\t\tvar hoffset = this.bw * (option.hoffset || 0.9);\r\n\t\t\t\tvar voffset = this.bh * (option.voffset || 0.82);\r\n\t\t\t\tvar position = option.position || CENTER;\r\n\t\t\t\tswitch (position) {\r\n\t\t\t\t\tcase CENTER:\r\n\t\t\t\t\tcase UP:\r\n\t\t\t\t\tcase DN:\r\n\t\t\t\t\t\tg.textAlign = \"center\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase BOTTOMLEFT:\r\n\t\t\t\t\tcase TOPLEFT:\r\n\t\t\t\t\tcase LT:\r\n\t\t\t\t\t\tg.textAlign = \"left\";\r\n\t\t\t\t\t\tpx -= hoffset;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase BOTTOMRIGHT:\r\n\t\t\t\t\tcase TOPRIGHT:\r\n\t\t\t\t\tcase RT:\r\n\t\t\t\t\t\tg.textAlign = \"right\";\r\n\t\t\t\t\t\tpx += hoffset;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tswitch (position) {\r\n\t\t\t\t\tcase CENTER:\r\n\t\t\t\t\tcase LT:\r\n\t\t\t\t\tcase RT:\r\n\t\t\t\t\t\tg.textBaseline = \"middle\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase TOPRIGHT:\r\n\t\t\t\t\tcase TOPLEFT:\r\n\t\t\t\t\tcase UP:\r\n\t\t\t\t\t\tg.textBaseline = \"candle-top\";\r\n\t\t\t\t\t\tpy -= voffset;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase BOTTOMRIGHT:\r\n\t\t\t\t\tcase BOTTOMLEFT:\r\n\t\t\t\t\tcase DN:\r\n\t\t\t\t\t\tg.textBaseline = \"alphabetic\";\r\n\t\t\t\t\t\tpy += voffset;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tg.fillText(text, px, py, maxLength);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------\r\n\t\t// ImageTile: Container for a tileset of images.\r\n\t\t//---------------------------------------------------------\r\n\t\tImageTile: {\r\n\t\t\tcols: 1,\r\n\t\t\trows: 1,\r\n\t\t\twidth: 0,\r\n\t\t\theight: 0,\r\n\r\n\t\t\tinitialize: function() {\r\n\t\t\t\tvar puzzle = this.puzzle;\r\n\t\t\t\tif (typeof Image !== \"undefined\") {\r\n\t\t\t\t\tthis.image_canvas = this.image_svg = new Image();\r\n\t\t\t\t\tthis.image_canvas.onload = function() {\r\n\t\t\t\t\t\tpuzzle.painter.paintAll();\r\n\t\t\t\t\t};\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.image_canvas = !!puzzle.pzpr.Candle.Canvas\r\n\t\t\t\t\t\t? new puzzle.pzpr.Candle.Canvas.Image()\r\n\t\t\t\t\t\t: {};\r\n\t\t\t\t\tthis.image_svg = {};\r\n\t\t\t\t}\r\n\t\t\t\tthis.image_canvas.src = this.image_svg.src = this.imgsrc_dataurl;\r\n\t\t\t\tthis.image_canvas.height = this.image_svg.height = this.height;\r\n\t\t\t\tthis.image_canvas.width = this.image_svg.width = this.width;\r\n\r\n\t\t\t\tthis.cwidth = this.image_canvas.width / this.cols;\r\n\t\t\t\tthis.cheight = this.image_canvas.height / this.rows;\r\n\t\t\t\tthis.loaded = true;\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------\r\n\t\t\t// imgTile.putImage: Draw one image from the tileset.\r\n\t\t\t//---------------------------------------------------------\r\n\t\t\tputImage: function(ctx, key, n, dx, dy, dw, dh) {\r\n\t\t\t\tvar img = ctx.use.canvas ? this.image_canvas : this.image_svg;\r\n\t\t\t\tvar sw = this.cwidth,\r\n\t\t\t\t\tsh = this.cheight;\r\n\t\t\t\tvar sx = sw * (n % this.cols),\r\n\t\t\t\t\tsy = sh * ((n / this.cols) | 0);\r\n\t\t\t\tif (dw === void 0) {\r\n\t\t\t\t\tdw = sw;\r\n\t\t\t\t\tdh = sh;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tctx.vid = key;\r\n\t\t\t\tctx.drawImage(n !== null ? img : null, sx, sy, sw, sh, dx, dy, dw, dh);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n})();\r\n","// MouseInput.js v3.5.2\r\n\r\n//---------------------------------------------------------------------------\r\n// ★MouseEventクラス マウス入力に関する情報の保持とイベント処理を扱う\r\n//---------------------------------------------------------------------------\r\n// パズル共通 マウス入力部\r\n// MouseEventクラスを定義\r\npzpr.classmgr.makeCommon({\r\n\t//---------------------------------------------------------\r\n\tMouseEvent: {\r\n\t\tinitialize: function() {\r\n\t\t\tthis.cursor = this.puzzle.cursor;\r\n\r\n\t\t\tthis.enableMouse = true; // マウス入力は有効か\r\n\r\n\t\t\tthis.mouseCell = null; // 入力されたセル等のID\r\n\t\t\tthis.firstCell = null; // mousedownされた時のセルのID(連黒分断禁用)\r\n\r\n\t\t\tthis.inputPoint = new this.klass.RawAddress(); // 入力イベントが発生したborder座標 ※端数あり\r\n\t\t\tthis.firstPoint = new this.klass.RawAddress(); // mousedownされた時のborder座標 ※端数あり\r\n\t\t\tthis.prevPos = new this.klass.Address(); // 前回のマウス入力イベントのborder座標\r\n\r\n\t\t\tthis.btn = \"\"; // 押されているボタン\r\n\t\t\tthis.inputData = null; // 入力中のデータ番号(実装依存)\r\n\t\t\tthis.firstState = null;\r\n\r\n\t\t\tthis.bordermode = false; // 境界線を入力中かどうか\r\n\r\n\t\t\tthis.mousestart = false; // mousedown/touchstartイベントかどうか\r\n\t\t\tthis.mousemove = false; // mousemove/touchmoveイベントかどうか\r\n\t\t\tthis.mouseend = false; // mouseup/touchendイベントかどうか\r\n\r\n\t\t\tthis.inputMode = \"auto\";\r\n\t\t\tthis.savedInputMode = { edit: \"auto\", play: \"auto\" };\r\n\r\n\t\t\tthis.mousereset();\r\n\t\t},\r\n\r\n\t\tRBShadeCell: false, // 連黒分断禁のパズル\r\n\r\n\t\tuse: false, // 黒マスの入力方法選択\r\n\t\tbgcolor: false, // 背景色の入力を可能にする\r\n\r\n\t\tinputMode: \"auto\", // 現在のinputMode\r\n\t\tsavedInputMode: {}, // モード変更時の保存値\r\n\t\tinputModes: { edit: [], play: [] }, // 現在のパズル種類にてauto以外で有効なinputModeの配列\r\n\r\n\t\tinversion: false, // マウスのボタンを左右反転する\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.mousereset() マウス入力に関する情報を初期化する\r\n\t\t// mv.modechange() モード変更時に設定を初期化する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tmousereset: function() {\r\n\t\t\tvar cell0 = this.mouseCell;\r\n\r\n\t\t\tthis.mouseCell = this.firstCell = this.board.emptycell; // 下の行へ続く\r\n\r\n\t\t\tthis.firstPoint.reset();\r\n\t\t\tthis.prevPos.reset();\r\n\r\n\t\t\tthis.btn = \"\";\r\n\t\t\tthis.inputData = null;\r\n\r\n\t\t\tthis.bordermode = false;\r\n\r\n\t\t\tthis.mousestart = false;\r\n\t\t\tthis.mousemove = false;\r\n\t\t\tthis.mouseend = false;\r\n\r\n\t\t\tif (this.puzzle.execConfig(\"dispmove\") && !!cell0 && !cell0.isnull) {\r\n\t\t\t\tcell0.draw();\r\n\t\t\t}\r\n\t\t},\r\n\t\tmodechange: function() {\r\n\t\t\tthis.mousereset();\r\n\t\t\tthis.inputMode = this.savedInputMode[\r\n\t\t\t\tthis.puzzle.editmode ? \"edit\" : \"play\"\r\n\t\t\t];\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.e_mousedown() Canvas上でマウスのボタンを押した際のイベント共通処理\r\n\t\t// mv.e_mouseup()   Canvas上でマウスのボタンを放した際のイベント共通処理\r\n\t\t// mv.e_mousemove() Canvas上でマウスを動かした際のイベント共通処理\r\n\t\t// mv.e_mousecancel() Canvas上でマウス操作がキャンセルされた場合のイベント共通処理\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t//イベントハンドラから呼び出される\r\n\t\t// この3つのマウスイベントはCanvasから呼び出される(mvをbindしている)\r\n\t\te_mousedown: function(e) {\r\n\t\t\tif (!this.enableMouse) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tthis.setMouseButton(e); /* どのボタンが押されたか取得 (mousedown時のみ) */\r\n\t\t\tif (!this.btn) {\r\n\t\t\t\tthis.mousereset();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar addrtarget = this.getBoardAddress(e);\r\n\t\t\tthis.moveTo(addrtarget.bx, addrtarget.by);\r\n\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t},\r\n\t\te_mouseup: function(e) {\r\n\t\t\tif (!this.enableMouse || !this.btn) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tthis.inputEnd();\r\n\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t},\r\n\t\te_mousemove: function(e) {\r\n\t\t\tif (!this.enableMouse || !this.btn) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\te.touches !== void 0 ||\r\n\t\t\t\te.which === void 0 ||\r\n\t\t\t\te.which !== 0 ||\r\n\t\t\t\t(e.type.match(/pointermove/i) && e.buttons > 0)\r\n\t\t\t) {\r\n\t\t\t\tvar addrtarget = this.getBoardAddress(e);\r\n\t\t\t\tthis.lineTo(addrtarget.bx, addrtarget.by);\r\n\t\t\t} else {\r\n\t\t\t\tthis.mousereset();\r\n\t\t\t}\r\n\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t},\r\n\t\te_mousecancel: function(e) {\r\n\t\t\tthis.mousereset();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.setMouseButton()  イベントが起こったボタンを設定する\r\n\t\t// mv.getBoardAddress() イベントが起こったcanvas内の座標を取得する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetMouseButton: function(e) {\r\n\t\t\tthis.btn = pzpr.util.getMouseButton(e);\r\n\r\n\t\t\t// SHIFTキー/Commandキーを押している時は左右ボタン反転\r\n\t\t\tvar kc = this.puzzle.key;\r\n\t\t\tkc.checkmodifiers(e);\r\n\t\t\tif (\r\n\t\t\t\t(kc.isSHIFT || kc.isMETA) !== this.inversion ||\r\n\t\t\t\tthis.inputMode === \"number-\"\r\n\t\t\t) {\r\n\t\t\t\tif (this.btn === \"left\") {\r\n\t\t\t\t\tthis.btn = \"right\";\r\n\t\t\t\t} else if (this.btn === \"right\") {\r\n\t\t\t\t\tthis.btn = \"left\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetBoardAddress: function(e) {\r\n\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\tpc = puzzle.painter;\r\n\t\t\tvar pix = { px: NaN, py: NaN };\r\n\t\t\tvar g = pc.context;\r\n\t\t\tif (!g) {\r\n\t\t\t\treturn pix;\r\n\t\t\t}\r\n\t\t\tif (\r\n\t\t\t\t!pzpr.env.API.touchevent ||\r\n\t\t\t\tpzpr.env.API.pointerevent ||\r\n\t\t\t\tpzpr.env.OS.iOS\r\n\t\t\t) {\r\n\t\t\t\tif (!isNaN(e.offsetX)) {\r\n\t\t\t\t\tpix = { px: e.offsetX, py: e.offsetY };\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpix = { px: e.layerX, py: e.layerY };\r\n\t\t\t\t} // Firefox 39以前, iOSはこちら\r\n\t\t\t} else {\r\n\t\t\t\tvar pagePos = pzpr.util.getPagePos(e),\r\n\t\t\t\t\trect = pzpr.util.getRect(pc.context.child);\r\n\t\t\t\tpix = { px: pagePos.px - rect.left, py: pagePos.py - rect.top };\r\n\t\t\t}\r\n\t\t\treturn { bx: (pix.px - pc.x0) / pc.bw, by: (pix.py - pc.y0) / pc.bh };\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.moveTo()   Canvas上にマウスの位置を設定する\r\n\t\t// mv.lineTo()   Canvas上でマウスを動かす\r\n\t\t// mv.inputEnd() Canvas上のマウス入力処理を終了する\r\n\t\t// mv.inputPath() Canvas上でひとつながりになる線を入力する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tmoveTo: function(bx, by) {\r\n\t\t\tthis.inputPoint.init(bx, by);\r\n\t\t\tthis.mouseevent(0);\r\n\t\t},\r\n\t\tlineTo: function(bx, by) {\r\n\t\t\t/* 前回の位置からの差分を順番に入力していきます */\r\n\t\t\tvar dx = bx - this.inputPoint.bx,\r\n\t\t\t\tdy = by - this.inputPoint.by;\r\n\t\t\tvar distance =\r\n\t\t\t\t(((dx >= 0 ? dx : -dx) + (dy >= 0 ? dy : -dy)) * 2 + 0.9) |\r\n\t\t\t\t0; /* 0.5くらいずつ動かす */\r\n\t\t\tvar mx = dx / distance,\r\n\t\t\t\tmy = dy / distance;\r\n\t\t\tfor (var i = 0; i < distance - 1; i++) {\r\n\t\t\t\tthis.inputPoint.move(mx, my);\r\n\t\t\t\tthis.mouseevent(1);\r\n\t\t\t}\r\n\t\t\tthis.inputPoint.init(bx, by);\r\n\t\t\tthis.mouseevent(1);\r\n\t\t},\r\n\t\tinputEnd: function() {\r\n\t\t\tthis.mouseevent(2);\r\n\t\t\tthis.mousereset();\r\n\t\t},\r\n\t\tinputPath: function() {\r\n\t\t\tvar args = Array.prototype.slice.call(arguments);\r\n\t\t\tthis.mousereset();\r\n\t\t\tthis.btn = typeof args[0] === \"string\" ? args.shift() : \"left\";\r\n\t\t\tthis.moveTo(args[0], args[1]);\r\n\t\t\tfor (var i = 2; i < args.length - 1; i += 2) {\r\n\t\t\t\t/* 奇数個の最後の一つは切り捨て */\r\n\t\t\t\tthis.lineTo(args[i], args[i + 1]);\r\n\t\t\t}\r\n\t\t\tthis.inputEnd();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.mouseevent() マウスイベント処理\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tmouseevent: function(step) {\r\n\t\t\tthis.cancelEvent = false;\r\n\t\t\tthis.mousestart = step === 0;\r\n\t\t\tthis.mousemove = step === 1;\r\n\t\t\tthis.mouseend = step === 2;\r\n\t\t\tvar puzzle = this.puzzle;\r\n\r\n\t\t\tpuzzle.emit(\"mouse\");\r\n\t\t\tif (!this.cancelEvent && (this.btn === \"left\" || this.btn === \"right\")) {\r\n\t\t\t\tif (this.mousestart) {\r\n\t\t\t\t\tpuzzle.opemgr.newOperation();\r\n\t\t\t\t\tpuzzle.errclear();\r\n\t\t\t\t\tpuzzle.opemgr.updateStarts();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpuzzle.opemgr.newChain();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.mouseinput();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.mouseinput()       マウスイベント共通処理。\r\n\t\t// mv.mouseinput_number()数字入力処理\r\n\t\t// mv.mouseinput_clear() セル内容の消去処理\r\n\t\t// mv.mouseinput_auto()  マウスイベント処理。各パズルのファイルでオーバーライドされる。\r\n\t\t// mv.mouseinput_other() inputMode指定時のマウスイベント処理。各パズルのファイルでオーバーライドされる。\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tmouseinput: function() {\r\n\t\t\tvar mode = this.inputMode;\r\n\t\t\tif (this.puzzle.key.isZ && this.inputMode.indexOf(/info\\-/) === -1) {\r\n\t\t\t\tif (this.inputModes.play.indexOf(\"info-line\") >= 0) {\r\n\t\t\t\t\tmode = \"info-line\";\r\n\t\t\t\t} else if (this.inputModes.play.indexOf(\"info-blk\") >= 0) {\r\n\t\t\t\t\tmode = \"info-blk\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tswitch (mode) {\r\n\t\t\t\tcase \"auto\":\r\n\t\t\t\t\tthis.mouseinput_auto();\r\n\t\t\t\t\tbreak; /* 各パズルのルーチンへ */\r\n\t\t\t\tcase \"number\":\r\n\t\t\t\tcase \"number-\":\r\n\t\t\t\t\tthis.mouseinput_number();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"clear\":\r\n\t\t\t\t\tthis.mouseinput_clear();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"cell51\":\r\n\t\t\t\t\tthis.input51_fixed();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"circle-unshade\":\r\n\t\t\t\t\tthis.inputFixedNumber(1);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"circle-shade\":\r\n\t\t\t\t\tthis.inputFixedNumber(2);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"undef\":\r\n\t\t\t\t\tthis.inputFixedNumber(-2);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"ice\":\r\n\t\t\t\t\tthis.inputIcebarn();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"numexist\":\r\n\t\t\t\t\tthis.inputFixedNumber(-2);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"numblank\":\r\n\t\t\t\t\tthis.inputFixedNumber(-3);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"bgcolor\":\r\n\t\t\t\t\tthis.inputBGcolor(true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"subcircle\":\r\n\t\t\t\tcase \"bgcolor1\":\r\n\t\t\t\t\tthis.inputFixedQsub(1);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"subcross\":\r\n\t\t\t\tcase \"bgcolor2\":\r\n\t\t\t\t\tthis.inputFixedQsub(2);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"completion\":\r\n\t\t\t\t\tif (this.mousestart) {\r\n\t\t\t\t\t\tthis.inputqcmp();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"objblank\":\r\n\t\t\t\t\tthis.inputDot();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"direc\":\r\n\t\t\t\t\tthis.inputdirec();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"arrow\":\r\n\t\t\t\t\tthis.inputarrow_cell();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"crossdot\":\r\n\t\t\t\t\tif (this.mousestart) {\r\n\t\t\t\t\t\tthis.inputcrossMark();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"border\":\r\n\t\t\t\t\tthis.inputborder();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"subline\":\r\n\t\t\t\t\tthis.inputQsubLine();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"shade\":\r\n\t\t\t\tcase \"unshade\":\r\n\t\t\t\t\tthis.inputShade();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"line\":\r\n\t\t\t\t\tthis.inputLine();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"peke\":\r\n\t\t\t\t\tthis.inputpeke();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"bar\":\r\n\t\t\t\t\tthis.inputTateyoko();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"info-line\":\r\n\t\t\t\t\tif (this.mousestart) {\r\n\t\t\t\t\t\tthis.dispInfoLine();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"info-blk\":\r\n\t\t\t\t\tif (this.mousestart) {\r\n\t\t\t\t\t\tthis.dispInfoBlk();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthis.mouseinput_other();\r\n\t\t\t\t\tbreak; /* 各パズルのルーチンへ */\r\n\t\t\t}\r\n\t\t},\r\n\t\tmouseinput_number: function() {\r\n\t\t\tif (this.mousestart) {\r\n\t\t\t\tthis.inputqnum();\r\n\t\t\t}\r\n\t\t},\r\n\t\tmouseinput_clear: function() {\r\n\t\t\tthis.inputclean_cell();\r\n\t\t},\r\n\t\t//オーバーライド用\r\n\t\tmouseinput_auto: function() {},\r\n\t\tmouseinput_other: function() {},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.notInputted()   盤面への入力が行われたかどうか判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tnotInputted: function() {\r\n\t\t\treturn !this.puzzle.opemgr.changeflag;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.setInputMode()     入力されるinputModeを固定する (falsyな値でresetする)\r\n\t\t// mv.getInputModeList() 有効なinputModeを配列にして返す (通常はauto)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetInputMode: function(mode) {\r\n\t\t\tmode = mode || \"auto\";\r\n\t\t\tif (\r\n\t\t\t\tthis.getInputModeList().indexOf(mode === \"number-\" ? \"number\" : mode) >=\r\n\t\t\t\t0\r\n\t\t\t) {\r\n\t\t\t\tthis.inputMode = mode;\r\n\t\t\t\tthis.savedInputMode[this.puzzle.editmode ? \"edit\" : \"play\"] = mode;\r\n\t\t\t} else {\r\n\t\t\t\tthrow \"Invalid input mode :\" + mode;\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetInputModeList: function(type) {\r\n\t\t\tif (this.puzzle.instancetype === \"viewer\") {\r\n\t\t\t\treturn [];\r\n\t\t\t}\r\n\t\t\ttype = !!type ? type : this.puzzle.editmode ? \"edit\" : \"play\";\r\n\t\t\tvar list = [\"auto\"];\r\n\t\t\tlist = list.concat(this.inputModes[type]);\r\n\t\t\tif (list.indexOf(\"number\") >= 0) {\r\n\t\t\t\tlist.splice(list.indexOf(\"number\") + 1, 0, \"number-\");\r\n\t\t\t}\r\n\t\t\treturn list;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.setInversion()     マウスの左右反転設定を行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetInversion: function(input) {\r\n\t\t\tthis.inversion = !!input;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.getcell()    入力された位置がどのセルに該当するかを返す\r\n\t\t// mv.getcell_excell()  入力された位置がどのセル/EXCELLに該当するかを返す\r\n\t\t// mv.getcross()   入力された位置がどの交差点に該当するかを返す\r\n\t\t// mv.getborder()  入力された位置がどの境界線・Lineに該当するかを返す(クリック用)\r\n\t\t// mv.getpos()    入力された位置が仮想セル上でどこの(X*2,Y*2)に該当するかを返す。\r\n\t\t//                外枠の左上が(0,0)で右下は(bd.cols*2,bd.rows*2)。rcは0～0.5のパラメータ。\r\n\t\t// mv.isBorderMode() 境界線入力モードかどうか判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetcell: function() {\r\n\t\t\treturn this.getpos(0).getc();\r\n\t\t},\r\n\t\tgetcell_excell: function() {\r\n\t\t\tvar pos = this.getpos(0),\r\n\t\t\t\texcell = pos.getex();\r\n\t\t\treturn !excell.isnull ? excell : pos.getc();\r\n\t\t},\r\n\t\tgetcross: function() {\r\n\t\t\treturn this.getpos(0.5).getx();\r\n\t\t},\r\n\r\n\t\tgetpos: function(spc) {\r\n\t\t\tvar addr = this.inputPoint,\r\n\t\t\t\tm1 = 2 * spc,\r\n\t\t\t\tm2 = 2 * (1 - spc),\r\n\t\t\t\tminaxis = Math.min(this.board.minbx, this.board.minby);\r\n\r\n\t\t\t// Add a constant to ensure all intermediate values aren't negative\r\n\t\t\tvar extra = 4 + (minaxis >= 0 ? 0 : -minaxis & ~1);\r\n\r\n\t\t\tvar bx = addr.bx + extra,\r\n\t\t\t\tby = addr.by + extra,\r\n\t\t\t\tdx = bx % 2,\r\n\t\t\t\tdy = by % 2;\r\n\t\t\tbx = (bx & ~1) + +(dx >= m1) + +(dx >= m2) - extra;\r\n\t\t\tby = (by & ~1) + +(dy >= m1) + +(dy >= m2) - extra;\r\n\t\t\treturn new this.klass.Address(bx, by);\r\n\t\t},\r\n\r\n\t\tgetborder: function(spc) {\r\n\t\t\tvar addr = this.inputPoint;\r\n\t\t\tvar bx = (addr.bx & ~1) + 1,\r\n\t\t\t\tby = (addr.by & ~1) + 1;\r\n\t\t\tvar dx = addr.bx + 1 - bx,\r\n\t\t\t\tdy = addr.by + 1 - by;\r\n\r\n\t\t\t// 真ん中のあたりはどこにも該当しないようにする\r\n\t\t\tvar bd = this.board;\r\n\t\t\tif (bd.linegraph.isLineCross) {\r\n\t\t\t\tif (!bd.borderAsLine) {\r\n\t\t\t\t\tvar m1 = 2 * spc,\r\n\t\t\t\t\t\tm2 = 2 * (1 - spc);\r\n\t\t\t\t\tif ((dx < m1 || m2 < dx) && (dy < m1 || m2 < dy)) {\r\n\t\t\t\t\t\treturn bd.emptyborder;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar m1 = 2 * (0.5 - spc),\r\n\t\t\t\t\t\tm2 = 2 * (0.5 + spc);\r\n\t\t\t\t\tif (m1 < dx && dx < m2 && m1 < dy && dy < m2) {\r\n\t\t\t\t\t\treturn bd.emptyborder;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (dx < 2 - dy) {\r\n\t\t\t\t//左上\r\n\t\t\t\tif (dx > dy) {\r\n\t\t\t\t\treturn bd.getb(bx, by - 1);\r\n\t\t\t\t} //左上＆右上 -> 上\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn bd.getb(bx - 1, by);\r\n\t\t\t\t} //左上＆左下 -> 左\r\n\t\t\t} else {\r\n\t\t\t\t//右下\r\n\t\t\t\tif (dx > dy) {\r\n\t\t\t\t\treturn bd.getb(bx + 1, by);\r\n\t\t\t\t} //右下＆右上 -> 右\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn bd.getb(bx, by + 1);\r\n\t\t\t\t} //右下＆左下 -> 下\r\n\t\t\t}\r\n\t\t\t// unreachable\r\n\t\t},\r\n\r\n\t\tisBorderMode: function() {\r\n\t\t\tif (this.mousestart) {\r\n\t\t\t\tthis.bordermode = !this.getpos(0.25).oncell();\r\n\t\t\t}\r\n\t\t\treturn this.bordermode;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.setcursor() TargetCursorの場所を移動する\r\n\t\t// mv.setcursorsnum() TargetCursorの補助記号に対する場所を移動する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetcursor: function(pos) {\r\n\t\t\tvar pos0 = this.cursor.getaddr();\r\n\t\t\tthis.cursor.setaddr(pos);\r\n\t\t\tpos0.draw();\r\n\t\t\tpos.draw();\r\n\t\t},\r\n\t\tsetcursorsnum: function(pos) {\r\n\t\t\tvar pos0 = this.cursor.getaddr();\r\n\t\t\tthis.cursor.setaddr(pos);\r\n\t\t\tvar bx = this.inputPoint.bx,\r\n\t\t\t\tby = this.inputPoint.by;\r\n\t\t\tbx = (((bx + 12) % 2) * 1.5) | 0;\r\n\t\t\tby = (((by + 12) % 2) * 1.5) | 0;\r\n\t\t\tvar target;\r\n\t\t\tif (this.pid !== \"factors\") {\r\n\t\t\t\ttarget = [5, 0, 4, 0, 0, 0, 2, 0, 3][by * 3 + bx];\r\n\t\t\t} else {\r\n\t\t\t\ttarget = [0, 0, 4, 0, 0, 0, 2, 0, 3][by * 3 + bx];\r\n\t\t\t}\r\n\t\t\tif (this.cursor.targetdir !== target) {\r\n\t\t\t\tthis.cursor.targetdir = target;\r\n\t\t\t}\r\n\t\t\tpos0.draw();\r\n\t\t\tpos.draw();\r\n\t\t}\r\n\t}\r\n});\r\n","// KeyInput.js v3.4.1\r\n\r\n//---------------------------------------------------------------------------\r\n// ★KeyEventクラス キーボード入力に関する情報の保持とイベント処理を扱う\r\n//---------------------------------------------------------------------------\r\n// パズル共通 キーボード入力部\r\n// KeyEventクラスを定義\r\npzpr.classmgr.makeCommon({\r\n\t//---------------------------------------------------------\r\n\tKeyEvent: {\r\n\t\tinitialize: function() {\r\n\t\t\tthis.cursor = this.puzzle.cursor;\r\n\r\n\t\t\tthis.enableKey = true; // キー入力は有効か\r\n\r\n\t\t\tthis.keyreset();\r\n\t\t},\r\n\r\n\t\tenablemake: false,\r\n\t\tenableplay: false,\r\n\t\tkeyup_event: false /* keyupイベントでもパズル個別のキーイベント関数を呼び出す */,\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// kc.keyreset()     キーボード入力に関する情報を初期化する\r\n\t\t// kc.isenablemode() 現在のモードでキー入力が有効か判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tkeyreset: function() {\r\n\t\t\tthis.isCTRL = false;\r\n\t\t\tthis.isMETA = false; // MacのCommandキーなど\r\n\t\t\tthis.isALT = false; // ALTはメニュー用なので基本的に使わない\r\n\t\t\tthis.isSHIFT = false;\r\n\t\t\tthis.isZ = false;\r\n\t\t\tthis.isX = false;\r\n\t\t\tthis.isY = false;\r\n\r\n\t\t\tthis.keydown = false;\r\n\t\t\tthis.keyup = false;\r\n\r\n\t\t\tthis.ca = \"\";\r\n\r\n\t\t\tthis.prev = null;\r\n\t\t},\r\n\t\tisenablemode: function() {\r\n\t\t\treturn (\r\n\t\t\t\t(this.puzzle.editmode && this.enablemake) ||\r\n\t\t\t\t(this.puzzle.playmode && this.enableplay)\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// kc.e_keydown()  キーを押した際のイベント共通処理\r\n\t\t// kc.e_keyup()    キーを離した際のイベント共通処理\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// この3つのキーイベントはwindowから呼び出される(kcをbindしている)\r\n\t\te_keydown: function(e) {\r\n\t\t\tvar c = this.getchar(e);\r\n\t\t\tif (!this.enableKey) {\r\n\t\t\t\tif (c === \"BS\" || c === \" \") {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.checkbutton(c, 0);\r\n\t\t\tif (c) {\r\n\t\t\t\tthis.keyevent(c, 0);\r\n\t\t\t}\r\n\r\n\t\t\tif (e.target === this.puzzle.canvas || this.cancelDefault) {\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t\te.preventDefault();\r\n\t\t\t}\r\n\t\t},\r\n\t\te_keyup: function(e) {\r\n\t\t\tvar c = this.getchar(e);\r\n\t\t\tif (!this.enableKey) {\r\n\t\t\t\tif (c === \"BS\" || c === \" \") {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.checkbutton(c, 1);\r\n\t\t\tif (c) {\r\n\t\t\t\tthis.keyevent(c, 1);\r\n\t\t\t}\r\n\r\n\t\t\tif (e.target === this.puzzle.canvas || this.cancelDefault) {\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t\te.preventDefault();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// kc.checkmodifiers()  Shift, Ctrl, Alt, Metaキーをチェックする\r\n\t\t// kc.checkbutton()     Z, X, Yキーの押下状況をチェックする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckmodifiers: function(e) {\r\n\t\t\tthis.isSHIFT = e.shiftKey;\r\n\t\t\tthis.isCTRL = e.ctrlKey;\r\n\t\t\tthis.isMETA = e.metaKey;\r\n\t\t\tthis.isALT = e.altKey;\r\n\t\t},\r\n\t\tcheckbutton: function(charall, step) {\r\n\t\t\tvar c = charall.split(/\\+/).pop();\r\n\t\t\tif (c === \"z\") {\r\n\t\t\t\tthis.isZ = step === 0;\r\n\t\t\t}\r\n\t\t\tif (c === \"x\") {\r\n\t\t\t\tthis.isX = step === 0;\r\n\t\t\t}\r\n\t\t\tif (c === \"y\") {\r\n\t\t\t\tthis.isY = step === 0;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// kc.getchar()  入力されたキーを表す文字列を返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// 48～57は0～9キー、65～90はa～z、96～105はテンキー、112～123はF1～F12キー\r\n\t\tgetchar: function(e) {\r\n\t\t\tthis.checkmodifiers(e);\r\n\r\n\t\t\tvar key = \"\",\r\n\t\t\t\tkeycode = !!e.keyCode ? e.keyCode : e.charCode;\r\n\r\n\t\t\tif (keycode === 38) {\r\n\t\t\t\tkey = \"up\";\r\n\t\t\t} else if (keycode === 40) {\r\n\t\t\t\tkey = \"down\";\r\n\t\t\t} else if (keycode === 37) {\r\n\t\t\t\tkey = \"left\";\r\n\t\t\t} else if (keycode === 39) {\r\n\t\t\t\tkey = \"right\";\r\n\t\t\t} else if (48 <= keycode && keycode <= 57) {\r\n\t\t\t\tkey = (keycode - 48).toString(36);\r\n\t\t\t} else if (65 <= keycode && keycode <= 90) {\r\n\t\t\t\tkey = (keycode - 55).toString(36);\r\n\t\t\t} //アルファベット\r\n\t\t\telse if (96 <= keycode && keycode <= 105) {\r\n\t\t\t\tkey = (keycode - 96).toString(36);\r\n\t\t\t} //テンキー対応\r\n\t\t\telse if (112 <= keycode && keycode <= 123) {\r\n\t\t\t\tkey = \"F\" + (keycode - 111).toString(10);\r\n\t\t\t} /* 112～123はF1～F12キー */ else if (keycode === 32 || keycode === 46) {\r\n\t\t\t\tkey = \" \";\r\n\t\t\t} // 32はスペースキー 46はdelキー\r\n\t\t\telse if (keycode === 8) {\r\n\t\t\t\tkey = \"BS\";\r\n\t\t\t} else if (keycode === 109 || keycode === 189 || keycode === 173) {\r\n\t\t\t\tkey = \"-\";\r\n\t\t\t}\r\n\r\n\t\t\tvar keylist = !!key ? [key] : [];\r\n\t\t\tif (this.isMETA) {\r\n\t\t\t\tkeylist.unshift(\"meta\");\r\n\t\t\t}\r\n\t\t\tif (this.isALT) {\r\n\t\t\t\tkeylist.unshift(\"alt\");\r\n\t\t\t}\r\n\t\t\tif (this.isCTRL) {\r\n\t\t\t\tkeylist.unshift(\"ctrl\");\r\n\t\t\t}\r\n\t\t\tif (this.isSHIFT) {\r\n\t\t\t\tkeylist.unshift(\"shift\");\r\n\t\t\t}\r\n\t\t\tkey = keylist.join(\"+\");\r\n\r\n\t\t\tif (key === \"alt+h\") {\r\n\t\t\t\tkey = \"left\";\r\n\t\t\t} else if (key === \"alt+k\") {\r\n\t\t\t\tkey = \"up\";\r\n\t\t\t} else if (key === \"alt+j\") {\r\n\t\t\t\tkey = \"down\";\r\n\t\t\t} else if (key === \"alt+l\") {\r\n\t\t\t\tkey = \"right\";\r\n\t\t\t}\r\n\r\n\t\t\treturn key;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// kc.inputKeys()   キーボードイベントを実行する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputKeys: function(array) {\r\n\t\t\tfor (var i = 0; i < arguments.length; i++) {\r\n\t\t\t\tthis.keyevent(arguments[i], 0);\r\n\t\t\t\tthis.keyevent(arguments[i], 1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// kc.keyevent()  キーイベント処理\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tkeyevent: function(c, step) {\r\n\t\t\tvar puzzle = this.puzzle;\r\n\t\t\tthis.cancelEvent = false;\r\n\t\t\tthis.cancelDefault = false;\r\n\t\t\tthis.keydown = step === 0;\r\n\t\t\tthis.keyup = step === 1;\r\n\r\n\t\t\t// always prevent backspace navigation, space scrolling\r\n\t\t\tif (c === \"BS\" || c === \" \") {\r\n\t\t\t\tthis.cancelDefault = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.keydown) {\r\n\t\t\t\tpuzzle.opemgr.newOperation();\r\n\t\t\t} else {\r\n\t\t\t\tpuzzle.opemgr.newChain();\r\n\t\t\t}\r\n\r\n\t\t\tif (this.keydown && !this.isZ) {\r\n\t\t\t\tpuzzle.errclear();\r\n\t\t\t\tpuzzle.opemgr.updateStarts();\r\n\t\t\t}\r\n\r\n\t\t\tpuzzle.emit(\"key\", c);\r\n\t\t\tif (this.cancelEvent) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!this.keyexec(c)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!this.keyDispInfo(c)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!this.isenablemode()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.keydown && this.moveTarget(c)) {\r\n\t\t\t\tthis.cancelDefault = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.keydown || (this.keyup && this.keyup_event)) {\r\n\t\t\t\tthis.keyinput(c);\r\n\t\t\t} /* 各パズルのルーチンへ */\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// kc.keyexec() モードに共通で行う処理を実行します\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tkeyexec: function(c) {\r\n\t\t\tvar puzzle = this.puzzle;\r\n\t\t\tif (this.keydown && c === \"alt+c\" && !puzzle.playeronly) {\r\n\t\t\t\tpuzzle.setMode(\r\n\t\t\t\t\tpuzzle.playmode ? puzzle.MODE_EDITOR : puzzle.MODE_PLAYER\r\n\t\t\t\t);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// kc.keyDispInfo() 一時的に情報を表示する処理を追加します\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tkeyDispInfo: function(c) {\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// kc.keyinput() キーを押した/離した際の各パズルごとのイベント処理。\r\n\t\t//               各パズルのファイルでオーバーライドされる。\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// オーバーライド用\r\n\t\tkeyinput: function(c) {\r\n\t\t\tthis.key_inputqnum(c); /* デフォルトはCell数字入力 */\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// kc.moveTarget()  キーボードからの入力対象を矢印キーで動かす\r\n\t\t// kc.moveTCell()   Cellのキーボードからの入力対象を矢印キーで動かす\r\n\t\t// kc.moveTCross()  Crossのキーボードからの入力対象を矢印キーで動かす\r\n\t\t// kc.moveTBorder() Borderのキーボードからの入力対象を矢印キーで動かす\r\n\t\t// kc.moveTC()      上記3つの関数の共通処理\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tmoveTarget: function(ca) {\r\n\t\t\treturn this.moveTCell(ca);\r\n\t\t},\r\n\t\tmoveTCell: function(ca) {\r\n\t\t\treturn this.moveTC(ca, 2);\r\n\t\t},\r\n\t\tmoveTCross: function(ca) {\r\n\t\t\treturn this.moveTC(ca, 2);\r\n\t\t},\r\n\t\tmoveTBorder: function(ca) {\r\n\t\t\treturn this.moveTC(ca, 1);\r\n\t\t},\r\n\t\tmoveTC: function(ca, mv) {\r\n\t\t\tvar cursor = this.cursor,\r\n\t\t\t\tpos0 = cursor.getaddr(),\r\n\t\t\t\tflag = true,\r\n\t\t\t\tdir = cursor.NDIR;\r\n\t\t\tswitch (ca) {\r\n\t\t\t\tcase \"up\":\r\n\t\t\t\t\tif (cursor.by - mv >= cursor.miny) {\r\n\t\t\t\t\t\tdir = cursor.UP;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"down\":\r\n\t\t\t\t\tif (cursor.by + mv <= cursor.maxy) {\r\n\t\t\t\t\t\tdir = cursor.DN;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"left\":\r\n\t\t\t\t\tif (cursor.bx - mv >= cursor.minx) {\r\n\t\t\t\t\t\tdir = cursor.LT;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"right\":\r\n\t\t\t\t\tif (cursor.bx + mv <= cursor.maxx) {\r\n\t\t\t\t\t\tdir = cursor.RT;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tflag = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif (flag) {\r\n\t\t\t\tcursor.movedir(dir, mv);\r\n\r\n\t\t\t\tpos0.draw();\r\n\t\t\t\tcursor.draw();\r\n\t\t\t}\r\n\t\t\treturn flag;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// kc.moveExCell()  ExCellのキーボードからの入力対象を矢印キーで動かす\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tmoveExCell: function(ca) {\r\n\t\t\tvar cursor = this.cursor,\r\n\t\t\t\taddr0 = cursor.getaddr(),\r\n\t\t\t\tflag = true,\r\n\t\t\t\tdir = addr0.NDIR;\r\n\t\t\tswitch (ca) {\r\n\t\t\t\tcase \"up\":\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tcursor.by === cursor.maxy &&\r\n\t\t\t\t\t\tcursor.minx < cursor.bx &&\r\n\t\t\t\t\t\tcursor.bx < cursor.maxx\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tcursor.by = cursor.miny;\r\n\t\t\t\t\t} else if (cursor.by > cursor.miny) {\r\n\t\t\t\t\t\tdir = addr0.UP;\r\n\t\t\t\t\t} else if (this.pid === \"easyasabc\" && cursor.by === -1) {\r\n\t\t\t\t\t\tdir = addr0.UP;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tflag = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"down\":\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tcursor.by === cursor.miny &&\r\n\t\t\t\t\t\tcursor.minx < cursor.bx &&\r\n\t\t\t\t\t\tcursor.bx < cursor.maxx\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tcursor.by = cursor.maxy;\r\n\t\t\t\t\t} else if (cursor.by < cursor.maxy) {\r\n\t\t\t\t\t\tdir = addr0.DN;\r\n\t\t\t\t\t} else if (this.pid === \"easyasabc\" && cursor.by === -3) {\r\n\t\t\t\t\t\tdir = addr0.DN;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tflag = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"left\":\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tcursor.bx === cursor.maxx &&\r\n\t\t\t\t\t\tcursor.miny < cursor.by &&\r\n\t\t\t\t\t\tcursor.by < cursor.maxy\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tcursor.bx = cursor.minx;\r\n\t\t\t\t\t} else if (cursor.bx > cursor.minx) {\r\n\t\t\t\t\t\tdir = addr0.LT;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tflag = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"right\":\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tcursor.bx === cursor.minx &&\r\n\t\t\t\t\t\tcursor.miny < cursor.by &&\r\n\t\t\t\t\t\tcursor.by < cursor.maxy\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tcursor.bx = cursor.maxx;\r\n\t\t\t\t\t} else if (cursor.bx < cursor.maxx) {\r\n\t\t\t\t\t\tdir = addr0.RT;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tflag = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tflag = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif (flag) {\r\n\t\t\t\tif (dir !== addr0.NDIR) {\r\n\t\t\t\t\tcursor.movedir(dir, 2);\r\n\t\t\t\t}\r\n\r\n\t\t\t\taddr0.draw();\r\n\t\t\t\tcursor.draw();\r\n\t\t\t}\r\n\t\t\treturn flag;\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ★TargetCursorクラス キー入力のターゲットを保持する\r\n\t//---------------------------------------------------------------------------\r\n\t\"TargetCursor:Address\": {\r\n\t\tinitialize: function() {\r\n\t\t\tthis.bx = 1;\r\n\t\t\tthis.by = 1;\r\n\t\t\tthis.mode51 = this.puzzle.klass.ExCell.prototype.ques === 51;\r\n\t\t\tthis.modesnum = this.puzzle.klass.Cell.prototype.enableSubNumberArray;\r\n\t\t\tthis.targetdirs = this.puzzle.klass.Cell.prototype.dirs51;\r\n\t\t\tif (this.mode51 && this.puzzle.editmode) {\r\n\t\t\t\tthis.targetdir = 4;\r\n\t\t\t} // right\r\n\t\t},\r\n\t\tinit: function(bx, by) {\r\n\t\t\tthis.bx = bx;\r\n\t\t\tthis.by = by;\r\n\t\t\tif (!this.mode51) {\r\n\t\t\t\tthis.targetdir = 0;\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t},\r\n\r\n\t\t// 有効な範囲(minx,miny)-(maxx,maxy)\r\n\t\tminx: null,\r\n\t\tminy: null,\r\n\t\tmaxx: null,\r\n\t\tmaxy: null,\r\n\r\n\t\tcrosstype: false,\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// tc.initCursor()           初期化時にカーソルの位置を設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinitCursor: function() {\r\n\t\t\tif (this.crosstype) {\r\n\t\t\t\tthis.init(0, 0);\r\n\t\t\t} else {\r\n\t\t\t\tthis.init(1, 1);\r\n\t\t\t}\r\n\r\n\t\t\tthis.adjust_init();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// tc.setminmax()            初期化時・モード変更時にプロパティを設定する\r\n\t\t// tc.setminmax_customize()  初期化時・モード変更時のプロパティをパズルごとに調節する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetminmax: function() {\r\n\t\t\tvar bd = this.board,\r\n\t\t\t\tbm = !this.crosstype ? 1 : 0;\r\n\t\t\tthis.minx = bd.minbx + bm;\r\n\t\t\tthis.miny = bd.minby + bm;\r\n\t\t\tthis.maxx = bd.maxbx - bm;\r\n\t\t\tthis.maxy = bd.maxby - bm;\r\n\r\n\t\t\tthis.setminmax_customize();\r\n\r\n\t\t\tthis.adjust_init();\r\n\t\t},\r\n\t\tsetminmax_customize: function() {},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// tc.adjust_init()       初期化時にカーソルの位置がおかしい場合に調整する\r\n\t\t// tc.adjust_modechange() モード変更時にカーソルの位置を調節する\r\n\t\t// tc.adjust_cell_to_excell() モード変更時にカーソルの位置をCellからExCellへ移動する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tadjust_init: function() {\r\n\t\t\tif (this.bx < this.minx) {\r\n\t\t\t\tthis.bx = this.minx;\r\n\t\t\t}\r\n\t\t\tif (this.by < this.miny) {\r\n\t\t\t\tthis.by = this.miny;\r\n\t\t\t}\r\n\t\t\tif (this.bx > this.maxx) {\r\n\t\t\t\tthis.bx = this.maxx;\r\n\t\t\t}\r\n\t\t\tif (this.by > this.maxy) {\r\n\t\t\t\tthis.by = this.maxy;\r\n\t\t\t}\r\n\t\t},\r\n\t\tadjust_modechange: function() {\r\n\t\t\tif (this.setminmax_customize !== this.common.setminmax_customize) {\r\n\t\t\t\tthis.setminmax();\r\n\t\t\t} // editmode, playmodeでminmaxが異なるパズル\r\n\t\t\tif (this.mode51 && this.puzzle.editmode) {\r\n\t\t\t\tthis.targetdir = 4;\r\n\t\t\t} // right\r\n\t\t\telse if (this.modesnum && this.puzzle.playmode) {\r\n\t\t\t\tthis.targetdir = 0;\r\n\t\t\t}\r\n\t\t},\r\n\t\tadjust_cell_to_excell: function() {\r\n\t\t\tvar bd = this.board;\r\n\t\t\tvar shortest = Math.min(\r\n\t\t\t\tthis.bx,\r\n\t\t\t\tbd.cols * 2 - this.bx,\r\n\t\t\t\tthis.by,\r\n\t\t\t\tbd.rows * 2 - this.by\r\n\t\t\t);\r\n\t\t\tif (shortest <= 0) {\r\n\t\t\t\treturn;\r\n\t\t\t} else if (this.by === shortest) {\r\n\t\t\t\tthis.by = this.miny;\r\n\t\t\t} else if (bd.rows * 2 - this.by === shortest) {\r\n\t\t\t\tthis.by = this.maxy;\r\n\t\t\t} else if (this.bx === shortest) {\r\n\t\t\t\tthis.bx = this.minx;\r\n\t\t\t} else if (bd.cols * 2 - this.bx === shortest) {\r\n\t\t\t\tthis.bx = this.maxx;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// tc.checksnum()  ターゲットの位置かどうか判定する (Cellのみ)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tchecksnum: function(pos) {\r\n\t\t\tvar bx = ((((pos.bx + 12) / 2) | 0) - 6) * 2 + 1;\r\n\t\t\tvar by = ((((pos.by + 12) / 2) | 0) - 6) * 2 + 1;\r\n\t\t\tvar result = this.bx === bx && this.by === by;\r\n\t\t\tif (result && this.modesnum && this.puzzle.playmode) {\r\n\t\t\t\tvar tmpx = (((pos.bx + 12) % 2) * 1.5) | 0;\r\n\t\t\t\tvar tmpy = (((pos.by + 12) % 2) * 1.5) | 0;\r\n\t\t\t\tif (this.pid !== \"factors\") {\r\n\t\t\t\t\tresult =\r\n\t\t\t\t\t\t[5, 0, 4, 0, 0, 0, 2, 0, 3][tmpy * 3 + tmpx] === this.targetdir;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult =\r\n\t\t\t\t\t\t[0, 0, 4, 0, 0, 0, 2, 0, 3][tmpy * 3 + tmpx] === this.targetdir;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// tc.getaddr() ターゲットの位置を移動する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tmovedir: function(dir, mv) {\r\n\t\t\tthis.puzzle.klass.Address.prototype.movedir.call(this, dir, mv);\r\n\t\t\tif (this.modesnum && this.puzzle.playmode) {\r\n\t\t\t\tthis.targetdir = 0;\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// tc.getaddr() ターゲットの位置をAddressクラスのオブジェクトで取得する\r\n\t\t// tc.setaddr() ターゲットの位置をAddressクラス等のオブジェクトで設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetaddr: function(pos) {\r\n\t\t\t/* Address, Cellなどのオブジェクトいずれを入力しても良い */\r\n\t\t\tif (\r\n\t\t\t\tpos.bx < this.minx ||\r\n\t\t\t\tthis.maxx < pos.bx ||\r\n\t\t\t\tpos.by < this.miny - (this.pid === \"easyasabc\" ? 2 : 0) ||\r\n\t\t\t\tthis.maxy < pos.by\r\n\t\t\t) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.set(pos);\r\n\t\t\tif (this.modesnum && this.puzzle.playmode) {\r\n\t\t\t\tthis.targetdir = 0;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// tc.moveTo() ターゲットの位置を指定した(bx,by)に設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tmoveTo: function(bx, by) {\r\n\t\t\tthis.init(bx, by);\r\n\t\t\tif (this.modesnum && this.puzzle.playmode) {\r\n\t\t\t\tthis.targetdir = 0;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// tc.chtarget()     SHIFTを押した時に[＼]の入力するところを選択する\r\n\t\t// tc.detectTarget() [＼]の右・下どちらに数字を入力するか判断する\r\n\t\t// tc.getNumOfTarget() Cell上でtargetとして取りうる数を返す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\ttargetdir: 0,\r\n\t\tchtarget: function(mouse, dx, dy) {\r\n\t\t\tif (this.oncell() && this.modesnum && this.puzzle.playmode) {\r\n\t\t\t\tif (this.pid !== \"factors\") {\r\n\t\t\t\t\tthis.targetdir = [5, 1, 3, 0, 2, 4][this.targetdir];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.targetdir = [4, 1, 3, 0, 2, 0][this.targetdir];\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (this.targetdirs === 4) {\r\n\t\t\t\t\tif (mouse) {\r\n\t\t\t\t\t\tvar ur = dx - dy > 0,\r\n\t\t\t\t\t\t\tul = dx + dy < 0;\r\n\t\t\t\t\t\tif (ur) {\r\n\t\t\t\t\t\t\tif (ul) {\r\n\t\t\t\t\t\t\t\tthis.targetdir = 1;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.targetdir = 4;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (ul) {\r\n\t\t\t\t\t\t\t\tthis.targetdir = 3;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.targetdir = 2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.targetdir = [4, 0, 3, 1, 2, 0][this.targetdir];\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (mouse) {\r\n\t\t\t\t\t\tthis.targetdir = dx - dy > 0 ? 4 : 2;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.targetdir = this.targetdir === 2 ? 4 : 2;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.draw();\r\n\t\t},\r\n\t\tdetectTarget: function(piece) {\r\n\t\t\tpiece = piece || this.getobj();\r\n\t\t\tvar bd = this.board,\r\n\t\t\t\tadc = piece.adjacent;\r\n\t\t\tif (piece.isnull) {\r\n\t\t\t\treturn 0;\r\n\t\t\t} else if (piece.group === \"cell\") {\r\n\t\t\t\tif (piece.ques !== 51 || piece.id === bd.cell.length - 1) {\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t} else if (this.targetdirs === 2) {\r\n\t\t\t\t\tvar invalidRight = adc.right.isnull || adc.right.ques === 51;\r\n\t\t\t\t\tvar invalidBottom = adc.bottom.isnull || adc.bottom.ques === 51;\r\n\t\t\t\t\tif (invalidRight && invalidBottom) {\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t} else if (invalidBottom) {\r\n\t\t\t\t\t\treturn piece.RT;\r\n\t\t\t\t\t} else if (invalidRight) {\r\n\t\t\t\t\t\treturn piece.DN;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (piece.group === \"excell\") {\r\n\t\t\t\tif (piece.id === bd.cols + bd.rows) {\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t} else if (\r\n\t\t\t\t\t(piece.by === -1 && adc.bottom.ques === 51) ||\r\n\t\t\t\t\t(piece.bx === -1 && adc.right.ques === 51)\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t} else if (piece.by === -1) {\r\n\t\t\t\t\treturn piece.DN;\r\n\t\t\t\t} else if (piece.bx === -1) {\r\n\t\t\t\t\treturn piece.RT;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t\treturn this.targetdir;\r\n\t\t},\r\n\t\tgetNumOfTarget: function(piece) {\r\n\t\t\tvar num = 1;\r\n\t\t\tif (piece.isnull) {\r\n\t\t\t\tnum = 0;\r\n\t\t\t} else if (piece.group === \"cell\") {\r\n\t\t\t\tif (this.modesnum && this.puzzle.playmode) {\r\n\t\t\t\t\tnum = 4 - (this.pid === \"factors\" ? 1 : 0);\r\n\t\t\t\t} else if (piece.ques === 51) {\r\n\t\t\t\t\tvar adc = piece.adjacent;\r\n\t\t\t\t\tnum =\r\n\t\t\t\t\t\t(!adc.right.isnull && adc.right.ques !== 51 ? 1 : 0) +\r\n\t\t\t\t\t\t(!adc.bottom.isnull && adc.bottom.ques !== 51 ? 1 : 0);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn num;\r\n\t\t},\r\n\r\n\t\tgetDot: function() {\r\n\t\t\treturn this.board.getDot(this.bx, this.by);\r\n\t\t}\r\n\t}\r\n});\r\n","// Encode.js v3.4.1\r\n\r\n//---------------------------------------------------------------------------\r\n// ★Encodeクラス URLのエンコード/デコードを扱う\r\n//---------------------------------------------------------------------------\r\n// URLエンコード/デコード\r\n// Encodeクラス\r\npzpr.classmgr.makeCommon({\r\n\t//---------------------------------------------------------\r\n\tEncode: {\r\n\t\tpflag: \"\",\r\n\t\toutpflag: \"\",\r\n\t\toutvariant: null,\r\n\t\toutcols: null,\r\n\t\toutrows: null,\r\n\t\toutbstr: \"\",\r\n\t\tfio: null,\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// enc.checkpflag()   pflagに指定した文字列が含まれているか調べる\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ぱずぷれApplet->v3でURLの仕様が変わったパズル:\r\n\t\t//     creek, gokigen, lits (Applet+c===v3, Applet===v3+d)\r\n\t\t// 何回かURL形式を変更したパズル:\r\n\t\t//     icebarn (v3, Applet+c, Applet), slalom (v3+p, v3+d, v3/Applet)\r\n\t\t// v3になって以降pidを分離したパズルのうち元パズルのURL形式を変更して短くしたパズル:\r\n\t\t//     bonsan, kramma (cを付加)\r\n\t\t// URL形式は同じで表示形式の情報をもたせているパズル:\r\n\t\t//     bosanowa, pipelink, yajilin\r\n\t\tcheckpflag: function(ca) {\r\n\t\t\treturn this.pflag.indexOf(ca) >= 0;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// enc.decodeURL()   parseURL()を行い、各種各パズルのdecode関数を呼び出す\r\n\t\t// enc.encodeURL()   各種各パズルのencode関数を呼び出し、URLを出力する\r\n\t\t//\r\n\t\t// enc.decodePzpr()  各パズルのURL入力用(オーバーライド用)\r\n\t\t// enc.encodePzpr()  各パズルのURL出力用(オーバーライド用)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeURL: function(url) {\r\n\t\t\tvar pzl = pzpr.parser.parseURL(url),\r\n\t\t\t\tpuzzle = this.puzzle,\r\n\t\t\t\tbd = puzzle.board;\r\n\r\n\t\t\tif (pzl.type === pzl.URL_PZPRFILE) {\r\n\t\t\t\tnew puzzle.klass.FileIO().filedecode(pzl.body);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (pzl.pid === \"dac1\" || pzl.pid === \"dac2\" || pzl.pid === \"dac3\" || pzl.pid === \"dac4\" || pzl.pid === \"dac5\") {\r\n\t\t\t\tpzl.cols = 8;\r\n\t\t\t\tpzl.rows = 8;\r\n\t\t\t}\r\n\t\t\tif (pzl.pid === \"dac6\") {\r\n\t\t\t\tpzl.cols = 15;\r\n\t\t\t\tpzl.rows = 20;\r\n\t\t\t}\r\n\r\n\t\t\tbd.initBoardSize(pzl.cols, pzl.rows);\r\n\t\t\tif (pzl.variant !== null) {\r\n\t\t\t\tpuzzle.setConfig(\"variant\", true);\r\n\t\t\t\tpuzzle.setConfig(\"variantid\", pzl.variant);\r\n\t\t\t}\r\n\r\n\t\t\tif (!!pzl.body) {\r\n\t\t\t\tthis.pflag = pzl.pflag;\r\n\t\t\t\tthis.outbstr = pzl.body;\r\n\t\t\t\tswitch (pzl.type) {\r\n\t\t\t\t\tcase pzl.URL_PZPRV3:\r\n\t\t\t\t\tcase pzl.URL_KANPENP:\r\n\t\t\t\t\t\tthis.decodePzpr(pzl.URL_PZPRV3);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase pzl.URL_PZPRAPP:\r\n\t\t\t\t\t\tthis.decodePzpr(pzl.URL_PZPRAPP);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase pzl.URL_KANPEN:\r\n\t\t\t\t\t\tthis.fio = new puzzle.klass.FileIO();\r\n\t\t\t\t\t\tthis.fio.dataarray = this.outbstr.replace(/_/g, \" \").split(\"/\");\r\n\t\t\t\t\t\tthis.decodeKanpen();\r\n\t\t\t\t\t\tthis.fio = null;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase pzl.URL_HEYAAPP:\r\n\t\t\t\t\t\tthis.decodeHeyaApp();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tbd.rebuildInfo();\r\n\t\t},\r\n\t\tencodeURL: function(type, mode) {\r\n\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\tpid = puzzle.pid,\r\n\t\t\t\tbd = puzzle.board;\r\n\t\t\tvar pzl = new pzpr.parser.URLData(\"\", mode);\r\n\r\n\t\t\ttype =\r\n\t\t\t\ttype || pzl.URL_PZPRV3; /* type===pzl.URL_AUTO(0)もまとめて変換する */\r\n\t\t\tif (type === pzl.URL_KANPEN && pid === \"lits\") {\r\n\t\t\t\ttype = pzl.URL_KANPENP;\r\n\t\t\t}\r\n\r\n\t\t\tthis.outpflag = null;\r\n\t\t\tvar variant = puzzle.getConfig(\"variant\");\r\n\t\t\tthis.outvariant = variant ? puzzle.getConfig(\"variantid\") : null;\r\n\t\t\tthis.outcols = bd.cols;\r\n\t\t\tthis.outrows = bd.rows;\r\n\t\t\tthis.outbstr = \"\";\r\n\r\n\t\t\tswitch (type) {\r\n\t\t\t\tcase pzl.URL_PZPRV3:\r\n\t\t\t\t\tthis.encodePzpr(pzl.URL_PZPRV3);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase pzl.URL_PZPRFILE:\r\n\t\t\t\t\tvar lines = this.puzzle.getFileData(pzl.FILE_PZPRV3).split(\"\\n\");\r\n\t\t\t\t\tlines = lines.map(encodeURIComponent);\r\n\t\t\t\t\tthis.outbstr = lines.join(\"/\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase pzl.URL_PZPRAPP:\r\n\t\t\t\t\tthrow \"no implementation\";\r\n\r\n\t\t\t\tcase pzl.URL_KANPENP:\r\n\t\t\t\t\tif (!puzzle.info.exists.kanpen) {\r\n\t\t\t\t\t\tthrow \"no implementation\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.encodePzpr(pzl.URL_PZPRAPP);\r\n\t\t\t\t\tthis.outpflag = this.outpflag || \"\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase pzl.URL_KANPEN:\r\n\t\t\t\t\tthis.fio = new puzzle.klass.FileIO();\r\n\t\t\t\t\tthis.encodeKanpen();\r\n\t\t\t\t\tthis.outbstr = this.fio.datastr\r\n\t\t\t\t\t\t.replace(/\\r?\\n/g, \"/\")\r\n\t\t\t\t\t\t.replace(/ /g, \"_\");\r\n\t\t\t\t\tthis.fio = null;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase pzl.URL_HEYAAPP:\r\n\t\t\t\t\tthis.encodeHeyaApp();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow \"invalid URL Type\";\r\n\t\t\t}\r\n\r\n\t\t\tpzl.pid = pid;\r\n\t\t\tpzl.type = type;\r\n\t\t\tpzl.pflag = this.outpflag;\r\n\t\t\tpzl.variant = this.outvariant;\r\n\t\t\tpzl.cols = this.outcols;\r\n\t\t\tpzl.rows = this.outrows;\r\n\t\t\tpzl.body = this.outbstr;\r\n\r\n\t\t\treturn pzl.generate();\r\n\t\t},\r\n\r\n\t\t// オーバーライド用\r\n\t\tdecodePzpr: function(type) {\r\n\t\t\tthrow \"no implementation\";\r\n\t\t},\r\n\t\tencodePzpr: function(type) {\r\n\t\t\tthrow \"no implementation\";\r\n\t\t},\r\n\t\tdecodeKanpen: function() {\r\n\t\t\tthrow \"no implementation\";\r\n\t\t},\r\n\t\tencodeKanpen: function() {\r\n\t\t\tthrow \"no implementation\";\r\n\t\t},\r\n\t\tdecodeHeyaApp: function() {\r\n\t\t\tthrow \"no implementation\";\r\n\t\t},\r\n\t\tencodeHeyaApp: function() {\r\n\t\t\tthrow \"no implementation\";\r\n\t\t}\r\n\t}\r\n});\r\n","// FileData.js\r\n\r\n(function() {\r\n\tfunction throwNoImplementation() {\r\n\t\tthrow \"no implementation\";\r\n\t}\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ★FileIOクラス ファイルのデータ形式エンコード/デコードを扱う\r\n\t//---------------------------------------------------------------------------\r\n\tpzpr.classmgr.makeCommon({\r\n\t\t//---------------------------------------------------------\r\n\t\tFileIO: {\r\n\t\t\tfilever: 0,\r\n\t\t\tlineseek: 0,\r\n\t\t\tdataarray: null,\r\n\t\t\txmldoc: null,\r\n\t\t\tdatastr: \"\",\r\n\t\t\tcurrentType: 0,\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// fio.filedecode()  ファイルデータ(文字列)からのデコード実行関数\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tfiledecode: function(datastr) {\r\n\t\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\t\tbd = puzzle.board,\r\n\t\t\t\t\tpzl = pzpr.parser.parseFile(datastr, puzzle.pid);\r\n\t\t\t\tvar filetype = (this.currentType = pzl.type);\r\n\r\n\t\t\t\tbd.initBoardSize(pzl.cols, pzl.rows);\r\n\r\n\t\t\t\tthis.filever = pzl.filever;\r\n\t\t\t\tif (filetype !== pzl.FILE_PBOX_XML) {\r\n\t\t\t\t\tthis.lineseek = 0;\r\n\t\t\t\t\tthis.dataarray = pzl.body.split(\"\\n\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.xmldoc = pzl.body;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// メイン処理\r\n\t\t\t\tswitch (filetype) {\r\n\t\t\t\t\tcase pzl.FILE_PZPR:\r\n\t\t\t\t\t\tthis.decodeData();\r\n\t\t\t\t\t\tif ((this.readLine() || \"\").match(/TrialData/)) {\r\n\t\t\t\t\t\t\tthis.lineseek--;\r\n\t\t\t\t\t\t\tthis.decodeTrial();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase pzl.FILE_PBOX:\r\n\t\t\t\t\t\tthis.kanpenOpen();\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase pzl.FILE_PBOX_XML:\r\n\t\t\t\t\t\tthis.kanpenOpenXML();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tpuzzle.metadata.update(pzl.metadata);\r\n\t\t\t\tif (pzl.history && filetype === pzl.FILE_PZPR) {\r\n\t\t\t\t\tpuzzle.opemgr.decodeHistory(pzl.history);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbd.rebuildInfo();\r\n\r\n\t\t\t\tthis.dataarray = null;\r\n\t\t\t},\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// fio.fileencode() ファイルデータ(文字列)へのエンコード実行関数\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tfileencode: function(filetype, option) {\r\n\t\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\t\tbd = puzzle.board;\r\n\t\t\t\tvar pzl = new pzpr.parser.FileData(\"\", puzzle.pid);\r\n\r\n\t\t\t\tthis.currentType = filetype =\r\n\t\t\t\t\tfiletype ||\r\n\t\t\t\t\tpzl.FILE_PZPR; /* type===pzl.FILE_AUTO(0)もまとめて変換する */\r\n\t\t\t\toption = option || {};\r\n\r\n\t\t\t\tthis.filever = 0;\r\n\t\t\t\tthis.datastr = \"\";\r\n\t\t\t\tif (filetype === pzl.FILE_PBOX_XML) {\r\n\t\t\t\t\tthis.xmldoc = new DOMParser().parseFromString(\r\n\t\t\t\t\t\t'<?xml version=\"1.0\" encoding=\"utf-8\" ?><puzzle />',\r\n\t\t\t\t\t\t\"text/xml\"\r\n\t\t\t\t\t);\r\n\t\t\t\t\tvar puzzlenode = this.xmldoc.querySelector(\"puzzle\");\r\n\t\t\t\t\tpuzzlenode.appendChild(this.createXMLNode(\"board\"));\r\n\t\t\t\t\tpuzzlenode.appendChild(this.createXMLNode(\"answer\"));\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// メイン処理\r\n\t\t\t\tswitch (filetype) {\r\n\t\t\t\t\tcase pzl.FILE_PZPR:\r\n\t\t\t\t\t\tthis.encodeData();\r\n\t\t\t\t\t\tif (!option.history && option.trial && bd.trialstage > 0) {\r\n\t\t\t\t\t\t\tthis.encodeTrial();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase pzl.FILE_PBOX:\r\n\t\t\t\t\t\tthis.kanpenSave();\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase pzl.FILE_PBOX_XML:\r\n\t\t\t\t\t\tthis.kanpenSaveXML();\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tthrow \"invalid filetype\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tpzl.type = filetype;\r\n\t\t\t\tpzl.filever = this.filever;\r\n\t\t\t\tpzl.cols = bd.cols;\r\n\t\t\t\tpzl.rows = bd.rows;\r\n\t\t\t\tif (filetype !== pzl.FILE_PBOX_XML) {\r\n\t\t\t\t\tpzl.body = this.datastr;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpzl.body = this.xmldoc;\r\n\t\t\t\t}\r\n\t\t\t\tpzl.metadata.update(puzzle.metadata);\r\n\t\t\t\tif (option.history && filetype === pzl.FILE_PZPR) {\r\n\t\t\t\t\tpzl.history = puzzle.opemgr.encodeHistory({ time: !!option.time });\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.datastr = \"\";\r\n\r\n\t\t\t\treturn pzl.generate();\r\n\t\t\t},\r\n\r\n\t\t\t// オーバーライド用\r\n\t\t\tdecodeData: throwNoImplementation,\r\n\t\t\tencodeData: throwNoImplementation,\r\n\t\t\tkanpenOpen: throwNoImplementation,\r\n\t\t\tkanpenSave: throwNoImplementation,\r\n\t\t\tkanpenOpenXML: throwNoImplementation,\r\n\t\t\tkanpenSaveXML: throwNoImplementation,\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// fio.decodeTrial() 仮置きデータを復旧する\r\n\t\t\t// fio.encodeTrial() 仮置きデータを出力する\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tdecodeTrial: function() {\r\n\t\t\t\tvar opemgr = this.puzzle.opemgr;\r\n\t\t\t\tvar bd = this.board;\r\n\t\t\t\tvar len = this.readLine().match(/TrialData\\((\\d+)\\)/)[1] | 0;\r\n\t\t\t\tfor (var i = len - 1; i >= 0; i--) {\r\n\t\t\t\t\tvar opes = [];\r\n\t\t\t\t\tvar bd1 = bd.freezecopy();\r\n\t\t\t\t\tbd.allclear(false);\r\n\t\t\t\t\tthis.decodeData();\r\n\t\t\t\t\tbd.compareData(bd1, function(group, c, a) {\r\n\t\t\t\t\t\tvar obj = bd[group][c];\r\n\t\t\t\t\t\tvar old = obj[a];\r\n\t\t\t\t\t\tvar num = bd1[group][c][a];\r\n\t\t\t\t\t\topes.push(new this.puzzle.klass.ObjectOperation(obj, a, old, num));\r\n\t\t\t\t\t});\r\n\t\t\t\t\topemgr.history.unshift(opes);\r\n\t\t\t\t\topemgr.history.unshift([\r\n\t\t\t\t\t\tnew this.puzzle.klass.TrialEnterOperation(i, i + 1)\r\n\t\t\t\t\t]);\r\n\t\t\t\t\topemgr.trialpos.unshift(i * 2);\r\n\t\t\t\t\tthis.readLine(); // 次の\"TrialData\"文字列は読み捨て\r\n\t\t\t\t}\r\n\t\t\t\topemgr.position = opemgr.history.length;\r\n\t\t\t\topemgr.resumeTrial();\r\n\t\t\t},\r\n\t\t\tencodeTrial: function() {\r\n\t\t\t\tvar opemgr = this.puzzle.opemgr,\r\n\t\t\t\t\tpos = opemgr.position;\r\n\t\t\t\topemgr.disableRecord();\r\n\t\t\t\tfor (var stage = this.board.trialstage; stage > 0; stage--) {\r\n\t\t\t\t\tthis.writeLine(\"TrialData(\" + stage + \")\");\r\n\t\t\t\t\topemgr.resumeGoto(opemgr.trialpos[stage - 1]);\r\n\t\t\t\t\tthis.encodeData();\r\n\t\t\t\t}\r\n\t\t\t\topemgr.resumeGoto(pos);\r\n\t\t\t\topemgr.resumeTrial();\r\n\t\t\t\topemgr.enableRecord();\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// fio.readLine()    ファイルに書かれている1行の文字列を返す\r\n\t\t\t// fio.getItemList() ファイルに書かれている改行＋スペース区切りの\r\n\t\t\t//                   複数行の文字列を配列にして返す\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\treadLine: function() {\r\n\t\t\t\tthis.lineseek++;\r\n\t\t\t\treturn this.dataarray[this.lineseek - 1];\r\n\t\t\t},\r\n\r\n\t\t\tgetItemList: function(rows) {\r\n\t\t\t\tvar item = [],\r\n\t\t\t\t\tline;\r\n\t\t\t\tfor (var i = 0; i < rows; i++) {\r\n\t\t\t\t\tif (!(line = this.readLine())) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar array1 = line.split(\" \");\r\n\t\t\t\t\tfor (var c = 0; c < array1.length; c++) {\r\n\t\t\t\t\t\tif (array1[c] !== \"\") {\r\n\t\t\t\t\t\t\titem.push(array1[c]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn item;\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// fio.writeLine()    ファイルに1行出力する\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\twriteLine: function(data) {\r\n\t\t\t\tif (typeof data === \"number\") {\r\n\t\t\t\t\tdata = \"\" + data;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdata = data || \"\";\r\n\t\t\t\t} // typeof data==='string'\r\n\t\t\t\tthis.datastr += data + \"\\n\";\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// fio.decodeObj()     配列で、個別文字列から個別セルなどの設定を行う\r\n\t\t\t// fio.decodeCell()    配列で、個別文字列から個別セルの設定を行う\r\n\t\t\t// fio.decodeCross()   配列で、個別文字列から個別Crossの設定を行う\r\n\t\t\t// fio.decodeBorder()  配列で、個別文字列から個別Borderの設定を行う\r\n\t\t\t// fio.decodeCellExCell()  配列で、個別文字列から個別セル/ExCellの設定を行う\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tdecodeObj: function(func, group, startbx, startby, endbx, endby) {\r\n\t\t\t\tvar bx = startbx,\r\n\t\t\t\t\tby = startby,\r\n\t\t\t\t\tstep = 2;\r\n\t\t\t\tvar item = this.getItemList((endby - startby) / step + 1);\r\n\t\t\t\tfor (var i = 0; i < item.length; i++) {\r\n\t\t\t\t\tfunc.call(this, this.board.getObjectPos(group, bx, by), item[i]);\r\n\r\n\t\t\t\t\tbx += step;\r\n\t\t\t\t\tif (bx > endbx) {\r\n\t\t\t\t\t\tbx = startbx;\r\n\t\t\t\t\t\tby += step;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (by > endby) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdecodeCell: function(func) {\r\n\t\t\t\tthis.decodeObj(\r\n\t\t\t\t\tfunc,\r\n\t\t\t\t\t\"cell\",\r\n\t\t\t\t\t1,\r\n\t\t\t\t\t1,\r\n\t\t\t\t\t2 * this.board.cols - 1,\r\n\t\t\t\t\t2 * this.board.rows - 1\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tdecodeCross: function(func) {\r\n\t\t\t\tthis.decodeObj(\r\n\t\t\t\t\tfunc,\r\n\t\t\t\t\t\"cross\",\r\n\t\t\t\t\t0,\r\n\t\t\t\t\t0,\r\n\t\t\t\t\t2 * this.board.cols,\r\n\t\t\t\t\t2 * this.board.rows\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tdecodeBorder: function(func) {\r\n\t\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\t\tbd = puzzle.board;\r\n\t\t\t\tif (\r\n\t\t\t\t\tbd.hasborder === 1 ||\r\n\t\t\t\t\tpuzzle.pid === \"bosanowa\" ||\r\n\t\t\t\t\t(puzzle.pid === \"fourcells\" && this.filever === 0)\r\n\t\t\t\t) {\r\n\t\t\t\t\tthis.decodeObj(\r\n\t\t\t\t\t\tfunc,\r\n\t\t\t\t\t\t\"border\",\r\n\t\t\t\t\t\t2,\r\n\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t2 * bd.cols - 2,\r\n\t\t\t\t\t\t2 * bd.rows - 1\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.decodeObj(\r\n\t\t\t\t\t\tfunc,\r\n\t\t\t\t\t\t\"border\",\r\n\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t2,\r\n\t\t\t\t\t\t2 * bd.cols - 1,\r\n\t\t\t\t\t\t2 * bd.rows - 2\r\n\t\t\t\t\t);\r\n\t\t\t\t} else if (bd.hasborder === 2) {\r\n\t\t\t\t\tif (this.currentType === pzpr.parser.FILE_PZPR) {\r\n\t\t\t\t\t\tthis.decodeObj(func, \"border\", 0, 1, 2 * bd.cols, 2 * bd.rows - 1);\r\n\t\t\t\t\t\tthis.decodeObj(func, \"border\", 1, 0, 2 * bd.cols - 1, 2 * bd.rows);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// pencilboxでは、outsideborderの時はぱずぷれとは順番が逆になってます\r\n\t\t\t\t\telse if (this.currentType === pzpr.parser.FILE_PBOX) {\r\n\t\t\t\t\t\tthis.decodeObj(func, \"border\", 1, 0, 2 * bd.cols - 1, 2 * bd.rows);\r\n\t\t\t\t\t\tthis.decodeObj(func, \"border\", 0, 1, 2 * bd.cols, 2 * bd.rows - 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdecodeCellExCell: function(func) {\r\n\t\t\t\tthis.decodeObj(\r\n\t\t\t\t\tfunc,\r\n\t\t\t\t\t\"obj\",\r\n\t\t\t\t\tthis.board.minbx + 1,\r\n\t\t\t\t\tthis.board.minby + 1,\r\n\t\t\t\t\tthis.board.maxbx - 1,\r\n\t\t\t\t\tthis.board.maxby - 1\r\n\t\t\t\t);\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// fio.encodeObj()     個別セルデータ等から個別文字列の設定を行う\r\n\t\t\t// fio.encodeCell()    個別セルデータから個別文字列の設定を行う\r\n\t\t\t// fio.encodeCross()   個別Crossデータから個別文字列の設定を行う\r\n\t\t\t// fio.encodeBorder()  個別Borderデータから個別文字列の設定を行う\r\n\t\t\t// fio.encodeCellExCell()  個別セル/ExCellデータから個別文字列の設定を行う\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tencodeObj: function(func, group, startbx, startby, endbx, endby) {\r\n\t\t\t\tvar step = 2;\r\n\t\t\t\tfor (var by = startby; by <= endby; by += step) {\r\n\t\t\t\t\tvar data = \"\";\r\n\t\t\t\t\tfor (var bx = startbx; bx <= endbx; bx += step) {\r\n\t\t\t\t\t\tdata += func.call(this, this.board.getObjectPos(group, bx, by));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.writeLine(data);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tencodeCell: function(func) {\r\n\t\t\t\tthis.encodeObj(\r\n\t\t\t\t\tfunc,\r\n\t\t\t\t\t\"cell\",\r\n\t\t\t\t\t1,\r\n\t\t\t\t\t1,\r\n\t\t\t\t\t2 * this.board.cols - 1,\r\n\t\t\t\t\t2 * this.board.rows - 1\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tencodeCross: function(func) {\r\n\t\t\t\tthis.encodeObj(\r\n\t\t\t\t\tfunc,\r\n\t\t\t\t\t\"cross\",\r\n\t\t\t\t\t0,\r\n\t\t\t\t\t0,\r\n\t\t\t\t\t2 * this.board.cols,\r\n\t\t\t\t\t2 * this.board.rows\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tencodeBorder: function(func) {\r\n\t\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\t\tbd = puzzle.board;\r\n\t\t\t\tif (bd.hasborder === 1 || puzzle.pid === \"bosanowa\") {\r\n\t\t\t\t\tthis.encodeObj(\r\n\t\t\t\t\t\tfunc,\r\n\t\t\t\t\t\t\"border\",\r\n\t\t\t\t\t\t2,\r\n\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t2 * bd.cols - 2,\r\n\t\t\t\t\t\t2 * bd.rows - 1\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.encodeObj(\r\n\t\t\t\t\t\tfunc,\r\n\t\t\t\t\t\t\"border\",\r\n\t\t\t\t\t\t1,\r\n\t\t\t\t\t\t2,\r\n\t\t\t\t\t\t2 * bd.cols - 1,\r\n\t\t\t\t\t\t2 * bd.rows - 2\r\n\t\t\t\t\t);\r\n\t\t\t\t} else if (bd.hasborder === 2) {\r\n\t\t\t\t\tif (this.currentType === pzpr.parser.FILE_PZPR) {\r\n\t\t\t\t\t\tthis.encodeObj(func, \"border\", 0, 1, 2 * bd.cols, 2 * bd.rows - 1);\r\n\t\t\t\t\t\tthis.encodeObj(func, \"border\", 1, 0, 2 * bd.cols - 1, 2 * bd.rows);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// pencilboxでは、outsideborderの時はぱずぷれとは順番が逆になってます\r\n\t\t\t\t\telse if (this.currentType === pzpr.parser.FILE_PBOX) {\r\n\t\t\t\t\t\tthis.encodeObj(func, \"border\", 1, 0, 2 * bd.cols - 1, 2 * bd.rows);\r\n\t\t\t\t\t\tthis.encodeObj(func, \"border\", 0, 1, 2 * bd.cols, 2 * bd.rows - 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tencodeCellExCell: function(func) {\r\n\t\t\t\tthis.encodeObj(\r\n\t\t\t\t\tfunc,\r\n\t\t\t\t\t\"obj\",\r\n\t\t\t\t\tthis.board.minbx + 1,\r\n\t\t\t\t\tthis.board.minby + 1,\r\n\t\t\t\t\tthis.board.maxbx - 1,\r\n\t\t\t\t\tthis.board.maxby - 1\r\n\t\t\t\t);\r\n\t\t\t},\r\n\r\n\t\t\tdecodeFlags: function() {\r\n\t\t\t\tvar flags = this.readLine().split(\",\");\r\n\t\t\t\tfor (var i = 0; i < flags.length; i++) {\r\n\t\t\t\t\tthis.puzzle.setConfig(flags[i], true);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tencodeFlags: function(flagnames) {\r\n\t\t\t\tvar flags = [];\r\n\t\t\t\tfor (var i = 0; i < flagnames.length; i++) {\r\n\t\t\t\t\tif (this.puzzle.getConfig(flagnames[i])) {\r\n\t\t\t\t\t\tflags.push(flagnames[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.writeLine(flags.join(\",\"));\r\n\t\t\t},\r\n\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\t// fio.decodeCellXMLBoard()  配列で、個別文字列から個別セルの設定を行う (XML board用)\r\n\t\t\t// fio.decodeCellXMLBrow()   配列で、個別文字列から個別セルの設定を行う (XML board用)\r\n\t\t\t// fio.decodeCellXMLArow()   配列で、個別文字列から個別セルの設定を行う (XML answer用)\r\n\t\t\t// fio.encodeCellXMLBoard()  個別セルデータから個別文字列の設定を行う (XML board用)\r\n\t\t\t// fio.encodeCellXMLBrow()   個別セルデータから個別文字列の設定を行う (XML board用)\r\n\t\t\t// fio.encodeCellXMLArow()   個別セルデータから個別文字列の設定を行う (XML answer用)\r\n\t\t\t// fio.createXMLNode()  指定されたattributeを持つXMLのノードを作成する\r\n\t\t\t//---------------------------------------------------------------------------\r\n\t\t\tdecodeCellXMLBoard: function(func) {\r\n\t\t\t\tvar nodes = this.xmldoc.querySelectorAll(\"board number\");\r\n\t\t\t\tfor (var i = 0; i < nodes.length; i++) {\r\n\t\t\t\t\tvar node = nodes[i];\r\n\t\t\t\t\tvar cell = this.board.getc(\r\n\t\t\t\t\t\t+node.getAttribute(\"c\") * 2 - 1,\r\n\t\t\t\t\t\t+node.getAttribute(\"r\") * 2 - 1\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (!cell.isnull) {\r\n\t\t\t\t\t\tfunc(cell, +node.getAttribute(\"n\"));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tencodeCellXMLBoard: function(func) {\r\n\t\t\t\tvar boardnode = this.xmldoc.querySelector(\"board\");\r\n\t\t\t\tvar bd = this.board;\r\n\t\t\t\tfor (var i = 0; i < bd.cell.length; i++) {\r\n\t\t\t\t\tvar cell = bd.cell[i],\r\n\t\t\t\t\t\tval = func(cell);\r\n\t\t\t\t\tif (val !== null) {\r\n\t\t\t\t\t\tboardnode.appendChild(\r\n\t\t\t\t\t\t\tthis.createXMLNode(\"number\", {\r\n\t\t\t\t\t\t\t\tr: ((cell.by / 2) | 0) + 1,\r\n\t\t\t\t\t\t\t\tc: ((cell.bx / 2) | 0) + 1,\r\n\t\t\t\t\t\t\t\tn: val\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tPBOX_ADJUST: 0,\r\n\t\t\tdecodeCellXMLBrow: function(func) {\r\n\t\t\t\tthis.decodeCellXMLrow_com(func, \"board\", \"brow\");\r\n\t\t\t},\r\n\t\t\tencodeCellXMLBrow: function(func) {\r\n\t\t\t\tthis.encodeCellXMLrow_com(func, \"board\", \"brow\");\r\n\t\t\t},\r\n\t\t\tdecodeCellXMLArow: function(func) {\r\n\t\t\t\tthis.decodeCellXMLrow_com(func, \"answer\", \"arow\");\r\n\t\t\t},\r\n\t\t\tencodeCellXMLArow: function(func) {\r\n\t\t\t\tthis.encodeCellXMLrow_com(func, \"answer\", \"arow\");\r\n\t\t\t},\r\n\t\t\tdecodeCellXMLrow_com: function(func, parentnodename, targetnodename) {\r\n\t\t\t\tvar rownodes = this.xmldoc.querySelectorAll(\r\n\t\t\t\t\tparentnodename + \" \" + targetnodename\r\n\t\t\t\t);\r\n\t\t\t\tvar ADJ = this.PBOX_ADJUST;\r\n\t\t\t\tfor (var b = 0; b < rownodes.length; b++) {\r\n\t\t\t\t\tvar bx = 1 - ADJ,\r\n\t\t\t\t\t\tby = +rownodes[b].getAttribute(\"row\") * 2 - 1 - ADJ;\r\n\t\t\t\t\tvar nodes = rownodes[b].childNodes;\r\n\t\t\t\t\tfor (var i = 0; i < nodes.length; i++) {\r\n\t\t\t\t\t\tif (nodes[i].nodeType !== 1) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar name = nodes[i].nodeName,\r\n\t\t\t\t\t\t\tn = nodes[i].getAttribute(\"n\") || 1;\r\n\t\t\t\t\t\tif (name === \"z\") {\r\n\t\t\t\t\t\t\tname = \"n0\";\r\n\t\t\t\t\t\t} else if (name === \"n\") {\r\n\t\t\t\t\t\t\tname = \"n\" + +nodes[i].getAttribute(\"v\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (var j = 0; j < n; j++) {\r\n\t\t\t\t\t\t\tfunc(this.board.getobj(bx, by), name);\r\n\t\t\t\t\t\t\tbx += 2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tencodeCellXMLrow_com: function(func, parentnodename, targetnodename) {\r\n\t\t\t\tvar boardnode = this.xmldoc.querySelector(parentnodename);\r\n\t\t\t\tvar ADJ = this.PBOX_ADJUST;\r\n\t\t\t\tvar bd = this.board;\r\n\t\t\t\tfor (var by = 1 - ADJ; by <= bd.maxby; by += 2) {\r\n\t\t\t\t\tvar rownode = this.createXMLNode(targetnodename, {\r\n\t\t\t\t\t\trow: (((by + ADJ) / 2) | 0) + 1\r\n\t\t\t\t\t});\r\n\t\t\t\t\tfor (var bx = 1 - ADJ; bx <= bd.maxbx; bx += 2) {\r\n\t\t\t\t\t\tvar piece = bd.getobj(bx, by),\r\n\t\t\t\t\t\t\tnodename = func(piece),\r\n\t\t\t\t\t\t\tnode;\r\n\t\t\t\t\t\tif (nodename.match(/n(\\d\\d+)/) || nodename.match(/n(\\-\\d+)/)) {\r\n\t\t\t\t\t\t\tnode = this.createXMLNode(\"n\", { v: RegExp.$1 });\r\n\t\t\t\t\t\t} else if (nodename === \"n0\") {\r\n\t\t\t\t\t\t\tnode = this.createXMLNode(\"z\");\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tnode = this.createXMLNode(nodename);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\trownode.appendChild(node);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tboardnode.appendChild(rownode);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tcreateXMLNode: function(name, attrs) {\r\n\t\t\t\tvar node = this.xmldoc.createElement(name);\r\n\t\t\t\tif (!!attrs) {\r\n\t\t\t\t\tfor (var i in attrs) {\r\n\t\t\t\t\t\tnode.setAttribute(i, attrs[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn node;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n})();\r\n","// Answer.js v3.4.1\r\n\r\n//---------------------------------------------------------------------------\r\n// ★AnsCheckクラス 答えチェック関連の関数を扱う\r\n//---------------------------------------------------------------------------\r\n\r\n// 回答チェッククラス\r\n// AnsCheckクラス\r\npzpr.classmgr.makeCommon({\r\n\t//---------------------------------------------------------\r\n\tAnsCheck: {\r\n\t\tinitialize: function() {\r\n\t\t\tthis.inCheck = false;\r\n\t\t\tthis.checkOnly = false;\r\n\r\n\t\t\tthis.makeCheckList();\r\n\t\t},\r\n\t\tfailcodemode: void 0,\r\n\t\tfailcode: void 0,\r\n\t\t_info: void 0,\r\n\t\tchecklist: [],\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.makeCheckList() 最初にchecklistの配列を生成する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tmakeCheckList: function() {\r\n\t\t\t/* 当該パズルで使用しないchecklistのアイテムをフィルタリング */\r\n\t\t\tvar checklist = this.checklist,\r\n\t\t\t\torder = [];\r\n\t\t\t\torder_nw = [];\r\n\t\t\t\torder_ne = [];\r\n\t\t\t\torder_sw = [];\r\n\t\t\t\torder_se = [];\r\n\t\t\tfor (var i = 0; i < checklist.length; i++) {\r\n\t\t\t\tvar item = checklist[i],\r\n\t\t\t\t\tisexist = true,\r\n\t\t\t\t\tprio = 0;\r\n\t\t\t\tif (item.match(\"@\")) {\r\n\t\t\t\t\tisexist = pzpr.util.checkpid(\r\n\t\t\t\t\t\titem.substr(item.indexOf(\"@\") + 1),\r\n\t\t\t\t\t\tthis.puzzle.pid\r\n\t\t\t\t\t);\r\n\t\t\t\t\titem = item.substr(0, item.indexOf(\"@\"));\r\n\t\t\t\t}\r\n\t\t\t\tif (isexist) {\r\n\t\t\t\t\tprio = (item.match(/\\+/) || []).length;\r\n\t\t\t\t\titem = item.replace(/\\+/g, \"\");\r\n\t\t\t\t\torder.push([this[item], prio]);\r\n\t\t\t\t\tif (item.match(\"b\")) {\r\n\t\t\t\t\t\torder_nw.push([this[item], prio])\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (item.match(\"d\")) {\r\n\t\t\t\t\t\torder_ne.push([this[item], prio])\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (item.match(\"p\")) {\r\n\t\t\t\t\t\torder_sw.push([this[item], prio])\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (item.match(\"q\")) {\r\n\t\t\t\t\t\torder_se.push([this[item], prio])\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.checklist_normal = [];\r\n\t\t\tfor (var i = 0; i < order.length; i++) {\r\n\t\t\t\tthis.checklist_normal.push(order[i][0]);\r\n\t\t\t}\r\n\t\t\tthis.checklist_normal_nw = [];\r\n\t\t\tfor (var i = 0; i < order_nw.length; i++) {\r\n\t\t\t\tthis.checklist_normal_nw.push(order_nw[i][0]);\r\n\t\t\t}\r\n\t\t\tthis.checklist_normal_ne = [];\r\n\t\t\tfor (var i = 0; i < order_ne.length; i++) {\r\n\t\t\t\tthis.checklist_normal_ne.push(order_ne[i][0]);\r\n\t\t\t}\r\n\t\t\tthis.checklist_normal_sw = [];\r\n\t\t\tfor (var i = 0; i < order_sw.length; i++) {\r\n\t\t\t\tthis.checklist_normal_sw.push(order_sw[i][0]);\r\n\t\t\t}\r\n\t\t\tthis.checklist_normal_se = [];\r\n\t\t\tfor (var i = 0; i < order_se.length; i++) {\r\n\t\t\t\tthis.checklist_normal_se.push(order_se[i][0]);\r\n\t\t\t}\r\n\r\n\t\t\t/* autocheck用のエラーをソートする */\r\n\t\t\torder = order.sort(function(a, b) {\r\n\t\t\t\treturn b[1] - a[1];\r\n\t\t\t});\r\n\t\t\tthis.checklist_auto = [];\r\n\t\t\tfor (var i = 0; i < order.length; i++) {\r\n\t\t\t\tthis.checklist_auto.push(order[i][0]);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.check()     答えのチェックを行う\r\n\t\t// ans.checkAns()  答えのチェックを行い、エラーコードを返す(nullはNo Error)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheck: function(activemode) {\r\n\t\t\tthis.board.border.seterr(0);\r\n\t\t\tthis.board.cell.seterr(0);\r\n\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tthis.inCheck = true;\r\n\r\n\t\t\tif (!!activemode) {\r\n\t\t\t\tthis.checkOnly = false;\r\n\t\t\t\tthis.checkAns(false);\r\n\t\t\t\tpuzzle.redraw(true);\r\n\t\t\t\tif (!this.failcode.complete) {\r\n\t\t\t\t\tbd.haserror = true;\r\n\t\t\t\t /* 描画キャッシュを破棄して描画し直す */\r\n\t\t\t\t}\r\n\t\t\t} else if (this.failcode === void 0 || this.failcodemode !== activemode) {\r\n\t\t\t\t/* activemodeでなく、前回の判定結果が残っていない場合はチェックします */\r\n\t\t\t\tbd.disableSetError();\r\n\t\t\t\tthis.checkOnly = true;\r\n\t\t\t\tthis.checkAns(activemode === false);\r\n\t\t\t\tthis.failcodemode = activemode;\r\n\t\t\t\tbd.enableSetError();\r\n\t\t\t}\r\n\t\t\t/* activemodeでなく、前回の判定結果が残っている場合はそれを返します */\r\n\r\n\t\t\tthis.inCheck = false;\r\n\t\t\treturn this.failcode;\r\n\t\t},\r\n\t\tchecknw: function(activemode) {\r\n\t\t\tthis.board.border.seterr(0);\r\n\t\t\tthis.board.cell.seterr(0);\r\n\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tthis.inCheck = true;\r\n\r\n\t\t\tif (!!activemode) {\r\n\t\t\t\tthis.checkOnly = false;\r\n\t\t\t\tthis.checkAnsNW(false);\r\n\t\t\t\tpuzzle.redraw(true);\r\n\t\t\t\tif (!this.failcode.completeq) {\r\n\t\t\t\t\tbd.haserror = true;\r\n\t\t\t\t\t /* 描画キャッシュを破棄して描画し直す */\r\n\t\t\t\t}\r\n\t\t\t} else if (this.failcode === void 0 || this.failcodemode !== activemode) {\r\n\t\t\t\t/* activemodeでなく、前回の判定結果が残っていない場合はチェックします */\r\n\t\t\t\tbd.disableSetError();\r\n\t\t\t\tthis.checkOnly = true;\r\n\t\t\t\tthis.checkAnsNW(activemode === false);\r\n\t\t\t\tthis.failcodemode = activemode;\r\n\t\t\t\tbd.enableSetError();\r\n\t\t\t}\r\n\t\t\t/* activemodeでなく、前回の判定結果が残っている場合はそれを返します */\r\n\r\n\t\t\tthis.inCheck = false;\r\n\t\t\treturn this.failcode;\r\n\t\t},\r\n\t\tcheckne: function(activemode) {\r\n\t\t\tthis.board.border.seterr(0);\r\n\t\t\tthis.board.cell.seterr(0);\r\n\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tthis.inCheck = true;\r\n\r\n\t\t\tif (!!activemode) {\r\n\t\t\t\tthis.checkOnly = false;\r\n\t\t\t\tthis.checkAnsNE(false);\r\n\t\t\t\tpuzzle.redraw(true);\r\n\t\t\t\tif (!this.failcode.completeq) {\r\n\t\t\t\t\tbd.haserror = true;\r\n\t\t\t\t\t /* 描画キャッシュを破棄して描画し直す */\r\n\t\t\t\t}\r\n\t\t\t} else if (this.failcode === void 0 || this.failcodemode !== activemode) {\r\n\t\t\t\t/* activemodeでなく、前回の判定結果が残っていない場合はチェックします */\r\n\t\t\t\tbd.disableSetError();\r\n\t\t\t\tthis.checkOnly = true;\r\n\t\t\t\tthis.checkAnsNE(activemode === false);\r\n\t\t\t\tthis.failcodemode = activemode;\r\n\t\t\t\tbd.enableSetError();\r\n\t\t\t}\r\n\t\t\t/* activemodeでなく、前回の判定結果が残っている場合はそれを返します */\r\n\r\n\t\t\tthis.inCheck = false;\r\n\t\t\treturn this.failcode;\r\n\t\t},\r\n\t\tchecksw: function(activemode) {\r\n\t\t\tthis.board.border.seterr(0);\r\n\t\t\tthis.board.cell.seterr(0);\r\n\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tthis.inCheck = true;\r\n\r\n\t\t\tif (!!activemode) {\r\n\t\t\t\tthis.checkOnly = false;\r\n\t\t\t\tthis.checkAnsSW(false);\r\n\t\t\t\tpuzzle.redraw(true);\r\n\t\t\t\tif (!this.failcode.completeq) {\r\n\t\t\t\t\tbd.haserror = true;\r\n\t\t\t\t\t /* 描画キャッシュを破棄して描画し直す */\r\n\t\t\t\t}\r\n\t\t\t} else if (this.failcode === void 0 || this.failcodemode !== activemode) {\r\n\t\t\t\t/* activemodeでなく、前回の判定結果が残っていない場合はチェックします */\r\n\t\t\t\tbd.disableSetError();\r\n\t\t\t\tthis.checkOnly = true;\r\n\t\t\t\tthis.checkAnsSW(activemode === false);\r\n\t\t\t\tthis.failcodemode = activemode;\r\n\t\t\t\tbd.enableSetError();\r\n\t\t\t}\r\n\t\t\t/* activemodeでなく、前回の判定結果が残っている場合はそれを返します */\r\n\r\n\t\t\tthis.inCheck = false;\r\n\t\t\treturn this.failcode;\r\n\t\t},\r\n\t\tcheckse: function(activemode) {\r\n\t\t\tthis.board.border.seterr(0);\r\n\t\t\tthis.board.cell.seterr(0);\r\n\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tthis.inCheck = true;\r\n\r\n\t\t\tif (!!activemode) {\r\n\t\t\t\tthis.checkOnly = false;\r\n\t\t\t\tthis.checkAnsSE(false);\r\n\t\t\t\tpuzzle.redraw(true);\r\n\t\t\t\tif (!this.failcode.completeq) {\r\n\t\t\t\t\tbd.haserror = true;\r\n\t\t\t\t\t /* 描画キャッシュを破棄して描画し直す */\r\n\t\t\t\t}\r\n\t\t\t} else if (this.failcode === void 0 || this.failcodemode !== activemode) {\r\n\t\t\t\t/* activemodeでなく、前回の判定結果が残っていない場合はチェックします */\r\n\t\t\t\tbd.disableSetError();\r\n\t\t\t\tthis.checkOnly = true;\r\n\t\t\t\tthis.checkAnsSE(activemode === false);\r\n\t\t\t\tthis.failcodemode = activemode;\r\n\t\t\t\tbd.enableSetError();\r\n\t\t\t}\r\n\t\t\t/* activemodeでなく、前回の判定結果が残っている場合はそれを返します */\r\n\r\n\t\t\tthis.inCheck = false;\r\n\t\t\treturn this.failcode;\r\n\t\t},\r\n\t\tcheckAns: function(break_if_error) {\r\n\t\t\tthis.failcode = new this.klass.CheckInfo();\r\n\t\t\tvar checkSingleError =\r\n\t\t\t\t!this.puzzle.getConfig(\"multierr\") || break_if_error;\r\n\t\t\tvar checklist =\r\n\t\t\t\tthis.checkOnly && checkSingleError\r\n\t\t\t\t\t? this.checklist_auto\r\n\t\t\t\t\t: this.checklist_normal;\r\n\t\t\tfor (var i = 0; i < checklist.length; i++) {\r\n\t\t\t\tchecklist[i].call(this);\r\n\t\t\t\tif (checkSingleError && this.failcode.length > 0) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!break_if_error) {\r\n\t\t\t\tthis.failcode.text = this.failcode.gettext();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcheckAnsNW: function(break_if_error) {\r\n\t\t\tthis.failcode = new this.klass.CheckInfo();\r\n\t\t\tthis.failcode.complete = false;\r\n\t\t\tvar checkSingleError =\r\n\t\t\t\t!this.puzzle.getConfig(\"multierr\") || break_if_error;\r\n\t\t\tvar checklist = this.checklist_normal_nw;\r\n\t\t\tfor (var i = 0; i < checklist.length; i++) {\r\n\t\t\t\tchecklist[i].call(this);\r\n\t\t\t\tif (checkSingleError && this.failcode.length > 0) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!break_if_error) {\r\n\t\t\t\tthis.failcode.text = this.failcode.gettext();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcheckAnsNE: function(break_if_error) {\r\n\t\t\tthis.failcode = new this.klass.CheckInfo();\r\n\t\t\tthis.failcode.complete = false;\r\n\t\t\tvar checkSingleError =\r\n\t\t\t\t!this.puzzle.getConfig(\"multierr\") || break_if_error;\r\n\t\t\tvar checklist = this.checklist_normal_ne;\r\n\t\t\tfor (var i = 0; i < checklist.length; i++) {\r\n\t\t\t\tchecklist[i].call(this);\r\n\t\t\t\tif (checkSingleError && this.failcode.length > 0) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!break_if_error) {\r\n\t\t\t\tthis.failcode.text = this.failcode.gettext();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcheckAnsSW: function(break_if_error) {\r\n\t\t\tthis.failcode = new this.klass.CheckInfo();\r\n\t\t\tthis.failcode.complete = false;\r\n\t\t\tvar checkSingleError =\r\n\t\t\t\t!this.puzzle.getConfig(\"multierr\") || break_if_error;\r\n\t\t\tvar checklist = this.checklist_normal_sw;\r\n\t\t\tfor (var i = 0; i < checklist.length; i++) {\r\n\t\t\t\tchecklist[i].call(this);\r\n\t\t\t\tif (checkSingleError && this.failcode.length > 0) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!break_if_error) {\r\n\t\t\t\tthis.failcode.text = this.failcode.gettext();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcheckAnsSE: function(break_if_error) {\r\n\t\t\tthis.failcode = new this.klass.CheckInfo();\r\n\t\t\tthis.failcode.complete = false;\r\n\t\t\tvar checkSingleError =\r\n\t\t\t\t!this.puzzle.getConfig(\"multierr\") || break_if_error;\r\n\t\t\tvar checklist = this.checklist_normal_se;\r\n\t\t\tfor (var i = 0; i < checklist.length; i++) {\r\n\t\t\t\tchecklist[i].call(this);\r\n\t\t\t\tif (checkSingleError && this.failcode.length > 0) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!break_if_error) {\r\n\t\t\t\tthis.failcode.text = this.failcode.gettext();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.resetCache() 前回のエラー情報等を破棄する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tresetCache: function() {\r\n\t\t\tthis.failcode = this.failcodemode = void 0;\r\n\t\t\tthis._info = {};\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ★CheckInfoクラス ans.checkで返すインスタンスのクラス\r\n\t//---------------------------------------------------------------------------\r\n\tCheckInfo: {\r\n\t\tinitialize: function(code) {\r\n\t\t\tthis.add(code);\r\n\t\t},\r\n\t\tcomplete: true,\r\n\t\tcompleteq: true,\r\n\t\tundecided: false,\r\n\t\ttext: \"\",\r\n\t\tlength: 0,\r\n\t\tlastcode: null,\r\n\r\n\t\tadd: function(code) {\r\n\t\t\tif (!code) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (code !== this.lastcode) {\r\n\t\t\t\tthis[this.length++] = this.lastcode = code;\r\n\t\t\t}\r\n\t\t\tthis.complete = false;\r\n\t\t\tthis.completeq = false;\r\n\t\t},\r\n\t\tgettext: function(lang) {\r\n\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\ttextlist = puzzle.faillist,\r\n\t\t\t\ttexts = [];\r\n\t\t\tvar langcode = (lang || pzpr.lang) === \"ja\" ? 0 : 1;\r\n\t\t\tif (this.length === 0) {\r\n\t\t\t\treturn textlist.complete[langcode];\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < this.length; i++) {\r\n\t\t\t\tvar textitem = textlist[this[i]] || textlist.invalid;\r\n\t\t\t\ttexts.push(textitem[langcode]);\r\n\t\t\t}\r\n\t\t\treturn texts.join(\"\\n\");\r\n\t\t},\r\n\t\tsetUndecided: function() {\r\n\t\t\tthis.undecided = true;\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ★FailCodeクラス 答えの文字列を扱う\r\n\t//---------------------------------------------------------------------------\r\n\t// FailCodeクラス\r\n\tFailCode: {\r\n\t\tcomplete: [\"正解です！\", \"Complete!\"],\r\n\t\tinvalid: [\"不明なエラーです\", \"Invalid Error\"]\r\n\t}\r\n});\r\n","// Operation.js v3.4.1\r\n\r\n// 入力情報管理クラス\r\n// Operationクラス\r\npzpr.classmgr.makeCommon({\r\n\t//---------------------------------------------------------------------------\r\n\t// ★Operation(派生)クラス 単体の操作情報を保持する\r\n\t//---------------------------------------------------------------------------\r\n\tOperation: {\r\n\t\texternal: false,\r\n\r\n\t\tinitialize: function() {\r\n\t\t\tthis.manager = this.puzzle.opemgr;\r\n\r\n\t\t\tif (arguments.length > 0) {\r\n\t\t\t\tvar args = Array.prototype.slice.call(arguments);\r\n\t\t\t\tthis.setData.apply(this, args);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\treqReset: false,\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ope.setData()  オブジェクトのデータを設定する\r\n\t\t// ope.decode()   ファイル出力された履歴の入力用ルーチン\r\n\t\t// ope.toString() ファイル出力する履歴の出力用ルーチン\r\n\t\t// ope.toJSON()   ファイル保存時に使用するルーチン\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetData: function(old, num) {\r\n\t\t\tthis.old = old;\r\n\t\t\tthis.num = num;\r\n\t\t},\r\n\t\tdecode: function(strs) {\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\ttoString: function() {\r\n\t\t\treturn \"\";\r\n\t\t},\r\n\t\ttoJSON: function() {\r\n\t\t\treturn this.toString();\r\n\t\t},\r\n\t\tbroadcast: function() {},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ope.undo()  操作opeを一手前に戻す\r\n\t\t// ope.redo()  操作opeを一手進める\r\n\t\t// ope.exec()  操作opeを反映する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tundo: function() {\r\n\t\t\tthis.exec(this.old);\r\n\t\t},\r\n\t\tredo: function() {\r\n\t\t\tthis.exec(this.num);\r\n\t\t},\r\n\t\texec: function(num) {}\r\n\t},\r\n\r\n\t// ObjectOperationクラス\r\n\t\"ObjectOperation:Operation\": {\r\n\t\tgroup: \"\",\r\n\t\tproperty: \"\",\r\n\t\tpos: null,\r\n\r\n\t\t/* 変換テーブル */\r\n\t\tSTRGROUP: {\r\n\t\t\tC: \"cell\",\r\n\t\t\tX: \"cross\",\r\n\t\t\tB: \"border\",\r\n\t\t\tE: \"excell\"\r\n\t\t},\r\n\t\tSTRPROP: {\r\n\t\t\tU: \"ques\",\r\n\t\t\tN: \"qnum\",\r\n\t\t\tZ: \"qnum2\",\r\n\t\t\tC: \"qchar\",\r\n\t\t\tM: \"anum\",\r\n\t\t\tD: \"qdir\",\r\n\t\t\tA: \"qans\",\r\n\t\t\tS: \"qsub\",\r\n\t\t\tK: \"qcmp\",\r\n\t\t\tB: \"snum\",\r\n\t\t\tL: \"line\"\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ope.setData()  オブジェクトのデータを設定する\r\n\t\t// ope.decode()   ファイル出力された履歴の入力用ルーチン\r\n\t\t// ope.toString() ファイル出力する履歴の出力用ルーチン\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetData: function(piece, property, old, num) {\r\n\t\t\tthis.group = piece.group;\r\n\t\t\tthis.property = property;\r\n\t\t\tthis.bx = piece.bx;\r\n\t\t\tthis.by = piece.by;\r\n\t\t\tthis.old = old;\r\n\t\t\tthis.num = num;\r\n\t\t\tif (property.length > 4 && property.substr(0, 4) === \"snum\") {\r\n\t\t\t\tthis.property = \"snum\";\r\n\t\t\t\tthis.pos = property.substr(4);\r\n\t\t\t}\r\n\t\t},\r\n\t\tdecode: function(strs) {\r\n\t\t\tthis.group = this.STRGROUP[strs[0].charAt(0)];\r\n\t\t\tthis.property = this.STRPROP[strs[0].charAt(1)];\r\n\t\t\tif (!this.group || !this.property) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tthis.pos =\r\n\t\t\t\tstrs[0].substr(0, 2) === \"CB\" && strs[0].length > 2\r\n\t\t\t\t\t? +strs[0].charAt(2)\r\n\t\t\t\t\t: null;\r\n\t\t\tthis.bx = +strs[1];\r\n\t\t\tthis.by = +strs[2];\r\n\t\t\tthis.old = +strs[3];\r\n\t\t\tthis.num = +strs[4];\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\ttoString: function() {\r\n\t\t\tvar prefix = \"\";\r\n\t\t\tfor (var i in this.STRGROUP) {\r\n\t\t\t\tif (this.group === this.STRGROUP[i]) {\r\n\t\t\t\t\tprefix += i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (var i in this.STRPROP) {\r\n\t\t\t\tif (this.property === this.STRPROP[i]) {\r\n\t\t\t\t\tprefix += i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (prefix === \"CB\" && this.pos !== null) {\r\n\t\t\t\tprefix += this.pos;\r\n\t\t\t}\r\n\t\t\treturn [prefix, this.bx, this.by, this.old, this.num].join(\",\");\r\n\t\t},\r\n\t\tbroadcast: function() {\r\n\t\t\tif (this.external) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.puzzle.emit(\"cellop\", this.toJSON());\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ope.isModify()  前の履歴をこのオブジェクトで更新するかどうか確認する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tisModify: function(lastope) {\r\n\t\t\t// 前回と同じ場所なら前回の更新のみ\r\n\t\t\tvar property = this.property;\r\n\t\t\tif (\r\n\t\t\t\tlastope.group === this.group &&\r\n\t\t\t\tlastope.property === this.property &&\r\n\t\t\t\tlastope.num === this.old &&\r\n\t\t\t\tlastope.bx === this.bx &&\r\n\t\t\t\tlastope.by === this.by &&\r\n\t\t\t\t(property === \"qnum\" ||\r\n\t\t\t\t\tproperty === \"qnum2\" ||\r\n\t\t\t\t\tproperty === \"qchar\" ||\r\n\t\t\t\t\tproperty === \"anum\" ||\r\n\t\t\t\t\t(property === \"snum\" && lastope.pos === this.pos))\r\n\t\t\t) {\r\n\t\t\t\tlastope.num = this.num;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\tisNoop: function() {\r\n\t\t\treturn this.num === this.old;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ope.exec()  操作opeを反映する。ope.undo(),ope.redo()から内部的に呼ばれる\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tgetPiece: function() {\r\n\t\t\tvar bd = this.board;\r\n\t\t\treturn bd.getObjectPos(this.group, this.bx, this.by);\r\n\t\t},\r\n\t\texec: function(num) {\r\n\t\t\tvar piece = this.getPiece(),\r\n\t\t\t\tbd = this.board;\r\n\t\t\tif (this.group !== piece.group) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\t// force setting data, to bypass prehook checks\r\n\t\t\tif (this.pos === null) {\r\n\t\t\t\tpiece.setdata(this.property, num, true);\r\n\t\t\t} else {\r\n\t\t\t\tpiece.setdata2(this.property, this.pos, num, true);\r\n\t\t\t}\r\n\t\t\tpiece.draw();\r\n\r\n\t\t\tswitch (this.property) {\r\n\t\t\t\tcase \"qcmp\":\r\n\t\t\t\t\tbd.cell.each(function(cell) {\r\n\t\t\t\t\t\tif (piece === cell.base) {\r\n\t\t\t\t\t\t\tcell.draw();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthis.puzzle.checker.resetCache();\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t// BoardClearOperationクラス\r\n\t\"BoardClearOperation:Operation\": {\r\n\t\tprefix: \"AC\",\r\n\t\treqReset: true,\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ope.decode()   ファイル出力された履歴の入力用ルーチン\r\n\t\t// ope.toString() ファイル出力する履歴の出力用ルーチン\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecode: function(strs) {\r\n\t\t\tif (strs[0] !== this.prefix) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\ttoString: function() {\r\n\t\t\treturn this.prefix;\r\n\t\t}\r\n\t},\r\n\r\n\t// BoardAdjustOperationクラス\r\n\t\"BoardAdjustOperation:Operation\": {\r\n\t\tprefix: \"AJ\",\r\n\t\treqReset: true,\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ope.setData()  オブジェクトのデータを設定する\r\n\t\t// ope.decode()   ファイル出力された履歴の入力用ルーチン\r\n\t\t// ope.toString() ファイル出力する履歴の出力用ルーチン\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetData: function(name) {\r\n\t\t\tthis.old = this.num = name;\r\n\t\t},\r\n\t\tdecode: function(strs) {\r\n\t\t\tif (strs[0] !== this.prefix) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tthis.old = this.num = strs[1];\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\ttoString: function() {\r\n\t\t\treturn [this.prefix, this.num].join(\",\");\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ope.undo()  操作opeを一手前に戻す\r\n\t\t// ope.redo()  操作opeを一手進める\r\n\t\t// ope.exec()  操作opeを反映する。ope.undo(),ope.redo()から内部的に呼ばれる\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tundo: function() {\r\n\t\t\tvar key_undo = this.board.exec.boardtype[this.old][0];\r\n\t\t\tthis.exec(key_undo);\r\n\t\t},\r\n\t\tredo: function() {\r\n\t\t\tvar key_redo = this.board.exec.boardtype[this.num][1];\r\n\t\t\tthis.exec(key_redo);\r\n\t\t},\r\n\t\texec: function(num) {\r\n\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\tbd = puzzle.board,\r\n\t\t\t\td = { x1: 0, y1: 0, x2: 2 * bd.cols, y2: 2 * bd.rows };\r\n\t\t\tbd.exec.execadjust_main(num, d);\r\n\t\t\tpuzzle.redraw();\r\n\t\t}\r\n\t},\r\n\r\n\t// BoardFlipOperationクラス\r\n\t\"BoardFlipOperation:Operation\": {\r\n\t\tprefix: \"AT\",\r\n\t\treqReset: true,\r\n\t\tarea: {},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ope.setData()  オブジェクトのデータを設定する\r\n\t\t// ope.decode()   ファイル出力された履歴の入力用ルーチン\r\n\t\t// ope.toString() ファイル出力する履歴の出力用ルーチン\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetData: function(d, name) {\r\n\t\t\tthis.area = d;\r\n\t\t\tthis.old = this.num = name;\r\n\t\t},\r\n\t\tdecode: function(strs) {\r\n\t\t\tif (strs[0] !== this.prefix) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tthis.old = this.num = strs[1];\r\n\t\t\tthis.area.x1 = +strs[2];\r\n\t\t\tthis.area.y1 = +strs[3];\r\n\t\t\tthis.area.x2 = +strs[4];\r\n\t\t\tthis.area.y2 = +strs[5];\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\ttoString: function() {\r\n\t\t\tvar d = this.area;\r\n\t\t\treturn [this.prefix, this.num, d.x1, d.y1, d.x2, d.y2].join(\",\");\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ope.undo()  操作opeを一手前に戻す\r\n\t\t// ope.redo()  操作opeを一手進める\r\n\t\t// ope.exec()  操作opeを反映する。ope.undo(),ope.redo()から内部的に呼ばれる\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tundo: function() {\r\n\t\t\t// とりあえず盤面全部の対応だけ\r\n\t\t\tvar d0 = this.area,\r\n\t\t\t\td = { x1: d0.x1, y1: d0.y1, x2: d0.x2, y2: d0.y2 };\r\n\t\t\tvar key_undo = this.board.exec.boardtype[this.old][0];\r\n\t\t\tif (key_undo & this.board.exec.TURN) {\r\n\t\t\t\tvar tmp = d.x1;\r\n\t\t\t\td.x1 = d.y1;\r\n\t\t\t\td.y1 = tmp;\r\n\t\t\t\ttmp = d.x2;\r\n\t\t\t\td.x2 = d.y2;\r\n\t\t\t\td.y2 = tmp;\r\n\t\t\t}\r\n\t\t\tthis.exec(key_undo, d);\r\n\t\t},\r\n\t\tredo: function() {\r\n\t\t\t// とりあえず盤面全部の対応だけ\r\n\t\t\tvar d0 = this.area,\r\n\t\t\t\td = { x1: d0.x1, y1: d0.y1, x2: d0.x2, y2: d0.y2 };\r\n\t\t\tvar key_redo = this.board.exec.boardtype[this.num][1];\r\n\t\t\tthis.exec(key_redo, d);\r\n\t\t},\r\n\t\texec: function(num, d) {\r\n\t\t\tvar puzzle = this.puzzle;\r\n\t\t\tpuzzle.board.exec.execadjust_main(num, d);\r\n\t\t\tpuzzle.redraw();\r\n\t\t}\r\n\t},\r\n\r\n\t// TrialEnterOperationクラス\r\n\t\"TrialEnterOperation:Operation\": {\r\n\t\tsetData: function(old, num) {\r\n\t\t\tthis.old = old;\r\n\t\t\tthis.num = num;\r\n\t\t},\r\n\t\tundo: function() {\r\n\t\t\tthis.manager.position--;\r\n\t\t\tthis.manager.resumeTrial();\r\n\t\t\tthis.manager.position++;\r\n\r\n\t\t\tthis.manager.trialpos.pop();\r\n\t\t\tthis.manager.emitTrial(this.old);\r\n\t\t},\r\n\t\tredo: function() {\r\n\t\t\tthis.manager.trialpos.push(this.manager.position);\r\n\t\t\tthis.manager.emitTrial(this.num);\r\n\t\t},\r\n\r\n\t\tdecode: function(strs) {\r\n\t\t\tif (strs[0] !== \"TE\") {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tthis.old = +strs[1];\r\n\t\t\tthis.num = +strs[2];\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\ttoString: function() {\r\n\t\t\treturn [\"TE\", this.old, this.num].join(\",\");\r\n\t\t}\r\n\t},\r\n\r\n\t// TrialFinalizeOperationクラス\r\n\t\"TrialFinalizeOperation:Operation\": {\r\n\t\tnum: [],\r\n\t\tsetData: function(old) {\r\n\t\t\tthis.old = old; // trialpos array\r\n\t\t},\r\n\t\texec: function(num) {\r\n\t\t\tthis.manager.trialpos = num.concat();\r\n\t\t\tif (num.length === 0) {\r\n\t\t\t\tthis.board.trialclear();\r\n\t\t\t} else {\r\n\t\t\t\tthis.manager.position--;\r\n\t\t\t\tthis.manager.resumeTrial();\r\n\t\t\t\tthis.manager.position++;\r\n\t\t\t}\r\n\t\t\tthis.manager.emitTrial(num.length);\r\n\t\t\tthis.puzzle.redraw();\r\n\t\t},\r\n\r\n\t\tdecode: function(strs) {\r\n\t\t\tif (strs[0] !== \"TF\") {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tstrs.shift();\r\n\t\t\tthis.old = JSON.parse(strs.join(\",\"));\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\ttoString: function() {\r\n\t\t\treturn \"TF,[\" + this.old.join(\",\") + \"]\";\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ★OperationListクラス OperationのListと時刻を保持する\r\n\t//---------------------------------------------------------------------------\r\n\tOperationList: {\r\n\t\tinitialize: function() {\r\n\t\t\tthis.time = this.puzzle.getTime();\r\n\t\t\tthis.length = 0;\r\n\t\t},\r\n\t\tpush: function(ope) {\r\n\t\t\tthis[this.length++] = ope;\r\n\t\t},\r\n\t\tsome: function(func) {\r\n\t\t\treturn Array.prototype.slice.call(this).some(func);\r\n\t\t}\r\n\t\t//\ttoString : function(){\r\n\t\t//\t\treturn Array.prototype.toString.call(this);\r\n\t\t//\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ★OperationManagerクラス 操作情報を扱い、Undo/Redoの動作を実装する\r\n\t//---------------------------------------------------------------------------\r\n\t// OperationManagerクラス\r\n\tOperationManager: {\r\n\t\tinitialize: function() {\r\n\t\t\tthis.lastope = null; // this.opeの最後に追加されたOperationへのポインタ\r\n\t\t\tthis.history = []; // OperationListのオブジェクトを保持する配列\r\n\t\t\tthis.position = 0; // 現在の表示操作番号を保持する\r\n\t\t\tthis.trialpos = []; // TrialModeの位置を保持する配列\r\n\t\t\tthis.disEmitTrial = 0; // Trial eventの呼び出し有効無効フラグ\r\n\t\t\tthis.savedStarts = [];\r\n\r\n\t\t\tthis.broken = false; // \"以前の操作\"を消して元に戻れなくなった状態\r\n\t\t\tthis.initpos = 0; // 盤面初期化時のposition\r\n\r\n\t\t\tthis.disrec = 0; // このクラスからの呼び出し時は1にする\r\n\t\t\tthis.disCombine = false; // 数字がくっついてしまうので、それを一時的に無効にするためのフラグ\r\n\t\t\tthis.forceRecord = false; // 強制的に登録する(盤面縮小時限定)\r\n\t\t\tthis.changeflag = false; // 操作が行われたらtrueにする(mv.notInputted()用)\r\n\t\t\tthis.chainflag = false; // 同じope直下の配列に新しいOperationオブジェクトを追加する\r\n\r\n\t\t\tthis.enableUndo = false; // Undoできる状態か？\r\n\t\t\tthis.enableRedo = false; // Redoできる状態か？\r\n\t\t\tthis.limitTrialUndo = false; // 仮置きモードでUndoを止める状態かどうか\r\n\r\n\t\t\tthis.undoExec = false; // Undo中\r\n\t\t\tthis.redoExec = false; // Redo中\r\n\t\t\tthis.reqReset = false; // Undo/Redo時に盤面回転等が入っていた時、resize,rebuildInfo関数のcallを要求する\r\n\r\n\t\t\tthis.enableNetwork = false;\r\n\r\n\t\t\tvar classes = this.klass;\r\n\t\t\tthis.operationlist = [\r\n\t\t\t\tclasses.ObjectOperation,\r\n\t\t\t\tclasses.BoardClearOperation,\r\n\t\t\t\tclasses.BoardAdjustOperation,\r\n\t\t\t\tclasses.BoardFlipOperation,\r\n\t\t\t\tclasses.TrialEnterOperation,\r\n\t\t\t\tclasses.TrialFinalizeOperation\r\n\t\t\t];\r\n\t\t\tthis.addExtraOperation();\r\n\t\t},\r\n\t\taddExtraOperation: function() {},\r\n\r\n\t\tgetStarts: function() {\r\n\t\t\tvar starts = [];\r\n\t\t\tfor (var i = 0; i < this.trialpos.length; i++) {\r\n\t\t\t\tvar pos = this.trialpos[i];\r\n\t\t\t\t// it appears that the first input is always\r\n\t\t\t\t// at index +1\r\n\t\t\t\tif (pos + 1 < this.history.length) {\r\n\t\t\t\t\tvar ope = this.history[pos + 1][0];\r\n\t\t\t\t\tif (!!ope.getPiece) {\r\n\t\t\t\t\t\tstarts.push(ope.getPiece());\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn starts;\r\n\t\t},\r\n\t\tupdateStarts: function() {\r\n\t\t\tvar oldstarts = this.savedStarts;\r\n\t\t\tvar count;\r\n\t\t\tfor (\r\n\t\t\t\tcount = oldstarts.length;\r\n\t\t\t\tcount > 0 && oldstarts[count - 1].isnull;\r\n\t\t\t\tcount--\r\n\t\t\t) {}\r\n\r\n\t\t\tvar starts = this.getStarts();\r\n\t\t\tif (count === starts.length) {\r\n\t\t\t\t// this implies that nothing changed,\r\n\t\t\t\t// assuming updateStarts gets called regularly\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < starts.length; i++) {\r\n\t\t\t\tthis.savedStarts[i] = starts[i];\r\n\t\t\t}\r\n\t\t\t// keep the full array length around since that's what we use to\r\n\t\t\t// key the markers, hence to hide\r\n\t\t\tfor (var i = starts.length; i < this.savedStarts.length; i++) {\r\n\t\t\t\tthis.savedStarts[i] = new this.puzzle.board.klass.BoardPiece();\r\n\t\t\t}\r\n\t\t\t// this is more redraws than we need technically\r\n\t\t\tfor (var i = 0; i < oldstarts.length; i++) {\r\n\t\t\t\toldstarts[i].draw();\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < this.savedStarts.length; i++) {\r\n\t\t\t\tthis.savedStarts[i].draw();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\r\n\t\t// um.disableRecord()  操作の登録を禁止する\r\n\t\t// um.enableRecord()   操作の登録を許可する\r\n\t\t// um.checkexec()      html上の[戻][進]ボタンを押すことが可能か設定する\r\n\t\t// um.allerase()       記憶していた操作を全て破棄する\r\n\t\t// um.newOperation()   マウス、キー入力開始時に呼び出す\r\n\t\t//---------------------------------------------------------------------------\r\n\r\n\t\t// 今この関数でレコード禁止になるのは、UndoRedo時、URLdecode、fileopen、adjustGeneral/Special時\r\n\t\t// 連動して実行しなくなるのはaddOpe().\r\n\t\t//  -> ここで使っているUndo/RedoとaddOpe以外はsetQues系関数を使用しないように変更\r\n\t\t//     変な制限事項がなくなるし、動作速度にもかなり効くしね\r\n\t\tdisableRecord: function() {\r\n\t\t\tthis.disrec++;\r\n\t\t},\r\n\t\tenableRecord: function() {\r\n\t\t\tif (this.disrec > 0) {\r\n\t\t\t\tthis.disrec--;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tcheckexec: function() {\r\n\t\t\tif (this.history === void 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.checkenable();\r\n\r\n\t\t\tthis.puzzle.emit(\"history\");\r\n\t\t},\r\n\t\tatStartOfTrial: function() {\r\n\t\t\treturn (\r\n\t\t\t\tthis.trialpos.length > 0 &&\r\n\t\t\t\tthis.position <= this.trialpos[this.trialpos.length - 1] + 1\r\n\t\t\t);\r\n\t\t},\r\n\t\tcheckenable: function() {\r\n\t\t\tif (this.limitTrialUndo && this.trialpos.length > 0) {\r\n\t\t\t\tthis.enableUndo = !this.atStartOfTrial();\r\n\t\t\t} else {\r\n\t\t\t\tthis.enableUndo = this.position > 0;\r\n\t\t\t}\r\n\t\t\tthis.enableRedo = this.position < this.history.length;\r\n\r\n\t\t\tthis.board.trialstage = this.trialpos.length;\r\n\t\t},\r\n\t\tallerase: function() {\r\n\t\t\tthis.lastope = null;\r\n\t\t\tthis.history = [];\r\n\t\t\tthis.position = 0;\r\n\t\t\tthis.broken = false;\r\n\t\t\tthis.initpos = 0;\r\n\t\t\tthis.changeflag = false;\r\n\t\t\tthis.chainflag = false;\r\n\t\t\tthis.checkexec();\r\n\t\t\tthis.trialpos = [];\r\n\t\t\tthis.limitTrialUndo = false;\r\n\t\t\tthis.puzzle.checker.resetCache();\r\n\t\t},\r\n\t\tnewOperation: function() {\r\n\t\t\tthis.changeflag = false;\r\n\t\t\tthis.chainflag = false;\r\n\t\t},\r\n\t\tnewChain: function() {\r\n\t\t\tthis.chainflag = false;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// opemgr.isModified()     操作がファイル等に保存されていないか確認する\r\n\t\t// opemgr.resetModifiedState() ファイルに保存された時などに保存した状態にする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tisModified: function() {\r\n\t\t\treturn this.broken || this.initpos < this.position;\r\n\t\t},\r\n\t\tresetModifiedState: function() {\r\n\t\t\tthis.broken = false;\r\n\t\t\tthis.initpos = this.position;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// opemgr.removeDescendant()  現在以降の履歴を消去する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tremoveDescendant: function() {\r\n\t\t\tif (this.position < this.initpos) {\r\n\t\t\t\tthis.broken = true;\r\n\t\t\t}\r\n\t\t\tfor (var i = this.history.length - 1; i >= this.position; i--) {\r\n\t\t\t\tthis.history.pop();\r\n\t\t\t}\r\n\t\t\tthis.position = this.history.length;\r\n\t\t\tthis.chainflag = false;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// um.add()  指定された操作を追加する(共通操作)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tadd: function(newope) {\r\n\t\t\tif (!this.puzzle.ready || (!this.forceRecord && this.disrec > 0)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tnewope.broadcast();\r\n\r\n\t\t\t/* Undoした場所で以降の操作がある時に操作追加された場合、以降の操作は消去する */\r\n\t\t\tif (this.enableRedo) {\r\n\t\t\t\tthis.removeDescendant();\r\n\t\t\t}\r\n\r\n\t\t\t/* 前の履歴を更新するかどうか判定 */\r\n\t\t\tvar puzzle = this.puzzle;\r\n\t\t\tif (\r\n\t\t\t\tthis.disCombine ||\r\n\t\t\t\t!this.lastope ||\r\n\t\t\t\t!newope.isModify ||\r\n\t\t\t\t!newope.isModify(this.lastope)\r\n\t\t\t) {\r\n\t\t\t\t/* 履歴を追加する */\r\n\t\t\t\tif (!this.chainflag) {\r\n\t\t\t\t\tthis.history.push(new this.klass.OperationList());\r\n\t\t\t\t\tthis.position++;\r\n\t\t\t\t\tthis.chainflag = true;\r\n\t\t\t\t}\r\n\t\t\t\tthis.history[this.history.length - 1].push(newope);\r\n\t\t\t\tthis.lastope = newope;\r\n\t\t\t\tthis.updateStarts();\r\n\t\t\t} else {\r\n\t\t\t\t/* merged into previous operation, remove if noop */\r\n\t\t\t\tif (this.lastope.isNoop && this.lastope.isNoop()) {\r\n\t\t\t\t\tthis.history.pop();\r\n\t\t\t\t\tthis.position--;\r\n\t\t\t\t\tthis.lastope = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (newope.property !== \"qcmp\" && newope.property !== \"snum\") {\r\n\t\t\t\tpuzzle.checker.resetCache();\r\n\t\t\t}\r\n\t\t\tthis.changeflag = true;\r\n\t\t\tthis.checkexec();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// um.decodeHistory() オブジェクトを履歴情報に変換する\r\n\t\t// um.encodeHistory() 履歴情報をオブジェクトに変換する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeHistory: function(historyinfo) {\r\n\t\t\tthis.allerase();\r\n\r\n\t\t\tthis.initpos = this.position = historyinfo.current || 0;\r\n\t\t\tthis.history = [];\r\n\t\t\tvar datas = historyinfo.datas || [];\r\n\t\t\tfor (var i = 0, len = datas.length; i < len; i++) {\r\n\t\t\t\tvar opelist = new this.klass.OperationList();\r\n\t\t\t\tthis.history.push(opelist);\r\n\t\t\t\tvar array = datas[i];\r\n\t\t\t\tif (array.time !== void 0) {\r\n\t\t\t\t\topelist.time = array.time;\r\n\t\t\t\t\tarray = array.ope;\r\n\t\t\t\t}\r\n\t\t\t\tfor (var j = 0, len2 = array.length; j < len2; j++) {\r\n\t\t\t\t\tvar strs = array[j].split(/,/);\r\n\t\t\t\t\tvar ope = null,\r\n\t\t\t\t\t\tList = this.operationlist;\r\n\t\t\t\t\tfor (var k = 0; k < List.length; k++) {\r\n\t\t\t\t\t\tvar ope1 = new List[k]();\r\n\t\t\t\t\t\tif (ope1.decode(strs)) {\r\n\t\t\t\t\t\t\tope = ope1;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!!ope) {\r\n\t\t\t\t\t\topelist.push(ope);\r\n\t\t\t\t\t\tthis.lastope = ope;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.checkexec();\r\n\r\n\t\t\tthis.trialpos = historyinfo.trialpos || [];\r\n\t\t\tif (this.trialpos.length > 0) {\r\n\t\t\t\tthis.resumeTrial();\r\n\t\t\t\tthis.limitTrialUndo = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tencodeHistory: function(extoption) {\r\n\t\t\textoption = extoption || {};\r\n\t\t\tthis.initpos = this.position;\r\n\t\t\tvar historyinfo = {\r\n\t\t\t\ttype: \"pzpr\",\r\n\t\t\t\tversion: 0.4\r\n\t\t\t};\r\n\t\t\tif (extoption.time) {\r\n\t\t\t\thistoryinfo.time = this.puzzle.getTime();\r\n\t\t\t}\r\n\t\t\tif (this.history.length > 0) {\r\n\t\t\t\thistoryinfo.current = this.position;\r\n\t\t\t\tif (this.trialpos.length > 0) {\r\n\t\t\t\t\thistoryinfo.trialpos = this.trialpos;\r\n\t\t\t\t}\r\n\t\t\t\tvar history = [];\r\n\t\t\t\tfor (var i = 0; i < this.history.length; ++i) {\r\n\t\t\t\t\tvar array = Array.prototype.slice.call(this.history[i]);\r\n\t\t\t\t\tif (!extoption.time) {\r\n\t\t\t\t\t\thistory.push(array);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\thistory.push({ ope: array, time: this.history[i].time });\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\thistoryinfo.datas = history;\r\n\t\t\t}\r\n\t\t\treturn historyinfo;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// opemgr.undo()  Undoを実行する\r\n\t\t// opemgr.redo()  Redoを実行する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tundo: function() {\r\n\t\t\tif (!this.enableUndo) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tvar opes = this.history[this.position - 1];\r\n\t\t\tthis.reqReset = this.checkReqReset(opes);\r\n\t\t\tthis.preproc();\r\n\t\t\tthis.undoCore();\r\n\t\t\tthis.postproc();\r\n\t\t\treturn this.enableUndo;\r\n\t\t},\r\n\t\tredo: function() {\r\n\t\t\tif (!this.enableRedo) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tvar opes = this.history[this.position];\r\n\t\t\tthis.reqReset = this.checkReqReset(opes);\r\n\t\t\tthis.preproc();\r\n\t\t\tthis.redoCore();\r\n\t\t\tthis.postproc();\r\n\t\t\treturn this.enableRedo;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// opemgr.undoCore()  Undoを実行する(preproc/postprocなし)\r\n\t\t// opemgr.redoCore()  Redoを実行する(preproc/postprocなし)\r\n\t\t// opemgr.resumeGoto()  指定された履歴の位置まで移動する(preproc/postprocなし)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tundoCore: function() {\r\n\t\t\tthis.undoExec = true;\r\n\t\t\tvar opes = this.history[this.position - 1];\r\n\t\t\tfor (var i = opes.length - 1; i >= 0; i--) {\r\n\t\t\t\tif (!!opes[i]) {\r\n\t\t\t\t\topes[i].undo();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.position--;\r\n\t\t\tthis.undoExec = false;\r\n\t\t},\r\n\t\tredoCore: function() {\r\n\t\t\tthis.redoExec = true;\r\n\t\t\tvar opes = this.history[this.position];\r\n\t\t\tfor (var i = 0; i < opes.length; ++i) {\r\n\t\t\t\tif (!!opes[i]) {\r\n\t\t\t\t\topes[i].redo();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.position++;\r\n\t\t\tthis.redoExec = false;\r\n\t\t},\r\n\t\tresumeGoto: function(pos) {\r\n\t\t\tif (pos < this.position) {\r\n\t\t\t\twhile (pos < this.position) {\r\n\t\t\t\t\tthis.undoCore();\r\n\t\t\t\t}\r\n\t\t\t} else if (this.position < pos) {\r\n\t\t\t\twhile (this.position < pos) {\r\n\t\t\t\t\tthis.redoCore();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.checkenable();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// um.checkReqReset() 盤面全体に影響する処理が含まれているかどうか判定する\r\n\t\t// um.preproc()  Undo/Redo実行前の処理を行う\r\n\t\t// um.postproc() Undo/Redo実行後の処理を行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckReqReset: function(opes) {\r\n\t\t\treturn opes.some(function(ope) {\r\n\t\t\t\treturn ope.reqReset;\r\n\t\t\t});\r\n\t\t},\r\n\t\tpreproc: function(opes) {\r\n\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\tbd = puzzle.board;\r\n\t\t\tthis.disableRecord();\r\n\r\n\t\t\tpuzzle.painter.suspend();\r\n\t\t\tpuzzle.errclear();\r\n\t\t\tthis.updateStarts();\r\n\t\t\tif (this.reqReset) {\r\n\t\t\t\tbd.disableInfo();\r\n\t\t\t}\r\n\t\t},\r\n\t\tpostproc: function() {\r\n\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\tbd = puzzle.board;\r\n\t\t\tif (this.reqReset) {\r\n\t\t\t\tbd.setposAll();\r\n\t\t\t\tbd.setminmax();\r\n\t\t\t\tbd.enableInfo();\r\n\t\t\t\tbd.rebuildInfo();\r\n\t\t\t\tpuzzle.redraw(true);\r\n\t\t\t\tpuzzle.emit(\"adjust\");\r\n\t\t\t}\r\n\t\t\tpuzzle.painter.unsuspend();\r\n\r\n\t\t\tthis.enableRecord();\r\n\t\t\tthis.checkexec();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// opemgr.enterTrial()   TrialModeにする\r\n\t\t// opemgr.acceptTrial()  現在のTrial状態を確定する\r\n\t\t// opemgr.rejectTrial()  Trial状態と履歴を破棄する\r\n\t\t// opemgr.resumeTrial()  ファイル読み込み時などにTrial状態を復帰する\r\n\t\t// opemgr.emtiTrial()    trial eventを呼び出す\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tenterTrial: function() {\r\n\t\t\tif (this.atStartOfTrial()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.newOperation();\r\n\t\t\tthis.add(\r\n\t\t\t\tnew this.puzzle.klass.TrialEnterOperation(\r\n\t\t\t\t\tthis.trialpos.length,\r\n\t\t\t\t\tthis.trialpos.length + 1\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t\tthis.trialpos.push(this.position - 1);\r\n\t\t\tthis.limitTrialUndo = true;\r\n\t\t\tthis.checkexec();\r\n\t\t\tthis.newOperation();\r\n\t\t\tthis.emitTrial();\r\n\t\t},\r\n\t\tacceptTrial: function() {\r\n\t\t\tif (this.trialpos[this.trialpos.length - 1] + 1 === this.position) {\r\n\t\t\t\tthis.position--;\r\n\t\t\t\tthis.removeDescendant();\r\n\t\t\t\tthis.trialpos.pop();\r\n\t\t\t}\r\n\t\t\tif (this.trialpos.length > 0) {\r\n\t\t\t\tthis.newOperation();\r\n\t\t\t\tthis.add(new this.puzzle.klass.TrialFinalizeOperation(this.trialpos));\r\n\t\t\t\tthis.board.trialclear();\r\n\t\t\t}\r\n\t\t\tthis.trialpos = [];\r\n\t\t\tthis.limitTrialUndo = false;\r\n\t\t\tthis.removeDescendant();\r\n\t\t\tthis.checkexec();\r\n\t\t\tthis.newOperation();\r\n\t\t\tthis.emitTrial();\r\n\t\t},\r\n\t\trejectTrial: function(rejectall) {\r\n\t\t\tif (this.trialpos.length === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.disableRecord();\r\n\t\t\tthis.board.errclear();\r\n\t\t\tif (rejectall || this.trialpos.length === 1) {\r\n\t\t\t\tvar pos = this.trialpos[0];\r\n\t\t\t\tthis.board.trialclear();\r\n\t\t\t\tthis.trialpos = [];\r\n\t\t\t\tthis.limitTrialUndo = false;\r\n\t\t\t\tthis.resumeGoto(pos);\r\n\t\t\t} else {\r\n\t\t\t\tthis.resumeGoto(this.trialpos[this.trialpos.length - 1]);\r\n\t\t\t\tthis.resumeTrial();\r\n\t\t\t}\r\n\t\t\tthis.enableRecord();\r\n\t\t\tthis.removeDescendant();\r\n\t\t\tthis.checkexec();\r\n\t\t\tthis.newOperation();\r\n\t\t\tthis.emitTrial();\r\n\t\t},\r\n\t\tresumeTrial: function() {\r\n\t\t\tif (this.trialpos.length > 0) {\r\n\t\t\t\tthis.disEmitTrial++;\r\n\t\t\t\tvar pos = this.position;\r\n\t\t\t\tthis.checkenable();\r\n\t\t\t\tthis.resumeGoto(this.trialpos[0]);\r\n\t\t\t\tthis.board.trialclear(true);\r\n\t\t\t\tif (this.position < pos) {\r\n\t\t\t\t\tthis.board.trialstage = 1;\r\n\t\t\t\t\tthis.resumeGoto(pos);\r\n\t\t\t\t}\r\n\t\t\t\tthis.disEmitTrial--;\r\n\t\t\t}\r\n\t\t},\r\n\t\temitTrial: function(num) {\r\n\t\t\tif (this.disEmitTrial === 0) {\r\n\t\t\t\tthis.puzzle.emit(\"trial\", num === void 0 ? this.trialpos.length : num);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n","// GraphicCommon.js v3.4.1\r\n\r\npzpr.classmgr.makeCommon({\r\n\t//---------------------------------------------------------\r\n\tGraphic: {\r\n\t\tpaintPost: function() {\r\n\t\t\tthis.drawTrialStarts();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawQuesCells()    Cellの、境界線の上に描画される問題の黒マスをCanvasに書き込む\r\n\t\t// pc.getQuesCellColor() 問題の黒マスの設定・描画判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawQuesCells: function() {\r\n\t\t\tthis.vinc(\"cell_front\", \"crispEdges\", true);\r\n\t\t\tthis.drawCells_common(\"c_fullf_\", this.getQuesCellColor);\r\n\t\t},\r\n\t\tgetQuesCellColor: function(cell) {\r\n\t\t\t// initialize()で上書きされる\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetQuesCellColor_ques: function(cell) {\r\n\t\t\tif (cell.ques !== 1) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tif ((cell.error || cell.qinfo) === 1) {\r\n\t\t\t\treturn this.errcolor1;\r\n\t\t\t}\r\n\t\t\treturn this.quescolor;\r\n\t\t},\r\n\t\tgetQuesCellColor_qnum: function(cell) {\r\n\t\t\tif (cell.qnum === -1) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tif ((cell.error || cell.qinfo) === 1) {\r\n\t\t\t\treturn this.errcolor1;\r\n\t\t\t}\r\n\t\t\treturn this.quescolor;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawShadedCells()    Cellの、境界線の上から描画される回答の黒マスをCanvasに書き込む\r\n\t\t// pc.getShadedCellColor() 回答の黒マスの設定・描画判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawShadedCells: function() {\r\n\t\t\tthis.vinc(\"cell_shaded\", \"crispEdges\", true);\r\n\t\t\tthis.drawCells_common(\"c_fulls_\", this.getShadedCellColor);\r\n\t\t},\r\n\t\tgetShadedCellColor: function(cell) {\r\n\t\t\tif (cell.qans !== 1) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tvar info = cell.error || cell.qinfo;\r\n\t\t\tif (info === 1) {\r\n\t\t\t\treturn this.errcolor1;\r\n\t\t\t} else if (info === 2) {\r\n\t\t\t\treturn this.errcolor2;\r\n\t\t\t} else if (cell.trial) {\r\n\t\t\t\treturn this.trialcolor;\r\n\t\t\t} else if (this.puzzle.execConfig(\"irowakeblk\")) {\r\n\t\t\t\treturn cell.sblk.color;\r\n\t\t\t}\r\n\t\t\treturn this.shadecolor;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawBGCells()    Cellの、境界線の下に描画される背景色をCanvasに書き込む\r\n\t\t// pc.getBGCellColor() 背景色の設定・描画判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawBGCells: function() {\r\n\t\t\tthis.vinc(\"cell_back\", \"crispEdges\", true);\r\n\t\t\tthis.drawCells_common(\"c_fullb_\", this.getBGCellColor);\r\n\t\t},\r\n\t\tgetBGCellColor: function(cell) {\r\n\t\t\t// initialize()で上書きされる\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetBGCellColor_error1: function(cell) {\r\n\t\t\tif (cell.error === 1 || cell.qinfo === 1) {\r\n\t\t\t\treturn this.errbcolor1;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetBGCellColor_error2: function(cell) {\r\n\t\t\tvar info = cell.error || cell.qinfo;\r\n\t\t\tif (info === 1) {\r\n\t\t\t\treturn this.errbcolor1;\r\n\t\t\t} else if (info === 2) {\r\n\t\t\t\treturn this.errbcolor2;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetBGCellColor_qcmp: function(cell) {\r\n\t\t\tif (cell.error === 1 || cell.qinfo === 1) {\r\n\t\t\t\treturn this.errbcolor1;\r\n\t\t\t} else if (\r\n\t\t\t\tthis.puzzle.execConfig(\"autocmp\") &&\r\n\t\t\t\t!!cell.room &&\r\n\t\t\t\tcell.room.cmp\r\n\t\t\t) {\r\n\t\t\t\treturn this.qcmpbgcolor;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetBGCellColor_qcmp1: function(cell) {\r\n\t\t\tif (cell.error === 1 || cell.qinfo === 1) {\r\n\t\t\t\treturn this.errbcolor1;\r\n\t\t\t} else if (cell.qsub === 1) {\r\n\t\t\t\treturn this.bcolor;\r\n\t\t\t} else if (\r\n\t\t\t\tthis.puzzle.execConfig(\"autocmp\") &&\r\n\t\t\t\t!!cell.room &&\r\n\t\t\t\tcell.room.cmp\r\n\t\t\t) {\r\n\t\t\t\treturn this.qcmpbgcolor;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetBGCellColor_qsub1: function(cell) {\r\n\t\t\tif ((cell.error || cell.qinfo) === 1) {\r\n\t\t\t\treturn this.errbcolor1;\r\n\t\t\t} else if (cell.qsub === 1) {\r\n\t\t\t\treturn this.bcolor;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetBGCellColor_qsub2: function(cell) {\r\n\t\t\tthis.bcolor = \"silver\"; /* 数字入力で背景が消えないようにする応急処置 */\r\n\t\t\tif ((cell.error || cell.qinfo) === 1) {\r\n\t\t\t\treturn this.errbcolor1;\r\n\t\t\t} else if (cell.qsub === 1) {\r\n\t\t\t\treturn this.qsubcolor1;\r\n\t\t\t} else if (cell.qsub === 2) {\r\n\t\t\t\treturn this.qsubcolor2;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetBGCellColor_qsub3: function(cell) {\r\n\t\t\tif ((cell.error || cell.qinfo) === 1) {\r\n\t\t\t\treturn this.errbcolor1;\r\n\t\t\t} else if (cell.qsub === 1) {\r\n\t\t\t\treturn this.qsubcolor1;\r\n\t\t\t} else if (cell.qsub === 2) {\r\n\t\t\t\treturn this.qsubcolor2;\r\n\t\t\t} else if (cell.qsub === 3) {\r\n\t\t\t\treturn this.qsubcolor3;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetBGCellColor_icebarn: function(cell) {\r\n\t\t\tif (cell.error === 1 || cell.qinfo === 1) {\r\n\t\t\t\tif (cell.ques === 6) {\r\n\t\t\t\t\treturn this.erricecolor;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this.errbcolor1;\r\n\t\t\t\t}\r\n\t\t\t} else if (cell.ques === 6) {\r\n\t\t\t\treturn this.icecolor;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetBGCellColor_qsub4: function(cell) {\r\n\t\t\tif (cell.error === 1 || cell.qinfo === 1) {\r\n\t\t\t\treturn this.errbcolor1;\r\n\t\t\t} else if ((cell.bx % 16 < 8 && cell.by % 16 > 8) || (cell.bx % 16 > 8 && cell.by % 16 < 8)) {\r\n\t\t\t\treturn this.icecolor;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetBGCellColor_qsub5: function(cell) {\r\n\t\t\tif (cell.error === 1 || cell.qinfo === 1) {\r\n\t\t\t\treturn this.errbcolor1;\r\n\t\t\t} else if ((cell.bx % 20 < 10 && cell.by % 20 > 10) || (cell.bx % 20 > 10 && cell.by % 20 < 10)) {\r\n\t\t\t\treturn this.icecolor;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawCells_common()  drawShadedCells, drawQuesCells, drawBGCellsの共通ルーチン\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawCells_common: function(header, colorfunc) {\r\n\t\t\tvar g = this.context;\r\n\t\t\tvar clist = this.range.cells;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i],\r\n\t\t\t\t\tcolor = colorfunc.call(this, cell);\r\n\t\t\t\tg.vid = header + cell.id;\r\n\t\t\t\tif (!!color) {\r\n\t\t\t\t\tg.fillStyle = color;\r\n\t\t\t\t\tg.fillRectCenter(\r\n\t\t\t\t\t\tcell.bx * this.bw,\r\n\t\t\t\t\t\tcell.by * this.bh,\r\n\t\t\t\t\t\tthis.bw + 0.5,\r\n\t\t\t\t\t\tthis.bh + 0.5\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawBGExCells()    ExCellに描画される背景色をCanvasに書き込む\r\n\t\t// pc.getBGExCellColor() 背景色の設定・描画判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawBGExCells: function() {\r\n\t\t\tvar g = this.vinc(\"excell_back\", \"crispEdges\", true);\r\n\r\n\t\t\tvar exlist = this.range.excells;\r\n\t\t\tfor (var i = 0; i < exlist.length; i++) {\r\n\t\t\t\tvar excell = exlist[i],\r\n\t\t\t\t\tcolor = this.getBGExCellColor(excell);\r\n\r\n\t\t\t\tg.vid = \"ex_full_\" + excell.id;\r\n\t\t\t\tif (!!color) {\r\n\t\t\t\t\tg.fillStyle = color;\r\n\t\t\t\t\tg.fillRectCenter(\r\n\t\t\t\t\t\texcell.bx * this.bw,\r\n\t\t\t\t\t\texcell.by * this.bh,\r\n\t\t\t\t\t\tthis.bw + 0.5,\r\n\t\t\t\t\t\tthis.bh + 0.5\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgetBGExCellColor: function(excell) {\r\n\t\t\tif (excell.error === 1 || excell.qinfo === 1) {\r\n\t\t\t\treturn this.errbcolor1;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawDotCells()  ・だけをCanvasに書き込む\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawDotCells: function() {\r\n\t\t\tvar g = this.vinc(\"cell_dot\", \"auto\", true);\r\n\r\n\t\t\tvar dsize = Math.max(this.cw * 0.06, 2);\r\n\t\t\tvar clist = this.range.cells;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i];\r\n\r\n\t\t\t\tg.vid = \"c_dot_\" + cell.id;\r\n\t\t\t\tif (cell.isDot()) {\r\n\t\t\t\t\tg.fillStyle = !cell.trial ? this.qanscolor : this.trialcolor;\r\n\t\t\t\t\tg.fillCircle(cell.bx * this.bw, cell.by * this.bh, dsize);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawCellArrows() 矢印だけをCanvasに書き込む\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawCellArrows: function() {\r\n\t\t\tvar g = this.vinc(\"cell_arrow\", \"auto\");\r\n\t\t\tvar al, aw, tl, tw;\r\n\r\n\t\t\tif (this.pid !== \"nagare\") {\r\n\t\t\t\tal = this.cw * 0.4; // ArrowLength\r\n\t\t\t\taw = this.cw * 0.03; // ArrowWidth\r\n\t\t\t\ttl = this.cw * 0.16; // 矢じりの長さの座標(中心-長さ)\r\n\t\t\t\ttw = this.cw * 0.16; // 矢じりの幅\r\n\t\t\t} else {\r\n\t\t\t\t/* 太い矢印 */\r\n\t\t\t\tal = this.cw * 0.35; // ArrowLength\r\n\t\t\t\taw = this.cw * 0.12; // ArrowWidth\r\n\t\t\t\ttl = 0; // 矢じりの長さの座標(中心-長さ)\r\n\t\t\t\ttw = this.cw * 0.35; // 矢じりの幅\r\n\t\t\t}\r\n\t\t\taw = aw >= 1 ? aw : 1;\r\n\t\t\ttw = tw >= 5 ? tw : 5;\r\n\r\n\t\t\tvar clist = this.range.cells;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i],\r\n\t\t\t\t\tdir = !cell.numberAsObject ? cell.qdir : cell.getNum();\r\n\t\t\t\tvar color = dir >= 1 && dir <= 4 ? this.getCellArrowColor(cell) : null;\r\n\r\n\t\t\t\tg.vid = \"c_arrow_\" + cell.id;\r\n\t\t\t\tif (!!color) {\r\n\t\t\t\t\tg.fillStyle = color;\r\n\t\t\t\t\tg.beginPath();\r\n\t\t\t\t\tvar px = cell.bx * this.bw,\r\n\t\t\t\t\t\tpy = cell.by * this.bh;\r\n\t\t\t\t\tswitch (dir) {\r\n\t\t\t\t\t\tcase cell.UP:\r\n\t\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\t\tpx,\r\n\t\t\t\t\t\t\t\tpy,\r\n\t\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t\t-al,\r\n\t\t\t\t\t\t\t\t-tw,\r\n\t\t\t\t\t\t\t\t-tl,\r\n\t\t\t\t\t\t\t\t-aw,\r\n\t\t\t\t\t\t\t\t-tl,\r\n\t\t\t\t\t\t\t\t-aw,\r\n\t\t\t\t\t\t\t\tal,\r\n\t\t\t\t\t\t\t\taw,\r\n\t\t\t\t\t\t\t\tal,\r\n\t\t\t\t\t\t\t\taw,\r\n\t\t\t\t\t\t\t\t-tl,\r\n\t\t\t\t\t\t\t\ttw,\r\n\t\t\t\t\t\t\t\t-tl,\r\n\t\t\t\t\t\t\t\ttrue\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase cell.DN:\r\n\t\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\t\tpx,\r\n\t\t\t\t\t\t\t\tpy,\r\n\t\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t\tal,\r\n\t\t\t\t\t\t\t\t-tw,\r\n\t\t\t\t\t\t\t\ttl,\r\n\t\t\t\t\t\t\t\t-aw,\r\n\t\t\t\t\t\t\t\ttl,\r\n\t\t\t\t\t\t\t\t-aw,\r\n\t\t\t\t\t\t\t\t-al,\r\n\t\t\t\t\t\t\t\taw,\r\n\t\t\t\t\t\t\t\t-al,\r\n\t\t\t\t\t\t\t\taw,\r\n\t\t\t\t\t\t\t\ttl,\r\n\t\t\t\t\t\t\t\ttw,\r\n\t\t\t\t\t\t\t\ttl,\r\n\t\t\t\t\t\t\t\ttrue\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase cell.LT:\r\n\t\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\t\tpx,\r\n\t\t\t\t\t\t\t\tpy,\r\n\t\t\t\t\t\t\t\t-al,\r\n\t\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t\t-tl,\r\n\t\t\t\t\t\t\t\t-tw,\r\n\t\t\t\t\t\t\t\t-tl,\r\n\t\t\t\t\t\t\t\t-aw,\r\n\t\t\t\t\t\t\t\tal,\r\n\t\t\t\t\t\t\t\t-aw,\r\n\t\t\t\t\t\t\t\tal,\r\n\t\t\t\t\t\t\t\taw,\r\n\t\t\t\t\t\t\t\t-tl,\r\n\t\t\t\t\t\t\t\taw,\r\n\t\t\t\t\t\t\t\t-tl,\r\n\t\t\t\t\t\t\t\ttw,\r\n\t\t\t\t\t\t\t\ttrue\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase cell.RT:\r\n\t\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\t\tpx,\r\n\t\t\t\t\t\t\t\tpy,\r\n\t\t\t\t\t\t\t\tal,\r\n\t\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t\ttl,\r\n\t\t\t\t\t\t\t\t-tw,\r\n\t\t\t\t\t\t\t\ttl,\r\n\t\t\t\t\t\t\t\t-aw,\r\n\t\t\t\t\t\t\t\t-al,\r\n\t\t\t\t\t\t\t\t-aw,\r\n\t\t\t\t\t\t\t\t-al,\r\n\t\t\t\t\t\t\t\taw,\r\n\t\t\t\t\t\t\t\ttl,\r\n\t\t\t\t\t\t\t\taw,\r\n\t\t\t\t\t\t\t\ttl,\r\n\t\t\t\t\t\t\t\ttw,\r\n\t\t\t\t\t\t\t\ttrue\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tg.fill();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetCellArrowColor: function(cell) {\r\n\t\t\tvar dir = !cell.numberAsObject ? cell.qdir : cell.getNum();\r\n\t\t\tif (dir >= 1 && dir <= 4) {\r\n\t\t\t\tif (!cell.numberAsObject || cell.qnum !== -1) {\r\n\t\t\t\t\treturn this.quescolor;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn !cell.trial ? this.qanscolor : this.trialcolor;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawSlashes() 斜線をCanvasに書き込む\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawSlashes: function() {\r\n\t\t\tvar g = this.vinc(\"cell_slash\", \"auto\");\r\n\r\n\t\t\tvar basewidth = Math.max(this.bw / 4, 2);\r\n\t\t\tvar irowake = this.puzzle.execConfig(\"irowake\");\r\n\r\n\t\t\tvar clist = this.range.cells;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i];\r\n\t\t\t\tg.vid = \"c_slash_\" + cell.id;\r\n\t\t\t\tif (cell.qans !== 0) {\r\n\t\t\t\t\tvar info = cell.error || cell.qinfo,\r\n\t\t\t\t\t\taddwidth = 0,\r\n\t\t\t\t\t\tcolor;\r\n\t\t\t\t\tif (this.pid === \"gokigen\" || this.pid === \"wagiri\") {\r\n\t\t\t\t\t\tif (cell.trial && this.puzzle.execConfig(\"irowake\")) {\r\n\t\t\t\t\t\t\taddwidth = -basewidth / 2;\r\n\t\t\t\t\t\t} else if (info === 1 || info === 3) {\r\n\t\t\t\t\t\t\taddwidth = basewidth / 2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (info === 1) {\r\n\t\t\t\t\t\tcolor = this.errcolor1;\r\n\t\t\t\t\t} else if (info === 2) {\r\n\t\t\t\t\t\tcolor = this.errcolor2;\r\n\t\t\t\t\t} else if (info === -1) {\r\n\t\t\t\t\t\tcolor = this.noerrcolor;\r\n\t\t\t\t\t} else if (irowake && cell.path.color) {\r\n\t\t\t\t\t\tcolor = cell.path.color;\r\n\t\t\t\t\t} else if (cell.trial) {\r\n\t\t\t\t\t\tcolor = this.trialcolor;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcolor = \"black\";\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tg.lineWidth = basewidth + addwidth;\r\n\t\t\t\t\tg.strokeStyle = color;\r\n\t\t\t\t\tg.beginPath();\r\n\t\t\t\t\tvar px = cell.bx * this.bw,\r\n\t\t\t\t\t\tpy = cell.by * this.bh;\r\n\t\t\t\t\tif (cell.qans === 31) {\r\n\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\tpx,\r\n\t\t\t\t\t\t\tpy,\r\n\t\t\t\t\t\t\t-this.bw,\r\n\t\t\t\t\t\t\t-this.bh,\r\n\t\t\t\t\t\t\tthis.bw,\r\n\t\t\t\t\t\t\tthis.bh,\r\n\t\t\t\t\t\t\ttrue\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else if (cell.qans === 32) {\r\n\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\tpx,\r\n\t\t\t\t\t\t\tpy,\r\n\t\t\t\t\t\t\tthis.bw,\r\n\t\t\t\t\t\t\t-this.bh,\r\n\t\t\t\t\t\t\t-this.bw,\r\n\t\t\t\t\t\t\tthis.bh,\r\n\t\t\t\t\t\t\ttrue\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tg.stroke();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawQuesNumbers()  Cellの問題数字をCanvasに書き込む\r\n\t\t// pc.drawAnsNumbers()   Cellの回答数字をCanvasに書き込む\r\n\t\t// pc.drawHatenas()      ques===-2の時に？をCanvasに書き込む\r\n\t\t// pc.getQuesNumberText()  書き込む数のテキストを取得する\r\n\t\t// pc.getQuesNumberColor() 問題数字の設定・描画判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawQuesNumbers: function() {\r\n\t\t\tthis.vinc(\"cell_number\", \"auto\");\r\n\t\t\tthis.drawNumbers_com(\r\n\t\t\t\tthis.getQuesNumberText,\r\n\t\t\t\tthis.getQuesNumberColor,\r\n\t\t\t\t\"cell_text_\",\r\n\t\t\t\tthis.textoption\r\n\t\t\t);\r\n\t\t},\r\n\t\tdrawAnsNumbers: function() {\r\n\t\t\tthis.vinc(\"cell_ans_number\", \"auto\");\r\n\t\t\tthis.drawNumbers_com(\r\n\t\t\t\tthis.getAnsNumberText,\r\n\t\t\t\tthis.getAnsNumberColor,\r\n\t\t\t\t\"cell_ans_text_\",\r\n\t\t\t\t{}\r\n\t\t\t);\r\n\t\t},\r\n\t\tdrawHatenas: function() {\r\n\t\t\tfunction getQuesHatenaText(cell) {\r\n\t\t\t\treturn cell.ques === -2 || cell.qnum === -2 ? \"?\" : \"\";\r\n\t\t\t}\r\n\t\t\tthis.vinc(\"cell_number\", \"auto\");\r\n\t\t\tthis.drawNumbers_com(\r\n\t\t\t\tgetQuesHatenaText,\r\n\t\t\t\tthis.getQuesNumberColor_qnum,\r\n\t\t\t\t\"cell_text_\",\r\n\t\t\t\tthis.textoption\r\n\t\t\t);\r\n\t\t},\r\n\t\tdrawNumbers_com: function(textfunc, colorfunc, header, textoption) {\r\n\t\t\tvar g = this.context;\r\n\t\t\tvar clist = this.range.cells;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i];\r\n\t\t\t\tvar text = textfunc.call(this, cell);\r\n\t\t\t\tg.vid = header + cell.id;\r\n\t\t\t\tif (!!text) {\r\n\t\t\t\t\tg.fillStyle = colorfunc.call(this, cell);\r\n\t\t\t\t\tvar x = cell.bx * this.bw;\r\n\t\t\t\t\tvar y = cell.by * this.bh + this.getNumberVerticalOffset(cell);\r\n\t\t\t\t\tthis.disptext(text, x, y, textoption);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgetNumberVerticalOffset: function(cell) {\r\n\t\t\treturn 0;\r\n\t\t},\r\n\r\n\t\tgetQuesNumberText: function(cell) {\r\n\t\t\treturn this.getNumberText(\r\n\t\t\t\tcell,\r\n\t\t\t\t(this.puzzle.execConfig(\"dispmove\") ? cell.base : cell).qnum\r\n\t\t\t);\r\n\t\t},\r\n\t\tgetAnsNumberText: function(cell) {\r\n\t\t\treturn this.getNumberText(cell, cell.anum);\r\n\t\t},\r\n\t\tgetNumberText: function(cell, num) {\r\n\t\t\tif (!cell.numberAsLetter) {\r\n\t\t\t\treturn this.getNumberTextCore(num);\r\n\t\t\t} else {\r\n\t\t\t\treturn this.getNumberTextCore_letter(num);\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetNumberTextCore: function(num) {\r\n\t\t\tvar hideHatena =\r\n\t\t\t\tthis.pid !== \"yajilin\"\r\n\t\t\t\t\t? this.hideHatena\r\n\t\t\t\t\t: this.puzzle.getConfig(\"disptype_yajilin\") === 2;\r\n\t\t\treturn num >= 0 ? \"\" + num : !hideHatena && num === -2 ? \"?\" : \"\";\r\n\t\t},\r\n\t\tgetNumberTextCore_letter: function(num) {\r\n\t\t\tvar text = \"\" + num;\r\n\t\t\tif (num === -1) {\r\n\t\t\t\ttext = \"\";\r\n\t\t\t} else if (num === -2) {\r\n\t\t\t\ttext = \"?\";\r\n\t\t\t} else if (num > 0 && num <= 26) {\r\n\t\t\t\ttext = (num + 9).toString(36).toUpperCase();\r\n\t\t\t} else if (num > 26 && num <= 52) {\r\n\t\t\t\ttext = (num - 17).toString(36).toLowerCase();\r\n\t\t\t}\r\n\t\t\treturn text;\r\n\t\t},\r\n\r\n\t\tgetQuesNumberColor: function(cell) {\r\n\t\t\t// initialize()で上書きされる\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetQuesNumberColor_fixed: function(cell) {\r\n\t\t\treturn this.quescolor;\r\n\t\t},\r\n\t\tgetQuesNumberColor_fixed_shaded: function(cell) {\r\n\t\t\treturn this.fontShadecolor;\r\n\t\t},\r\n\t\tgetQuesNumberColor_qnum: function(cell) {\r\n\t\t\treturn (cell.error || cell.qinfo) === 1 ? this.errcolor1 : this.quescolor;\r\n\t\t},\r\n\t\tgetQuesNumberColor_move: function(cell) {\r\n\t\t\tvar puzzle = this.puzzle;\r\n\t\t\tvar info = cell.error || cell.qinfo;\r\n\t\t\tif (info === 1 || info === 4) {\r\n\t\t\t\treturn this.errcolor1;\r\n\t\t\t} else if (\r\n\t\t\t\tpuzzle.execConfig(\"dispmove\") &&\r\n\t\t\t\tpuzzle.mouse.mouseCell === cell\r\n\t\t\t) {\r\n\t\t\t\treturn this.movecolor;\r\n\t\t\t}\r\n\t\t\treturn this.quescolor;\r\n\t\t},\r\n\t\tgetQuesNumberColor_mixed: function(cell) {\r\n\t\t\tvar info = cell.error || cell.qinfo;\r\n\t\t\tif ((cell.ques >= 1 && cell.ques <= 5) || cell.qans === 1) {\r\n\t\t\t\treturn this.fontShadecolor;\r\n\t\t\t} else if (info === 1 || info === 4) {\r\n\t\t\t\treturn this.errcolor1;\r\n\t\t\t}\r\n\t\t\treturn this.quescolor;\r\n\t\t},\r\n\r\n\t\tgetAnsNumberColor: function(cell) {\r\n\t\t\tif ((cell.error || cell.qinfo) === 1) {\r\n\t\t\t\treturn this.errcolor1;\r\n\t\t\t}\r\n\t\t\treturn !cell.trial ? this.qanscolor : this.trialcolor;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawNumbersExCell()  ExCellの数字をCanvasに書き込む\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawNumbersExCell: function() {\r\n\t\t\tvar g = this.vinc(\"excell_number\", \"auto\");\r\n\r\n\t\t\tvar exlist = this.range.excells;\r\n\t\t\tfor (var i = 0; i < exlist.length; i++) {\r\n\t\t\t\tvar excell = exlist[i];\r\n\t\t\t\tvar text = this.getQuesNumberText(excell);\r\n\r\n\t\t\t\tg.vid = \"excell_text_\" + excell.id;\r\n\t\t\t\tif (!!text) {\r\n\t\t\t\t\tg.fillStyle = this.getQuesNumberColor(excell);\r\n\t\t\t\t\tthis.disptext(text, excell.bx * this.bw, excell.by * this.bh);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawSubNumbers()  Cellの補助数字をCanvasに書き込む\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawSubNumbers: function() {\r\n\t\t\tvar g = this.vinc(\"cell_subnumber\", \"auto\");\r\n\t\t\tvar posarray = [5, 4, 2, 3];\r\n\r\n\t\t\tvar clist = this.range.cells;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i];\r\n\t\t\t\tfor (var n = 0; n < 4; n++) {\r\n\t\t\t\t\tvar text = !cell.numberAsLetter\r\n\t\t\t\t\t\t? this.getNumberTextCore(cell.snum[n])\r\n\t\t\t\t\t\t: this.getNumberTextCore_letter(cell.snum[n]);\r\n\t\t\t\t\tg.vid = \"cell_subtext_\" + cell.id + \"_\" + n;\r\n\t\t\t\t\tif (!!text) {\r\n\t\t\t\t\t\tg.fillStyle = !cell.trial ? this.subcolor : this.trialcolor;\r\n\t\t\t\t\t\tthis.disptext(text, cell.bx * this.bw, cell.by * this.bh, {\r\n\t\t\t\t\t\t\tposition: posarray[n],\r\n\t\t\t\t\t\t\tratio: 0.33,\r\n\t\t\t\t\t\t\thoffset: 0.8\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tg.vhide();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawArrowNumbers() Cellの数字と矢印をCanvasに書き込む\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawArrowNumbers: function() {\r\n\t\t\tvar g = this.vinc(\"cell_arrownumber\", \"auto\");\r\n\r\n\t\t\tvar al = this.cw * 0.4; // ArrowLength\r\n\t\t\tvar aw = this.cw * 0.03; // ArrowWidth\r\n\t\t\tvar tl = this.cw * 0.16; // 矢じりの長さの座標(中心-長さ)\r\n\t\t\tvar tw = this.cw * 0.12; // 矢じりの幅\r\n\t\t\tvar dy = -this.bh * 0.6;\r\n\t\t\tvar dx = [this.bw * 0.6, this.bw * 0.7, this.bw * 0.8, this.bw * 0.85];\r\n\r\n\t\t\tvar clist = this.range.cells;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i],\r\n\t\t\t\t\tdir = cell.qdir;\r\n\t\t\t\tvar text = this.getQuesNumberText(cell);\r\n\t\t\t\tvar px = cell.bx * this.bw,\r\n\t\t\t\t\tpy = cell.by * this.bh;\r\n\t\t\t\tvar digit = text.length - 1;\r\n\r\n\t\t\t\tif (!!text) {\r\n\t\t\t\t\tg.fillStyle = this.getQuesNumberColor(cell);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 矢印の描画\r\n\t\t\t\tg.vid = \"cell_arrow_\" + cell.id;\r\n\t\t\t\tif (!!text && dir !== cell.NDIR) {\r\n\t\t\t\t\tg.beginPath();\r\n\t\t\t\t\tswitch (dir) {\r\n\t\t\t\t\t\tcase cell.UP:\r\n\t\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\t\tpx + dx[digit],\r\n\t\t\t\t\t\t\t\tpy,\r\n\t\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t\t-al,\r\n\t\t\t\t\t\t\t\t-tw,\r\n\t\t\t\t\t\t\t\t-tl,\r\n\t\t\t\t\t\t\t\t-aw,\r\n\t\t\t\t\t\t\t\t-tl,\r\n\t\t\t\t\t\t\t\t-aw,\r\n\t\t\t\t\t\t\t\tal,\r\n\t\t\t\t\t\t\t\taw,\r\n\t\t\t\t\t\t\t\tal,\r\n\t\t\t\t\t\t\t\taw,\r\n\t\t\t\t\t\t\t\t-tl,\r\n\t\t\t\t\t\t\t\ttw,\r\n\t\t\t\t\t\t\t\t-tl,\r\n\t\t\t\t\t\t\t\ttrue\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase cell.DN:\r\n\t\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\t\tpx + dx[digit],\r\n\t\t\t\t\t\t\t\tpy,\r\n\t\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t\tal,\r\n\t\t\t\t\t\t\t\t-tw,\r\n\t\t\t\t\t\t\t\ttl,\r\n\t\t\t\t\t\t\t\t-aw,\r\n\t\t\t\t\t\t\t\ttl,\r\n\t\t\t\t\t\t\t\t-aw,\r\n\t\t\t\t\t\t\t\t-al,\r\n\t\t\t\t\t\t\t\taw,\r\n\t\t\t\t\t\t\t\t-al,\r\n\t\t\t\t\t\t\t\taw,\r\n\t\t\t\t\t\t\t\ttl,\r\n\t\t\t\t\t\t\t\ttw,\r\n\t\t\t\t\t\t\t\ttl,\r\n\t\t\t\t\t\t\t\ttrue\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase cell.LT:\r\n\t\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\t\tpx,\r\n\t\t\t\t\t\t\t\tpy + dy,\r\n\t\t\t\t\t\t\t\t-al,\r\n\t\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t\t-tl,\r\n\t\t\t\t\t\t\t\t-tw,\r\n\t\t\t\t\t\t\t\t-tl,\r\n\t\t\t\t\t\t\t\t-aw,\r\n\t\t\t\t\t\t\t\tal,\r\n\t\t\t\t\t\t\t\t-aw,\r\n\t\t\t\t\t\t\t\tal,\r\n\t\t\t\t\t\t\t\taw,\r\n\t\t\t\t\t\t\t\t-tl,\r\n\t\t\t\t\t\t\t\taw,\r\n\t\t\t\t\t\t\t\t-tl,\r\n\t\t\t\t\t\t\t\ttw,\r\n\t\t\t\t\t\t\t\ttrue\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase cell.RT:\r\n\t\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\t\tpx,\r\n\t\t\t\t\t\t\t\tpy + dy,\r\n\t\t\t\t\t\t\t\tal,\r\n\t\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t\ttl,\r\n\t\t\t\t\t\t\t\t-tw,\r\n\t\t\t\t\t\t\t\ttl,\r\n\t\t\t\t\t\t\t\t-aw,\r\n\t\t\t\t\t\t\t\t-al,\r\n\t\t\t\t\t\t\t\t-aw,\r\n\t\t\t\t\t\t\t\t-al,\r\n\t\t\t\t\t\t\t\taw,\r\n\t\t\t\t\t\t\t\ttl,\r\n\t\t\t\t\t\t\t\taw,\r\n\t\t\t\t\t\t\t\ttl,\r\n\t\t\t\t\t\t\t\ttw,\r\n\t\t\t\t\t\t\t\ttrue\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tg.fill();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 数字の描画\r\n\t\t\t\tg.vid = \"cell_arnum_\" + cell.id;\r\n\t\t\t\tif (!!text) {\r\n\t\t\t\t\tvar option = { ratio: 0.8 };\r\n\t\t\t\t\tif (dir !== cell.NDIR) {\r\n\t\t\t\t\t\toption.ratio = 0.7;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (dir === cell.UP || dir === cell.DN) {\r\n\t\t\t\t\t\tpx -= this.cw * 0.1;\r\n\t\t\t\t\t} else if (dir === cell.LT || dir === cell.RT) {\r\n\t\t\t\t\t\tpy += this.ch * 0.1;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.disptext(text, px, py, option);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawCircledNumbers() Cell上の丸数字をCanvasに書き込む\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawCircledNumbers: function() {\r\n\t\t\tthis.drawCircles();\r\n\r\n\t\t\tthis.vinc(\"cell_number\", \"auto\");\r\n\t\t\tthis.drawNumbers_com(\r\n\t\t\t\tthis.getQuesNumberText,\r\n\t\t\t\tthis.getQuesNumberColor,\r\n\t\t\t\t\"cell_text_\",\r\n\t\t\t\t{ ratio: 0.65 }\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawTapaNumbers() draw Tapa-like clues\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawTapaNumbers: function() {\r\n\t\t\tvar g = this.vinc(\"cell_tapanum\", \"auto\");\r\n\t\t\tvar bw = this.bw,\r\n\t\t\t\tbh = this.bh;\r\n\t\t\tvar opts = [\r\n\t\t\t\t{ option: {}, pos: [{ x: 0, y: 0 }] },\r\n\t\t\t\t{\r\n\t\t\t\t\toption: { ratio: 0.56 },\r\n\t\t\t\t\tpos: [\r\n\t\t\t\t\t\t{ x: -0.4, y: -0.4 },\r\n\t\t\t\t\t\t{ x: 0.4, y: 0.4 }\r\n\t\t\t\t\t]\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\toption: { ratio: 0.48 },\r\n\t\t\t\t\tpos: [\r\n\t\t\t\t\t\t{ x: -0.5, y: -0.4 },\r\n\t\t\t\t\t\t{ x: 0.5, y: -0.4 },\r\n\t\t\t\t\t\t{ x: 0, y: 0.4 }\r\n\t\t\t\t\t]\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\toption: { ratio: 0.4 },\r\n\t\t\t\t\tpos: [\r\n\t\t\t\t\t\t{ x: -0.55, y: 0 },\r\n\t\t\t\t\t\t{ x: 0, y: -0.5 },\r\n\t\t\t\t\t\t{ x: 0.55, y: 0 },\r\n\t\t\t\t\t\t{ x: 0, y: 0.5 }\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t];\r\n\r\n\t\t\tvar clist = this.range.cells;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i],\r\n\t\t\t\t\tbx = cell.bx,\r\n\t\t\t\t\tby = cell.by;\r\n\t\t\t\tvar nums = cell.qnums,\r\n\t\t\t\t\tn = nums.length;\r\n\r\n\t\t\t\tg.fillStyle = this.getQuesNumberColor(cell);\r\n\t\t\t\tfor (var k = 0; k < 4; k++) {\r\n\t\t\t\t\tg.vid = \"cell_text_\" + cell.id + \"_\" + k;\r\n\t\t\t\t\tif (k < n && nums[k] !== -1) {\r\n\t\t\t\t\t\tvar opt = opts[n - 1],\r\n\t\t\t\t\t\t\tpx = (bx + opt.pos[k].x) * bw,\r\n\t\t\t\t\t\t\tpy = (by + opt.pos[k].y) * bh;\r\n\t\t\t\t\t\tvar text = nums[k] >= 0 ? \"\" + nums[k] : \"?\";\r\n\t\t\t\t\t\tthis.disptext(text, px, py, opt.option);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tg.vhide();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawCrosses()    Crossの丸数字をCanvasに書き込む\r\n\t\t// pc.drawCrossMarks() Cross上の黒点をCanvasに書き込む\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawCrosses: function() {\r\n\t\t\tvar g = this.vinc(\"cross_base\", \"auto\", true);\r\n\r\n\t\t\tvar csize = this.cw * this.crosssize + 1;\r\n\t\t\tg.lineWidth = 1;\r\n\r\n\t\t\tvar option = { ratio: 0.6 };\r\n\t\t\tvar clist = this.range.crosses;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cross = clist[i],\r\n\t\t\t\t\tpx = cross.bx * this.bw,\r\n\t\t\t\t\tpy = cross.by * this.bh;\r\n\r\n\t\t\t\t// ○の描画\r\n\t\t\t\tg.vid = \"x_cp_\" + cross.id;\r\n\t\t\t\tif (cross.qnum !== -1) {\r\n\t\t\t\t\tg.fillStyle =\r\n\t\t\t\t\t\tcross.error === 1 || cross.qinfo === 1 ? this.errcolor1 : \"white\";\r\n\t\t\t\t\tg.strokeStyle = \"black\";\r\n\t\t\t\t\tg.shapeCircle(px, py, csize);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 数字の描画\r\n\t\t\t\tg.vid = \"cross_text_\" + cross.id;\r\n\t\t\t\tif (cross.qnum >= 0) {\r\n\t\t\t\t\tg.fillStyle = this.quescolor;\r\n\t\t\t\t\tthis.disptext(\"\" + cross.qnum, px, py, option);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tdrawCrossMarks: function() {\r\n\t\t\tvar g = this.vinc(\"cross_mark\", \"auto\", true);\r\n\r\n\t\t\tvar csize = this.cw * this.crosssize;\r\n\t\t\tvar clist = this.range.crosses;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cross = clist[i];\r\n\r\n\t\t\t\tg.vid = \"x_cm_\" + cross.id;\r\n\t\t\t\tif (cross.qnum === 1) {\r\n\t\t\t\t\tg.fillStyle =\r\n\t\t\t\t\t\tcross.error === 1 || cross.qinfo === 1\r\n\t\t\t\t\t\t\t? this.errcolor1\r\n\t\t\t\t\t\t\t: this.quescolor;\r\n\t\t\t\t\tg.fillCircle(cross.bx * this.bw, cross.by * this.bh, csize);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawBorders()        境界線をCanvasに書き込む\r\n\t\t// pc.drawBorders_common() 境界線をCanvasに書き込む(共通処理)\r\n\t\t// pc.getBorderColor()     境界線の設定・描画判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawBorders: function() {\r\n\t\t\tthis.vinc(\"border\", \"crispEdges\", true);\r\n\t\t\tthis.drawBorders_common(\"b_bd_\");\r\n\t\t},\r\n\t\tdrawBorders_common: function(header) {\r\n\t\t\tvar g = this.context;\r\n\r\n\t\t\tvar blist = this.range.borders;\r\n\t\t\tfor (var i = 0; i < blist.length; i++) {\r\n\t\t\t\tvar border = blist[i],\r\n\t\t\t\t\tcolor = this.getBorderColor(border);\r\n\r\n\t\t\t\tg.vid = header + border.id;\r\n\t\t\t\tif (!!color) {\r\n\t\t\t\t\tvar px = border.bx * this.bw,\r\n\t\t\t\t\t\tpy = border.by * this.bh;\r\n\t\t\t\t\tvar lm = (this.lw + this.addlw) / 2;\r\n\t\t\t\t\tg.fillStyle = color;\r\n\t\t\t\t\tif (border.isVert()) {\r\n\t\t\t\t\t\tg.fillRectCenter(px, py, lm, this.bh + lm);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tg.fillRectCenter(px, py, this.bw + lm, lm);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgetBorderColor: function(border) {\r\n\t\t\t// initialize()で上書きされる\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetBorderColor_ques: function(border) {\r\n\t\t\tif (border.isBorder()) {\r\n\t\t\t\treturn this.quescolor;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetBorderColor_qans: function(border) {\r\n\t\t\tvar err = border.error || border.qinfo;\r\n\t\t\tif (border.isBorder()) {\r\n\t\t\t\tif (err === 1) {\r\n\t\t\t\t\treturn this.errcolor1;\r\n\t\t\t\t} else if (err === -1) {\r\n\t\t\t\t\treturn this.noerrcolor;\r\n\t\t\t\t} else if (border.trial) {\r\n\t\t\t\t\treturn this.trialcolor;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this.qanscolor;\r\n\t\t\t\t}\r\n\t\t\t} else if (!!border.isCmp && border.isCmp()) {\r\n\t\t\t\treturn this.qcmpcolor;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetBorderColor_ice: function(border) {\r\n\t\t\tvar cell1 = border.sidecell[0],\r\n\t\t\t\tcell2 = border.sidecell[1];\r\n\t\t\tif (\r\n\t\t\t\tborder.inside &&\r\n\t\t\t\t!cell1.isnull &&\r\n\t\t\t\t!cell2.isnull &&\r\n\t\t\t\tcell1.ice() ^ cell2.ice()\r\n\t\t\t) {\r\n\t\t\t\treturn this.quescolor;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawQansBorders()    問題の境界線をCanvasに書き込む\r\n\t\t// pc.drawQuesBorders()    回答の境界線をCanvasに書き込む\r\n\t\t// pc.getQuesBorderColor() 問題の境界線の設定・描画判定する\r\n\t\t// pc.getQansBorderColor() 回答の境界線の設定・描画判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawQuesBorders: function() {\r\n\t\t\tthis.vinc(\"border_question\", \"crispEdges\", true);\r\n\t\t\tthis.getBorderColor = this.getQuesBorderColor;\r\n\t\t\tthis.drawBorders_common(\"b_bdques_\");\r\n\t\t},\r\n\t\tdrawQansBorders: function() {\r\n\t\t\tthis.vinc(\"border_answer\", \"crispEdges\", true);\r\n\t\t\tthis.getBorderColor = this.getQansBorderColor;\r\n\t\t\tthis.drawBorders_common(\"b_bdans_\");\r\n\t\t},\r\n\t\tgetQuesBorderColor: function(border) {\r\n\t\t\tif (border.ques >= 1) {\r\n\t\t\t\treturn this.getBorderColor_ques(border);\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetQansBorderColor: function(border) {\r\n\t\t\tif (border.qans >= 1) {\r\n\t\t\t\treturn this.getBorderColor_qans(border);\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawBorderQsubs() 境界線用の補助記号をCanvasに書き込む\r\n\t\t// pc.drawBoxBorders()  境界線と黒マスの間の線を描画する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawBorderQsubs: function() {\r\n\t\t\tvar g = this.vinc(\"border_qsub\", \"crispEdges\", true);\r\n\r\n\t\t\tvar m = this.cw * 0.15; //Margin\r\n\t\t\tvar blist = this.range.borders;\r\n\t\t\tfor (var i = 0; i < blist.length; i++) {\r\n\t\t\t\tvar border = blist[i];\r\n\r\n\t\t\t\tg.vid = \"b_qsub1_\" + border.id;\r\n\t\t\t\tif (border.qsub === 1) {\r\n\t\t\t\t\tvar px = border.bx * this.bw,\r\n\t\t\t\t\t\tpy = border.by * this.bh;\r\n\t\t\t\t\tg.fillStyle = !border.trial ? this.pekecolor : this.trialcolor;\r\n\t\t\t\t\tif (border.isHorz()) {\r\n\t\t\t\t\t\tg.fillRectCenter(px, py, 0.5, this.bh - m);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tg.fillRectCenter(px, py, this.bw - m, 0.5);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// 外枠がない場合は考慮していません\r\n\t\tdrawBoxBorders: function(tileflag) {\r\n\t\t\tvar g = this.vinc(\"boxborder\", \"crispEdges\");\r\n\r\n\t\t\tvar lm = this.lm;\r\n\t\t\tvar cw = this.cw;\r\n\t\t\tvar ch = this.ch;\r\n\r\n\t\t\tg.strokeStyle = this.bbcolor;\r\n\t\t\tg.lineWidth = 1;\r\n\r\n\t\t\tvar clist = this.range.cells;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i],\r\n\t\t\t\t\tisdraw = cell.qans === 1;\r\n\t\t\t\tif (this.pid === \"stostone\" && this.board.falling) {\r\n\t\t\t\t\tisdraw = false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tg.vid = \"c_bb_\" + cell.id;\r\n\t\t\t\tif (isdraw) {\r\n\t\t\t\t\tvar px = (cell.bx - 1) * this.bw,\r\n\t\t\t\t\t\tpy = (cell.by - 1) * this.bh;\r\n\t\t\t\t\tvar px0 = px - 0.5,\r\n\t\t\t\t\t\tpx1 = px + lm + 0.5,\r\n\t\t\t\t\t\tpx2 = px + cw - lm - 0.5,\r\n\t\t\t\t\t\tpx3 = px + cw + 0.5;\r\n\t\t\t\t\tvar py0 = py - 0.5,\r\n\t\t\t\t\t\tpy1 = py + lm + 0.5,\r\n\t\t\t\t\t\tpy2 = py + ch - lm - 0.5,\r\n\t\t\t\t\t\tpy3 = py + ch + 0.5;\r\n\r\n\t\t\t\t\t// この関数を呼ぶ場合は全てhasborder===1なので\r\n\t\t\t\t\t// 外枠用の考慮部分を削除しています。\r\n\t\t\t\t\tvar adb = cell.adjborder;\r\n\t\t\t\t\tvar UPin = cell.by > 2,\r\n\t\t\t\t\t\tDNin = cell.by < 2 * this.board.rows - 2;\r\n\t\t\t\t\tvar LTin = cell.bx > 2,\r\n\t\t\t\t\t\tRTin = cell.bx < 2 * this.board.cols - 2;\r\n\r\n\t\t\t\t\tvar isUP = !UPin || adb.top.ques === 1;\r\n\t\t\t\t\tvar isDN = !DNin || adb.bottom.ques === 1;\r\n\t\t\t\t\tvar isLT = !LTin || adb.left.ques === 1;\r\n\t\t\t\t\tvar isRT = !RTin || adb.right.ques === 1;\r\n\r\n\t\t\t\t\tvar isUL =\r\n\t\t\t\t\t\t!UPin ||\r\n\t\t\t\t\t\t!LTin ||\r\n\t\t\t\t\t\tcell.relbd(-2, -1).ques === 1 ||\r\n\t\t\t\t\t\tcell.relbd(-1, -2).ques === 1;\r\n\t\t\t\t\tvar isUR =\r\n\t\t\t\t\t\t!UPin ||\r\n\t\t\t\t\t\t!RTin ||\r\n\t\t\t\t\t\tcell.relbd(2, -1).ques === 1 ||\r\n\t\t\t\t\t\tcell.relbd(1, -2).ques === 1;\r\n\t\t\t\t\tvar isDL =\r\n\t\t\t\t\t\t!DNin ||\r\n\t\t\t\t\t\t!LTin ||\r\n\t\t\t\t\t\tcell.relbd(-2, 1).ques === 1 ||\r\n\t\t\t\t\t\tcell.relbd(-1, 2).ques === 1;\r\n\t\t\t\t\tvar isDR =\r\n\t\t\t\t\t\t!DNin ||\r\n\t\t\t\t\t\t!RTin ||\r\n\t\t\t\t\t\tcell.relbd(2, 1).ques === 1 ||\r\n\t\t\t\t\t\tcell.relbd(1, 2).ques === 1;\r\n\r\n\t\t\t\t\tg.beginPath();\r\n\r\n\t\t\t\t\tif (isUP || isUL) {\r\n\t\t\t\t\t\tg.moveTo(px1, py1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!isUP && isUL) {\r\n\t\t\t\t\t\tg.lineTo(px1, py0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!isUP && isUR) {\r\n\t\t\t\t\t\tg.moveTo(px2, py0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (isUP || isUR) {\r\n\t\t\t\t\t\tg.lineTo(px2, py1);\r\n\t\t\t\t\t} else if (isRT || isUR) {\r\n\t\t\t\t\t\tg.moveTo(px2, py1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!isRT && isUR) {\r\n\t\t\t\t\t\tg.lineTo(px3, py1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!isRT && isDR) {\r\n\t\t\t\t\t\tg.moveTo(px3, py2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (isRT || isDR) {\r\n\t\t\t\t\t\tg.lineTo(px2, py2);\r\n\t\t\t\t\t} else if (isDN || isDR) {\r\n\t\t\t\t\t\tg.moveTo(px2, py2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!isDN && isDR) {\r\n\t\t\t\t\t\tg.lineTo(px2, py3);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!isDN && isDL) {\r\n\t\t\t\t\t\tg.moveTo(px1, py3);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (isDN || isDL) {\r\n\t\t\t\t\t\tg.lineTo(px1, py2);\r\n\t\t\t\t\t} else if (isLT || isDL) {\r\n\t\t\t\t\t\tg.moveTo(px1, py2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!isLT && isDL) {\r\n\t\t\t\t\t\tg.lineTo(px0, py2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!isLT && isUL) {\r\n\t\t\t\t\t\tg.moveTo(px0, py1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (isLT || isUL) {\r\n\t\t\t\t\t\tg.lineTo(px1, py1);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tg.stroke();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawLines()    回答の線をCanvasに書き込む\r\n\t\t// pc.getLineColor() 描画する線の色を設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawLines: function() {\r\n\t\t\tvar g = this.vinc(\"line\", \"crispEdges\");\r\n\r\n\t\t\tvar blist = this.range.borders;\r\n\t\t\tfor (var i = 0; i < blist.length; i++) {\r\n\t\t\t\tvar border = blist[i],\r\n\t\t\t\t\tcolor = this.getLineColor(border);\r\n\r\n\t\t\t\tg.vid = \"b_line_\" + border.id;\r\n\t\t\t\tif (!!color) {\r\n\t\t\t\t\tvar px = border.bx * this.bw,\r\n\t\t\t\t\t\tpy = border.by * this.bh;\r\n\t\t\t\t\tvar isvert = this.board.borderAsLine === border.isVert();\r\n\t\t\t\t\tvar lm = this.lm + this.addlw / 2;\r\n\r\n\t\t\t\t\tg.fillStyle = color;\r\n\t\t\t\t\tif (isvert) {\r\n\t\t\t\t\t\tg.fillRectCenter(px, py, lm, this.bh + lm);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tg.fillRectCenter(px, py, this.bw + lm, lm);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.addlw = 0;\r\n\t\t},\r\n\t\tgetLineColor: function(border) {\r\n\t\t\tthis.addlw = 0;\r\n\t\t\tif (border.isLine()) {\r\n\t\t\t\tvar info = border.error || border.qinfo,\r\n\t\t\t\t\tpuzzle = this.puzzle;\r\n\t\t\t\tvar isIrowake =\r\n\t\t\t\t\tpuzzle.execConfig(\"irowake\") && border.path && border.path.color;\r\n\t\t\t\tvar isDispmove = puzzle.execConfig(\"dispmove\");\r\n\r\n\t\t\t\tif (border.trial && puzzle.execConfig(\"irowake\")) {\r\n\t\t\t\t\tthis.addlw = -this.lm;\r\n\t\t\t\t} else if (info === 1) {\r\n\t\t\t\t\tthis.addlw = 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (info === 1) {\r\n\t\t\t\t\treturn this.errlinecolor;\r\n\t\t\t\t} else if (info === -1) {\r\n\t\t\t\t\treturn this.noerrcolor;\r\n\t\t\t\t} else if (isDispmove) {\r\n\t\t\t\t\treturn border.trial ? this.movetrialcolor : this.movelinecolor;\r\n\t\t\t\t} else if (isIrowake) {\r\n\t\t\t\t\treturn border.path.color;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn border.trial ? this.trialcolor : this.linecolor;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawTip()    動いたことを示す矢印のやじりを書き込む\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawTip: function() {\r\n\t\t\tvar g = this.vinc(\"cell_linetip\", \"auto\");\r\n\r\n\t\t\tvar tsize = this.cw * 0.3;\r\n\t\t\tvar tplus = this.cw * 0.05;\r\n\r\n\t\t\tvar clist = this.range.cells;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i],\r\n\t\t\t\t\tdir = 0,\r\n\t\t\t\t\tborder = null;\r\n\t\t\t\tif (\r\n\t\t\t\t\tcell.lcnt === 1 &&\r\n\t\t\t\t\tcell.qnum === -1 &&\r\n\t\t\t\t\t!this.puzzle.execConfig(\"dispmove\")\r\n\t\t\t\t) {\r\n\t\t\t\t\tvar adb = cell.adjborder;\r\n\t\t\t\t\tif (adb.top.isLine()) {\r\n\t\t\t\t\t\tdir = 2;\r\n\t\t\t\t\t\tborder = adb.top;\r\n\t\t\t\t\t} else if (adb.bottom.isLine()) {\r\n\t\t\t\t\t\tdir = 1;\r\n\t\t\t\t\t\tborder = adb.bottom;\r\n\t\t\t\t\t} else if (adb.left.isLine()) {\r\n\t\t\t\t\t\tdir = 4;\r\n\t\t\t\t\t\tborder = adb.left;\r\n\t\t\t\t\t} else if (adb.right.isLine()) {\r\n\t\t\t\t\t\tdir = 3;\r\n\t\t\t\t\t\tborder = adb.right;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tg.vid = \"c_tip_\" + cell.id;\r\n\t\t\t\tif (dir !== 0) {\r\n\t\t\t\t\tg.strokeStyle = this.getLineColor(border) || this.linecolor;\r\n\t\t\t\t\tg.lineWidth = this.lw + this.addlw; //LineWidth\r\n\r\n\t\t\t\t\tg.beginPath();\r\n\t\t\t\t\tvar px = cell.bx * this.bw + 1,\r\n\t\t\t\t\t\tpy = cell.by * this.bh + 1;\r\n\t\t\t\t\tif (dir === 1) {\r\n\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\tpx,\r\n\t\t\t\t\t\t\tpy,\r\n\t\t\t\t\t\t\t-tsize,\r\n\t\t\t\t\t\t\ttsize,\r\n\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t-tplus,\r\n\t\t\t\t\t\t\ttsize,\r\n\t\t\t\t\t\t\ttsize,\r\n\t\t\t\t\t\t\tfalse\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else if (dir === 2) {\r\n\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\tpx,\r\n\t\t\t\t\t\t\tpy,\r\n\t\t\t\t\t\t\t-tsize,\r\n\t\t\t\t\t\t\t-tsize,\r\n\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\ttplus,\r\n\t\t\t\t\t\t\ttsize,\r\n\t\t\t\t\t\t\t-tsize,\r\n\t\t\t\t\t\t\tfalse\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else if (dir === 3) {\r\n\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\tpx,\r\n\t\t\t\t\t\t\tpy,\r\n\t\t\t\t\t\t\ttsize,\r\n\t\t\t\t\t\t\t-tsize,\r\n\t\t\t\t\t\t\t-tplus,\r\n\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\ttsize,\r\n\t\t\t\t\t\t\ttsize,\r\n\t\t\t\t\t\t\tfalse\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else if (dir === 4) {\r\n\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\tpx,\r\n\t\t\t\t\t\t\tpy,\r\n\t\t\t\t\t\t\t-tsize,\r\n\t\t\t\t\t\t\t-tsize,\r\n\t\t\t\t\t\t\ttplus,\r\n\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t-tsize,\r\n\t\t\t\t\t\t\ttsize,\r\n\t\t\t\t\t\t\tfalse\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tg.stroke();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawPekes()    境界線上の×をCanvasに書き込む\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawPekes: function() {\r\n\t\t\tvar g = this.vinc(\"border_peke\", \"auto\", true);\r\n\r\n\t\t\tvar size = this.cw * 0.15 + 1;\r\n\t\t\tif (size < 4) {\r\n\t\t\t\tsize = 4;\r\n\t\t\t}\r\n\t\t\tg.lineWidth = (1 + this.cw / 40) | 0;\r\n\r\n\t\t\tvar blist = this.range.borders;\r\n\t\t\tfor (var i = 0; i < blist.length; i++) {\r\n\t\t\t\tvar border = blist[i];\r\n\t\t\t\tg.vid = \"b_peke_\" + border.id;\r\n\t\t\t\tif (border.qsub === 2) {\r\n\t\t\t\t\tg.strokeStyle = !border.trial ? this.pekecolor : this.trialcolor;\r\n\t\t\t\t\tg.strokeCross(border.bx * this.bw, border.by * this.bh, size - 1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawBaseMarks() 交点のdotをCanvasに書き込む\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawBaseMarks: function() {\r\n\t\t\tvar g = this.vinc(\"cross_mark\", \"auto\", true);\r\n\t\t\tg.fillStyle = this.quescolor;\r\n\r\n\t\t\tvar size = this.cw / 10;\r\n\t\t\tvar clist = this.range.crosses;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cross = clist[i];\r\n\t\t\t\tg.vid = \"x_cm_\" + cross.id;\r\n\t\t\t\tg.fillCircle(cross.bx * this.bw, cross.by * this.bh, size / 2);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawTriangle()   三角形をCanvasに書き込む\r\n\t\t// pc.drawTriangle1()  三角形をCanvasに書き込む(1マスのみ)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawTriangle: function() {\r\n\t\t\tvar g = this.vinc(\"cell_triangle\", \"crispEdges\");\r\n\r\n\t\t\tvar clist = this.range.cells;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i],\r\n\t\t\t\t\tnum = cell.ques !== 0 ? cell.ques : cell.qans;\r\n\r\n\t\t\t\tg.vid = \"c_tri_\" + cell.id;\r\n\t\t\t\tif (num >= 2 && num <= 5) {\r\n\t\t\t\t\tg.fillStyle = this.getTriangleColor(cell);\r\n\t\t\t\t\tthis.drawTriangle1(cell.bx * this.bw, cell.by * this.bh, num);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetTriangleColor: function(cell) {\r\n\t\t\treturn this.quescolor;\r\n\t\t},\r\n\t\tdrawTriangle1: function(px, py, num) {\r\n\t\t\tvar g = this.context;\r\n\t\t\tvar mgn = this.pid === \"reflect\" ? 1 : 0.5,\r\n\t\t\t\tbw = this.bw + 1 - mgn,\r\n\t\t\t\tbh = this.bh + 1 - mgn;\r\n\t\t\tg.beginPath();\r\n\t\t\tswitch (num) {\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tg.setOffsetLinePath(px, py, -bw, -bh, -bw, bh, bw, bh, true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tg.setOffsetLinePath(px, py, bw, -bh, -bw, bh, bw, bh, true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 4:\r\n\t\t\t\t\tg.setOffsetLinePath(px, py, -bw, -bh, bw, -bh, bw, bh, true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 5:\r\n\t\t\t\t\tg.setOffsetLinePath(px, py, -bw, -bh, bw, -bh, -bw, bh, true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tg.fill();\r\n\t\t},\r\n\t\tdrawTriangle2: function(px, py, dir) {\r\n\t\t\tvar g = this.context;\r\n\t\t\tvar bw = this.bw + 1,\r\n\t\t\t\tbh = this.bh + 1;\r\n\t\t\tg.beginPath();\r\n\t\t\tswitch (dir) {\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tg.setOffsetLinePath(px, py, 0, 0, -bw, -bh, bw, -bh, true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tg.setOffsetLinePath(px, py, 0, 0, -bw, bh, bw, bh, true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tg.setOffsetLinePath(px, py, 0, 0, -bw, -bh, -bw, bh, true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 4:\r\n\t\t\t\t\tg.setOffsetLinePath(px, py, 0, 0, bw, -bh, bw, bh, true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tg.fill();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawMBs()    Cell上の○,×をCanvasに書き込む\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawMBs: function() {\r\n\t\t\tvar g = this.vinc(\"cell_mb\", \"auto\", true);\r\n\t\t\tg.lineWidth = 1;\r\n\r\n\t\t\tvar rsize = this.cw * 0.35;\r\n\t\t\tvar clist = this.range.cells;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i],\r\n\t\t\t\t\tpx,\r\n\t\t\t\t\tpy;\r\n\t\t\t\tif (cell.qsub > 0) {\r\n\t\t\t\t\tpx = cell.bx * this.bw;\r\n\t\t\t\t\tpy = cell.by * this.bh;\r\n\t\t\t\t\tg.strokeStyle = !cell.trial ? this.mbcolor : \"rgb(192, 192, 192)\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tg.vid = \"c_MB1_\" + cell.id;\r\n\t\t\t\tif (cell.qsub === 1) {\r\n\t\t\t\t\tg.strokeCircle(px, py, rsize);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tg.vid = \"c_MB2_\" + cell.id;\r\n\t\t\t\tif (cell.qsub === 2) {\r\n\t\t\t\t\tg.strokeCross(px, py, rsize);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawBorderAuxDir()    directional aux marks\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawBorderAuxDir: function() {\r\n\t\t\tvar g = this.vinc(\"border_dirsub\", \"crispEdges\");\r\n\t\t\tvar ssize = this.cw * 0.1;\r\n\r\n\t\t\tg.lineWidth = this.cw * 0.1;\r\n\r\n\t\t\tvar blist = this.range.borders;\r\n\t\t\tfor (var i = 0; i < blist.length; i++) {\r\n\t\t\t\tvar border = blist[i],\r\n\t\t\t\t\tpx = border.bx * this.bw,\r\n\t\t\t\t\tpy = border.by * this.bh,\r\n\t\t\t\t\tdir = border.qsub - 10;\r\n\r\n\t\t\t\t// 向き補助記号の描画\r\n\t\t\t\tg.vid = \"b_daux_\" + border.id;\r\n\t\t\t\tif (dir >= 1 && dir <= 8) {\r\n\t\t\t\t\tg.strokeStyle = !border.trial ? \"rgb(64,64,64)\" : this.trialcolor;\r\n\t\t\t\t\tg.beginPath();\r\n\t\t\t\t\tswitch (dir) {\r\n\t\t\t\t\t\tcase border.UP:\r\n\t\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\t\tpx,\r\n\t\t\t\t\t\t\t\tpy,\r\n\t\t\t\t\t\t\t\t-ssize * 2,\r\n\t\t\t\t\t\t\t\t+ssize,\r\n\t\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t\t-ssize,\r\n\t\t\t\t\t\t\t\t+ssize * 2,\r\n\t\t\t\t\t\t\t\t+ssize,\r\n\t\t\t\t\t\t\t\tfalse\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase border.DN:\r\n\t\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\t\tpx,\r\n\t\t\t\t\t\t\t\tpy,\r\n\t\t\t\t\t\t\t\t-ssize * 2,\r\n\t\t\t\t\t\t\t\t-ssize,\r\n\t\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t\t+ssize,\r\n\t\t\t\t\t\t\t\t+ssize * 2,\r\n\t\t\t\t\t\t\t\t-ssize,\r\n\t\t\t\t\t\t\t\tfalse\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase border.LT:\r\n\t\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\t\tpx,\r\n\t\t\t\t\t\t\t\tpy,\r\n\t\t\t\t\t\t\t\t+ssize,\r\n\t\t\t\t\t\t\t\t-ssize * 2,\r\n\t\t\t\t\t\t\t\t-ssize,\r\n\t\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t\t+ssize,\r\n\t\t\t\t\t\t\t\t+ssize * 2,\r\n\t\t\t\t\t\t\t\tfalse\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase border.RT:\r\n\t\t\t\t\t\t\tg.setOffsetLinePath(\r\n\t\t\t\t\t\t\t\tpx,\r\n\t\t\t\t\t\t\t\tpy,\r\n\t\t\t\t\t\t\t\t-ssize,\r\n\t\t\t\t\t\t\t\t-ssize * 2,\r\n\t\t\t\t\t\t\t\t+ssize,\r\n\t\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t\t-ssize,\r\n\t\t\t\t\t\t\t\t+ssize * 2,\r\n\t\t\t\t\t\t\t\tfalse\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tg.stroke();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawCircles()          数字や白丸黒丸等を表すCellの丸を書き込む\r\n\t\t// pc.getCircleStrokeColor() 描画する円の線の色を設定する\r\n\t\t// pc.getCircleFillColor()   描画する円の背景色を設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawCircles: function() {\r\n\t\t\tvar g = this.vinc(\"cell_circle\", \"auto\", true);\r\n\r\n\t\t\tvar ra = this.circleratio;\r\n\t\t\tvar rsize_stroke = (this.cw * (ra[0] + ra[1])) / 2,\r\n\t\t\t\trsize_fill = this.cw * ra[0];\r\n\r\n\t\t\tvar clist = this.range.cells;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i];\r\n\r\n\t\t\t\tvar color = this.getCircleFillColor(cell);\r\n\t\t\t\tg.vid = \"c_cirb_\" + cell.id;\r\n\t\t\t\tif (!!color) {\r\n\t\t\t\t\tg.fillStyle = color;\r\n\t\t\t\t\tg.fillCircle(cell.bx * this.bw, cell.by * this.bh, rsize_fill);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tg = this.vinc(\"cell_circle_stroke\", \"auto\", true);\r\n\t\t\tg.lineWidth = Math.max(this.cw * (ra[0] - ra[1]), 1);\r\n\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i];\r\n\r\n\t\t\t\tvar color = this.getCircleStrokeColor(cell);\r\n\t\t\t\tg.vid = \"c_cira_\" + cell.id;\r\n\t\t\t\tif (!!color) {\r\n\t\t\t\t\tg.strokeStyle = color;\r\n\t\t\t\t\tg.strokeCircle(cell.bx * this.bw, cell.by * this.bh, rsize_stroke);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgetCircleStrokeColor: function(cell) {\r\n\t\t\t// initialize()で上書きされる\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetCircleStrokeColor_qnum: function(cell) {\r\n\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\terror = cell.error || cell.qinfo;\r\n\t\t\tvar isdrawmove = puzzle.execConfig(\"dispmove\");\r\n\t\t\tvar num = (!isdrawmove ? cell : cell.base).qnum;\r\n\t\t\tif (num !== -1) {\r\n\t\t\t\tif (isdrawmove && puzzle.mouse.mouseCell === cell) {\r\n\t\t\t\t\treturn this.movecolor;\r\n\t\t\t\t} else if (error === 1 || error === 4) {\r\n\t\t\t\t\treturn this.errcolor1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this.quescolor;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetCircleStrokeColor_qnum2: function(cell) {\r\n\t\t\tif (cell.qnum === 1) {\r\n\t\t\t\treturn cell.error === 1 ? this.errcolor1 : this.quescolor;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\r\n\t\tgetCircleFillColor: function(cell) {\r\n\t\t\t// initialize()で上書きされる\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetCircleFillColor_qnum: function(cell) {\r\n\t\t\tif (cell.qnum !== -1) {\r\n\t\t\t\tvar error = cell.error || cell.qinfo;\r\n\t\t\t\tif (error === 1 || error === 4) {\r\n\t\t\t\t\treturn this.errbcolor1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this.circlebasecolor;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetCircleFillColor_qnum2: function(cell) {\r\n\t\t\tif (cell.qnum === 1) {\r\n\t\t\t\treturn cell.error === 1 ? this.errbcolor1 : \"white\";\r\n\t\t\t} else if (cell.qnum === 2) {\r\n\t\t\t\treturn cell.error === 1 ? this.errcolor1 : this.quescolor;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetCircleFillColor_qcmp: function(cell) {\r\n\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\terror = cell.error || cell.qinfo;\r\n\t\t\tvar isdrawmove = puzzle.execConfig(\"dispmove\");\r\n\t\t\tvar num = (!isdrawmove ? cell : cell.base).qnum;\r\n\t\t\tif (num !== -1) {\r\n\t\t\t\tif (error === 1 || error === 4) {\r\n\t\t\t\t\treturn this.errbcolor1;\r\n\t\t\t\t} else if (cell.isCmp()) {\r\n\t\t\t\t\treturn this.qcmpcolor;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this.circlebasecolor;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawDepartures()    移動系パズルで、移動元を示す記号を書き込む\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawDepartures: function() {\r\n\t\t\tvar g = this.vinc(\"cell_depart\", \"auto\", true);\r\n\t\t\tg.fillStyle = this.movelinecolor;\r\n\r\n\t\t\tvar rsize = this.cw * 0.15;\r\n\t\t\tvar isdrawmove = this.puzzle.execConfig(\"dispmove\");\r\n\t\t\tvar clist = this.range.cells;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i];\r\n\r\n\t\t\t\tg.vid = \"c_dcir_\" + cell.id;\r\n\t\t\t\tif (isdrawmove && cell.isDeparture()) {\r\n\t\t\t\t\tvar px = cell.bx * this.bw,\r\n\t\t\t\t\t\tpy = cell.by * this.bh;\r\n\t\t\t\t\tg.fillCircle(px, py, rsize);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawLineParts()   ╋などをCanvasに書き込む\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawLineParts: function() {\r\n\t\t\tvar g = this.vinc(\"cell_lineparts\", \"crispEdges\");\r\n\t\t\tg.fillStyle = this.quescolor;\r\n\r\n\t\t\tvar lm = this.lm,\r\n\t\t\t\tbw = this.bw,\r\n\t\t\t\tbh = this.bh;\r\n\t\t\tvar clist = this.range.cells;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i],\r\n\t\t\t\t\tqu = cell.ques;\r\n\r\n\t\t\t\tg.vid = \"c_lp_\" + cell.id;\r\n\t\t\t\tif (qu >= 11 && qu <= 17) {\r\n\t\t\t\t\tvar px = cell.bx * this.bw,\r\n\t\t\t\t\t\tpy = cell.by * this.bh;\r\n\t\t\t\t\tvar px0 = px - bw - 0.5,\r\n\t\t\t\t\t\tpx1 = px - lm,\r\n\t\t\t\t\t\tpx2 = px + lm,\r\n\t\t\t\t\t\tpx3 = px + bw + 0.5;\r\n\t\t\t\t\tvar py0 = py - bh - 0.5,\r\n\t\t\t\t\t\tpy1 = py - lm,\r\n\t\t\t\t\t\tpy2 = py + lm,\r\n\t\t\t\t\t\tpy3 = py + bh + 0.5;\r\n\r\n\t\t\t\t\tvar flag = { 11: 15, 12: 3, 13: 12, 14: 9, 15: 5, 16: 6, 17: 10 }[qu];\r\n\t\t\t\t\tg.beginPath();\r\n\t\t\t\t\tg.moveTo(px1, py1);\r\n\t\t\t\t\tif (flag & 1) {\r\n\t\t\t\t\t\tg.lineTo(px1, py0);\r\n\t\t\t\t\t\tg.lineTo(px2, py0);\r\n\t\t\t\t\t} // top\r\n\t\t\t\t\tg.lineTo(px2, py1);\r\n\t\t\t\t\tif (flag & 8) {\r\n\t\t\t\t\t\tg.lineTo(px3, py1);\r\n\t\t\t\t\t\tg.lineTo(px3, py2);\r\n\t\t\t\t\t} // right\r\n\t\t\t\t\tg.lineTo(px2, py2);\r\n\t\t\t\t\tif (flag & 2) {\r\n\t\t\t\t\t\tg.lineTo(px2, py3);\r\n\t\t\t\t\t\tg.lineTo(px1, py3);\r\n\t\t\t\t\t} // bottom\r\n\t\t\t\t\tg.lineTo(px1, py2);\r\n\t\t\t\t\tif (flag & 4) {\r\n\t\t\t\t\t\tg.lineTo(px0, py2);\r\n\t\t\t\t\t\tg.lineTo(px0, py1);\r\n\t\t\t\t\t} // left\r\n\t\t\t\t\tg.closePath();\r\n\t\t\t\t\tg.fill();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawTateyokos()   縦棒・横棒をCanvasに書き込む\r\n\t\t// pc.getBarColor()     縦棒・横棒の色を取得する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawTateyokos: function() {\r\n\t\t\tvar g = this.vinc(\"cell_tateyoko\", \"crispEdges\");\r\n\t\t\tvar lm = Math.max(this.cw / 6, 3) / 2; //LineWidth\r\n\r\n\t\t\tvar clist = this.range.cells;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i],\r\n\t\t\t\t\tpx = cell.bx * this.bw,\r\n\t\t\t\t\tpy = cell.by * this.bh;\r\n\t\t\t\tvar qa = cell.qans;\r\n\r\n\t\t\t\tg.vid = \"c_bar1_\" + cell.id;\r\n\t\t\t\tif (qa === 11 || qa === 12) {\r\n\t\t\t\t\tg.fillStyle = this.getBarColor(cell, true);\r\n\t\t\t\t\tg.fillRectCenter(px, py, lm + this.addlw / 2, this.bh);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tg.vid = \"c_bar2_\" + cell.id;\r\n\t\t\t\tif (qa === 11 || qa === 13) {\r\n\t\t\t\t\tg.fillStyle = this.getBarColor(cell, false);\r\n\t\t\t\t\tg.fillRectCenter(px, py, this.bw, lm + this.addlw / 2);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.addlw = 0;\r\n\t\t},\r\n\r\n\t\tgetBarColor: function(cell, vert) {\r\n\t\t\tvar err = cell.error,\r\n\t\t\t\tisErr =\r\n\t\t\t\t\terr === 1 || err === 4 || (err === 5 && vert) || (err === 6 && !vert),\r\n\t\t\t\tcolor = \"\";\r\n\t\t\tthis.addlw = 0;\r\n\t\t\tif (isErr) {\r\n\t\t\t\tcolor = this.errlinecolor;\r\n\t\t\t\tthis.addlw = 1;\r\n\t\t\t} else if (err !== 0) {\r\n\t\t\t\tcolor = this.noerrcolor;\r\n\t\t\t} else if (cell.trial) {\r\n\t\t\t\tcolor = this.trialcolor;\r\n\t\t\t} else {\r\n\t\t\t\tcolor = this.linecolor;\r\n\t\t\t}\r\n\t\t\treturn color;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawQues51()         Ques===51があるようなパズルで、描画関数を呼び出す\r\n\t\t// pc.drawSlash51Cells()   [＼]のナナメ線をCanvasに書き込む\r\n\t\t// pc.drawSlash51ExCells() ExCell上の[＼]のナナメ線をCanvasに書き込む\r\n\t\t// pc.drawExCellGrid()     ExCell間の境界線をCanvasに書き込む\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawQues51: function() {\r\n\t\t\tthis.drawExCellGrid();\r\n\t\t\tthis.drawTargetTriangle();\r\n\t\t\tthis.drawSlash51Cells();\r\n\t\t\tthis.drawSlash51ExCells();\r\n\t\t},\r\n\t\tdrawSlash51Cells: function() {\r\n\t\t\tvar g = this.vinc(\"cell_ques51\", \"crispEdges\", true);\r\n\r\n\t\t\tg.strokeStyle = this.quescolor;\r\n\t\t\tg.lineWidth = 1;\r\n\t\t\tvar clist = this.range.cells;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i];\r\n\r\n\t\t\t\tg.vid = \"c_slash51_\" + cell.id;\r\n\t\t\t\tif (cell.ques === 51) {\r\n\t\t\t\t\tvar px = cell.bx * this.bw,\r\n\t\t\t\t\t\tpy = cell.by * this.bh;\r\n\t\t\t\t\tg.strokeLine(px - this.bw, py - this.bh, px + this.bw, py + this.bh);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tg.vid = \"c_slash51b_\" + cell.id;\r\n\t\t\t\tif (cell.ques === 51 && cell.dirs51 === 4) {\r\n\t\t\t\t\tvar px = cell.bx * this.bw,\r\n\t\t\t\t\t\tpy = cell.by * this.bh;\r\n\t\t\t\t\tg.strokeLine(px - this.bw, py + this.bh, px + this.bw, py - this.bh);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tdrawSlash51ExCells: function() {\r\n\t\t\tvar g = this.vinc(\"excell_ques51\", \"crispEdges\", true);\r\n\r\n\t\t\tg.strokeStyle = this.quescolor;\r\n\t\t\tg.lineWidth = 1;\r\n\t\t\tvar exlist = this.range.excells;\r\n\t\t\tfor (var i = 0; i < exlist.length; i++) {\r\n\t\t\t\tvar excell = exlist[i],\r\n\t\t\t\t\tpx = excell.bx * this.bw,\r\n\t\t\t\t\tpy = excell.by * this.bh;\r\n\t\t\t\tg.vid = \"ex_slash51_\" + excell.id;\r\n\t\t\t\tg.strokeLine(px - this.bw, py - this.bh, px + this.bw, py + this.bh);\r\n\t\t\t}\r\n\t\t},\r\n\t\tdrawExCellGrid: function() {\r\n\t\t\tvar g = this.vinc(\"grid_excell\", \"crispEdges\", true);\r\n\r\n\t\t\tg.fillStyle = this.quescolor;\r\n\t\t\tvar exlist = this.range.excells;\r\n\t\t\tfor (var i = 0; i < exlist.length; i++) {\r\n\t\t\t\tvar excell = exlist[i];\r\n\t\t\t\tvar px = excell.bx * this.bw,\r\n\t\t\t\t\tpy = excell.by * this.bh;\r\n\r\n\t\t\t\tg.vid = \"ex_bdx_\" + excell.id;\r\n\t\t\t\tif (excell.by === -1 && excell.bx < this.board.maxbx) {\r\n\t\t\t\t\tg.fillRectCenter(px + this.bw, py, 0.5, this.bh);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tg.vid = \"ex_bdy_\" + excell.id;\r\n\t\t\t\tif (excell.bx === -1 && excell.by < this.board.maxby) {\r\n\t\t\t\t\tg.fillRectCenter(px, py + this.bh, this.bw, 0.5);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawQuesNumbersOn51()   [＼]に数字を記入する\r\n\t\t// pc.drawQuesNumbersOn51_1() 1つの[＼]に数字を記入する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawQuesNumbersOn51: function() {\r\n\t\t\tthis.vinc(\"cell_number51\", \"auto\");\r\n\r\n\t\t\tvar d = this.range;\r\n\t\t\tfor (var bx = d.x1 | 1; bx <= d.x2; bx += 2) {\r\n\t\t\t\tfor (var by = d.y1 | 1; by <= d.y2; by += 2) {\r\n\t\t\t\t\tvar piece = this.board.getobj(bx, by); /* cell or excell */\r\n\t\t\t\t\tif (!piece.isnull) {\r\n\t\t\t\t\t\tif (piece.dirs51 === 4) {\r\n\t\t\t\t\t\t\tthis.drawQuesNumbersOn51_2(piece);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.drawQuesNumbersOn51_1(piece);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tdrawQuesNumbersOn51_1: function(piece) {\r\n\t\t\t/* cell or excell */\r\n\t\t\tvar g = this.context,\r\n\t\t\t\tval,\r\n\t\t\t\tadj,\r\n\t\t\t\tpx = piece.bx * this.bw,\r\n\t\t\t\tpy = piece.by * this.bh;\r\n\t\t\tvar option = { ratio: 0.45 };\r\n\t\t\tg.fillStyle =\r\n\t\t\t\tpiece.error === 1 || piece.qinfo === 1\r\n\t\t\t\t\t? this.errcolor1\r\n\t\t\t\t\t: this.quescolor;\r\n\r\n\t\t\tadj = piece.relcell(2, 0);\r\n\t\t\tval = piece.ques === 51 ? piece.qnum : -1;\r\n\r\n\t\t\tg.vid = [piece.group, piece.id, \"text_ques51_rt\"].join(\"_\");\r\n\t\t\tif (val >= 0 && !adj.isnull && adj.ques !== 51) {\r\n\t\t\t\toption.position = this.TOPRIGHT;\r\n\t\t\t\tthis.disptext(\"\" + val, px, py, option);\r\n\t\t\t} else {\r\n\t\t\t\tg.vhide();\r\n\t\t\t}\r\n\r\n\t\t\tadj = piece.relcell(0, 2);\r\n\t\t\tval = piece.ques === 51 ? piece.qnum2 : -1;\r\n\r\n\t\t\tg.vid = [piece.group, piece.id, \"text_ques51_dn\"].join(\"_\");\r\n\t\t\tif (val >= 0 && !adj.isnull && adj.ques !== 51) {\r\n\t\t\t\toption.position = this.BOTTOMLEFT;\r\n\t\t\t\tthis.disptext(\"\" + val, px, py, option);\r\n\t\t\t} else {\r\n\t\t\t\tg.vhide();\r\n\t\t\t}\r\n\t\t},\r\n\t\tdrawQuesNumbersOn51_2: function(piece) {\r\n\t\t\tvar g = this.context,\r\n\t\t\t\tval,\r\n\t\t\t\tpx = piece.bx * this.bw,\r\n\t\t\t\tpy = piece.by * this.bh;\r\n\t\t\tvar option = { ratio: 0.4, width: [0.35, 0.23, 0.15] };\r\n\t\t\tg.fillStyle =\r\n\t\t\t\tpiece.error === 1 || piece.qinfo === 1\r\n\t\t\t\t\t? this.errcolor1\r\n\t\t\t\t\t: this.quescolor;\r\n\r\n\t\t\tfor (var dir = 1; dir <= 4; dir++) {\r\n\t\t\t\tval = piece.getQnumDir(dir);\r\n\t\t\t\tg.vid = [piece.group, piece.id, \"text_ques51\", dir].join(\"_\");\r\n\t\t\t\tif (val >= 0) {\r\n\t\t\t\t\toption.position = dir + 5;\r\n\t\t\t\t\tthis.disptext(\"\" + val, px, py, option);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawTarget()  入力対象となる場所を描画する\r\n\t\t// pc.drawCursor()  キーボードからの入力対象をCanvasに書き込む\r\n\t\t// pc.drawTargetSubNumber() Cellの補助数字の入力対象に背景色をつける\r\n\t\t// pc.drawTargetTriangle() [＼]のうち入力対象のほうに背景色をつける\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawTarget: function() {\r\n\t\t\tthis.drawCursor(true, this.puzzle.editmode);\r\n\t\t},\r\n\r\n\t\tdrawCursor: function(islarge, isdraw) {\r\n\t\t\tthis.drawRawCursor(\r\n\t\t\t\t\"target_cursor\",\r\n\t\t\t\t\"\",\r\n\t\t\t\tthis.puzzle.cursor,\r\n\t\t\t\tislarge,\r\n\t\t\t\tisdraw !== false && this.puzzle.getConfig(\"cursor\"),\r\n\t\t\t\tthis.puzzle.editmode ? this.targetColorEdit : this.targetColorPlay\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\tdrawTrialStarts: function() {\r\n\t\t\tvar starts = this.puzzle.opemgr.savedStarts;\r\n\t\t\tfor (var i = 0; i < starts.length; i++) {\r\n\t\t\t\tvar piece = starts[i];\r\n\t\t\t\tthis.drawRawCursor(\r\n\t\t\t\t\t\"trial_cursor\",\r\n\t\t\t\t\t\"trial_\" + i,\r\n\t\t\t\t\tpiece,\r\n\t\t\t\t\tfalse,\r\n\t\t\t\t\t!piece.isnull && this.puzzle.getConfig(\"trialmarker\"),\r\n\t\t\t\t\tthis.targetColorTrial\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdrawRawCursor: function(layerid, prefix, cursor, islarge, isdraw, color) {\r\n\t\t\tvar g = this.vinc(layerid, \"crispEdges\");\r\n\r\n\t\t\tvar px = cursor.bx * this.bw,\r\n\t\t\t\tpy = cursor.by * this.bh,\r\n\t\t\t\tw,\r\n\t\t\t\tsize;\r\n\t\t\tif (islarge !== false) {\r\n\t\t\t\tw = Math.max(this.cw / 16, 2) | 0;\r\n\t\t\t\tsize = this.bw - 0.5;\r\n\t\t\t} else {\r\n\t\t\t\tw = Math.max(this.cw / 24, 1) | 0;\r\n\t\t\t\tsize = this.bw * 0.56;\r\n\t\t\t}\r\n\r\n\t\t\tisdraw = isdraw !== false && !this.outputImage;\r\n\t\t\tg.fillStyle = color;\r\n\r\n\t\t\tg.vid = prefix + \"ti1_\";\r\n\t\t\tif (isdraw) {\r\n\t\t\t\tg.fillRect(px - size, py - size, size * 2, w);\r\n\t\t\t} else {\r\n\t\t\t\tg.vhide();\r\n\t\t\t}\r\n\t\t\tg.vid = prefix + \"ti2_\";\r\n\t\t\tif (isdraw) {\r\n\t\t\t\tg.fillRect(px - size, py - size, w, size * 2);\r\n\t\t\t} else {\r\n\t\t\t\tg.vhide();\r\n\t\t\t}\r\n\t\t\tg.vid = prefix + \"ti3_\";\r\n\t\t\tif (isdraw) {\r\n\t\t\t\tg.fillRect(px - size, py + size - w, size * 2, w);\r\n\t\t\t} else {\r\n\t\t\t\tg.vhide();\r\n\t\t\t}\r\n\t\t\tg.vid = prefix + \"ti4_\";\r\n\t\t\tif (isdraw) {\r\n\t\t\t\tg.fillRect(px + size - w, py - size, w, size * 2);\r\n\t\t\t} else {\r\n\t\t\t\tg.vhide();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdrawTargetSubNumber: function() {\r\n\t\t\tvar g = this.vinc(\"target_subnum\", \"crispEdges\");\r\n\r\n\t\t\tvar d = this.range,\r\n\t\t\t\tcursor = this.puzzle.cursor;\r\n\t\t\tif (cursor.bx < d.x1 || d.x2 < cursor.bx) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (cursor.by < d.y1 || d.y2 < cursor.by) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar target = cursor.targetdir;\r\n\r\n\t\t\tg.vid = \"target_subnum\";\r\n\t\t\tg.fillStyle = this.ttcolor;\r\n\t\t\tif (this.puzzle.playmode && target !== 0) {\r\n\t\t\t\tvar bw = this.bw,\r\n\t\t\t\t\tbh = this.bh;\r\n\t\t\t\tvar px = cursor.bx * bw + 0.5,\r\n\t\t\t\t\tpy = cursor.by * bh + 0.5;\r\n\t\t\t\tvar tw = bw * 0.8,\r\n\t\t\t\t\tth = bh * 0.8;\r\n\t\t\t\tif (target === 5) {\r\n\t\t\t\t\tg.fillRect(px - bw, py - bh, tw, th);\r\n\t\t\t\t} else if (target === 4) {\r\n\t\t\t\t\tg.fillRect(px + bw - tw, py - bh, tw, th);\r\n\t\t\t\t} else if (target === 2) {\r\n\t\t\t\t\tg.fillRect(px - bw, py + bh - th, tw, th);\r\n\t\t\t\t} else if (target === 3) {\r\n\t\t\t\t\tg.fillRect(px + bw - tw, py + bh - th, tw, th);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tg.vhide();\r\n\t\t\t}\r\n\t\t},\r\n\t\tdrawTargetTriangle: function() {\r\n\t\t\tvar g = this.vinc(\"target_triangle\", \"auto\");\r\n\r\n\t\t\tvar d = this.range,\r\n\t\t\t\tcursor = this.puzzle.cursor;\r\n\t\t\tif (cursor.bx < d.x1 || d.x2 < cursor.bx) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (cursor.by < d.y1 || d.y2 < cursor.by) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar target = cursor.detectTarget();\r\n\r\n\t\t\tg.vid = \"target_triangle\";\r\n\t\t\tg.fillStyle = this.ttcolor;\r\n\t\t\tif (this.puzzle.editmode && target !== 0) {\r\n\t\t\t\tif (cursor.targetdirs === 4) {\r\n\t\t\t\t\tthis.drawTriangle2(cursor.bx * this.bw, cursor.by * this.bh, target);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.drawTriangle1(\r\n\t\t\t\t\t\tcursor.bx * this.bw,\r\n\t\t\t\t\t\tcursor.by * this.bh,\r\n\t\t\t\t\t\ttarget === 4 ? 4 : 2\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tg.vhide();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------\r\n\t\t// pc.drawStartGoal()  draw Start and Goal symbols\r\n\t\t//--------------------------------------------------------------------------\r\n\t\tdrawStartGoal: function() {\r\n\t\t\tvar g = this.vinc(\"cell_sg\", \"auto\");\r\n\t\t\tvar bd = this.board,\r\n\t\t\t\td = this.range;\r\n\r\n\t\t\tg.vid = \"text_stpos\";\r\n\t\t\tvar cell = bd.startpos.getc();\r\n\t\t\tif (\r\n\t\t\t\tcell.bx >= d.x1 &&\r\n\t\t\t\td.x2 >= cell.bx &&\r\n\t\t\t\tcell.by >= d.y1 &&\r\n\t\t\t\td.y2 >= cell.by\r\n\t\t\t) {\r\n\t\t\t\tif (!cell.isnull) {\r\n\t\t\t\t\tg.fillStyle =\r\n\t\t\t\t\t\tthis.puzzle.mouse.draggingSG && this.puzzle.mouse.inputData === 10\r\n\t\t\t\t\t\t\t? \"red\"\r\n\t\t\t\t\t\t\t: cell.qans === 1\r\n\t\t\t\t\t\t\t? this.fontShadecolor\r\n\t\t\t\t\t\t\t: this.quescolor;\r\n\t\t\t\t\tthis.disptext(\"S\", cell.bx * this.bw, cell.by * this.bh);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tg.vid = \"text_glpos\";\r\n\t\t\tcell = bd.goalpos.getc();\r\n\t\t\tif (\r\n\t\t\t\tcell.bx >= d.x1 &&\r\n\t\t\t\td.x2 >= cell.bx &&\r\n\t\t\t\tcell.by >= d.y1 &&\r\n\t\t\t\td.y2 >= cell.by\r\n\t\t\t) {\r\n\t\t\t\tif (!cell.isnull) {\r\n\t\t\t\t\tg.fillStyle =\r\n\t\t\t\t\t\tthis.puzzle.mouse.draggingSG && this.puzzle.mouse.inputData === 11\r\n\t\t\t\t\t\t\t? \"red\"\r\n\t\t\t\t\t\t\t: cell.qans === 1\r\n\t\t\t\t\t\t\t? this.fontShadecolor\r\n\t\t\t\t\t\t\t: this.quescolor;\r\n\t\t\t\t\tthis.disptext(\"G\", cell.bx * this.bw, cell.by * this.bh);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------\r\n\t\t// pc.getDotFillColor()  The circle fill color, or null for no fill.\r\n\t\t// pc.getDotOutlineColor()  The circle outline color, or null for no outline.\r\n\t\t// pc.getDotRadius()  The circle radius, as a fraction.\r\n\t\t// pc.drawDots()  Draw circles on all dot positions\r\n\t\t//--------------------------------------------------------------------------\r\n\t\tgetDotFillColor: function(dot) {\r\n\t\t\tif (dot.getDot() === 1) {\r\n\t\t\t\treturn \"white\";\r\n\t\t\t}\r\n\t\t\tif (dot.getDot() === 2) {\r\n\t\t\t\treturn dot.iserror() ? this.errcolor1 : this.quescolor;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetDotOutlineColor: function(dot) {\r\n\t\t\tif (dot.getDot() === 1) {\r\n\t\t\t\treturn dot.iserror() ? this.errcolor1 : this.quescolor;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetDotRadius: function(dot) {\r\n\t\t\treturn 0.18;\r\n\t\t},\r\n\r\n\t\tdrawDots: function() {\r\n\t\t\tvar g = this.vinc(\"dot\", \"auto\", true);\r\n\r\n\t\t\tg.lineWidth = Math.max(this.cw * 0.04, 1);\r\n\t\t\tvar d = this.range;\r\n\t\t\tvar dlist = this.board.dotinside(d.x1, d.y1, d.x2, d.y2);\r\n\t\t\tfor (var i = 0; i < dlist.length; i++) {\r\n\t\t\t\tvar dot = dlist[i],\r\n\t\t\t\t\tbx = dot.bx,\r\n\t\t\t\t\tby = dot.by;\r\n\r\n\t\t\t\tg.vid = \"s_dot_\" + dot.id;\r\n\t\t\t\tvar outline = this.getDotOutlineColor(dot);\r\n\t\t\t\tvar color = this.getDotFillColor(dot);\r\n\t\t\t\tif (!!color || !!outline) {\r\n\t\t\t\t\tg.strokeStyle = outline;\r\n\t\t\t\t\tg.fillStyle = color;\r\n\t\t\t\t\tg.shapeCircle(\r\n\t\t\t\t\t\tbx * this.bw,\r\n\t\t\t\t\t\tby * this.bh,\r\n\t\t\t\t\t\tthis.cw * this.getDotRadius(dot)\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawDashedCenterLines() セルの中心から中心にひかれる点線をCanvasに描画する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawDashedCenterLines: function() {\r\n\t\t\tvar g = this.vinc(\"centerline\", \"crispEdges\", true),\r\n\t\t\t\tbd = this.board;\r\n\r\n\t\t\tvar x1 = this.range.x1,\r\n\t\t\t\ty1 = this.range.y1,\r\n\t\t\t\tx2 = this.range.x2,\r\n\t\t\t\ty2 = this.range.y2;\r\n\t\t\tif (x1 < bd.minbx + 1) {\r\n\t\t\t\tx1 = bd.minbx + 1;\r\n\t\t\t}\r\n\t\t\tif (x2 > bd.maxbx - 1) {\r\n\t\t\t\tx2 = bd.maxbx - 1;\r\n\t\t\t}\r\n\t\t\tif (y1 < bd.minby + 1) {\r\n\t\t\t\ty1 = bd.minby + 1;\r\n\t\t\t}\r\n\t\t\tif (y2 > bd.maxby - 1) {\r\n\t\t\t\ty2 = bd.maxby - 1;\r\n\t\t\t}\r\n\t\t\tx1 -= ~x1 & 1;\r\n\t\t\ty1 -= ~y1 & 1;\r\n\t\t\tx2 += ~x2 & 1;\r\n\t\t\ty2 += ~y2 & 1; /* (x1,y1)-(x2,y2)を外側の奇数範囲まで広げる */\r\n\r\n\t\t\tvar dasharray = this.getDashArray();\r\n\r\n\t\t\tg.lineWidth = 1;\r\n\t\t\tg.strokeStyle = this.gridcolor;\r\n\t\t\tfor (var i = x1; i <= x2; i += 2) {\r\n\t\t\t\tvar px = i * this.bw,\r\n\t\t\t\t\tpy1 = y1 * this.bh,\r\n\t\t\t\t\tpy2 = y2 * this.bh;\r\n\t\t\t\tg.vid = \"cliney_\" + i;\r\n\t\t\t\tg.strokeDashedLine(px, py1, px, py2, dasharray);\r\n\t\t\t}\r\n\t\t\tfor (var i = y1; i <= y2; i += 2) {\r\n\t\t\t\tvar py = i * this.bh,\r\n\t\t\t\t\tpx1 = x1 * this.bw,\r\n\t\t\t\t\tpx2 = x2 * this.bw;\r\n\t\t\t\tg.vid = \"clinex_\" + i;\r\n\t\t\t\tg.strokeDashedLine(px1, py, px2, py, dasharray);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgetDashArray: function() {\r\n\t\t\tvar dashCount = Math.max(Math.round(this.cw / 10), 4);\r\n\t\t\tvar stepSize = this.cw / dashCount;\r\n\t\t\tvar lengthOn = (5 / 8) * stepSize;\r\n\t\t\tvar lengthOff = stepSize - lengthOn;\r\n\r\n\t\t\tvar dasharray = [];\r\n\t\t\tdasharray.push(lengthOn / 2, lengthOff);\r\n\t\t\tfor (var i = 0; i < dashCount - 1; i++) {\r\n\t\t\t\tdasharray.push(lengthOn, lengthOff);\r\n\t\t\t}\r\n\t\t\tdasharray.push(lengthOn / 2);\r\n\t\t\tdasharray.push(0);\r\n\t\t\treturn dasharray;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawGrid()        セルの枠線(実線)をCanvasに書き込む\r\n\t\t// pc.drawDashedGrid()  セルの枠線(点線)をCanvasに書き込む\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawGrid: function(haschassis, isdraw) {\r\n\t\t\tvar g = this.vinc(\"grid\", \"crispEdges\", true),\r\n\t\t\t\tbd = this.board;\r\n\r\n\t\t\t// ignore excells\r\n\t\t\tvar minx = Math.max(bd.minbx, 0),\r\n\t\t\t\tmaxx = Math.min(bd.maxbx, 2 * bd.cols);\r\n\t\t\tvar miny = Math.max(bd.minby, 0),\r\n\t\t\t\tmaxy = Math.min(bd.maxby, 2 * bd.rows);\r\n\r\n\t\t\t// 外枠まで描画するわけじゃないので、maxbxとか使いません\r\n\t\t\tvar x1 = this.range.x1,\r\n\t\t\t\ty1 = this.range.y1,\r\n\t\t\t\tx2 = this.range.x2,\r\n\t\t\t\ty2 = this.range.y2;\r\n\t\t\tif (x1 < minx) {\r\n\t\t\t\tx1 = minx;\r\n\t\t\t}\r\n\t\t\tif (x2 > maxx) {\r\n\t\t\t\tx2 = maxx;\r\n\t\t\t}\r\n\t\t\tif (y1 < miny) {\r\n\t\t\t\ty1 = miny;\r\n\t\t\t}\r\n\t\t\tif (y2 > maxy) {\r\n\t\t\t\ty2 = maxy;\r\n\t\t\t}\r\n\t\t\tx1 -= x1 & 1;\r\n\t\t\ty1 -= y1 & 1; /* (x1,y1)を外側の偶数位置に移動する */\r\n\t\t\tif (x1 >= x2 || y1 >= y2) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar bs = bd.hasborder !== 2 && haschassis !== false ? 2 : 0,\r\n\t\t\t\tbw = this.bw,\r\n\t\t\t\tbh = this.bh;\r\n\t\t\tvar xa = Math.max(x1, minx + bs),\r\n\t\t\t\txb = Math.min(x2, maxx - bs);\r\n\t\t\tvar ya = Math.max(y1, miny + bs),\r\n\t\t\t\tyb = Math.min(y2, maxy - bs);\r\n\r\n\t\t\t// isdraw!==false: 指定無しかtrueのときは描画する\r\n\t\t\tg.lineWidth = this.gw;\r\n\t\t\tg.strokeStyle = this.gridcolor;\r\n\t\t\tfor (var i = xa; i <= xb; i += 2) {\r\n\t\t\t\tg.vid = \"bdy_\" + i;\r\n\t\t\t\tif (isdraw !== false) {\r\n\t\t\t\t\tvar px = i * bw,\r\n\t\t\t\t\t\tpy1 = y1 * bh,\r\n\t\t\t\t\t\tpy2 = y2 * bh;\r\n\t\t\t\t\tg.strokeLine(px, py1, px, py2);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (var i = ya; i <= yb; i += 2) {\r\n\t\t\t\tg.vid = \"bdx_\" + i;\r\n\t\t\t\tif (isdraw !== false) {\r\n\t\t\t\t\tvar py = i * bh,\r\n\t\t\t\t\t\tpx1 = x1 * bw,\r\n\t\t\t\t\t\tpx2 = x2 * bw;\r\n\t\t\t\t\tg.strokeLine(px1, py, px2, py);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tg.vhide();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tdrawDashedGrid: function(haschassis) {\r\n\t\t\tvar g = this.vinc(\"grid\", \"crispEdges\", true),\r\n\t\t\t\tbd = this.board;\r\n\r\n\t\t\t// ignore excells\r\n\t\t\tvar minx = Math.max(bd.minbx, 0),\r\n\t\t\t\tmaxx = Math.min(bd.maxbx, 2 * bd.cols);\r\n\t\t\tvar miny = Math.max(bd.minby, 0),\r\n\t\t\t\tmaxy = Math.min(bd.maxby, 2 * bd.rows);\r\n\r\n\t\t\t// 外枠まで描画するわけじゃないので、maxbxとか使いません\r\n\t\t\tvar x1 = this.range.x1,\r\n\t\t\t\ty1 = this.range.y1,\r\n\t\t\t\tx2 = this.range.x2,\r\n\t\t\t\ty2 = this.range.y2;\r\n\t\t\tif (x1 < minx) {\r\n\t\t\t\tx1 = minx;\r\n\t\t\t}\r\n\t\t\tif (x2 > maxx) {\r\n\t\t\t\tx2 = maxx;\r\n\t\t\t}\r\n\t\t\tif (y1 < miny) {\r\n\t\t\t\ty1 = miny;\r\n\t\t\t}\r\n\t\t\tif (y2 > maxy) {\r\n\t\t\t\ty2 = maxy;\r\n\t\t\t}\r\n\t\t\tx1 -= x1 & 1;\r\n\t\t\ty1 -= y1 & 1;\r\n\t\t\tx2 += x2 & 1;\r\n\t\t\ty2 += y2 & 1; /* (x1,y1)-(x2,y2)を外側の偶数範囲に移動する */\r\n\r\n\t\t\tvar dasharray = this.getDashArray();\r\n\r\n\t\t\tvar bs = haschassis !== false ? 2 : 0,\r\n\t\t\t\tbw = this.bw,\r\n\t\t\t\tbh = this.bh;\r\n\t\t\tvar xa = Math.max(x1, minx + bs),\r\n\t\t\t\txb = Math.min(x2, maxx - bs);\r\n\t\t\tvar ya = Math.max(y1, miny + bs),\r\n\t\t\t\tyb = Math.min(y2, maxy - bs);\r\n\r\n\t\t\tg.lineWidth = this.gw;\r\n\t\t\tg.strokeStyle = this.gridcolor;\r\n\t\t\tfor (var i = xa; i <= xb; i += 2) {\r\n\t\t\t\tvar px = i * bw,\r\n\t\t\t\t\tpy1 = y1 * bh,\r\n\t\t\t\t\tpy2 = y2 * bh;\r\n\t\t\t\tg.vid = \"bdy_\" + i;\r\n\t\t\t\tg.strokeDashedLine(px, py1, px, py2, dasharray);\r\n\t\t\t}\r\n\t\t\tfor (var i = ya; i <= yb; i += 2) {\r\n\t\t\t\tvar py = i * bh,\r\n\t\t\t\t\tpx1 = x1 * bw,\r\n\t\t\t\t\tpx2 = x2 * bw;\r\n\t\t\t\tg.vid = \"bdx_\" + i;\r\n\t\t\t\tg.strokeDashedLine(px1, py, px2, py, dasharray);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// pc.drawChassis()     外枠をCanvasに書き込む\r\n\t\t// pc.drawChassis_ex1() bd.hasexcell==1の時の外枠をCanvasに書き込む\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdrawChassis: function(withexcell) {\r\n\t\t\tvar g = this.vinc(\"chassis\", \"crispEdges\", true),\r\n\t\t\t\tbd = this.board;\r\n\r\n\t\t\tvar exWidth = withexcell ? bd.minbx * -0.5 * this.cw : 0;\r\n\t\t\tvar exHeight = withexcell ? bd.minby * -0.5 * this.ch : 0;\r\n\r\n\t\t\tvar boardWidth = bd.cols * this.cw,\r\n\t\t\t\tboardHeight = bd.rows * this.ch;\r\n\t\t\tvar lw = this.lw,\r\n\t\t\t\tlm = this.lm;\r\n\t\t\tif (this.pid === \"bosanowa\") {\r\n\t\t\t\tlw = 1;\r\n\t\t\t\tlm = 0.5;\r\n\t\t\t}\r\n\t\t\tg.fillStyle = this.quescolor;\r\n\t\t\tg.vid = \"chs1_\";\r\n\t\t\tg.fillRect(-lm, -exHeight - lm, lw, boardHeight + exHeight + lw);\r\n\t\t\tg.vid = \"chs2_\";\r\n\t\t\tg.fillRect(\r\n\t\t\t\tboardWidth - lm,\r\n\t\t\t\t-exHeight - lm,\r\n\t\t\t\tlw,\r\n\t\t\t\tboardHeight + exHeight + lw\r\n\t\t\t);\r\n\t\t\tg.vid = \"chs3_\";\r\n\t\t\tg.fillRect(-exWidth - lm, -lm, boardWidth + exWidth + lw, lw);\r\n\t\t\tg.vid = \"chs4_\";\r\n\t\t\tg.fillRect(\r\n\t\t\t\t-exWidth - lm,\r\n\t\t\t\tboardHeight - lm,\r\n\t\t\t\tboardWidth + exWidth + lw,\r\n\t\t\t\tlw\r\n\t\t\t);\r\n\t\t},\r\n\t\tdrawChassis_ex1: function(boldflag) {\r\n\t\t\tvar g = this.vinc(\"chassis_ex1\", \"crispEdges\", true),\r\n\t\t\t\tbd = this.board;\r\n\r\n\t\t\tvar x1 = this.range.x1,\r\n\t\t\t\ty1 = this.range.y1,\r\n\t\t\t\tx2 = this.range.x2,\r\n\t\t\t\ty2 = this.range.y2;\r\n\t\t\tif (x1 <= 0) {\r\n\t\t\t\tx1 = bd.minbx;\r\n\t\t\t}\r\n\t\t\tif (x2 > bd.maxbx) {\r\n\t\t\t\tx2 = bd.maxbx;\r\n\t\t\t}\r\n\t\t\tif (y1 <= 0) {\r\n\t\t\t\ty1 = bd.minby;\r\n\t\t\t}\r\n\t\t\tif (y2 > bd.maxby) {\r\n\t\t\t\ty2 = bd.maxby;\r\n\t\t\t}\r\n\r\n\t\t\tvar lw = this.lw,\r\n\t\t\t\tlm = this.lm;\r\n\t\t\tvar boardWidth = bd.cols * this.cw,\r\n\t\t\t\tboardHeight = bd.rows * this.ch;\r\n\r\n\t\t\t// extendcell==1も含んだ外枠の描画\r\n\t\t\tg.fillStyle = this.quescolor;\r\n\t\t\tg.vid = \"chsex1_1_\";\r\n\t\t\tg.fillRect(-this.cw - lm, -this.ch - lm, lw, boardHeight + this.ch + lw);\r\n\t\t\tg.vid = \"chsex1_2_\";\r\n\t\t\tg.fillRect(\r\n\t\t\t\tboardWidth - lm,\r\n\t\t\t\t-this.ch - lm,\r\n\t\t\t\tlw,\r\n\t\t\t\tboardHeight + this.ch + lw\r\n\t\t\t);\r\n\t\t\tg.vid = \"chsex1_3_\";\r\n\t\t\tg.fillRect(-this.cw - lm, -this.ch - lm, boardWidth + this.cw + lw, lw);\r\n\t\t\tg.vid = \"chsex1_4_\";\r\n\t\t\tg.fillRect(\r\n\t\t\t\t-this.cw - lm,\r\n\t\t\t\tboardHeight - lm,\r\n\t\t\t\tboardWidth + this.cw + lw,\r\n\t\t\t\tlw\r\n\t\t\t);\r\n\r\n\t\t\t// 通常のセルとextendcell==1の間の描画\r\n\t\t\tif (boldflag) {\r\n\t\t\t\t// すべて太線で描画する場合\r\n\t\t\t\tg.vid = \"chs1_\";\r\n\t\t\t\tg.fillRect(-lm, -lm, lw, boardHeight + lw - 1);\r\n\t\t\t\tg.vid = \"chs2_\";\r\n\t\t\t\tg.fillRect(-lm, -lm, boardWidth + lw - 1, lw);\r\n\t\t\t} else {\r\n\t\t\t\t// ques==51のセルが隣接している時に細線を描画する場合\r\n\t\t\t\tg.vid = \"chs1_\";\r\n\t\t\t\tg.fillRect(-0.5, -0.5, 1, boardHeight);\r\n\t\t\t\tg.vid = \"chs2_\";\r\n\t\t\t\tg.fillRect(-0.5, -0.5, boardWidth, 1);\r\n\r\n\t\t\t\tvar clist = this.range.cells;\r\n\t\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\t\tvar cell = clist[i],\r\n\t\t\t\t\t\tpx = (cell.bx - 1) * this.bw,\r\n\t\t\t\t\t\tpy = (cell.by - 1) * this.bh;\r\n\r\n\t\t\t\t\tif (cell.bx === 1) {\r\n\t\t\t\t\t\tg.vid = \"chs1_sub_\" + cell.by;\r\n\t\t\t\t\t\tif (cell.ques !== 51) {\r\n\t\t\t\t\t\t\tg.fillRect(-lm, py - lm, lw, this.ch + lw);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tg.vhide();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (cell.by === 1) {\r\n\t\t\t\t\t\tg.vid = \"chs2_sub_\" + cell.bx;\r\n\t\t\t\t\t\tif (cell.ques !== 51) {\r\n\t\t\t\t\t\t\tg.fillRect(px - lm, -lm, this.cw + lw, lw);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tg.vhide();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n","// KeyCommon.js v3.4.1\r\n\r\npzpr.classmgr.makeCommon({\r\n\t//---------------------------------------------------------\r\n\tKeyEvent: {\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// kc.key_inputcross() 上限maxまでの数字をCrossの問題データをして入力する(keydown時)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tkey_inputcross: function(ca) {\r\n\t\t\tvar cross = this.cursor.getx();\r\n\t\t\tvar max = cross.getmaxnum(),\r\n\t\t\t\tval = -1;\r\n\r\n\t\t\tif (\"0\" <= ca && ca <= \"9\") {\r\n\t\t\t\tvar num = +ca,\r\n\t\t\t\t\tcur = cross.qnum;\r\n\t\t\t\tif (cur <= 0 || cur * 10 + num > max) {\r\n\t\t\t\t\tcur = 0;\r\n\t\t\t\t}\r\n\t\t\t\tval = cur * 10 + num;\r\n\t\t\t\tif (val > max) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t} else if (ca === \"-\") {\r\n\t\t\t\tval = cross.qnum !== -2 ? -2 : -1;\r\n\t\t\t} else if (ca === \" \" || ca === \"BS\") {\r\n\t\t\t\tval = -1;\r\n\t\t\t} else {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tcross.setQnum(val);\r\n\t\t\tcross.draw();\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// kc.key_inputqnum() 上限maxまでの数字をCellの問題データをして入力する(keydown時)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tkey_inputqnum: function(ca) {\r\n\t\t\tvar cell = this.cursor.getc();\r\n\t\t\tif (\r\n\t\t\t\tcell.enableSubNumberArray &&\r\n\t\t\t\tthis.puzzle.playmode &&\r\n\t\t\t\tca === \"shift\" &&\r\n\t\t\t\tcell.noNum()\r\n\t\t\t) {\r\n\t\t\t\tthis.cursor.chtarget();\r\n\t\t\t} else {\r\n\t\t\t\tthis.key_inputqnum_main(cell, ca);\r\n\t\t\t}\r\n\t\t},\r\n\t\tkey_inputqnum_main: function(cell, ca) {\r\n\t\t\tvar cell0 = cell,\r\n\t\t\t\tpuzzle = this.puzzle,\r\n\t\t\t\tbd = puzzle.board;\r\n\t\t\tif (puzzle.editmode && bd.roommgr.hastop) {\r\n\t\t\t\tcell0 = cell = cell.room.top;\r\n\t\t\t} else if (puzzle.execConfig(\"dispmove\")) {\r\n\t\t\t\tif (cell.isDestination()) {\r\n\t\t\t\t\tcell = cell.base;\r\n\t\t\t\t} else if (cell.lcnt > 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (cell.enableSubNumberArray && this.cursor.targetdir >= 2) {\r\n\t\t\t\tvar snumpos = [-1, -1, 2, 3, 1, 0][this.cursor.targetdir];\r\n\t\t\t\tif (snumpos === -1) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar val = this.getNewNumber(cell, ca, cell.snum[snumpos]);\r\n\t\t\t\tif (val === null) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tcell.setSnum(snumpos, val);\r\n\t\t\t} else {\r\n\t\t\t\tvar val = this.getNewNumber(cell, ca, cell.getNum());\r\n\t\t\t\tif (val === null) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tcell.setNum(val);\r\n\t\t\t\tif (cell.numberWithMB && cell.enableSubNumberArray && ca === \" \") {\r\n\t\t\t\t\tcell.clrSnum();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (puzzle.execConfig(\"dispmove\") && cell.noNum()) {\r\n\t\t\t\tcell.eraseMovedLines(); /* 丸数字がなくなったら付属する線も消去する */\r\n\t\t\t}\r\n\r\n\t\t\tcell0.draw();\r\n\t\t\tthis.prev = cell;\r\n\t\t\tthis.cancelDefault = true;\r\n\t\t},\r\n\t\tgetNewNumber: function(cell, ca, cur) {\r\n\t\t\tvar max = cell.getmaxnum(),\r\n\t\t\t\tmin = cell.getminnum(),\r\n\t\t\t\tval = null;\r\n\r\n\t\t\tif (\"0\" <= ca && ca <= \"9\" && !cell.numberAsLetter) {\r\n\t\t\t\tvar num = +ca;\r\n\t\t\t\tif (cur <= 0 || cur * 10 + num > max || this.prev !== cell) {\r\n\t\t\t\t\tcur = 0;\r\n\t\t\t\t}\r\n\t\t\t\tval = cur * 10 + num;\r\n\t\t\t\tif (val > max || (min > 0 && val === 0)) {\r\n\t\t\t\t\tval = null;\r\n\t\t\t\t}\r\n\t\t\t} else if (\r\n\t\t\t\t\"a\" <= ca &&\r\n\t\t\t\tca <= \"z\" &&\r\n\t\t\t\tca.length === 1 &&\r\n\t\t\t\tcell.numberAsLetter\r\n\t\t\t) {\r\n\t\t\t\tif (ca.length > 1 && ca !== \"BS\") {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t\tvar num = parseInt(ca, 36) - 10;\r\n\t\t\t\tif (cur > 0 && (cur - 1) % 26 === num) {\r\n\t\t\t\t\t// Same alphabet\r\n\t\t\t\t\tval = cur <= 26 ? cur + 26 : -1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tval = num + 1;\r\n\t\t\t\t}\r\n\t\t\t\tif (val > max || (min > 0 && val === 0)) {\r\n\t\t\t\t\tval = null;\r\n\t\t\t\t}\r\n\t\t\t} else if (ca === \"BS\") {\r\n\t\t\t\tif (cur < 10 || cell.numberAsLetter) {\r\n\t\t\t\t\tval = -1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tval = (cur / 10) | 0;\r\n\t\t\t\t}\r\n\t\t\t} else if (ca === \"-\") {\r\n\t\t\t\tval = this.puzzle.editmode && !cell.disInputHatena ? -2 : -1;\r\n\t\t\t} else if (ca === \" \") {\r\n\t\t\t\tval = -1;\r\n\t\t\t} else if (ca === \"s1\") {\r\n\t\t\t\tval = -2;\r\n\t\t\t} else if (ca === \"s2\") {\r\n\t\t\t\tval = -3;\r\n\t\t\t} else {\r\n\t\t\t\tval = null;\r\n\t\t\t}\r\n\r\n\t\t\treturn val;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// kc.key_inputarrow()  四方向の矢印などを設定する\r\n\t\t// kc.key_inputdirec()  四方向の矢印つき数字の矢印を設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tkey_inputarrow: function(ca) {\r\n\t\t\treturn this.key_inputdirec_common(ca, false);\r\n\t\t},\r\n\t\tkey_inputdirec: function(ca) {\r\n\t\t\treturn this.key_inputdirec_common(ca, true);\r\n\t\t},\r\n\t\tkey_inputdirec_common: function(ca, arrownum) {\r\n\t\t\t// 共通処理\r\n\t\t\tvar cell = this.cursor.getc();\r\n\t\t\tif (arrownum && cell.qnum === -1) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tvar dir = cell.NDIR;\r\n\t\t\tswitch (ca) {\r\n\t\t\t\tcase \"shift+up\":\r\n\t\t\t\t\tdir = cell.UP;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"shift+down\":\r\n\t\t\t\t\tdir = cell.DN;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"shift+left\":\r\n\t\t\t\t\tdir = cell.LT;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"shift+right\":\r\n\t\t\t\t\tdir = cell.RT;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif (dir !== cell.NDIR) {\r\n\t\t\t\tcell.setQdir(cell.qdir !== dir ? dir : cell.NDIR);\r\n\t\t\t\tif (!arrownum) {\r\n\t\t\t\t\tcell.setQnum(-1);\r\n\t\t\t\t}\r\n\t\t\t\tthis.cursor.draw();\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// kc.inputnumber51()  [＼]の数字等を入力する\r\n\t\t// kc.setnum51()      モード別に数字を設定する\r\n\t\t// kc.getnum51()      モード別に数字を取得する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputnumber51: function(ca, max_obj) {\r\n\t\t\tvar cursor = this.cursor;\r\n\t\t\tif (ca === \"shift\") {\r\n\t\t\t\tcursor.chtarget();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar piece = cursor.getobj(); /* cell or excell */\r\n\t\t\tvar target = cursor.detectTarget(piece);\r\n\t\t\tif (target === 0 || (piece.group === \"cell\" && piece.is51cell())) {\r\n\t\t\t\tif (ca === \"q\" && !piece.isnull) {\r\n\t\t\t\t\tif (!piece.is51cell()) {\r\n\t\t\t\t\t\tpiece.set51cell();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tpiece.remove51cell();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcursor.drawaround();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (target === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar def = this.klass.Cell.prototype[\r\n\t\t\t\ttarget === piece.RT ? \"qnum\" : \"qnum2\"\r\n\t\t\t];\r\n\t\t\tvar max = piece.getmaxnum(),\r\n\t\t\t\tval = def;\r\n\r\n\t\t\tif (\"0\" <= ca && ca <= \"9\") {\r\n\t\t\t\tvar num = +ca,\r\n\t\t\t\t\tcur = this.getnum51(piece, target);\r\n\t\t\t\tif (cur <= 0 || cur * 10 + num > max || this.prev !== piece) {\r\n\t\t\t\t\tcur = 0;\r\n\t\t\t\t}\r\n\t\t\t\tval = cur * 10 + num;\r\n\t\t\t\tif (val > max) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t} else if (ca === \"-\" || ca === \" \") {\r\n\t\t\t\tval = def;\r\n\t\t\t} else {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.setnum51(piece, target, val);\r\n\t\t\tthis.prev = piece;\r\n\t\t\tcursor.draw();\r\n\t\t},\r\n\t\tsetnum51: function(piece, target, val) {\r\n\t\t\t/* piece : cell or excell */\r\n\t\t\tpiece.setQnumDir(target, val);\r\n\t\t},\r\n\t\tgetnum51: function(piece, target) {\r\n\t\t\t/* piece : cell or excell */\r\n\t\t\treturn piece.getQnumDir(target);\r\n\t\t}\r\n\t}\r\n});\r\n","// MouseCommon.js v3.4.1\r\n\r\npzpr.classmgr.makeCommon({\r\n\t//---------------------------------------------------------\r\n\tMouseEvent: {\r\n\t\t// 共通関数\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.inputcell() Cellのqans(回答データ)に0/1/2のいずれかを入力する。\r\n\t\t// mv.decIC()     0/1/2どれを入力すべきかを決定する。\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputShade: function() {\r\n\t\t\tthis.inputcell();\r\n\t\t},\r\n\t\tinputcell: function() {\r\n\t\t\tvar cell = this.getcell();\r\n\t\t\tif (cell.isnull || cell === this.mouseCell) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.inputData === null) {\r\n\t\t\t\tthis.decIC(cell);\r\n\t\t\t}\r\n\r\n\t\t\tthis.mouseCell = cell;\r\n\t\t\tthis.initFirstCell(cell);\r\n\r\n\t\t\tvar shade = 1,\r\n\t\t\t\tunshade = 2;\r\n\t\t\tif (this.inputData === shade && !cell.allowShade()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.inputData === unshade && !cell.allowUnshade()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.RBShadeCell && this.inputData === shade) {\r\n\t\t\t\tvar cell0 = this.firstCell;\r\n\t\t\t\tif (\r\n\t\t\t\t\t((cell0.bx & 2) ^ (cell0.by & 2)) !==\r\n\t\t\t\t\t((cell.bx & 2) ^ (cell.by & 2))\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.RBShadeCell && this.inputData !== shade) {\r\n\t\t\t\tif (this.firstState !== 1 && cell.qans === 1 && this.btn === \"right\") {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tcell.setQans(this.inputData === shade ? 1 : 0);\r\n\t\t\tcell.setQsub(this.inputData === unshade ? 1 : 0);\r\n\r\n\t\t\tcell.draw();\r\n\t\t},\r\n\t\tinitFirstCell: function(cell) {\r\n\t\t\tif (!this.firstCell.isnull) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.firstCell = cell;\r\n\t\t\tthis.firstState = cell.qans;\r\n\t\t},\r\n\t\tdecIC: function(cell) {\r\n\t\t\tif (this.inputMode === \"shade\") {\r\n\t\t\t\tthis.inputData = cell.qans !== 1 ? 1 : 0;\r\n\t\t\t} else if (this.inputMode === \"unshade\") {\r\n\t\t\t\tthis.inputData = cell.qsub !== 1 ? 2 : 0;\r\n\t\t\t} else if (this.puzzle.getConfig(\"use\") === 1) {\r\n\t\t\t\tif (this.btn === \"left\") {\r\n\t\t\t\t\tthis.inputData = cell.qans !== 1 ? 1 : 0;\r\n\t\t\t\t} else if (this.btn === \"right\") {\r\n\t\t\t\t\tthis.inputData = cell.qsub !== 1 ? 2 : 0;\r\n\t\t\t\t}\r\n\t\t\t} else if (this.puzzle.getConfig(\"use\") === 2) {\r\n\t\t\t\tif (cell.numberRemainsUnshaded && cell.qnum !== -1) {\r\n\t\t\t\t\tthis.inputData = cell.qsub !== 1 ? 2 : 0;\r\n\t\t\t\t} else if (this.btn === \"left\") {\r\n\t\t\t\t\tif (cell.qans === 1) {\r\n\t\t\t\t\t\tthis.inputData = 2;\r\n\t\t\t\t\t} else if (cell.qsub === 1) {\r\n\t\t\t\t\t\tthis.inputData = 0;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.inputData = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (this.btn === \"right\") {\r\n\t\t\t\t\tif (cell.qans === 1) {\r\n\t\t\t\t\t\tthis.inputData = 0;\r\n\t\t\t\t\t} else if (cell.qsub === 1) {\r\n\t\t\t\t\t\tthis.inputData = 1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.inputData = 2;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.inputclean_cell() Cellのqans(回答データ)を消去する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputclean_cell: function() {\r\n\t\t\tvar cell = this.getcell();\r\n\t\t\tif (cell.isnull || cell === this.mouseCell) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.mouseCell = cell;\r\n\r\n\t\t\tvar clist = new this.klass.CellList([cell]);\r\n\t\t\tif (this.puzzle.playmode) {\r\n\t\t\t\tclist.ansclear();\r\n\t\t\t} else {\r\n\t\t\t\tclist.allclear();\r\n\t\t\t}\r\n\r\n\t\t\tcell.draw();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.inputqnum()      Cellのqnum(数字データ)に数字を入力する\r\n\t\t// mv.inputqnum_main() Cellのqnum(数字データ)に数字を入力する(メイン処理)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputqnum: function() {\r\n\t\t\tvar cell = this.getcell();\r\n\t\t\tif (cell.isnull || cell === this.mouseCell) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tthis.cursor.modesnum &&\r\n\t\t\t\tthis.puzzle.playmode &&\r\n\t\t\t\t!this.cursor.checksnum(this.inputPoint) &&\r\n\t\t\t\tcell.noNum()\r\n\t\t\t) {\r\n\t\t\t\tthis.setcursorsnum(cell);\r\n\t\t\t} else if (cell !== this.cursor.getc()) {\r\n\t\t\t\tthis.setcursor(cell);\r\n\t\t\t} else {\r\n\t\t\t\tthis.inputqnum_main(cell);\r\n\t\t\t}\r\n\t\t\tthis.mouseCell = cell;\r\n\t\t},\r\n\t\tinputqnum_main: function(cell) {\r\n\t\t\tvar cell0 = cell,\r\n\t\t\t\tpuzzle = this.puzzle;\r\n\t\t\tif (\r\n\t\t\t\tpuzzle.playmode &&\r\n\t\t\t\tcell.qnum !== puzzle.klass.Cell.prototype.qnum &&\r\n\t\t\t\t!puzzle.klass.Cell.prototype.supportQnumAnum\r\n\t\t\t) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (puzzle.editmode && puzzle.board.roommgr.hastop) {\r\n\t\t\t\tcell0 = cell = cell.room.top;\r\n\t\t\t} else if (puzzle.execConfig(\"dispmove\")) {\r\n\t\t\t\tif (cell.isDestination()) {\r\n\t\t\t\t\tcell = cell.base;\r\n\t\t\t\t} else if (cell.lcnt > 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tcell.enableSubNumberArray &&\r\n\t\t\t\tpuzzle.playmode &&\r\n\t\t\t\tthis.cursor.targetdir >= 2\r\n\t\t\t) {\r\n\t\t\t\tvar snumpos = [-1, -1, 2, 3, 1, 0][this.cursor.targetdir];\r\n\t\t\t\tif (snumpos === -1) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tcell.setSnum(snumpos, this.getNewNumber(cell, cell.snum[snumpos]));\r\n\t\t\t} else if (puzzle.editmode && cell.ques === 51) {\r\n\t\t\t\tvar target = puzzle.cursor.detectTarget(cell);\r\n\t\t\t\tpuzzle.key.setnum51(\r\n\t\t\t\t\tcell,\r\n\t\t\t\t\ttarget,\r\n\t\t\t\t\tthis.getNewNumber(cell, puzzle.key.getnum51(cell, target))\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tcell.setNum(this.getNewNumber(cell, cell.getNum()));\r\n\t\t\t}\r\n\r\n\t\t\tif (puzzle.execConfig(\"dispmove\") && cell.noNum()) {\r\n\t\t\t\tcell.eraseMovedLines(); /* 丸数字がなくなったら付属する線も消去する */\r\n\t\t\t}\r\n\r\n\t\t\tcell0.draw();\r\n\t\t},\r\n\t\tgetNewNumber: function(cell, num) {\r\n\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\tishatena = puzzle.editmode && !cell.disInputHatena;\r\n\t\t\tvar max = cell.getmaxnum(),\r\n\t\t\t\tmin = cell.getminnum(),\r\n\t\t\t\tval = -1,\r\n\t\t\t\tqs = cell.qsub;\r\n\r\n\t\t\tvar subtype = 0; // qsubを0～いくつまで入力可能かの設定\r\n\t\t\tif (puzzle.editmode) {\r\n\t\t\t\tsubtype = -1;\r\n\t\t\t} else if (this.cursor.targetdir >= 2) {\r\n\t\t\t\tsubtype = 0;\r\n\t\t\t\tqs = 0;\r\n\t\t\t} else if (cell.numberWithMB) {\r\n\t\t\t\tsubtype = 2;\r\n\t\t\t\tqs = cell.qsub;\r\n\t\t\t} else if (puzzle.pid === \"roma\" || puzzle.pid === \"yinyang\") {\r\n\t\t\t\tsubtype = 0;\r\n\t\t\t} // 全マス埋めるタイプのパズルは補助記号なし\r\n\t\t\telse if (cell.numberAsObject || puzzle.pid === \"hebi\") {\r\n\t\t\t\tsubtype = 1;\r\n\t\t\t}\r\n\r\n\t\t\t// playmode: subtypeは0以上、 qsにqsub値が入る\r\n\t\t\t// editmode: subtypeは-1固定、qsは常に0が入る\r\n\t\t\tif (this.btn === \"left\") {\r\n\t\t\t\tif (num >= max) {\r\n\t\t\t\t\tval = subtype >= 1 ? -2 : -1;\r\n\t\t\t\t} else if (qs === 1) {\r\n\t\t\t\t\tval = subtype >= 2 ? -3 : -1;\r\n\t\t\t\t} else if (qs === 2) {\r\n\t\t\t\t\tval = -1;\r\n\t\t\t\t} else if (num === -1) {\r\n\t\t\t\t\tval = ishatena ? -2 : min;\r\n\t\t\t\t} else if (num < min) {\r\n\t\t\t\t\tval = min;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tval = num + 1;\r\n\t\t\t\t}\r\n\t\t\t} else if (this.btn === \"right\") {\r\n\t\t\t\tif (qs === 1) {\r\n\t\t\t\t\tval = max;\r\n\t\t\t\t} else if (qs === 2) {\r\n\t\t\t\t\tval = -2;\r\n\t\t\t\t} else if (num === -1) {\r\n\t\t\t\t\tif (subtype === 1) {\r\n\t\t\t\t\t\tval = -2;\r\n\t\t\t\t\t} else if (subtype === 2) {\r\n\t\t\t\t\t\tval = -3;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tval = max;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (num > max) {\r\n\t\t\t\t\tval = max;\r\n\t\t\t\t} else if (num <= min) {\r\n\t\t\t\t\tval = ishatena ? -2 : -1;\r\n\t\t\t\t} else if (num === -2) {\r\n\t\t\t\t\tval = -1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tval = num - 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn val;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.inputFixedNumber() Cellに固定のqnum/anum値を入力する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputFixedNumber: function(num) {\r\n\t\t\tvar cell = this.getcell();\r\n\t\t\tif (cell.isnull || cell === this.mouseCell) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar val = cell.getNum();\r\n\t\t\tif (val === -1 && cell.qsub > 0) {\r\n\t\t\t\tval = -1 - cell.qsub;\r\n\t\t\t}\r\n\t\t\tif (this.inputData === null) {\r\n\t\t\t\tthis.inputData = val === num ? -1 : num;\r\n\t\t\t}\r\n\t\t\tif (val !== num || this.inputData === -1) {\r\n\t\t\t\tcell.setNum(this.inputData);\r\n\t\t\t\tcell.draw();\r\n\t\t\t}\r\n\t\t\tthis.mouseCell = cell;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.inputQues() Cellのquesデータをarrayのとおりに入力する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputQues: function(array) {\r\n\t\t\tvar cell = this.getcell();\r\n\t\t\tif (cell.isnull) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (cell !== this.cursor.getc() && this.inputMode === \"auto\") {\r\n\t\t\t\tthis.setcursor(cell);\r\n\t\t\t} else {\r\n\t\t\t\tthis.inputQues_main(array, cell);\r\n\t\t\t}\r\n\t\t},\r\n\t\tinputQues_main: function(array, cell) {\r\n\t\t\tvar qu = cell.ques,\r\n\t\t\t\tlen = array.length;\r\n\t\t\tvar isInc =\r\n\t\t\t\t(this.inputMode === \"quesmark\" || this.inputMode === \"auto\") ===\r\n\t\t\t\t(this.btn === \"left\");\r\n\t\t\tif (isInc) {\r\n\t\t\t\tfor (var i = 0; i <= len - 1; i++) {\r\n\t\t\t\t\tif (qu === array[i]) {\r\n\t\t\t\t\t\tcell.setQues(array[i < len - 1 ? i + 1 : 0]);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfor (var i = len - 1; i >= 0; i--) {\r\n\t\t\t\t\tif (qu === array[i]) {\r\n\t\t\t\t\t\tcell.setQues(array[i > 0 ? i - 1 : len - 1]);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcell.draw();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.inputMB()        Cellのqsub(補助記号)の○, ×データを入力する\r\n\t\t// mv.inputFixedQsub() Cellのqsub(補助記号)の○, ×データを固定で入力する\r\n\t\t// mv.inputBGcolor()   Cellの背景色を入力する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputMB: function() {\r\n\t\t\tvar cell = this.getcell();\r\n\t\t\tif (cell.isnull) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tcell.setQsub((this.btn === \"left\" ? [1, 2, 0] : [2, 0, 1])[cell.qsub]);\r\n\t\t\tcell.draw();\r\n\t\t},\r\n\t\tinputFixedQsub: function(val) {\r\n\t\t\tvar cell = this.getcell();\r\n\t\t\tif (cell.isnull || cell.is51cell() || cell === this.mouseCell) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.inputData === null) {\r\n\t\t\t\tthis.inputData = cell.qsub !== val ? val : 0;\r\n\t\t\t}\r\n\t\t\tcell.setQsub(this.inputData);\r\n\t\t\tcell.draw();\r\n\t\t\tthis.mouseCell = cell;\r\n\t\t},\r\n\t\tinputBGcolor: function(isforceforward) {\r\n\t\t\tvar cell = this.getcell();\r\n\t\t\tif (cell.isnull || cell.is51cell() || cell === this.mouseCell) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.inputData !== null) {\r\n\t\t\t} else if (this.inputMode === \"bgcolor1\") {\r\n\t\t\t\tthis.inputMode = cell.qsub !== 1 ? 11 : 10;\r\n\t\t\t} else if (this.inputMode === \"bgcolor2\") {\r\n\t\t\t\tthis.inputMode = cell.qsub !== 2 ? 12 : 10;\r\n\t\t\t} else if (isforceforward || this.btn === \"left\") {\r\n\t\t\t\tif (cell.qsub === 0) {\r\n\t\t\t\t\tthis.inputData = 11;\r\n\t\t\t\t} else if (cell.qsub === 1) {\r\n\t\t\t\t\tthis.inputData = 12;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.inputData = 10;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (cell.qsub === 0) {\r\n\t\t\t\t\tthis.inputData = 12;\r\n\t\t\t\t} else if (cell.qsub === 1) {\r\n\t\t\t\t\tthis.inputData = 10;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.inputData = 11;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcell.setQsub(this.inputData - 10);\r\n\t\t\tcell.draw();\r\n\r\n\t\t\tthis.mouseCell = cell;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.inputdirec()      Cellのdirec(方向)のデータを入力する\r\n\t\t// mv.inputarrow_cell() Cellの矢印を入力する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputdirec: function() {\r\n\t\t\tvar pos = this.getpos(0);\r\n\t\t\tif (this.prevPos.equals(pos)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar cell = this.prevPos.getc();\r\n\t\t\tif (!cell.isnull) {\r\n\t\t\t\tif (cell.qnum !== -1) {\r\n\t\t\t\t\tvar dir = this.prevPos.getdir(pos, 2);\r\n\t\t\t\t\tif (dir !== cell.NDIR) {\r\n\t\t\t\t\t\tcell.setQdir(cell.qdir !== dir ? dir : 0);\r\n\t\t\t\t\t\tcell.draw();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.prevPos = pos;\r\n\t\t},\r\n\t\tinputarrow_cell: function() {\r\n\t\t\tvar pos = this.getpos(0);\r\n\t\t\tif (this.prevPos.equals(pos) && this.inputData === 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar dir = pos.NDIR,\r\n\t\t\t\tcell = this.prevPos.getc();\r\n\t\t\tif (!cell.isnull) {\r\n\t\t\t\tvar dir = this.prevPos.getdir(pos, 2);\r\n\t\t\t\tif (dir !== pos.NDIR) {\r\n\t\t\t\t\tthis.inputarrow_cell_main(cell, dir);\r\n\t\t\t\t\tcell.draw();\r\n\t\t\t\t\tthis.mousereset();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.prevPos = pos;\r\n\t\t},\r\n\t\tinputarrow_cell_main: function(cell, dir) {\r\n\t\t\tif (cell.numberAsObject) {\r\n\t\t\t\tcell.setNum(dir);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.inputtile()  黒タイル、白タイルを入力する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputtile: function() {\r\n\t\t\tvar cell = this.getcell();\r\n\t\t\tif (cell.isnull || cell.is51cell() || cell === this.mouseCell) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.inputData === null) {\r\n\t\t\t\tthis.decIC(cell);\r\n\t\t\t}\r\n\r\n\t\t\tthis.mouseCell = cell;\r\n\t\t\tvar clist = cell.room.clist;\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell2 = clist[i];\r\n\t\t\t\tif (this.inputData === 1 || cell2.qsub !== 3) {\r\n\t\t\t\t\t(this.inputData === 1 ? cell2.setShade : cell2.clrShade).call(cell2);\r\n\t\t\t\t\tcell2.setQsub(this.inputData === 2 ? 1 : 0);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tclist.draw();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.inputIcebarn()  アイスバーンを入力する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputIcebarn: function() {\r\n\t\t\tvar cell = this.getcell();\r\n\t\t\tif (cell.isnull || cell === this.mouseCell) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.inputData === null) {\r\n\t\t\t\tthis.inputData = cell.ice() ? 0 : 6;\r\n\t\t\t}\r\n\r\n\t\t\tcell.setQues(this.inputData);\r\n\t\t\tcell.drawaround();\r\n\t\t\tthis.mouseCell = cell;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.input51()            inputMode=='auto'時に[＼]を作ったり消したりする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinput51: function() {\r\n\t\t\tvar piece = this.getcell_excell(); /* piece : cell or excell */\r\n\t\t\tif (piece.isnull) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar group = piece.group;\r\n\t\t\tif (\r\n\t\t\t\tgroup === \"excell\" ||\r\n\t\t\t\t(group === \"cell\" && piece !== this.cursor.getc())\r\n\t\t\t) {\r\n\t\t\t\tthis.setcursor(piece);\r\n\t\t\t} else if (group === \"cell\") {\r\n\t\t\t\tthis.input51_main(piece);\r\n\t\t\t}\r\n\t\t},\r\n\t\tinput51_main: function(cell) {\r\n\t\t\tif (this.btn === \"right\") {\r\n\t\t\t\tcell.remove51cell();\r\n\t\t\t} else if (this.btn === \"left\") {\r\n\t\t\t\tif (!cell.is51cell()) {\r\n\t\t\t\t\tcell.set51cell();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar dx = this.inputPoint.bx - cell.bx,\r\n\t\t\t\t\t\tdy = this.inputPoint.by - cell.by;\r\n\t\t\t\t\tthis.cursor.chtarget(true, dx, dy);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tcell.drawaround();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.input51_fixed()      inputMode固定時に[＼]を作ったり消したりする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinput51_fixed: function() {\r\n\t\t\tvar cell = this.getcell();\r\n\t\t\tif (cell.isnull || cell === this.mouseCell) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.inputMode === \"clear\") {\r\n\t\t\t\tcell.remove51cell();\r\n\t\t\t\tthis.inputData = 0;\r\n\t\t\t} else if (this.inputMode === \"cell51\" && !cell.is51cell()) {\r\n\t\t\t\tcell.set51cell();\r\n\t\t\t\tthis.inputData = 51;\r\n\t\t\t}\r\n\r\n\t\t\tcell.drawaround();\r\n\r\n\t\t\tthis.mouseCell = cell;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.inputqnum_cell51()   [＼]のCellに数字を入力する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputqnum_cell51: function() {\r\n\t\t\tvar piece = this.getcell_excell(); /* piece : cell or excell */\r\n\t\t\tif (piece.isnull || (this.mouseCell === piece && !this.mouseend)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tthis.mousestart &&\r\n\t\t\t\t(piece !== this.cursor.getobj() || piece.ques !== 51)\r\n\t\t\t) {\r\n\t\t\t\tthis.setcursor(piece);\r\n\t\t\t\tthis.mousereset();\r\n\t\t\t} else if (\r\n\t\t\t\t(this.mousestart && this.cursor.getNumOfTarget(piece) < 2) ||\r\n\t\t\t\tthis.mouseend\r\n\t\t\t) {\r\n\t\t\t\tthis.inputqnum_main(piece);\r\n\t\t\t\tthis.mousereset();\r\n\t\t\t} else {\r\n\t\t\t\tthis.mouseCell = piece;\r\n\t\t\t\tthis.inputselect_cell51(piece);\r\n\t\t\t}\r\n\t\t},\r\n\t\tinputselect_cell51: function(cell) {\r\n\t\t\tif (this.mousestart) {\r\n\t\t\t\tthis.prevPos = this.getpos(0);\r\n\t\t\t} else if (this.mousemove) {\r\n\t\t\t\tvar dir = this.prevPos.getdir(this.getpos(0), 2);\r\n\t\t\t\tif (\r\n\t\t\t\t\t(dir === cell.RT || dir === cell.DN) &&\r\n\t\t\t\t\tdir !== this.cursor.targetdir\r\n\t\t\t\t) {\r\n\t\t\t\t\tthis.cursor.targetdir = dir;\r\n\t\t\t\t\tthis.cursor.draw();\r\n\t\t\t\t}\r\n\t\t\t\tif (dir !== cell.NDIR) {\r\n\t\t\t\t\tthis.mousereset();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.inputqnum_cross() Crossのques(問題データ)に0～4を入力する。\r\n\t\t// mv.inputcrossMark()  Crossの黒点を入力する。\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputqnum_cross: function() {\r\n\t\t\tvar cross = this.getcross();\r\n\t\t\tif (cross.isnull || cross === this.mouseCell) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (cross !== this.cursor.getx()) {\r\n\t\t\t\tthis.setcursor(cross);\r\n\t\t\t} else {\r\n\t\t\t\tthis.inputqnum_main(cross);\r\n\t\t\t}\r\n\t\t\tthis.mouseCell = cross;\r\n\t\t},\r\n\t\tinputcross_main: function(cross) {\r\n\t\t\tif (this.btn === \"left\") {\r\n\t\t\t\tcross.setQnum(cross.qnum !== 4 ? cross.qnum + 1 : -2);\r\n\t\t\t} else if (this.btn === \"right\") {\r\n\t\t\t\tcross.setQnum(cross.qnum !== -2 ? cross.qnum - 1 : 4);\r\n\t\t\t}\r\n\t\t\tcross.draw();\r\n\t\t},\r\n\t\tinputcrossMark: function() {\r\n\t\t\tvar pos = this.getpos(0.24);\r\n\t\t\tif (!pos.oncross()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar bd = this.board,\r\n\t\t\t\tbm = bd.hascross === 2 ? 0 : 2;\r\n\t\t\tif (\r\n\t\t\t\tpos.bx < bd.minbx + bm ||\r\n\t\t\t\tpos.bx > bd.maxbx - bm ||\r\n\t\t\t\tpos.by < bd.minby + bm ||\r\n\t\t\t\tpos.by > bd.maxby - bm\r\n\t\t\t) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar cross = pos.getx();\r\n\t\t\tif (cross.isnull) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.puzzle.opemgr.disCombine = true;\r\n\t\t\tcross.setQnum(cross.qnum === 1 ? -1 : 1);\r\n\t\t\tthis.puzzle.opemgr.disCombine = false;\r\n\r\n\t\t\tcross.draw();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.inputclean_cross() Crossのqans(回答データ)を消去する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputclean_cross: function() {\r\n\t\t\tvar cross = this.getcross();\r\n\t\t\tif (cross.isnull || cross === this.mouseCell) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.mouseCell = cross;\r\n\r\n\t\t\tvar xlist = new this.klass.CrossList([cross]);\r\n\t\t\tif (this.puzzle.playmode) {\r\n\t\t\t\txlist.ansclear();\r\n\t\t\t} else {\r\n\t\t\t\txlist.allclear();\r\n\t\t\t}\r\n\r\n\t\t\tcross.draw();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.inputborder()     盤面境界線のデータを入力する\r\n\t\t// mv.inputQsubLine()   盤面の境界線用補助記号を入力する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputborder: function() {\r\n\t\t\tvar pos = this.getpos(0.35);\r\n\t\t\tif (this.prevPos.equals(pos)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar border = this.prevPos.getborderobj(pos);\r\n\t\t\tif (!border.isnull) {\r\n\t\t\t\tif (this.inputData === null) {\r\n\t\t\t\t\tthis.inputData = border.isBorder() ? 0 : 1;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.inputData === 1) {\r\n\t\t\t\t\tborder.setBorder();\r\n\t\t\t\t} else if (this.inputData === 0) {\r\n\t\t\t\t\tborder.removeBorder();\r\n\t\t\t\t}\r\n\t\t\t\tborder.draw();\r\n\t\t\t}\r\n\t\t\tthis.prevPos = pos;\r\n\t\t},\r\n\t\tinputQsubLine: function() {\r\n\t\t\tvar pos = this.getpos(0);\r\n\t\t\tif (this.prevPos.equals(pos)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar border = this.prevPos.getnb(pos);\r\n\t\t\tif (!border.isnull) {\r\n\t\t\t\tif (this.inputData === null) {\r\n\t\t\t\t\tthis.inputData = border.qsub === 0 ? 1 : 0;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.inputData === 1) {\r\n\t\t\t\t\tborder.setQsub(1);\r\n\t\t\t\t} else if (this.inputData === 0) {\r\n\t\t\t\t\tborder.setQsub(0);\r\n\t\t\t\t}\r\n\t\t\t\tborder.draw();\r\n\t\t\t}\r\n\t\t\tthis.prevPos = pos;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.inputLine()     盤面の線を入力する\r\n\t\t// mv.inputMoveLine() 移動系パズル向けに盤面の線を入力する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputLine: function() {\r\n\t\t\t/* \"ものを動かしたように描画する\"でなければinputLineと同じ */\r\n\t\t\tif (this.puzzle.execConfig(\"dispmove\")) {\r\n\t\t\t\tthis.inputMoveLine();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar cell = this.getcell();\r\n\t\t\tthis.initFirstCell(cell);\r\n\r\n\t\t\tvar pos, border;\r\n\t\t\tif (!this.board.borderAsLine) {\r\n\t\t\t\tpos = this.getpos(0);\r\n\t\t\t\tif (this.prevPos.equals(pos)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tborder = this.prevPos.getnb(pos);\r\n\t\t\t} else {\r\n\t\t\t\tpos = this.getpos(0.35);\r\n\t\t\t\tif (this.prevPos.equals(pos)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tborder = this.prevPos.getborderobj(pos);\r\n\t\t\t}\r\n\r\n\t\t\tif (!border.isnull) {\r\n\t\t\t\tif (this.inputData === null) {\r\n\t\t\t\t\tthis.inputData = border.isLine() ? 0 : 1;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.inputData === 1) {\r\n\t\t\t\t\tborder.setLine();\r\n\t\t\t\t} else if (this.inputData === 0) {\r\n\t\t\t\t\tborder.removeLine();\r\n\t\t\t\t}\r\n\t\t\t\tborder.draw();\r\n\t\t\t}\r\n\t\t\tthis.prevPos = pos;\r\n\t\t},\r\n\t\tinputMoveLine: function() {\r\n\t\t\tvar moving = true;\r\n\t\t\tvar targetCell = this.getcell();\r\n\r\n\t\t\twhile (moving) {\r\n\t\t\t\tmoving = false;\r\n\t\t\t\tvar cell =\r\n\t\t\t\t\tthis.mouseCell && !this.mousestart\r\n\t\t\t\t\t\t? this.mouseCell.getOrthogonalCell(targetCell)\r\n\t\t\t\t\t\t: targetCell;\r\n\t\t\t\tif (cell.isnull) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar cell0 = this.mouseCell,\r\n\t\t\t\t\tpos = cell.getaddr();\r\n\t\t\t\t/* 初回はこの中に入ってきます。 */\r\n\t\t\t\tif (this.mousestart && cell.isDestination()) {\r\n\t\t\t\t\tthis.mouseCell = cell;\r\n\t\t\t\t\tthis.prevPos = pos;\r\n\t\t\t\t\tcell.draw();\r\n\t\t\t\t} else if (this.mousemove && !cell0.isnull && !cell.isDestination()) {\r\n\t\t\t\t\t/* 移動中の場合 */\r\n\t\t\t\t\tvar border = this.prevPos.getnb(pos);\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\t!border.isnull &&\r\n\t\t\t\t\t\t((!border.isLine() && cell.lcnt === 0) ||\r\n\t\t\t\t\t\t\t(border.isLine() && cell0.lcnt === 1))\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tvar old = border.isLine();\r\n\t\t\t\t\t\tif (!old) {\r\n\t\t\t\t\t\t\tborder.setLine();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tborder.removeLine();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.puzzle.opemgr.changeflag = true;\r\n\t\t\t\t\t\tif (old !== border.isLine()) {\r\n\t\t\t\t\t\t\tthis.mouseCell = cell;\r\n\t\t\t\t\t\t\tthis.prevPos = pos;\r\n\t\t\t\t\t\t\tborder.draw();\r\n\t\t\t\t\t\t\tmoving = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.inputpeke()   盤面の線が通らないことを示す×を入力する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputpeke: function() {\r\n\t\t\tvar pos = this.getpos(0.22);\r\n\t\t\tif (this.prevPos.equals(pos)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar border = pos.getb();\r\n\t\t\tif (!border.isnull) {\r\n\t\t\t\tif (this.inputData === null) {\r\n\t\t\t\t\tthis.inputData = border.qsub !== 2 ? 2 : 3;\r\n\t\t\t\t}\r\n\t\t\t\tif (\r\n\t\t\t\t\tthis.inputData === 2 &&\r\n\t\t\t\t\tborder.isLine() &&\r\n\t\t\t\t\tthis.puzzle.execConfig(\"dispmove\")\r\n\t\t\t\t) {\r\n\t\t\t\t} else if (this.inputData === 2) {\r\n\t\t\t\t\tborder.setPeke();\r\n\t\t\t\t} else if (this.inputData === 3) {\r\n\t\t\t\t\tborder.removeLineAndQsub();\r\n\t\t\t\t}\r\n\t\t\t\tborder.draw();\r\n\t\t\t}\r\n\t\t\tthis.prevPos = pos;\r\n\t\t},\r\n\t\tinputpeke_ifborder: function() {\r\n\t\t\tvar border = this.getpos(0.22).getb();\r\n\t\t\tif (border.group === \"border\" && !border.isnull) {\r\n\t\t\t\tthis.inputpeke();\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.inputdiraux_mousedown()   input lines/pekes/dir aux marks: mousedown\r\n\t\t// mv.inputdiraux_mousemove()                                    mousemove\r\n\t\t// mv.clickdiraux()                                              click\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputdiraux_mousedown: function() {\r\n\t\t\tvar pos = this.getpos(0.22),\r\n\t\t\t\tborder = pos.getb();\r\n\t\t\tif (!border.isnull) {\r\n\t\t\t\tthis.inputData = border.isnull || border.qsub !== 2 ? 2 : 3;\r\n\t\t\t\tthis.inputpeke();\r\n\t\t\t}\r\n\t\t},\r\n\t\tinputdiraux_mousemove: function() {\r\n\t\t\tvar pos = this.getpos(0);\r\n\t\t\tif (pos.getc().isnull) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar border = this.prevPos.getnb(pos);\r\n\t\t\tif (!border.isnull) {\r\n\t\t\t\tvar newval = null,\r\n\t\t\t\t\tdir = this.prevPos.getdir(pos, 2);\r\n\t\t\t\tif (this.inputData === null) {\r\n\t\t\t\t\tthis.inputData = border.qsub !== 10 + dir ? 11 : 0;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.inputData === 11) {\r\n\t\t\t\t\tnewval = 10 + dir;\r\n\t\t\t\t} else if (this.inputData === 0 && border.qsub === 10 + dir) {\r\n\t\t\t\t\tnewval = 0;\r\n\t\t\t\t}\r\n\t\t\t\tif (newval !== null) {\r\n\t\t\t\t\tborder.setQsub(newval);\r\n\t\t\t\t\tborder.draw();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.prevPos = pos;\r\n\t\t},\r\n\t\tclickdiraux: function() {\r\n\t\t\tvar pos = this.getpos(0.22);\r\n\t\t\tif (this.prevPos.equals(pos)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar border = pos.getb();\r\n\t\t\tif (border.isnull) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar trans = { 0: 2, 2: 0 },\r\n\t\t\t\tqs = border.qsub;\r\n\t\t\tif (!border.isvert) {\r\n\t\t\t\ttrans =\r\n\t\t\t\t\tthis.btn === \"left\"\r\n\t\t\t\t\t\t? { 0: 2, 2: 11, 11: 12, 12: 0 }\r\n\t\t\t\t\t\t: { 0: 12, 12: 11, 11: 2, 2: 0 };\r\n\t\t\t} else {\r\n\t\t\t\ttrans =\r\n\t\t\t\t\tthis.btn === \"left\"\r\n\t\t\t\t\t\t? { 0: 2, 2: 13, 13: 14, 14: 0 }\r\n\t\t\t\t\t\t: { 0: 14, 14: 13, 13: 2, 2: 0 };\r\n\t\t\t}\r\n\t\t\tqs = trans[qs] || 0;\r\n\t\t\tif (this.inputMode === \"diraux\" && qs === 2) {\r\n\t\t\t\tqs = trans[qs] || 0;\r\n\t\t\t}\r\n\r\n\t\t\tborder.setQsub(qs);\r\n\t\t\tborder.draw();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.inputTateyoko() 縦棒・横棒をドラッグで入力する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinputTateyoko: function() {\r\n\t\t\tif (this.mouseend && this.notInputted() && !!this.clickTateyoko) {\r\n\t\t\t\tthis.clickTateyoko();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar cell = this.getcell();\r\n\t\t\tif (cell.isnull) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// 黒マス上なら何もしない\r\n\t\t\tif (this.pid !== \"amibo\" && cell.ques === 1) {\r\n\t\t\t} else if (this.pid === \"amibo\" && cell.isNum()) {\r\n\t\t\t}\r\n\t\t\t// 初回 or 入力し続けていて別のマスに移動した場合\r\n\t\t\telse if (this.mouseCell !== cell) {\r\n\t\t\t\tthis.firstPoint.set(this.inputPoint);\r\n\t\t\t}\r\n\t\t\t// まだ入力していないセルの場合\r\n\t\t\telse if (this.firstPoint.bx !== null) {\r\n\t\t\t\tvar val = null,\r\n\t\t\t\t\tdx = this.inputPoint.bx - this.firstPoint.bx,\r\n\t\t\t\t\tdy = this.inputPoint.by - this.firstPoint.by;\r\n\t\t\t\tif (dy <= -0.5 || 0.5 <= dy) {\r\n\t\t\t\t\tval = 1;\r\n\t\t\t\t} else if (dx <= -0.5 || 0.5 <= dx) {\r\n\t\t\t\t\tval = 2;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (val !== null) {\r\n\t\t\t\t\tvar plus = this.pid === \"amibo\" || this.pid === \"tatamibari\";\r\n\r\n\t\t\t\t\tvar shape = 0;\r\n\t\t\t\t\tif (this.puzzle.playmode) {\r\n\t\t\t\t\t\tshape = { 0: 0, 11: 3, 12: 1, 13: 2 }[cell.qans];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tshape = { \"-1\": 0, 1: 3, 2: 1, 3: 2 }[cell.qnum];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.inputData === null ? shape & val : this.inputData <= 0) {\r\n\t\t\t\t\t\tval = !plus ? 0 : -val;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// 描画・後処理\r\n\t\t\t\t\tif (!plus) {\r\n\t\t\t\t\t\tshape = val;\r\n\t\t\t\t\t} else if (val > 0) {\r\n\t\t\t\t\t\tshape |= val;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tshape &= ~-val;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.puzzle.playmode) {\r\n\t\t\t\t\t\tcell.setQans([0, 12, 13, 11][shape]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcell.setQnum([-1, 2, 3, 1][shape]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcell.draw();\r\n\r\n\t\t\t\t\tthis.inputData = +(val > 0);\r\n\t\t\t\t\tthis.firstPoint.reset();\r\n\r\n\t\t\t\t\tif (this.pid === \"tatamibari\") {\r\n\t\t\t\t\t\tthis.mousereset();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.mouseCell = cell;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// mv.dispInfoBlk()  ひとつながりの黒マスを赤く表示する\r\n\t\t// mv.dispInfoUblk()\r\n\t\t// mv.dispInfoBlk8() ななめつながりの黒マスを赤く表示する\r\n\t\t// mv.dispInfoLine()   ひとつながりの線を赤く表示する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdispInfoBlk: function() {\r\n\t\t\tvar cell = this.getcell();\r\n\t\t\tthis.mousereset();\r\n\t\t\tif (cell.isnull || !cell.isShade()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!this.RBShadeCell) {\r\n\t\t\t\tcell.sblk.clist.setinfo(1);\r\n\t\t\t} else {\r\n\t\t\t\tthis.dispInfoBlk8(cell);\r\n\t\t\t}\r\n\t\t\tthis.board.hasinfo = true;\r\n\t\t\tthis.puzzle.redraw();\r\n\t\t},\r\n\t\tdispInfoUblk: function() {\r\n\t\t\tvar cell = this.getcell();\r\n\t\t\tthis.mousereset();\r\n\t\t\tif (cell.isnull || !cell.isUnshade()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcell.ublk.clist.setinfo(1);\r\n\t\t\tthis.board.hasinfo = true;\r\n\t\t\tthis.puzzle.redraw();\r\n\t\t},\r\n\t\tdispInfoBlk8: function(cell0) {\r\n\t\t\tvar stack = [cell0];\r\n\t\t\twhile (stack.length > 0) {\r\n\t\t\t\tvar cell = stack.pop();\r\n\t\t\t\tif (cell.qinfo !== 0) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcell.setinfo(1);\r\n\t\t\t\tvar bx = cell.bx,\r\n\t\t\t\t\tby = cell.by,\r\n\t\t\t\t\tclist = this.board.cellinside(bx - 2, by - 2, bx + 2, by + 2);\r\n\t\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\t\tvar cell2 = clist[i];\r\n\t\t\t\t\tif (cell2.qinfo === 0 && cell2.isShade()) {\r\n\t\t\t\t\t\tstack.push(cell2);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdispInfoLine: function() {\r\n\t\t\tvar bd = this.board,\r\n\t\t\t\tborder = this.getborder(0.15);\r\n\t\t\tthis.mousereset();\r\n\t\t\tif (border.isnull) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!border.isLine()) {\r\n\t\t\t\tvar piece = !bd.borderAsLine\r\n\t\t\t\t\t? this.getcell()\r\n\t\t\t\t\t: this.getcross(); /* cell or cross */\r\n\t\t\t\tif (\r\n\t\t\t\t\tpiece.isnull ||\r\n\t\t\t\t\t(bd.linegraph.isLineCross && (piece.lcnt === 3 || piece.lcnt === 4))\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar adb = piece.adjborder;\r\n\t\t\t\tif (adb.left.isLine()) {\r\n\t\t\t\t\tborder = adb.left;\r\n\t\t\t\t} else if (adb.right.isLine()) {\r\n\t\t\t\t\tborder = adb.right;\r\n\t\t\t\t} else if (adb.top.isLine()) {\r\n\t\t\t\t\tborder = adb.top;\r\n\t\t\t\t} else if (adb.bottom.isLine()) {\r\n\t\t\t\t\tborder = adb.bottom;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (border.isnull) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tbd.border.setinfo(-1);\r\n\t\t\tborder.path.setedgeinfo(1);\r\n\t\t\tbd.hasinfo = true;\r\n\t\t\tthis.puzzle.redraw();\r\n\t\t}\r\n\t}\r\n});\r\n","// AnswerCommon.js v3.4.1\r\nvar NW = [0,1,2,3,8,9,10,11,16,17,18,19,24,25,26,27];\r\nvar NE = [4,5,6,7,12,13,14,15,20,21,22,23,28,29,30,31];\r\nvar SW = [32,33,34,35,40,41,42,43,48,49,50,51,56,57,58,59];\r\nvar SE = [36,37,38,39,44,45,46,47,52,53,54,55,60,61,62,63];\r\npzpr.classmgr.makeCommon({\r\n\t//---------------------------------------------------------\r\n\tAnsCheck: {\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkAllCell()   条件func==trueになるマスがあったらエラーを設定する\r\n\t\t// ans.checkNoNumCell() 数字の入っていないセルがあるか判定する\r\n\t\t// ans.checkIceLines()  アイスバーン上で線が曲がっているか判定する\r\n\t\t// ans.checkNotCrossOnMark()  十字のマーク上で線が交差していることを判定する\r\n\t\t// ans.checkLineOnShadeCell() 黒マス上に線がないことを判定する\r\n\t\t// ans.checkNoLineObject()    線が出ていない数字や○がないかどうか判定する\r\n\t\t// ans.checkLineOverLetter()  線が数字などを通過しているか判定する\r\n\t\t// ans.checkNumberHasArrow()  For editors only. Check if a number clue is without an arrow.\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckAllCell: function(func, code) {\r\n\t\t\tfor (var c = 0; c < this.board.cell.length; c++) {\r\n\t\t\t\tvar cell = this.board.cell[c];\r\n\t\t\t\tif (cell.ques === 7) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (!func(cell)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.failcode.add(code);\r\n\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcell.seterr(1);\r\n\t\t\t}\r\n\t\t},\r\n\t\tcheckSomeCell: function(func, code) {\r\n\t\t\tfor (var c = 0; c < this.board.cell.length; c++) {\r\n\t\t\t\tvar cell = this.board.cell[c];\r\n\t\t\t\tif (cell.ques === 7) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (!func(cell)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.failcode.add(code);\r\n\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcell.seterr(1);\r\n\t\t\t}\r\n\t\t},\r\n\t\tcheckNoNumCell: function() {\r\n\t\t\tthis.checkAllCell(function(cell) {\r\n\t\t\t\treturn cell.ques === 0 && cell.noNum();\r\n\t\t\t}, \"ceNoNum\");\r\n\t\t},\r\n\t\tcheckIceLines: function() {\r\n\t\t\tthis.checkAllCell(function(cell) {\r\n\t\t\t\treturn cell.ice() && cell.isLineCurve();\r\n\t\t\t}, \"lnCurveOnIce\");\r\n\t\t},\r\n\t\tcheckNotCrossOnMark: function() {\r\n\t\t\tthis.checkAllCell(function(cell) {\r\n\t\t\t\treturn cell.lcnt !== 4 && cell.ques === 11;\r\n\t\t\t}, \"lnNotCrossMk\");\r\n\t\t},\r\n\t\tcheckLineOnShadeCell: function() {\r\n\t\t\tthis.checkAllCell(function(cell) {\r\n\t\t\t\treturn (cell.ques === 1 || cell.qans === 1) && cell.lcnt > 0;\r\n\t\t\t}, \"lnOnShade\");\r\n\t\t},\r\n\t\tcheckNoLineObject: function() {\r\n\t\t\tthis.checkAllCell(function(cell) {\r\n\t\t\t\treturn cell.lcnt === 0 && cell.isNum();\r\n\t\t\t}, \"nmNoLine\");\r\n\t\t},\r\n\t\tcheckLineOverLetter: function() {\r\n\t\t\tthis.checkAllCell(\r\n\t\t\t\tfunction(cell) {\r\n\t\t\t\t\treturn cell.lcnt >= 2 && cell.isNum();\r\n\t\t\t\t},\r\n\t\t\t\tthis.board.linegraph.moveline ? \"laOnNum\" : \"lcOnNum\"\r\n\t\t\t);\r\n\t\t},\r\n\t\tcheckNumberHasArrow: function() {\r\n\t\t\tthis.checkAllCell(function(cell) {\r\n\t\t\t\treturn cell.qnum >= 0 && cell.qdir === cell.NDIR;\r\n\t\t\t}, \"anNoArrow\");\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkDir4Cell()  セルの周囲4マスの条件がfunc==trueの時、エラーを設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckDir4Cell: function(iscount, type, code) {\r\n\t\t\t// type = 0:違う 1:numより小さい 2:numより大きい\r\n\t\t\tfor (var c = 0; c < this.board.cell.length; c++) {\r\n\t\t\t\tvar cell = this.board.cell[c];\r\n\t\t\t\tif (!cell.isValidNum()) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tvar num = cell.getNum(),\r\n\t\t\t\t\tcount = cell.countDir4Cell(iscount);\r\n\t\t\t\tif (\r\n\t\t\t\t\t(type === 0 && num === count) ||\r\n\t\t\t\t\t(type === 1 && num <= count) ||\r\n\t\t\t\t\t(type === 2 && num >= count)\r\n\t\t\t\t) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.failcode.add(code);\r\n\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcell.seterr(1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkSideCell()  隣り合った2つのセルが条件func==trueの時、エラーを設定する\r\n\t\t// ans.checkAdjacentShadeCell()  黒マスが隣接している時、エラーを設定する\r\n\t\t// ans.checkAdjacentDiffNumber() 同じ数字が隣接している時、エラーを設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckSideCell: function(func, code) {\r\n\t\t\tvar result = true,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tfor (var c = 0; c < bd.cell.length; c++) {\r\n\t\t\t\tvar cell = bd.cell[c],\r\n\t\t\t\t\tcell2 = cell.adjacent.right;\r\n\t\t\t\tif (cell.bx < bd.maxbx - 1 && func(cell, cell2)) {\r\n\t\t\t\t\tresult = false;\r\n\t\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcell.seterr(1);\r\n\t\t\t\t\tcell2.seterr(1);\r\n\t\t\t\t}\r\n\t\t\t\tcell2 = cell.adjacent.bottom;\r\n\t\t\t\tif (cell.by < bd.maxby - 1 && func(cell, cell2)) {\r\n\t\t\t\t\tresult = false;\r\n\t\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcell.seterr(1);\r\n\t\t\t\t\tcell2.seterr(1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!result) {\r\n\t\t\t\tthis.failcode.add(code);\r\n\t\t\t}\r\n\t\t},\r\n\t\tcheckAdjacentShadeCell: function() {\r\n\t\t\tthis.checkSideCell(function(cell1, cell2) {\r\n\t\t\t\treturn cell1.isShade() && cell2.isShade();\r\n\t\t\t}, \"csAdjacent\");\r\n\t\t},\r\n\t\tcheckAdjacentDiffNumber: function() {\r\n\t\t\tthis.checkSideCell(function(cell1, cell2) {\r\n\t\t\t\treturn cell1.sameNumber(cell2);\r\n\t\t\t}, \"nmAdjacent\");\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.check2x2Block()      2x2のセルが全て条件func==trueの時、エラーを設定する\r\n\t\t// ans.check2x2ShadeCell()  2x2のセルが黒マスの時、エラーを設定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheck2x2Block: function(func, code) {\r\n\t\t\tvar bd = this.board;\r\n\t\t\tfor (var c = 0; c < bd.cell.length; c++) {\r\n\t\t\t\tvar cell = bd.cell[c];\r\n\t\t\t\tif (cell.bx >= bd.maxbx - 1 || cell.by >= bd.maxby - 1) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar bx = cell.bx,\r\n\t\t\t\t\tby = cell.by;\r\n\t\t\t\tvar clist = bd.cellinside(bx, by, bx + 2, by + 2).filter(func);\r\n\t\t\t\tif (clist.length < 4) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.failcode.add(code);\r\n\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tclist.seterr(1);\r\n\t\t\t}\r\n\t\t},\r\n\t\tcheck2x2ShadeCell: function() {\r\n\t\t\tthis.check2x2Block(function(cell) {\r\n\t\t\t\treturn cell.isShade();\r\n\t\t\t}, \"cs2x2\");\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkSameColorTile() 白マスと黒マスが混ざったタイルがないかどうかチェックする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckSameColorTile: function() {\r\n\t\t\tthis.checkSameObjectInRoom(\r\n\t\t\t\tthis.board.roommgr,\r\n\t\t\t\tfunction(cell) {\r\n\t\t\t\t\treturn cell.isShade() ? 1 : 2;\r\n\t\t\t\t},\r\n\t\t\t\t\"bkMixed\"\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkConnectShade()    黒マスがひとつながりかどうかを判定する\r\n\t\t// ans.checkConnectUnshade()  白マスがひとつながりかどうかを判定する\r\n\t\t// ans.checkConnectNumber()   数字がひとつながりかどうかを判定する\r\n\t\t// ans.checkOneArea()  白マス/黒マス/線がひとつながりかどうかを判定する\r\n\t\t// ans.checkConnectUnshadeRB() 連黒分断禁のパズルで白マスが分断されているかチェックする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckConnectShade: function() {\r\n\t\t\tthis.checkOneArea(this.board.sblkmgr, \"csDivide\");\r\n\t\t},\r\n\t\tcheckConnectUnshade: function() {\r\n\t\t\tthis.checkOneArea(this.board.ublkmgr, \"cuDivide\");\r\n\t\t},\r\n\t\tcheckConnectNumber: function() {\r\n\t\t\tthis.checkOneArea(this.board.nblkmgr, \"nmDivide\");\r\n\t\t},\r\n\t\tcheckOneArea: function(graph, code) {\r\n\t\t\tif (graph.components.length > 1) {\r\n\t\t\t\tthis.failcode.add(code);\r\n\t\t\t\tgraph.components[0].getnodeobjs().seterr(1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tcheckConnectUnshadeRB: function() {\r\n\t\t\tif (this.board.ublkmgr.components.length > 1) {\r\n\t\t\t\tthis.failcode.add(\"cuDivideRB\");\r\n\t\t\t\tvar errclist = new this.klass.CellList();\r\n\t\t\t\tvar clist = this.board.cell.filter(function(cell) {\r\n\t\t\t\t\treturn cell.isShade();\r\n\t\t\t\t});\r\n\t\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\t\tvar cell = clist[i],\r\n\t\t\t\t\t\tlist = cell.getdir4clist(),\r\n\t\t\t\t\t\tfid = null;\r\n\t\t\t\t\tfor (var n = 0; n < list.length; n++) {\r\n\t\t\t\t\t\tvar cell2 = list[n][0];\r\n\t\t\t\t\t\tif (fid === null) {\r\n\t\t\t\t\t\t\tfid = cell2.ublk;\r\n\t\t\t\t\t\t} else if (fid !== cell2.ublk) {\r\n\t\t\t\t\t\t\terrclist.add(cell);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\terrclist.seterr(1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkShadeCellExist()  盤面に少なくとも一つは黒マスがあることを判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckShadeCellExist: function() {\r\n\t\t\tvar bd = this.board;\r\n\t\t\tif (bd.sblkmgr.enabled) {\r\n\t\t\t\tif (bd.sblkmgr.components.length > 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t} else if (bd.ublkmgr.enabled) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tbd.ublkmgr.components.length === 0 ||\r\n\t\t\t\t\tbd.ublkmgr.components[0].nodes.length !== bd.cell.length\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (\r\n\t\t\t\t\tbd.cell.some(function(cell) {\r\n\t\t\t\t\t\treturn cell.isShade();\r\n\t\t\t\t\t})\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.failcode.add(\"brNoShade\");\r\n\t\t},\r\n\r\n\t\t// autocheck trigger: shading status of all cells explicitly decided\r\n\t\tdoneShadingDecided: function() {\r\n\t\t\tvar bd = this.board;\r\n\t\t\tif (\r\n\t\t\t\tbd.cell.some(function(cell) {\r\n\t\t\t\t\treturn !cell.isShadeDecided();\r\n\t\t\t\t})\r\n\t\t\t) {\r\n\t\t\t\tthis.failcode.setUndecided();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkOneLoop()  盤面に引かれているループが一つに繋がっていることを判定する\r\n\t\t// ans.checkOneLine()  check if there are multiple lines\r\n\t\t// ans.checkOneLineBase()\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckOneLoop: function() {\r\n\t\t\tthis.checkOneLineBase(\"lnPlLoop\");\r\n\t\t},\r\n\r\n\t\tcheckOneLine: function() {\r\n\t\t\tthis.checkOneLineBase(\"lnPlLine\");\r\n\t\t},\r\n\r\n\t\tcheckOneLineBase: function(code) {\r\n\t\t\tvar bd = this.board,\r\n\t\t\t\tpaths = bd.linegraph.components;\r\n\t\t\tif (paths.length > 1) {\r\n\t\t\t\tthis.failcode.add(code);\r\n\t\t\t\tbd.border.setnoerr();\r\n\t\t\t\tpaths[0].setedgeerr(1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkNumberExist()  盤面に少なくとも一つは数字があることを判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckNumberExist: function() {\r\n\t\t\tif (\r\n\t\t\t\tthis.board.cell.some(function(cell) {\r\n\t\t\t\t\treturn cell.isValidNum();\r\n\t\t\t\t})\r\n\t\t\t) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.failcode.add(\"brNoValidNum\");\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkConnectAllNumber() 盤面に引かれている線が一つに繋がっていることを判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckConnectAllNumber: function() {\r\n\t\t\tvar bd = this.board,\r\n\t\t\t\tpaths = bd.linegraph.components;\r\n\t\t\tif (paths.length > 1) {\r\n\t\t\t\tthis.failcode.add(\"lcDivided\");\r\n\t\t\t\tbd.border.setnoerr();\r\n\t\t\t\tpaths[0].setedgeerr(1);\r\n\t\t\t\tpaths[0].clist.seterr(4);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkLineExist()  盤面に少なくとも一本は線が引かれていることを判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckLineExist: function() {\r\n\t\t\tvar bd = this.board;\r\n\t\t\tif (\r\n\t\t\t\tbd.linegraph.ltotal[0] !==\r\n\t\t\t\t(!bd.borderAsLine ? bd.cell : bd.cross).length\r\n\t\t\t) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.failcode.add(\"brNoLine\");\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkLineCount() セルから出ている線の本数について判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckCrossLine: function() {\r\n\t\t\tthis.checkLineCount(4, \"lnCross\");\r\n\t\t},\r\n\t\tcheckBranchLine: function() {\r\n\t\t\tthis.checkLineCount(3, \"lnBranch\");\r\n\t\t},\r\n\t\tcheckDeadendLine: function() {\r\n\t\t\tthis.checkLineCount(1, \"lnDeadEnd\");\r\n\t\t},\r\n\t\tcheckNoLine: function() {\r\n\t\t\tthis.checkLineCount(0, \"ceNoLine\");\r\n\t\t},\r\n\t\tcheckLineCount: function(val, code) {\r\n\t\t\tvar result = true,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tif (!bd.linegraph.ltotal[val]) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!bd.borderAsLine) {\r\n\t\t\t\tthis.checkAllCell(function(cell) {\r\n\t\t\t\t\treturn cell.lcnt === val;\r\n\t\t\t\t}, code);\r\n\t\t\t} else {\r\n\t\t\t\tvar boardcross = bd.cross;\r\n\t\t\t\tfor (var c = 0; c < boardcross.length; c++) {\r\n\t\t\t\t\tvar cross = boardcross[c];\r\n\t\t\t\t\tif (cross.lcnt !== val) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tresult = false;\r\n\t\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcross.seterr(1);\r\n\t\t\t\t\tbd.borderinside(\r\n\t\t\t\t\t\tcross.bx - 1,\r\n\t\t\t\t\t\tcross.by - 1,\r\n\t\t\t\t\t\tcross.bx + 1,\r\n\t\t\t\t\t\tcross.by + 1\r\n\t\t\t\t\t).seterr(1);\r\n\t\t\t\t}\r\n\t\t\t\tif (!result) {\r\n\t\t\t\t\tthis.failcode.add(code);\r\n\t\t\t\t\tbd.border.setnoerr();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkConnectLineCount() ○などがないセルから出ている線の本数について判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckCrossConnectLine: function() {\r\n\t\t\tthis.checkConnectLineCount(4, \"lnCross\");\r\n\t\t},\r\n\t\tcheckBranchConnectLine: function() {\r\n\t\t\tthis.checkConnectLineCount(3, \"lnBranch\");\r\n\t\t},\r\n\t\tcheckDeadendConnectLine: function() {\r\n\t\t\tthis.checkConnectLineCount(1, \"lnDeadEnd\");\r\n\t\t},\r\n\t\tcheckConnectLineCount: function(val, code) {\r\n\t\t\tif (!this.board.linegraph.ltotal[val]) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.checkAllCell(function(cell) {\r\n\t\t\t\treturn cell.noNum() && cell.lcnt === val;\r\n\t\t\t}, code);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkenableLineParts() '一部があかされている'線の部分に、線が引かれているか判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckenableLineParts: function() {\r\n\t\t\tvar bd = this.board;\r\n\t\t\tfor (var c = 0; c < bd.cell.length; c++) {\r\n\t\t\t\tvar cell = bd.cell[c],\r\n\t\t\t\t\tadb = cell.adjborder;\r\n\t\t\t\tif (\r\n\t\t\t\t\t(!adb.top.isLine() || !cell.noLP(cell.UP)) &&\r\n\t\t\t\t\t(!adb.bottom.isLine() || !cell.noLP(cell.DN)) &&\r\n\t\t\t\t\t(!adb.left.isLine() || !cell.noLP(cell.LT)) &&\r\n\t\t\t\t\t(!adb.right.isLine() || !cell.noLP(cell.RT))\r\n\t\t\t\t) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.failcode.add(\"ceAddLine\");\r\n\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcell.seterr(1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkAllArea()    すべてのエリアがevalfuncを満たすかどうか判定する\r\n\t\t// ans.checkAllBlock()   すべてのfuncを満たすマスで構成されるエリアが\r\n\t\t//                       evalfuncを満たすかどうか判定する\r\n\t\t// ans.checkAllArea2()   すべてのエリアがareaを引数に取るevalfuncを満たすかどうか判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckAllArea: function(graph, evalfunc, code) {\r\n\t\t\tthis.checkAllBlock(graph, null, evalfunc, code);\r\n\t\t},\r\n\t\tcheckAllBlock: function(graph, filterfunc, evalfunc, code) {\r\n\t\t\tvar areas = graph.components;\r\n\t\t\tfor (var id = 0; id < areas.length; id++) {\r\n\t\t\t\tvar area = areas[id],\r\n\t\t\t\t\tclist = area.clist;\r\n\t\t\t\tvar top = !!area.top ? area.top : clist.getQnumCell();\r\n\t\t\t\tvar d = clist.getRectSize();\r\n\t\t\t\tvar a = (!!filterfunc ? clist.filter(filterfunc) : clist).length;\r\n\t\t\t\tvar n = !!top && !top.isnull ? top.qnum : -1;\r\n\t\t\t\tif (evalfunc(d.cols, d.rows, a, n)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.failcode.add(code);\r\n\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (areas !== this.board.linegraph) {\r\n\t\t\t\t\tclist.seterr(this.pid !== \"tateyoko\" ? 1 : 4);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.board.border.setnoerr();\r\n\t\t\t\t\tarea.objs.seterr(1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tcheckSomeBlock: function(graph, filterfunc, qdl, evalfunc, code) {\r\n\t\t\tvar areas = graph.components;\r\n\t\t\tfor (var id = 0; id < areas.length; id++) {\r\n\t\t\t\tvar area = areas[id],\r\n\t\t\t\t\tclist = area.clist;\r\n\t\t\t\tvar accept = false;\r\n\t\t\t\tif (qdl === \"NW\") {\r\n\t\t\t\t\tfor (var idd = 0; idd < clist.length; idd++) {\r\n\t\t\t\t\t\tif (clist[idd].id in NW) {\r\n\t\t\t\t\t\t\taccept = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (qdl === \"NE\") {\r\n\t\t\t\t\tfor (var idd = 0; idd < clist.length; idd++) {\r\n\t\t\t\t\t\tif (clist[idd].id in NE) {\r\n\t\t\t\t\t\t\taccept = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (qdl === \"SW\") {\r\n\t\t\t\t\tfor (var idd = 0; idd < clist.length; idd++) {\r\n\t\t\t\t\t\tif (clist[idd].id in SW) {\r\n\t\t\t\t\t\t\taccept = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (qdl === \"SE\") {\r\n\t\t\t\t\tfor (var idd = 0; idd < clist.length; idd++) {\r\n\t\t\t\t\t\tif (clist[idd].id in SE) {\r\n\t\t\t\t\t\t\taccept = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!accept) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tvar top = !!area.top ? area.top : clist.getQnumCell();\r\n\t\t\t\tvar d = clist.getRectSize();\r\n\t\t\t\tvar a = (!!filterfunc ? clist.filter(filterfunc) : clist).length;\r\n\t\t\t\tvar n = !!top && !top.isnull ? top.qnum : -1;\r\n\t\t\t\tif (evalfunc(d.cols, d.rows, a, n)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.failcode.add(code);\r\n\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (areas !== this.board.linegraph) {\r\n\t\t\t\t\tclist.seterr(this.pid !== \"tateyoko\" ? 1 : 4);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.board.border.setnoerr();\r\n\t\t\t\t\tarea.objs.seterr(1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkNumberAndSize()  部屋にある数字と面積が等しいか判定する\r\n\t\t// ans.checkRoomRect()       領域が全て四角形であるかどうか判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckNumberAndSize: function() {\r\n\t\t\tthis.checkAllArea(\r\n\t\t\t\tthis.board.roommgr,\r\n\t\t\t\tfunction(w, h, a, n) {\r\n\t\t\t\t\treturn n <= 0 || n === a;\r\n\t\t\t\t},\r\n\t\t\t\t\"bkSizeNe\"\r\n\t\t\t);\r\n\t\t},\r\n\t\tcheckRoomRect: function() {\r\n\t\t\tthis.checkAllArea(\r\n\t\t\t\tthis.board.roommgr,\r\n\t\t\t\tfunction(w, h, a, n) {\r\n\t\t\t\t\treturn w * h === a;\r\n\t\t\t\t},\r\n\t\t\t\t\"bkNotRect\"\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkNoNumber()       部屋に数字が含まれていないかの判定を行う\r\n\t\t// ans.checkDoubleNumber()   部屋に数字が2つ以上含まれていないように判定を行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckNoNumber: function() {\r\n\t\t\tthis.checkAllBlock(\r\n\t\t\t\tthis.board.roommgr,\r\n\t\t\t\tfunction(cell) {\r\n\t\t\t\t\treturn cell.isNum();\r\n\t\t\t\t},\r\n\t\t\t\tfunction(w, h, a, n) {\r\n\t\t\t\t\treturn a !== 0;\r\n\t\t\t\t},\r\n\t\t\t\t\"bkNoNum\"\r\n\t\t\t);\r\n\t\t},\r\n\t\tcheckDoubleNumber: function() {\r\n\t\t\tthis.checkAllBlock(\r\n\t\t\t\tthis.board.roommgr,\r\n\t\t\t\tfunction(cell) {\r\n\t\t\t\t\treturn cell.isNum();\r\n\t\t\t\t},\r\n\t\t\t\tfunction(w, h, a, n) {\r\n\t\t\t\t\treturn a < 2;\r\n\t\t\t\t},\r\n\t\t\t\t\"bkNumGe2\"\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkShadeCellCount() 領域内の数字と黒マスの数が等しいか判定する\r\n\t\t// ans.checkNoShadeCellInArea()  部屋に黒マスがあるか判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckShadeCellCount: function() {\r\n\t\t\tthis.checkAllBlock(\r\n\t\t\t\tthis.board.roommgr,\r\n\t\t\t\tfunction(cell) {\r\n\t\t\t\t\treturn cell.isShade();\r\n\t\t\t\t},\r\n\t\t\t\tfunction(w, h, a, n) {\r\n\t\t\t\t\treturn n < 0 || n === a;\r\n\t\t\t\t},\r\n\t\t\t\t\"bkShadeNe\"\r\n\t\t\t);\r\n\t\t},\r\n\t\tcheckNoShadeCellInArea: function() {\r\n\t\t\tthis.checkAllBlock(\r\n\t\t\t\tthis.board.roommgr,\r\n\t\t\t\tfunction(cell) {\r\n\t\t\t\t\treturn cell.isShade();\r\n\t\t\t\t},\r\n\t\t\t\tfunction(w, h, a, n) {\r\n\t\t\t\t\treturn a > 0;\r\n\t\t\t\t},\r\n\t\t\t\t\"bkNoShade\"\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkLinesInArea()  領域の中で線が通っているセルの数を判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckLinesInArea: function(graph, evalfunc, code) {\r\n\t\t\tthis.checkAllBlock(\r\n\t\t\t\tgraph,\r\n\t\t\t\tfunction(cell) {\r\n\t\t\t\t\treturn cell.lcnt > 0;\r\n\t\t\t\t},\r\n\t\t\t\tevalfunc,\r\n\t\t\t\tcode\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkNoMovedObjectInRoom() 領域に移動後のオブジェクトがないと判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckNoMovedObjectInRoom: function(graph) {\r\n\t\t\tthis.checkAllBlock(\r\n\t\t\t\tgraph,\r\n\t\t\t\tfunction(cell) {\r\n\t\t\t\t\treturn cell.base.qnum !== -1;\r\n\t\t\t\t},\r\n\t\t\t\tfunction(w, h, a, n) {\r\n\t\t\t\t\treturn a !== 0;\r\n\t\t\t\t},\r\n\t\t\t\t\"bkNoNum\"\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkDisconnectLine() 数字などに繋がっていない線の判定を行う\r\n\t\t// ans.checkConnectObject()  数字が線で2つ以上繋がっていないように判定を行う\r\n\t\t// ans.checkTripleObject()   数字が線で3つ以上繋がっていないように判定を行う\r\n\t\t// ans.checkConnectObjectCount() 上記関数の共通処理\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckDisconnectLine: function() {\r\n\t\t\tthis.checkConnectObjectCount(\r\n\t\t\t\tfunction(a) {\r\n\t\t\t\t\treturn a > 0;\r\n\t\t\t\t},\r\n\t\t\t\tthis.board.linegraph.moveline ? \"laIsolate\" : \"lcIsolate\"\r\n\t\t\t);\r\n\t\t},\r\n\t\tcheckConnectObject: function() {\r\n\t\t\tthis.checkConnectObjectCount(function(a) {\r\n\t\t\t\treturn a < 2;\r\n\t\t\t}, \"nmConnected\");\r\n\t\t},\r\n\t\tcheckTripleObject: function() {\r\n\t\t\tthis.checkConnectObjectCount(function(a) {\r\n\t\t\t\treturn a < 3;\r\n\t\t\t}, \"lcTripleNum\");\r\n\t\t},\r\n\t\tcheckConnectObjectCount: function(evalfunc, code) {\r\n\t\t\tvar result = true,\r\n\t\t\t\tpaths = this.board.linegraph.components;\r\n\t\t\tfor (var id = 0; id < paths.length; id++) {\r\n\t\t\t\tvar clist = paths[id].clist;\r\n\t\t\t\tif (\r\n\t\t\t\t\tevalfunc(\r\n\t\t\t\t\t\tclist.filter(function(cell) {\r\n\t\t\t\t\t\t\treturn cell.isNum();\r\n\t\t\t\t\t\t}).length\r\n\t\t\t\t\t)\r\n\t\t\t\t) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tresult = false;\r\n\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tthis.board.border.setnoerr();\r\n\t\t\t\tpaths[id].setedgeerr(1);\r\n\t\t\t\tpaths[id].clist.seterr(4);\r\n\t\t\t}\r\n\t\t\tif (!result) {\r\n\t\t\t\tthis.failcode.add(code);\r\n\t\t\t\tthis.board.border.setnoerr();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkSideAreaSize() 境界線をはさんで接する部屋のgetvalで得られるサイズが異なることを判定する\r\n\t\t// ans.checkSideAreaCell() 境界線をはさんでタテヨコに接するセルの判定を行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckSideAreaSize: function(graph, getval, code) {\r\n\t\t\tvar sides = graph.getSideAreaInfo();\r\n\t\t\tfor (var i = 0; i < sides.length; i++) {\r\n\t\t\t\tvar a1 = getval(sides[i][0]),\r\n\t\t\t\t\ta2 = getval(sides[i][1]);\r\n\t\t\t\tif (a1 <= 0 || a2 <= 0 || a1 !== a2) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.failcode.add(code);\r\n\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tsides[i][0].clist.seterr(1);\r\n\t\t\t\tsides[i][1].clist.seterr(1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tcheckSideAreaCell: function(func, flag, code) {\r\n\t\t\tfor (var id = 0; id < this.board.border.length; id++) {\r\n\t\t\t\tvar border = this.board.border[id];\r\n\t\t\t\tif (!border.isBorder()) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tvar cell1 = border.sidecell[0],\r\n\t\t\t\t\tcell2 = border.sidecell[1];\r\n\t\t\t\tif (cell1.isnull || cell2.isnull || !func(cell1, cell2)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.failcode.add(code);\r\n\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (!flag) {\r\n\t\t\t\t\tcell1.seterr(1);\r\n\t\t\t\t\tcell2.seterr(1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcell1.room.clist.seterr(1);\r\n\t\t\t\t\tcell2.room.clist.seterr(1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkSameObjectInRoom()      部屋の中のgetvalueの値が1種類であるか判定する\r\n\t\t// ans.checkDifferentNumberInRoom() 部屋の中に同じ数字が存在しないことを判定する\r\n\t\t// ans.isDifferentNumberInClist()   clistの中に同じ数字が存在しないことを判定だけを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckSameObjectInRoom: function(graph, getvalue, code) {\r\n\t\t\tvar areas = graph.components;\r\n\t\t\tallloop: for (var id = 0; id < areas.length; id++) {\r\n\t\t\t\tvar clist = areas[id].clist;\r\n\t\t\t\tvar roomval = -1;\r\n\t\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\t\tvar cell = clist[i],\r\n\t\t\t\t\t\tval = getvalue(cell);\r\n\t\t\t\t\tif (val === -1 || roomval === val) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (roomval === -1) {\r\n\t\t\t\t\t\troomval = val;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.failcode.add(code);\r\n\t\t\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\t\t\tbreak allloop;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (areas !== this.board.linegraph.components) {\r\n\t\t\t\t\t\t\tclist.seterr(1);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.board.border.setnoerr();\r\n\t\t\t\t\t\t\tareas[id].setedgeerr(1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tcheckDifferentNumberInRoom: function() {\r\n\t\t\tthis.checkDifferentNumberInRoom_main(\r\n\t\t\t\tthis.board.roommgr,\r\n\t\t\t\tthis.isDifferentNumberInClist\r\n\t\t\t);\r\n\t\t},\r\n\t\tcheckDifferentNumberInRoom_main: function(graph, evalfunc) {\r\n\t\t\tvar areas = graph.components;\r\n\t\t\tfor (var r = 0; r < areas.length; r++) {\r\n\t\t\t\tvar clist = areas[r].clist;\r\n\t\t\t\tif (evalfunc.call(this, clist)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.failcode.add(\"bkDupNum\");\r\n\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tclist.seterr(1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tisDifferentNumberInClist: function(clist) {\r\n\t\t\treturn this.isIndividualObject(clist, function(cell) {\r\n\t\t\t\treturn cell.getNum();\r\n\t\t\t});\r\n\t\t},\r\n\t\tisDifferentAnsNumberInClist: function(clist) {\r\n\t\t\treturn this.isIndividualObject(clist, function(cell) {\r\n\t\t\t\treturn cell.anum;\r\n\t\t\t});\r\n\t\t},\r\n\t\tisIndividualObject: function(clist, numfunc) {\r\n\t\t\tif (clist.length <= 0) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tvar result = true,\r\n\t\t\t\td = [],\r\n\t\t\t\tnum = [];\r\n\t\t\tvar max = -1,\r\n\t\t\t\tbottom = clist[0].getminnum();\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tif (max < numfunc(clist[i])) {\r\n\t\t\t\t\tmax = numfunc(clist[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (var n = bottom; n <= max; n++) {\r\n\t\t\t\td[n] = 0;\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tnum[clist[i].id] = numfunc(clist[i]);\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tif (num[clist[i].id] >= bottom) {\r\n\t\t\t\t\td[num[clist[i].id]]++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar clist2 = clist.filter(function(cell) {\r\n\t\t\t\treturn num[cell.id] >= bottom && d[num[cell.id]] >= 2;\r\n\t\t\t});\r\n\t\t\tif (clist2.length > 0) {\r\n\t\t\t\tclist2.seterr(1);\r\n\t\t\t\tresult = false;\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkRowsCols()              タテ列・ヨコ列の数字の判定を行う\r\n\t\t// ans.checkDifferentNumberInLine() タテ列・ヨコ列に同じ数字が入っていないことを判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t/* ともにevalfuncはAnswerクラスの関数限定 */\r\n\t\tcheckRowsCols: function(evalfunc, code) {\r\n\t\t\tvar result = true,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tallloop: do {\r\n\t\t\t\t/* 横方向サーチ */\r\n\t\t\t\tfor (var by = 1; by <= bd.maxby; by += 2) {\r\n\t\t\t\t\tvar clist = bd.cellinside(bd.minbx + 1, by, bd.maxbx - 1, by);\r\n\t\t\t\t\tif (evalfunc.call(this, clist)) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tresult = false;\r\n\t\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\t\tbreak allloop;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t/* 縦方向サーチ */\r\n\t\t\t\tfor (var bx = 1; bx <= bd.maxbx; bx += 2) {\r\n\t\t\t\t\tvar clist = bd.cellinside(bx, bd.minby + 1, bx, bd.maxby - 1);\r\n\t\t\t\t\tif (evalfunc.call(this, clist)) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tresult = false;\r\n\t\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\t\tbreak allloop;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} while (0);\r\n\r\n\t\t\tif (!result) {\r\n\t\t\t\tthis.failcode.add(code);\r\n\t\t\t}\r\n\t\t},\r\n\t\tcheckDifferentNumberInLine: function() {\r\n\t\t\tthis.checkRowsCols(this.isDifferentNumberInClist, \"nmDupRow\");\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkRowsColsPartly()      黒マスや[＼]等で分かれるタテ列・ヨコ列の数字の判定を行う\r\n\t\t// ans.checkRowsColsFor51cell()   [＼]で分かれるタテ列・ヨコ列の数字の判定を行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckRowsColsPartly: function(evalfunc, termfunc, code) {\r\n\t\t\tvar result = true,\r\n\t\t\t\tbd = this.board,\r\n\t\t\t\tinfo;\r\n\t\t\tallloop: do {\r\n\t\t\t\t/* 横方向サーチ */\r\n\t\t\t\tinfo = { keycell: null, key51num: -1, isvert: false };\r\n\t\t\t\tfor (var by = 1; by <= bd.maxby; by += 2) {\r\n\t\t\t\t\tfor (var bx = 1; bx <= bd.maxbx; bx += 2) {\r\n\t\t\t\t\t\tfor (var tx = bx; tx <= bd.maxbx; tx += 2) {\r\n\t\t\t\t\t\t\tif (termfunc(bd.getc(tx, by))) {\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tinfo.keycell = bd.getobj(bx - 2, by);\r\n\t\t\t\t\t\tinfo.key51num = info.keycell.qnum;\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\ttx > bx &&\r\n\t\t\t\t\t\t\t!evalfunc.call(this, bd.cellinside(bx, by, tx - 2, by), info)\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tresult = false;\r\n\t\t\t\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\t\t\t\tbreak allloop;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbx = tx; /* 次のループはbx=tx+2 */\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t/* 縦方向サーチ */\r\n\t\t\t\tinfo = { keycell: null, key51num: -1, isvert: true };\r\n\t\t\t\tfor (var bx = 1; bx <= bd.maxbx; bx += 2) {\r\n\t\t\t\t\tfor (var by = 1; by <= bd.maxby; by += 2) {\r\n\t\t\t\t\t\tfor (var ty = by; ty <= bd.maxby; ty += 2) {\r\n\t\t\t\t\t\t\tif (termfunc(bd.getc(bx, ty))) {\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tinfo.keycell = bd.getobj(bx, by - 2);\r\n\t\t\t\t\t\tinfo.key51num = info.keycell.qnum2;\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tty > by &&\r\n\t\t\t\t\t\t\t!evalfunc.call(this, bd.cellinside(bx, by, bx, ty - 2), info)\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tresult = false;\r\n\t\t\t\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\t\t\t\tbreak allloop;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tby = ty; /* 次のループはbx=ty+2 */\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} while (0);\r\n\r\n\t\t\tif (!result) {\r\n\t\t\t\tthis.failcode.add(code);\r\n\t\t\t}\r\n\t\t},\r\n\t\tcheckRowsColsFor51cell: function(evalfunc, code) {\r\n\t\t\tthis.checkRowsColsPartly(\r\n\t\t\t\tevalfunc,\r\n\t\t\t\tfunction(cell) {\r\n\t\t\t\t\treturn cell.is51cell();\r\n\t\t\t\t},\r\n\t\t\t\tcode\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkBorderCount()  ある交点との周り四方向の境界線の数を判定する(bp==1:黒点が打たれている場合)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckBorderCross: function() {\r\n\t\t\tthis.checkBorderCount(4, 0, \"bdCross\");\r\n\t\t},\r\n\t\tcheckBorderDeadend: function() {\r\n\t\t\tthis.checkBorderCount(1, 0, \"bdDeadEnd\");\r\n\t\t},\r\n\t\tcheckBorderCount: function(val, bp, code) {\r\n\t\t\tvar result = true,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tvar crosses =\r\n\t\t\t\tbd.hascross === 2\r\n\t\t\t\t\t? bd.cross\r\n\t\t\t\t\t: bd.crossinside(\r\n\t\t\t\t\t\t\tbd.minbx + 2,\r\n\t\t\t\t\t\t\tbd.minby + 2,\r\n\t\t\t\t\t\t\tbd.maxbx - 2,\r\n\t\t\t\t\t\t\tbd.maxby - 2\r\n\t\t\t\t\t  );\r\n\t\t\tfor (var c = 0; c < crosses.length; c++) {\r\n\t\t\t\tvar cross = crosses[c];\r\n\t\t\t\tif (\r\n\t\t\t\t\tcross.lcnt !== val ||\r\n\t\t\t\t\t(bp === 1 && cross.qnum !== 1) ||\r\n\t\t\t\t\t(bp === 2 && cross.qnum === 1) ||\r\n\t\t\t\t\t(bp === 3 && (cross.bx % 8 === 0 || cross.by % 8 === 0) && (cross.bx > 8 || cross.by > 8)) ||\r\n\t\t\t\t\t(bp === 4 && (cross.bx % 8 === 0 || cross.by % 8 === 0) && (cross.bx > 8 || cross.by < 8)) ||\r\n\t\t\t\t\t(bp === 5 && (cross.bx % 8 === 0 || cross.by % 8 === 0) && (cross.bx < 8 || cross.by > 8)) ||\r\n\t\t\t\t\t(bp === 6 && (cross.bx % 8 === 0 || cross.by % 8 === 0) && (cross.bx < 8 || cross.by < 8))\r\n\t\t\t\t) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tresult = false;\r\n\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcross.setCrossBorderError();\r\n\t\t\t}\r\n\t\t\tif (!result) {\r\n\t\t\t\tthis.failcode.add(code);\r\n\t\t\t\tbd.border.setnoerr();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// ans.checkLineShape()  すべての丸などで区切られた線が、pathを引数に取るevalfunc==falseになるかどうか判定する\r\n\t\t// ans.checkLineShapeDeadend()  オブジェクトを結ぶ線が途中で途切れていることを判定する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tcheckLineShape: function(evalfunc, code) {\r\n\t\t\tvar result = true,\r\n\t\t\t\tpathsegs = this.getLineShapeInfo();\r\n\t\t\tfor (var id = 0; id < pathsegs.length; id++) {\r\n\t\t\t\tvar pathseg = pathsegs[id];\r\n\t\t\t\tif (!pathseg || !evalfunc(pathseg)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tresult = false;\r\n\t\t\t\tif (this.checkOnly) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tvar cells = pathseg.cells;\r\n\t\t\t\tif (!!cells[0] && !cells[0].isnull) {\r\n\t\t\t\t\tcells[0].seterr(1);\r\n\t\t\t\t}\r\n\t\t\t\tif (!!cells[1] && !cells[1].isnull) {\r\n\t\t\t\t\tcells[1].seterr(1);\r\n\t\t\t\t}\r\n\t\t\t\tpathseg.objs.seterr(1);\r\n\t\t\t}\r\n\t\t\tif (!result) {\r\n\t\t\t\tthis.failcode.add(code);\r\n\t\t\t\tthis.board.border.setnoerr();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcheckLineShapeDeadend: function() {\r\n\t\t\tthis.checkLineShape(function(pathseg) {\r\n\t\t\t\treturn pathseg.cells[1].isnull;\r\n\t\t\t}, \"lcDeadEnd\");\r\n\t\t},\r\n\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\t// ans.getLineShapeInfo() 丸などで区切られた線を探索し情報を設定する\r\n\t\t// ans.serachLineShapeInfo() 丸などで区切られた線を探索します\r\n\t\t//--------------------------------------------------------------------------------\r\n\t\tgetLineShapeInfo: function() {\r\n\t\t\tif (this._info.num) {\r\n\t\t\t\treturn this._info.num;\r\n\t\t\t}\r\n\r\n\t\t\tvar bd = this.board;\r\n\t\t\tvar pathsegs = [],\r\n\t\t\t\tpassed = [];\r\n\t\t\tfor (var id = 0; id < bd.border.length; id++) {\r\n\t\t\t\tpassed[id] = false;\r\n\t\t\t}\r\n\r\n\t\t\tvar clist = bd.cell.filter(function(cell) {\r\n\t\t\t\treturn cell.isNum();\r\n\t\t\t});\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i],\r\n\t\t\t\t\tadb = cell.adjborder;\r\n\t\t\t\tvar dir4bd = [adb.top, adb.bottom, adb.left, adb.right];\r\n\t\t\t\tfor (var a = 0; a < 4; a++) {\r\n\t\t\t\t\tvar firstbd = dir4bd[a];\r\n\t\t\t\t\tif (firstbd.isnull) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar pathseg = this.serachLineShapeInfo(cell, a + 1, passed);\r\n\t\t\t\t\tif (!!pathseg) {\r\n\t\t\t\t\t\tpathsegs.push(pathseg);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn (this._info.num = pathsegs);\r\n\t\t},\r\n\t\tserachLineShapeInfo: function(cell1, dir, passed) {\r\n\t\t\tvar pathseg = {\r\n\t\t\t\tobjs: new this.klass.BorderList(),\r\n\t\t\t\tcells: [cell1, null], // 出発したセル、到達したセル\r\n\t\t\t\tccnt: 0, // 曲がった回数\r\n\t\t\t\tlength: [], // 曲がった箇所で区切った、それぞれの線分の長さの配列\r\n\t\t\t\tdir1: dir, // dir1 スタート地点で線が出発した方向\r\n\t\t\t\tdir2: 0 // dir2 到達地点から見た、到達した線の方向\r\n\t\t\t};\r\n\r\n\t\t\tvar pos = cell1.getaddr();\r\n\t\t\twhile (1) {\r\n\t\t\t\tpos.movedir(dir, 1);\r\n\t\t\t\tif (pos.oncell()) {\r\n\t\t\t\t\tvar cell = pos.getc(),\r\n\t\t\t\t\t\tadb = cell.adjborder;\r\n\t\t\t\t\tif (cell.isnull || cell1 === cell || cell.isNum()) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} else if (this.board.linegraph.iscrossing(cell) && cell.lcnt >= 3) {\r\n\t\t\t\t\t} else if (dir !== 1 && adb.bottom.isLine()) {\r\n\t\t\t\t\t\tif (dir !== 2) {\r\n\t\t\t\t\t\t\tpathseg.ccnt++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdir = 2;\r\n\t\t\t\t\t} else if (dir !== 2 && adb.top.isLine()) {\r\n\t\t\t\t\t\tif (dir !== 1) {\r\n\t\t\t\t\t\t\tpathseg.ccnt++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdir = 1;\r\n\t\t\t\t\t} else if (dir !== 3 && adb.right.isLine()) {\r\n\t\t\t\t\t\tif (dir !== 4) {\r\n\t\t\t\t\t\t\tpathseg.ccnt++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdir = 4;\r\n\t\t\t\t\t} else if (dir !== 4 && adb.left.isLine()) {\r\n\t\t\t\t\t\tif (dir !== 3) {\r\n\t\t\t\t\t\t\tpathseg.ccnt++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdir = 3;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar border = pos.getb();\r\n\t\t\t\t\tif (border.isnull || !border.isLine() || passed[border.id]) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tpathseg.objs.add(border);\r\n\t\t\t\t\tpassed[border.id] = true;\r\n\r\n\t\t\t\t\tif (isNaN(pathseg.length[pathseg.ccnt])) {\r\n\t\t\t\t\t\tpathseg.length[pathseg.ccnt] = 1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tpathseg.length[pathseg.ccnt]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (pathseg.objs.length > 0) {\r\n\t\t\t\tpathseg.cells[1] = pos.getc();\r\n\t\t\t\tpathseg.dir2 = [0, 2, 1, 4, 3][dir];\r\n\t\t\t\treturn pathseg;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t},\r\n\r\n\t//---------------------------------------------------------------------------\r\n\t// ★FailCodeクラス 答えの文字列を扱う\r\n\t//---------------------------------------------------------------------------\r\n\tFailCode: {\r\n\t\t/* ** 黒マス ** */\r\n\t\tcs2x2: [\r\n\t\t\t\"2x2の黒マスのカタマリがあります。\",\r\n\t\t\t\"There is a 2x2 block of shaded cells.\"\r\n\t\t],\r\n\t\tcsNotSquare: [\r\n\t\t\t\"正方形でない黒マスのカタマリがあります。\",\r\n\t\t\t\"A group of shaded cells is not a square.\"\r\n\t\t],\r\n\t\tcsAdjacent: [\r\n\t\t\t\"黒マスがタテヨコに連続しています。\",\r\n\t\t\t\"Some shaded cells are adjacent.\"\r\n\t\t],\r\n\t\tcsDivide: [\"黒マスが分断されています。\", \"The shaded cells are divided.\"],\r\n\t\tcuDivide: [\"白マスが分断されています。\", \"The unshaded cells are divided.\"],\r\n\t\tcuDivideRB: [\r\n\t\t\t\"白マスが分断されています。\",\r\n\t\t\t\"The unshaded cells are divided.\"\r\n\t\t] /* 連黒分断禁 */,\r\n\t\tbrNoShade: [\r\n\t\t\t\"盤面に黒マスがありません。\",\r\n\t\t\t\"There are no shaded cells on the board.\"\r\n\t\t],\r\n\r\n\t\t/* ** 領域＋数字 ** */\r\n\t\tbkNoNum: [\"数字のないブロックがあります。\", \"A block has no number.\"],\r\n\t\tbkNumGe2: [\r\n\t\t\t\"1つのブロックに2つ以上の数字が入っています。\",\r\n\t\t\t\"A block has multiple numbers.\"\r\n\t\t],\r\n\t\tbkDupNum: [\r\n\t\t\t\"同じブロックに同じ数字が入っています。\",\r\n\t\t\t\"There are equal numbers in a block.\"\r\n\t\t],\r\n\t\tbkPlNum: [\r\n\t\t\t\"複数種類の数字が入っているブロックがあります。\",\r\n\t\t\t\"A block has two or more kinds of number.\"\r\n\t\t],\r\n\t\tbkSepNum: [\r\n\t\t\t\"同じ数字が異なるブロックに入っています。\",\r\n\t\t\t\"One kind of number is included in different blocks.\"\r\n\t\t],\r\n\r\n\t\tbkSizeNe: [\r\n\t\t\t\"数字とブロックの大きさが違います。\",\r\n\t\t\t\"The size of the block is not equal to the number.\"\r\n\t\t],\r\n\r\n\t\tbkShadeNe: [\r\n\t\t\t\"部屋の数字と黒マスの数が一致していません。\",\r\n\t\t\t\"The number of shaded cells in the room and the number written in the room is different.\"\r\n\t\t],\r\n\t\tbkShadeDivide: [\r\n\t\t\t\"1つの部屋に入る黒マスが2つ以上に分裂しています。\",\r\n\t\t\t\"Shaded cells are divided in a room.\"\r\n\t\t],\r\n\t\tbkNoShade: [\"黒マスがない部屋があります。\", \"A room has no shaded cell.\"],\r\n\t\tbkMixed: [\r\n\t\t\t\"白マスと黒マスの混在したタイルがあります。\",\r\n\t\t\t\"A tile includes both shaded and unshaded cells.\"\r\n\t\t],\r\n\r\n\t\tbkWidthGt1: [\r\n\t\t\t\"幅が１マスではないタタミがあります。\",\r\n\t\t\t\"The width of the tatami is not one.\"\r\n\t\t],\r\n\r\n\t\tbrNoValidNum: [\r\n\t\t\t\"盤面に数字がありません。\",\r\n\t\t\t\"There are no numbers on the board.\"\r\n\t\t],\r\n\r\n\t\t/* ** 領域＋線を引く ** */\r\n\t\tbrNoLine: [\"線が引かれていません。\", \"There is no line on the board.\"],\r\n\r\n\t\t/* ** 盤面切り分け系 ** */\r\n\t\tbkNotRect: [\r\n\t\t\t\"四角形ではない部屋があります。\",\r\n\t\t\t\"There is a room whose shape is not a rectangle.\"\r\n\t\t],\r\n\t\tbdDeadEnd: [\r\n\t\t\t\"途中で途切れている線があります。\",\r\n\t\t\t\"There is a dead-end line.\"\r\n\t\t],\r\n\t\tbdCross: [\"十字の交差点があります。\", \"There is a crossing border line.\"],\r\n\r\n\t\t/* ** 線を引く系 ** */\r\n\t\tlnDeadEnd: [\r\n\t\t\t\"途中で途切れている線があります。\",\r\n\t\t\t\"There is a dead-end line.\"\r\n\t\t],\r\n\t\tlnBranch: [\"分岐している線があります。\", \"There is a branch line.\"],\r\n\t\tlnCross: [\"線が交差しています。\", \"There is a crossing line.\"],\r\n\t\tlnNotCrossMk: [\r\n\t\t\t\"十字の場所で線が交差していません。\",\r\n\t\t\t\"A cross-joint cell doesn't have four-way lines.\"\r\n\t\t],\r\n\t\tlnCrossExIce: [\r\n\t\t\t\"氷の部分以外で線が交差しています。\",\r\n\t\t\t\"A line is crossed outside of ice.\"\r\n\t\t],\r\n\t\tlnCurveOnIce: [\"氷の部分で線が曲がっています。\", \"A line turns on ice.\"],\r\n\t\tlnPlLine: [\"線がひとつながりではありません。\", \"There are multiple lines.\"],\r\n\t\tlnPlLoop: [\"輪っかが一つではありません。\", \"There are multiple loops.\"],\r\n\t\tlnOnShade: [\r\n\t\t\t\"黒マスの上に線が引かれています。\",\r\n\t\t\t\"There is a line on a shaded cell.\"\r\n\t\t],\r\n\r\n\t\t/* ** 線でつなぐ系 ** */\r\n\t\tlcDeadEnd: [\"線が途中で途切れています。\", \"There is a dead-end line.\"],\r\n\t\tlcDivided: [\r\n\t\t\t\"線が全体でひとつながりになっていません。\",\r\n\t\t\t\"All lines and numbers are not connected to each other.\"\r\n\t\t],\r\n\t\tlcTripleNum: [\r\n\t\t\t\"3つ以上の数字がつながっています。\",\r\n\t\t\t\"Three or more numbers are connected.\"\r\n\t\t],\r\n\t\tlcIsolate: [\r\n\t\t\t\"数字につながっていない線があります。\",\r\n\t\t\t\"A line doesn't connect to any number.\"\r\n\t\t],\r\n\t\tlcOnNum: [\r\n\t\t\t\"数字の上を線が通過しています。\",\r\n\t\t\t\"A line goes through a number.\"\r\n\t\t],\r\n\t\tnmNoLine: [\r\n\t\t\t\"どこにもつながっていない数字があります。\",\r\n\t\t\t\"A number is not connected to another number.\"\r\n\t\t],\r\n\t\tnmConnected: [\r\n\t\t\t\"アルファベットが繋がっています。\",\r\n\t\t\t\"There are connected letters.\"\r\n\t\t],\r\n\r\n\t\t/* ** 線で動かす系 ** */\r\n\t\tlaIsolate: [\r\n\t\t\t\"アルファベットにつながっていない線があります。\",\r\n\t\t\t\"A line doesn't connect to any letter.\"\r\n\t\t],\r\n\t\tlaOnNum: [\r\n\t\t\t\"アルファベットの上を線が通過しています。\",\r\n\t\t\t\"A line goes through a letter.\"\r\n\t\t],\r\n\t\tlaCurve: [\"曲がっている線があります。\", \"A line has curve.\"],\r\n\t\tlaLenNe: [\"数字と線の長さが違います。\", \"The length of a line is wrong.\"],\r\n\r\n\t\t/* ** 単体セルチェック ** */\r\n\t\tceNoNum: [\"数字の入っていないマスがあります。\", \"There is an empty cell.\"],\r\n\t\tceNoLine: [\"線が引かれていないマスがあります。\", \"There is an empty cell.\"],\r\n\t\tceAddLine: [\r\n\t\t\t\"最初から引かれている線があるマスに線が足されています。\",\r\n\t\t\t\"A cell with given lines has extra lines.\"\r\n\t\t],\r\n\r\n\t\tanNoArrow: [\"矢印がない数字のマスがあります。\", \"A number has no arrow.\"],\r\n\t\tanShadeNe: [\r\n\t\t\t\"矢印の方向にある黒マスの数が正しくありません。\",\r\n\t\t\t\"The number of shaded cells is not correct.\"\r\n\t\t],\r\n\r\n\t\t/* ** 数字系 ** */\r\n\t\tnmAdjacent: [\r\n\t\t\t\"同じ数字がタテヨコに連続しています。\",\r\n\t\t\t\"Equal numbers are adjacent.\"\r\n\t\t],\r\n\t\tnmDupRow: [\r\n\t\t\t\"同じ列に同じ数字が入っています。\",\r\n\t\t\t\"There are equal numbers in a row or column.\"\r\n\t\t],\r\n\t\tnmDivide: [\r\n\t\t\t\"タテヨコにつながっていない数字があります。\",\r\n\t\t\t\"Numbers are divided.\"\r\n\t\t],\r\n\t\tnmSumViewNe: [\r\n\t\t\t\"数字と黒マスにぶつかるまでの4方向のマスの合計が違います。\",\r\n\t\t\t\"A cell containing a clue number sees a different number of cells in the four orthogonal directions.\"\r\n\t\t]\r\n\t}\r\n});\r\n","// BoardExecCommon.js v3.4.1\r\n\r\npzpr.classmgr.makeCommon({\r\n\t//---------------------------------------------------------\r\n\tBoardExec: {\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t// bd.exec.adjustBoardData()    回転・反転開始前に各セルの調節を行う(共通処理)\r\n\t\t// bd.exec.adjustBoardData2()   回転・反転終了後に各セルの調節を行う(共通処理)\r\n\t\t//   から呼び出される共通関数\r\n\t\t//------------------------------------------------------------------------------\r\n\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t// bd.exec.adjustNumberArrow()  回転・反転開始前の矢印つき数字の調整\r\n\t\t// bd.exec.adjustCellArrow()    回転・反転開始前の矢印セルの調整\r\n\t\t// bd.exec.adjustBorderArrow()  回転・反転開始前の境界線にある矢印セル等の調整\r\n\t\t//------------------------------------------------------------------------------\r\n\t\tadjustNumberArrow: function(key, d) {\r\n\t\t\tif (key & this.TURNFLIP) {\r\n\t\t\t\tthis.adjustCellQdirArrow(key, d);\r\n\t\t\t}\r\n\t\t},\r\n\t\tadjustCellArrow: function(key, d) {\r\n\t\t\tif (key & this.TURNFLIP) {\r\n\t\t\t\tif (this.klass.Cell.prototype.numberAsObject) {\r\n\t\t\t\t\tthis.adjustCellQnumArrow(key, d);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.adjustCellQdirArrow(key, d);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tadjustCellQdirArrow: function(key, d) {\r\n\t\t\tvar trans = this.getTranslateDir(key);\r\n\t\t\tvar clist = this.board.cellinside(d.x1, d.y1, d.x2, d.y2);\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i];\r\n\t\t\t\tvar val = trans[cell.qdir];\r\n\t\t\t\tif (!!val) {\r\n\t\t\t\t\tcell.setQdir(val);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tadjustCellQnumArrow: function(key, d) {\r\n\t\t\tvar trans = this.getTranslateDir(key);\r\n\t\t\tvar clist = this.board.cellinside(d.x1, d.y1, d.x2, d.y2);\r\n\t\t\tfor (var i = 0; i < clist.length; i++) {\r\n\t\t\t\tvar cell = clist[i];\r\n\t\t\t\tvar val = trans[cell.qnum];\r\n\t\t\t\tif (!!val) {\r\n\t\t\t\t\tcell.setQnum(val);\r\n\t\t\t\t}\r\n\t\t\t\tvar val = trans[cell.anum];\r\n\t\t\t\tif (!!val) {\r\n\t\t\t\t\tcell.setAnum(val);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tadjustBorderArrow: function(key, d) {\r\n\t\t\tif (key & this.TURNFLIP) {\r\n\t\t\t\tvar trans = this.getTranslateDir(key);\r\n\t\t\t\tvar blist = this.board.borderinside(d.x1, d.y1, d.x2, d.y2);\r\n\t\t\t\tfor (var i = 0; i < blist.length; i++) {\r\n\t\t\t\t\tvar border = blist[i],\r\n\t\t\t\t\t\tval;\r\n\t\t\t\t\tval = trans[border.qdir];\r\n\t\t\t\t\tif (!!val) {\r\n\t\t\t\t\t\tborder.setQdir(val);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetTranslateDir: function(key) {\r\n\t\t\tvar trans = {};\r\n\t\t\tswitch (key) {\r\n\t\t\t\tcase this.FLIPY:\r\n\t\t\t\t\ttrans = { 1: 2, 2: 1 };\r\n\t\t\t\t\tbreak; // 上下反転\r\n\t\t\t\tcase this.FLIPX:\r\n\t\t\t\t\ttrans = { 3: 4, 4: 3 };\r\n\t\t\t\t\tbreak; // 左右反転\r\n\t\t\t\tcase this.TURNR:\r\n\t\t\t\t\ttrans = { 1: 4, 2: 3, 3: 1, 4: 2 };\r\n\t\t\t\t\tbreak; // 右90°回転\r\n\t\t\t\tcase this.TURNL:\r\n\t\t\t\t\ttrans = { 1: 3, 2: 4, 3: 2, 4: 1 };\r\n\t\t\t\t\tbreak; // 左90°回転\r\n\t\t\t}\r\n\t\t\treturn trans;\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t// bd.exec.adjustQues51_1()     回転・反転開始前の[＼]セルの調整\r\n\t\t// bd.exec.adjustQues51_2()     回転・反転終了後の[＼]セルの調整\r\n\t\t//------------------------------------------------------------------------------\r\n\t\tadjustQues51_1: function(key, d) {\r\n\t\t\tvar bx1 = d.x1 | 1,\r\n\t\t\t\tby1 = d.y1 | 1;\r\n\t\t\tthis.qnumw = [];\r\n\t\t\tthis.qnumh = [];\r\n\r\n\t\t\tvar bd = this.board;\r\n\t\t\tfor (var by = by1; by <= d.y2; by += 2) {\r\n\t\t\t\tthis.qnumw[by] = [bd.getex(-1, by).qnum];\r\n\t\t\t\tfor (var bx = bx1; bx <= d.x2; bx += 2) {\r\n\t\t\t\t\tvar cell = bd.getc(bx, by);\r\n\t\t\t\t\tif (cell.is51cell()) {\r\n\t\t\t\t\t\tthis.qnumw[by].push(cell.qnum);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (var bx = bx1; bx <= d.x2; bx += 2) {\r\n\t\t\t\tthis.qnumh[bx] = [bd.getex(bx, -1).qnum2];\r\n\t\t\t\tfor (var by = by1; by <= d.y2; by += 2) {\r\n\t\t\t\t\tvar cell = bd.getc(bx, by);\r\n\t\t\t\t\tif (cell.is51cell()) {\r\n\t\t\t\t\t\tthis.qnumh[bx].push(cell.qnum2);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tadjustQues51_2: function(key, d) {\r\n\t\t\tvar xx = d.x1 + d.x2,\r\n\t\t\t\tyy = d.y1 + d.y2,\r\n\t\t\t\tbx1 = d.x1 | 1,\r\n\t\t\t\tby1 = d.y1 | 1,\r\n\t\t\t\tidx;\r\n\r\n\t\t\tvar bd = this.board;\r\n\t\t\tbd.disableInfo();\r\n\t\t\tswitch (key) {\r\n\t\t\t\tcase this.FLIPY: // 上下反転\r\n\t\t\t\t\tfor (var bx = bx1; bx <= d.x2; bx += 2) {\r\n\t\t\t\t\t\tidx = 1;\r\n\t\t\t\t\t\tthis.qnumh[bx] = this.qnumh[bx].reverse();\r\n\t\t\t\t\t\tbd.getex(bx, -1).setQnum2(this.qnumh[bx][0]);\r\n\t\t\t\t\t\tfor (var by = by1; by <= d.y2; by += 2) {\r\n\t\t\t\t\t\t\tvar cell = bd.getc(bx, by);\r\n\t\t\t\t\t\t\tif (cell.is51cell()) {\r\n\t\t\t\t\t\t\t\tcell.setQnum2(this.qnumh[bx][idx]);\r\n\t\t\t\t\t\t\t\tidx++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase this.FLIPX: // 左右反転\r\n\t\t\t\t\tfor (var by = by1; by <= d.y2; by += 2) {\r\n\t\t\t\t\t\tidx = 1;\r\n\t\t\t\t\t\tthis.qnumw[by] = this.qnumw[by].reverse();\r\n\t\t\t\t\t\tbd.getex(-1, by).setQnum(this.qnumw[by][0]);\r\n\t\t\t\t\t\tfor (var bx = bx1; bx <= d.x2; bx += 2) {\r\n\t\t\t\t\t\t\tvar cell = bd.getc(bx, by);\r\n\t\t\t\t\t\t\tif (cell.is51cell()) {\r\n\t\t\t\t\t\t\t\tcell.setQnum(this.qnumw[by][idx]);\r\n\t\t\t\t\t\t\t\tidx++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase this.TURNR: // 右90°反転\r\n\t\t\t\t\tfor (var by = by1; by <= d.y2; by += 2) {\r\n\t\t\t\t\t\tidx = 1;\r\n\t\t\t\t\t\tthis.qnumh[by] = this.qnumh[by].reverse();\r\n\t\t\t\t\t\tbd.getex(-1, by).setQnum(this.qnumh[by][0]);\r\n\t\t\t\t\t\tfor (var bx = bx1; bx <= d.x2; bx += 2) {\r\n\t\t\t\t\t\t\tvar cell = bd.getc(bx, by);\r\n\t\t\t\t\t\t\tif (cell.is51cell()) {\r\n\t\t\t\t\t\t\t\tcell.setQnum(this.qnumh[by][idx]);\r\n\t\t\t\t\t\t\t\tidx++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var bx = bx1; bx <= d.x2; bx += 2) {\r\n\t\t\t\t\t\tidx = 1;\r\n\t\t\t\t\t\tbd.getex(bx, -1).setQnum2(this.qnumw[xx - bx][0]);\r\n\t\t\t\t\t\tfor (var by = by1; by <= d.y2; by += 2) {\r\n\t\t\t\t\t\t\tvar cell = bd.getc(bx, by);\r\n\t\t\t\t\t\t\tif (cell.is51cell()) {\r\n\t\t\t\t\t\t\t\tcell.setQnum2(this.qnumw[xx - bx][idx]);\r\n\t\t\t\t\t\t\t\tidx++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase this.TURNL: // 左90°反転\r\n\t\t\t\t\tfor (var by = by1; by <= d.y2; by += 2) {\r\n\t\t\t\t\t\tidx = 1;\r\n\t\t\t\t\t\tbd.getex(-1, by).setQnum(this.qnumh[yy - by][0]);\r\n\t\t\t\t\t\tfor (var bx = bx1; bx <= d.x2; bx += 2) {\r\n\t\t\t\t\t\t\tvar cell = bd.getc(bx, by);\r\n\t\t\t\t\t\t\tif (cell.is51cell()) {\r\n\t\t\t\t\t\t\t\tcell.setQnum(this.qnumh[yy - by][idx]);\r\n\t\t\t\t\t\t\t\tidx++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var bx = bx1; bx <= d.x2; bx += 2) {\r\n\t\t\t\t\t\tidx = 1;\r\n\t\t\t\t\t\tthis.qnumw[bx] = this.qnumw[bx].reverse();\r\n\t\t\t\t\t\tbd.getex(bx, -1).setQnum2(this.qnumw[bx][0]);\r\n\t\t\t\t\t\tfor (var by = by1; by <= d.y2; by += 2) {\r\n\t\t\t\t\t\t\tvar cell = bd.getc(bx, by);\r\n\t\t\t\t\t\t\tif (cell.is51cell()) {\r\n\t\t\t\t\t\t\t\tcell.setQnum2(this.qnumw[bx][idx]);\r\n\t\t\t\t\t\t\t\tidx++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tbd.enableInfo();\r\n\t\t},\r\n\r\n\t\tadjustExCellTopLeft_1: function(key, d) {\r\n\t\t\tvar bx1 = d.x1 | 1,\r\n\t\t\t\tby1 = d.y1 | 1;\r\n\t\t\tthis.qnumw = [];\r\n\t\t\tthis.qnumh = [];\r\n\r\n\t\t\tvar bd = this.board;\r\n\t\t\tvar rowmin = bd.excellRows(bd.cols, bd.rows) * -2 + 1;\r\n\t\t\tvar colmin = bd.excellCols(bd.cols, bd.rows) * -2 + 1;\r\n\t\t\tfor (var by = by1; by <= d.y2; by += 2) {\r\n\t\t\t\tthis.qnumw[by] = [];\r\n\t\t\t\tfor (var bx = colmin; bx <= -1; bx += 2) {\r\n\t\t\t\t\tthis.qnumw[by].push(bd.getex(bx, by).qnum);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (var bx = bx1; bx <= d.x2; bx += 2) {\r\n\t\t\t\tthis.qnumh[bx] = [];\r\n\t\t\t\tfor (var by = rowmin; by <= -1; by += 2) {\r\n\t\t\t\t\tthis.qnumh[bx].push(bd.getex(bx, by).qnum);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tadjustExCellTopLeft_2: function(key, d, preserve) {\r\n\t\t\tvar xx = d.x1 + d.x2,\r\n\t\t\t\tyy = d.y1 + d.y2,\r\n\t\t\t\tbx1 = d.x1 | 1,\r\n\t\t\t\tby1 = d.y1 | 1;\r\n\r\n\t\t\tif (!preserve) {\r\n\t\t\t\tif (key === this.FLIPX || key === this.TURNL) {\r\n\t\t\t\t\tfor (var id in this.qnumw) {\r\n\t\t\t\t\t\tthis.qnumw[id].reverse();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (key === this.FLIPY || key === this.TURNR) {\r\n\t\t\t\t\tfor (var id in this.qnumh) {\r\n\t\t\t\t\t\tthis.qnumh[id].reverse();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar bd = this.board;\r\n\t\t\tbd.disableInfo();\r\n\t\t\tvar rowmin = bd.excellRows(bd.cols, bd.rows) * -2 + 1;\r\n\t\t\tvar colmin = bd.excellCols(bd.cols, bd.rows) * -2 + 1;\r\n\t\t\tswitch (key) {\r\n\t\t\t\tcase this.FLIPY: // 上下反転\r\n\t\t\t\t\tfor (var bx = bx1; bx <= d.x2; bx += 2) {\r\n\t\t\t\t\t\tfor (var by = -1; by >= rowmin; by -= 2) {\r\n\t\t\t\t\t\t\tbd.getex(bx, by).setQnum(this.qnumh[bx].pop());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase this.FLIPX: // 左右反転\r\n\t\t\t\t\tfor (var by = by1; by <= d.y2; by += 2) {\r\n\t\t\t\t\t\tfor (var bx = -1; bx >= colmin; bx -= 2) {\r\n\t\t\t\t\t\t\tbd.getex(bx, by).setQnum(this.qnumw[by].pop());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase this.TURNR: // 右90°反転\r\n\t\t\t\t\tfor (var by = by1; by <= d.y2; by += 2) {\r\n\t\t\t\t\t\tfor (var bx = -1; bx >= colmin; bx -= 2) {\r\n\t\t\t\t\t\t\tbd.getex(bx, by).setQnum(this.qnumh[by].pop());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var bx = bx1; bx <= d.x2; bx += 2) {\r\n\t\t\t\t\t\tfor (var by = -1; by >= rowmin; by -= 2) {\r\n\t\t\t\t\t\t\tbd.getex(bx, by).setQnum(this.qnumw[xx - bx].pop());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase this.TURNL: // 左90°反転\r\n\t\t\t\t\tfor (var by = by1; by <= d.y2; by += 2) {\r\n\t\t\t\t\t\tfor (var bx = -1; bx >= colmin; bx -= 2) {\r\n\t\t\t\t\t\t\tbd.getex(bx, by).setQnum(this.qnumh[yy - by].pop());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var bx = bx1; bx <= d.x2; bx += 2) {\r\n\t\t\t\t\t\tfor (var by = -1; by >= rowmin; by -= 2) {\r\n\t\t\t\t\t\t\tbd.getex(bx, by).setQnum(this.qnumw[bx].pop());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tbd.enableInfo();\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t// bd.exec.getAfterPos()  回転・反転開始前のIN/OUTなどの位置の調整\r\n\t\t//------------------------------------------------------------------------------\r\n\t\tgetAfterPos: function(key, d, piece) {\r\n\t\t\tvar puzzle = this.puzzle,\r\n\t\t\t\tbd = puzzle.board;\r\n\t\t\tvar xx = d.x1 + d.x2,\r\n\t\t\t\tyy = d.y1 + d.y2,\r\n\t\t\t\tbx1 = piece.bx,\r\n\t\t\t\tby1 = piece.by,\r\n\t\t\t\tbx2,\r\n\t\t\t\tby2;\r\n\t\t\tswitch (key) {\r\n\t\t\t\tcase this.FLIPY:\r\n\t\t\t\t\tbx2 = bx1;\r\n\t\t\t\t\tby2 = yy - by1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase this.FLIPX:\r\n\t\t\t\t\tbx2 = xx - bx1;\r\n\t\t\t\t\tby2 = by1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase this.TURNR:\r\n\t\t\t\t\tbx2 = yy - by1;\r\n\t\t\t\t\tby2 = bx1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase this.TURNL:\r\n\t\t\t\t\tbx2 = by1;\r\n\t\t\t\t\tby2 = xx - bx1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase this.EXPANDUP:\r\n\t\t\t\t\tbx2 = bx1;\r\n\t\t\t\t\tby2 = by1 + (by1 === bd.minby ? 0 : 2);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase this.EXPANDDN:\r\n\t\t\t\t\tbx2 = bx1;\r\n\t\t\t\t\tby2 = by1 + (by1 === bd.maxby ? 2 : 0);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase this.EXPANDLT:\r\n\t\t\t\t\tbx2 = bx1 + (bx1 === bd.minbx ? 0 : 2);\r\n\t\t\t\t\tby2 = by1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase this.EXPANDRT:\r\n\t\t\t\t\tbx2 = bx1 + (bx1 === bd.maxbx ? 2 : 0);\r\n\t\t\t\t\tby2 = by1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase this.REDUCEUP:\r\n\t\t\t\t\tbx2 = bx1;\r\n\t\t\t\t\tby2 = by1 - (by1 <= bd.minby + 2 ? 0 : 2);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase this.REDUCEDN:\r\n\t\t\t\t\tbx2 = bx1;\r\n\t\t\t\t\tby2 = by1 - (by1 >= bd.maxby - 2 ? 2 : 0);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase this.REDUCELT:\r\n\t\t\t\t\tbx2 = bx1 - (bx1 <= bd.minbx + 2 ? 0 : 2);\r\n\t\t\t\t\tby2 = by1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase this.REDUCERT:\r\n\t\t\t\t\tbx2 = bx1 - (bx1 >= bd.maxbx - 2 ? 2 : 0);\r\n\t\t\t\t\tby2 = by1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbx2 = bx1;\r\n\t\t\t\t\tby2 = by1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\tpos: new puzzle.klass.Address(bx2, by2),\r\n\t\t\t\tisdel: this.isdel(key, piece)\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n});\r\n","// EncodeCommon.js v3.4.1\r\n\r\npzpr.classmgr.makeCommon({\r\n\t//---------------------------------------------------------\r\n\tEncode: {\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// enc.include()    文字列caはbottomとupの間にあるか\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tinclude: function(ca, bottom, up) {\r\n\t\t\treturn bottom <= ca && ca <= up;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// enc.decode4Cell()  quesが0～4までの場合、デコードする\r\n\t\t// enc.encode4Cell()  quesが0～4までの場合、問題部をエンコードする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecode4Cell: function() {\r\n\t\t\tvar c = 0,\r\n\t\t\t\ti = 0,\r\n\t\t\t\tbstr = this.outbstr,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tfor (i = 0; i < bstr.length; i++) {\r\n\t\t\t\tvar cell = bd.cell[c],\r\n\t\t\t\t\tca = bstr.charAt(i);\r\n\t\t\t\tif (this.include(ca, \"0\", \"4\")) {\r\n\t\t\t\t\tcell.qnum = parseInt(ca, 16);\r\n\t\t\t\t} else if (this.include(ca, \"5\", \"9\")) {\r\n\t\t\t\t\tcell.qnum = parseInt(ca, 16) - 5;\r\n\t\t\t\t\tc++;\r\n\t\t\t\t} else if (this.include(ca, \"a\", \"e\")) {\r\n\t\t\t\t\tcell.qnum = parseInt(ca, 16) - 10;\r\n\t\t\t\t\tc += 2;\r\n\t\t\t\t} else if (this.include(ca, \"g\", \"z\")) {\r\n\t\t\t\t\tc += parseInt(ca, 36) - 16;\r\n\t\t\t\t} else if (ca === \".\") {\r\n\t\t\t\t\tcell.qnum = -2;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tc++;\r\n\t\t\t\tif (!bd.cell[c]) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.outbstr = bstr.substr(i + 1);\r\n\t\t},\r\n\t\tencode4Cell: function() {\r\n\t\t\tvar count = 0,\r\n\t\t\t\tcm = \"\",\r\n\t\t\t\tbd = this.board;\r\n\t\t\tfor (var c = 0; c < bd.cell.length; c++) {\r\n\t\t\t\tvar pstr = \"\",\r\n\t\t\t\t\tqn = bd.cell[c].qnum;\r\n\r\n\t\t\t\tif (qn >= 0) {\r\n\t\t\t\t\tif (!!bd.cell[c + 1] && bd.cell[c + 1].qnum !== -1) {\r\n\t\t\t\t\t\tpstr = \"\" + qn.toString(16);\r\n\t\t\t\t\t} else if (!!bd.cell[c + 2] && bd.cell[c + 2].qnum !== -1) {\r\n\t\t\t\t\t\tpstr = \"\" + (5 + qn).toString(16);\r\n\t\t\t\t\t\tc++;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tpstr = \"\" + (10 + qn).toString(16);\r\n\t\t\t\t\t\tc += 2;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (qn === -2) {\r\n\t\t\t\t\tpstr = \".\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcount++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (count === 0) {\r\n\t\t\t\t\tcm += pstr;\r\n\t\t\t\t} else if (pstr || count === 20) {\r\n\t\t\t\t\tcm += (count + 15).toString(36) + pstr;\r\n\t\t\t\t\tcount = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tcm += (count + 15).toString(36);\r\n\t\t\t}\r\n\r\n\t\t\tthis.outbstr += cm;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// enc.decode1Cell()  compact variants of encode4Cell for sparse single ques value\r\n\t\t// enc.encode1Cell()\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecode1Cell: function(val) {\r\n\t\t\tvar c = 0,\r\n\t\t\t\ti = 0,\r\n\t\t\t\tbstr = this.outbstr,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tfor (i = 0; i < bstr.length; i++) {\r\n\t\t\t\tvar cell = bd.cell[c],\r\n\t\t\t\t\tca = bstr.charAt(i);\r\n\t\t\t\tif (this.include(ca, \"0\", \"h\")) {\r\n\t\t\t\t\tcell.qnum = val;\r\n\t\t\t\t\tc += parseInt(ca, 36);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tc += parseInt(ca, 36) - 18;\r\n\t\t\t\t}\r\n\t\t\t\tc++;\r\n\t\t\t\tif (!bd.cell[c]) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.outbstr = bstr.substr(i + 1);\r\n\t\t},\r\n\t\tencode1Cell: function(val) {\r\n\t\t\tvar count = -1,\r\n\t\t\t\thave = false,\r\n\t\t\t\tcm = \"\",\r\n\t\t\t\tbd = this.board;\r\n\t\t\tfor (var c = 0; c < bd.cell.length; c++) {\r\n\t\t\t\tif (bd.cell[c].qnum === val) {\r\n\t\t\t\t\tif (count >= 0) {\r\n\t\t\t\t\t\tif (have) {\r\n\t\t\t\t\t\t\tcm += count.toString(36);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcm += (count + 18).toString(36);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\thave = true;\r\n\t\t\t\t\tcount = 0;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tcount++;\r\n\t\t\t\tif (count === 17) {\r\n\t\t\t\t\tif (have) {\r\n\t\t\t\t\t\tcm += count.toString(36);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcm += (count + 18).toString(36);\r\n\t\t\t\t\t}\r\n\t\t\t\t\thave = false;\r\n\t\t\t\t\tcount = -1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (count >= 0) {\r\n\t\t\t\tif (have) {\r\n\t\t\t\t\tcm += count.toString(36);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcm += (count + 18).toString(36);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.outbstr += cm;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// enc.decode4Cross()  quesが0～4までの場合、デコードする\r\n\t\t// enc.encode4Cross()  quesが0～4までの場合、問題部をエンコードする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecode4Cross: function() {\r\n\t\t\tvar c = 0,\r\n\t\t\t\ti = 0,\r\n\t\t\t\tbstr = this.outbstr,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tfor (i = 0; i < bstr.length; i++) {\r\n\t\t\t\tvar cross = bd.cross[c],\r\n\t\t\t\t\tca = bstr.charAt(i);\r\n\t\t\t\tif (this.include(ca, \"0\", \"4\")) {\r\n\t\t\t\t\tcross.qnum = parseInt(ca, 16);\r\n\t\t\t\t} else if (this.include(ca, \"5\", \"9\")) {\r\n\t\t\t\t\tcross.qnum = parseInt(ca, 16) - 5;\r\n\t\t\t\t\tc++;\r\n\t\t\t\t} else if (this.include(ca, \"a\", \"e\")) {\r\n\t\t\t\t\tcross.qnum = parseInt(ca, 16) - 10;\r\n\t\t\t\t\tc += 2;\r\n\t\t\t\t} else if (this.include(ca, \"g\", \"z\")) {\r\n\t\t\t\t\tc += parseInt(ca, 36) - 16;\r\n\t\t\t\t} else if (ca === \".\") {\r\n\t\t\t\t\tcross.qnum = -2;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tc++;\r\n\t\t\t\tif (!bd.cross[c]) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.outbstr = bstr.substr(i + 1);\r\n\t\t},\r\n\t\tencode4Cross: function() {\r\n\t\t\tvar count = 0,\r\n\t\t\t\tcm = \"\",\r\n\t\t\t\tbd = this.board;\r\n\t\t\tfor (var c = 0; c < bd.cross.length; c++) {\r\n\t\t\t\tvar pstr = \"\",\r\n\t\t\t\t\tqn = bd.cross[c].qnum;\r\n\r\n\t\t\t\tif (qn >= 0) {\r\n\t\t\t\t\tif (!!bd.cross[c + 1] && bd.cross[c + 1].qnum !== -1) {\r\n\t\t\t\t\t\tpstr = \"\" + qn.toString(16);\r\n\t\t\t\t\t} else if (!!bd.cross[c + 2] && bd.cross[c + 2].qnum !== -1) {\r\n\t\t\t\t\t\tpstr = \"\" + (5 + qn).toString(16);\r\n\t\t\t\t\t\tc++;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tpstr = \"\" + (10 + qn).toString(16);\r\n\t\t\t\t\t\tc += 2;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (qn === -2) {\r\n\t\t\t\t\tpstr = \".\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcount++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (count === 0) {\r\n\t\t\t\t\tcm += pstr;\r\n\t\t\t\t} else if (pstr || count === 20) {\r\n\t\t\t\t\tcm += (count + 15).toString(36) + pstr;\r\n\t\t\t\t\tcount = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tcm += (count + 15).toString(36);\r\n\t\t\t}\r\n\r\n\t\t\tthis.outbstr += cm;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// enc.decodeNumber10()  quesが0～9までの場合、デコードする\r\n\t\t// enc.encodeNumber10()  quesが0～9までの場合、問題部をエンコードする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeNumber10: function() {\r\n\t\t\tvar c = 0,\r\n\t\t\t\ti = 0,\r\n\t\t\t\tbstr = this.outbstr,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tfor (i = 0; i < bstr.length; i++) {\r\n\t\t\t\tvar cell = bd.cell[c],\r\n\t\t\t\t\tca = bstr.charAt(i);\r\n\r\n\t\t\t\tif (ca === \".\") {\r\n\t\t\t\t\tcell.qnum = -2;\r\n\t\t\t\t} else if (this.include(ca, \"0\", \"9\")) {\r\n\t\t\t\t\tcell.qnum = parseInt(ca, 10);\r\n\t\t\t\t} else if (this.include(ca, \"a\", \"z\")) {\r\n\t\t\t\t\tc += parseInt(ca, 36) - 10;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tc++;\r\n\t\t\t\tif (!bd.cell[c]) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.outbstr = bstr.substr(i + 1);\r\n\t\t},\r\n\t\tmaybeEncodeNumber10: function() {\r\n\t\t\tvar cm = \"\",\r\n\t\t\t\tcount = 0,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tfor (var c = 0; c < bd.cell.length; c++) {\r\n\t\t\t\tvar pstr = \"\",\r\n\t\t\t\t\tqn = bd.cell[c].qnum;\r\n\r\n\t\t\t\tif (qn === -2) {\r\n\t\t\t\t\tpstr = \".\";\r\n\t\t\t\t} else if (qn >= 0 && qn < 10) {\r\n\t\t\t\t\tpstr = qn.toString(10);\r\n\t\t\t\t} else if (qn >= 10) {\r\n\t\t\t\t\treturn \"\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcount++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (count === 0) {\r\n\t\t\t\t\tcm += pstr;\r\n\t\t\t\t} else if (pstr || count === 26) {\r\n\t\t\t\t\tcm += (9 + count).toString(36) + pstr;\r\n\t\t\t\t\tcount = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tcm += (9 + count).toString(36);\r\n\t\t\t}\r\n\t\t\treturn cm;\r\n\t\t},\r\n\t\tencodeNumber10: function() {\r\n\t\t\tthis.outbstr += this.maybeEncodeNumber10();\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// enc.decodeNumber16()  quesが0～8192?までの場合、デコードする\r\n\t\t// enc.encodeNumber16()  quesが0～8192?までの場合、問題部をエンコードする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\treadNumber16: function(bstr, i) {\r\n\t\t\tvar ca = bstr.charAt(i);\r\n\r\n\t\t\tif (this.include(ca, \"0\", \"9\") || this.include(ca, \"a\", \"f\")) {\r\n\t\t\t\treturn [parseInt(ca, 16), 1];\r\n\t\t\t} else if (ca === \"-\") {\r\n\t\t\t\treturn [parseInt(bstr.substr(i + 1, 2), 16), 3];\r\n\t\t\t} else if (ca === \"+\") {\r\n\t\t\t\treturn [parseInt(bstr.substr(i + 1, 3), 16), 4];\r\n\t\t\t} else if (ca === \"=\") {\r\n\t\t\t\treturn [parseInt(bstr.substr(i + 1, 3), 16) + 4096, 4];\r\n\t\t\t} else if (ca === \"%\") {\r\n\t\t\t\treturn [parseInt(bstr.substr(i + 1, 3), 16) + 8192, 4];\r\n\t\t\t} else if (ca === \".\") {\r\n\t\t\t\treturn [-2, 1];\r\n\t\t\t} else {\r\n\t\t\t\treturn [-1, 0];\r\n\t\t\t}\r\n\t\t},\r\n\t\tdecodeOneNumber16: function() {\r\n\t\t\tvar res = this.readNumber16(this.outbstr, 0);\r\n\t\t\tthis.outbstr = this.outbstr.substr(res[1]);\r\n\t\t\treturn res[0];\r\n\t\t},\r\n\t\tdecodeNumber16: function() {\r\n\t\t\tswitch (this.pid) {\r\n\t\t\t\tcase \"dac1\": var bstr = \"h8g2h1h663i8ah4j8i2552i1311g355g4g2g322g2g45i3333\"; break;\r\n\t\t\t\tcase \"dac2\": var bstr = \"cci454ganam8a444ga88ao8n5g8a46j\"; break;\r\n\t\t\t\tcase \"dac3\": var bstr = \"g3g2h2g4h06h5j1i23i35g2h1h5g6h5g4h3h63h23h5h1g\"; break;\r\n\t\t\t\tcase \"dac4\": var bstr = \"43g488g8h1iah0ich3g134gae33g5g5g5g3k62g233j1g21g3g\"; break;\r\n\t\t\t\tcase \"dac5\": var bstr = \"22g3j2g3gaci4g3ga8g3g34h4g3j552j4j2h9h3i22g3\"; break;\r\n\t\t\t\tcase \"dac6\": var bstr = \"g3h3jal022h6g4g4cg8g20g323g5g8agcg-16g234h9g4h6gac2h2g5o48g3h7884g3i52g52p4g4g4h4h52g9931g63q2g446243j2i3164g4h8gcg-14g99i534g844h9g2g542135h6j96h434i-10-10c194j4g58geg-103143h7675413223141g7j3i1g241h5g6g32g42g2332j71i1g23354435g23411\"; break;\r\n\t\t\t\tdefault: var bstr = this.outbstr;\r\n\t\t\t}\r\n\t\t\tvar c = 0,\r\n\t\t\t\ti = 0,\r\n\t\t\t\tbd = this.board;\r\n\t\t\twhile (i < bstr.length && bd.cell[c]) {\r\n\t\t\t\tvar cell = bd.cell[c],\r\n\t\t\t\t\tca = bstr.charAt(i);\r\n\t\t\t\tvar res = this.readNumber16(bstr, i);\r\n\t\t\t\tif (res[0] !== -1) {\r\n\t\t\t\t\tcell.qnum = res[0];\r\n\t\t\t\t\ti += res[1];\r\n\t\t\t\t\tc++;\r\n\t\t\t\t} else if (ca >= \"g\" && ca <= \"z\") {\r\n\t\t\t\t\tc += parseInt(ca, 36) - 15;\r\n\t\t\t\t\ti++;\r\n\t\t\t\t} else {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.outbstr = bstr.substr(i);\r\n\t\t},\r\n\t\twriteNumber16: function(qn) {\r\n\t\t\tif (qn === -2) {\r\n\t\t\t\treturn \".\";\r\n\t\t\t} else if (qn >= 0 && qn < 16) {\r\n\t\t\t\treturn qn.toString(16);\r\n\t\t\t} else if (qn >= 16 && qn < 256) {\r\n\t\t\t\treturn \"-\" + qn.toString(16);\r\n\t\t\t} else if (qn >= 256 && qn < 4096) {\r\n\t\t\t\treturn \"+\" + qn.toString(16);\r\n\t\t\t} else if (qn >= 4096 && qn < 8192) {\r\n\t\t\t\treturn \"=\" + (qn - 4096).toString(16);\r\n\t\t\t} else if (qn >= 8192) {\r\n\t\t\t\treturn \"%\" + (qn - 8192).toString(16);\r\n\t\t\t} else {\r\n\t\t\t\treturn \"\";\r\n\t\t\t}\r\n\t\t},\r\n\t\tencodeNumber16: function() {\r\n\t\t\tvar bd = this.board;\r\n\t\t\tthis.genericEncodeNumber16(bd.cell.length, function(c) {\r\n\t\t\t\treturn bd.cell[c].qnum;\r\n\t\t\t});\r\n\t\t},\r\n\t\tgenericEncodeNumber16: function(length, get_func) {\r\n\t\t\tvar count = 0,\r\n\t\t\t\tcm = \"\";\r\n\t\t\tfor (var c = 0; c < length; c++) {\r\n\t\t\t\tvar qn = get_func(c);\r\n\t\t\t\tvar pstr = this.writeNumber16(qn);\r\n\t\t\t\tif (pstr === \"\") {\r\n\t\t\t\t\tcount++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (count === 0) {\r\n\t\t\t\t\tcm += pstr;\r\n\t\t\t\t} else if (pstr || count === 20) {\r\n\t\t\t\t\tcm += (15 + count).toString(36) + pstr;\r\n\t\t\t\t\tcount = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tcm += (15 + count).toString(36);\r\n\t\t\t}\r\n\r\n\t\t\tthis.outbstr += cm;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// enc.decodeNumber10or16()  full range, but falling back to {de,en}codeNumber10 for backwards compatibility\r\n\t\t// enc.encodeNumber10or16()  full range, but falling back to {de,en}codeNumber10 for backwards compatibility\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeNumber10or16: function() {\r\n\t\t\tvar bstr = this.outbstr;\r\n\t\t\tif (bstr.length === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar ca = bstr.charAt(0);\r\n\t\t\tif (ca === \"-\") {\r\n\t\t\t\tthis.outbstr = bstr.substr(1);\r\n\t\t\t\tthis.decodeNumber16();\r\n\t\t\t} else {\r\n\t\t\t\tthis.decodeNumber10();\r\n\t\t\t}\r\n\t\t},\r\n\t\tencodeNumber10or16: function() {\r\n\t\t\tvar cm = this.maybeEncodeNumber10();\r\n\t\t\tif (cm.length > 0) {\r\n\t\t\t\tthis.outbstr += cm;\r\n\t\t\t\treturn;\r\n\t\t\t} else {\r\n\t\t\t\tthis.outbstr += \"-\";\r\n\t\t\t\tthis.encodeNumber16();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdecodeNumber16ExCell: function() {\r\n\t\t\t// 盤面外数字のデコード\r\n\t\t\tvar ec = 0,\r\n\t\t\t\ti = 0,\r\n\t\t\t\tbstr = this.outbstr,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tfor (i = 0; i < bstr.length; i++) {\r\n\t\t\t\tvar ca = bstr.charAt(i),\r\n\t\t\t\t\texcell = bd.excell[ec];\r\n\t\t\t\tif (this.include(ca, \"0\", \"9\") || this.include(ca, \"a\", \"f\")) {\r\n\t\t\t\t\texcell.qnum = parseInt(bstr.substr(i, 1), 16);\r\n\t\t\t\t} else if (ca === \"-\") {\r\n\t\t\t\t\texcell.qnum = parseInt(bstr.substr(i + 1, 2), 16);\r\n\t\t\t\t\ti += 2;\r\n\t\t\t\t} else if (ca === \".\") {\r\n\t\t\t\t\texcell.qnum = -2;\r\n\t\t\t\t} else if (ca >= \"g\" && ca <= \"z\") {\r\n\t\t\t\t\tec += parseInt(ca, 36) - 16;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tec++;\r\n\t\t\t\tif (ec >= bd.excell.length) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.outbstr = bstr.substr(i + 1);\r\n\t\t},\r\n\t\tencodeNumber16ExCell: function() {\r\n\t\t\tvar bd = this.board;\r\n\t\t\tthis.genericEncodeNumber16(bd.excell.length, function(c) {\r\n\t\t\t\treturn bd.excell[c].qnum;\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tencodeNumber16ExCellFlushed: function() {\r\n\t\t\tvar bd = this.board,\r\n\t\t\t\tcols = bd.cols,\r\n\t\t\t\trows = bd.rows;\r\n\t\t\tvar nums = bd.excell.map(function(ex) {\r\n\t\t\t\treturn ex.qnum;\r\n\t\t\t});\r\n\r\n\t\t\tbd.genericFlush(\r\n\t\t\t\tbd.excellCols(cols, rows),\r\n\t\t\t\tbd.excellRows(cols, rows),\r\n\t\t\t\tcols,\r\n\t\t\t\trows,\r\n\t\t\t\tfunction(i) {\r\n\t\t\t\t\treturn nums[i];\r\n\t\t\t\t},\r\n\t\t\t\tfunction(i, num) {\r\n\t\t\t\t\tnums[i] = num;\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\tthis.genericEncodeNumber16(nums.length, function(c) {\r\n\t\t\t\treturn nums[c];\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// enc.decodeRoomNumber16()  部屋＋部屋の一つのquesが0～8192?までの場合、デコードする\r\n\t\t// enc.encodeRoomNumber16()  部屋＋部屋の一つのquesが0～8192?までの場合、問題部をエンコードする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeRoomNumber16: function() {\r\n\t\t\tvar r = 0,\r\n\t\t\t\ti = 0,\r\n\t\t\t\tbstr = this.outbstr,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tbd.roommgr.rebuild();\r\n\t\t\tfor (i = 0; i < bstr.length; i++) {\r\n\t\t\t\tvar ca = bstr.charAt(i),\r\n\t\t\t\t\ttop = bd.roommgr.components[r].top;\r\n\r\n\t\t\t\tif (this.include(ca, \"0\", \"9\") || this.include(ca, \"a\", \"f\")) {\r\n\t\t\t\t\ttop.qnum = parseInt(ca, 16);\r\n\t\t\t\t} else if (ca === \"-\") {\r\n\t\t\t\t\ttop.qnum = parseInt(bstr.substr(i + 1, 2), 16);\r\n\t\t\t\t\ti += 2;\r\n\t\t\t\t} else if (ca === \"+\") {\r\n\t\t\t\t\ttop.qnum = parseInt(bstr.substr(i + 1, 3), 16);\r\n\t\t\t\t\ti += 3;\r\n\t\t\t\t} else if (ca === \"=\") {\r\n\t\t\t\t\ttop.qnum = parseInt(bstr.substr(i + 1, 3), 16) + 4096;\r\n\t\t\t\t\ti += 3;\r\n\t\t\t\t} else if (ca === \"%\") {\r\n\t\t\t\t\ttop.qnum = parseInt(bstr.substr(i + 1, 3), 16) + 8192;\r\n\t\t\t\t\ti += 3;\r\n\t\t\t\t} else if (ca === \"*\") {\r\n\t\t\t\t\ttop.qnum = parseInt(bstr.substr(i + 1, 4), 16) + 12240;\r\n\t\t\t\t\ti += 4;\r\n\t\t\t\t} else if (ca === \"$\") {\r\n\t\t\t\t\ttop.qnum = parseInt(bstr.substr(i + 1, 5), 16) + 77776;\r\n\t\t\t\t\ti += 5;\r\n\t\t\t\t} else if (ca >= \"g\" && ca <= \"z\") {\r\n\t\t\t\t\tr += parseInt(ca, 36) - 16;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tr++;\r\n\t\t\t\tif (r >= bd.roommgr.components.length) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.outbstr = bstr.substr(i + 1);\r\n\t\t},\r\n\t\tencodeRoomNumber16: function() {\r\n\t\t\tvar count = 0,\r\n\t\t\t\tcm = \"\",\r\n\t\t\t\tbd = this.board;\r\n\t\t\tbd.roommgr.rebuild();\r\n\t\t\tfor (var r = 0; r < bd.roommgr.components.length; r++) {\r\n\t\t\t\tvar pstr = \"\",\r\n\t\t\t\t\tqn = bd.roommgr.components[r].top.qnum;\r\n\r\n\t\t\t\tif (qn >= 0 && qn < 16) {\r\n\t\t\t\t\tpstr = qn.toString(16);\r\n\t\t\t\t} else if (qn >= 16 && qn < 256) {\r\n\t\t\t\t\tpstr = \"-\" + qn.toString(16);\r\n\t\t\t\t} else if (qn >= 256 && qn < 4096) {\r\n\t\t\t\t\tpstr = \"+\" + qn.toString(16);\r\n\t\t\t\t} else if (qn >= 4096 && qn < 8192) {\r\n\t\t\t\t\tpstr = \"=\" + (qn - 4096).toString(16);\r\n\t\t\t\t} else if (qn >= 8192 && qn < 12240) {\r\n\t\t\t\t\tpstr = \"%\" + (qn - 8192).toString(16);\r\n\t\t\t\t} else if (qn >= 12240 && qn < 77776) {\r\n\t\t\t\t\tpstr = \"*\" + (qn - 12240).toString(16);\r\n\t\t\t\t} else if (qn >= 77776) {\r\n\t\t\t\t\tpstr = \"$\" + (qn - 77776).toString(16);\r\n\t\t\t\t} // 最大1126352\r\n\t\t\t\telse {\r\n\t\t\t\t\tcount++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (count === 0) {\r\n\t\t\t\t\tcm += pstr;\r\n\t\t\t\t} else if (pstr || count === 20) {\r\n\t\t\t\t\tcm += (15 + count).toString(36) + pstr;\r\n\t\t\t\t\tcount = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tcm += (15 + count).toString(36);\r\n\t\t\t}\r\n\r\n\t\t\tthis.outbstr += cm;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// enc.decodeArrowNumber16()  矢印付きquesが0～8192?までの場合、デコードする\r\n\t\t// enc.encodeArrowNumber16()  矢印付きquesが0～8192?までの場合、問題部をエンコードする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeArrowNumber16: function() {\r\n\t\t\tvar c = 0,\r\n\t\t\t\ti = 0,\r\n\t\t\t\tbstr = this.outbstr,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tfor (i = 0; i < bstr.length; i++) {\r\n\t\t\t\tvar ca = bstr.charAt(i),\r\n\t\t\t\t\tcell = bd.cell[c];\r\n\r\n\t\t\t\tif (this.include(ca, \"0\", \"4\")) {\r\n\t\t\t\t\tvar ca1 = bstr.charAt(i + 1);\r\n\t\t\t\t\tcell.qdir = parseInt(ca, 16);\r\n\t\t\t\t\tcell.qnum = ca1 !== \".\" ? parseInt(ca1, 16) : -2;\r\n\t\t\t\t\ti++;\r\n\t\t\t\t} else if (this.include(ca, \"5\", \"9\")) {\r\n\t\t\t\t\tcell.qdir = parseInt(ca, 16) - 5;\r\n\t\t\t\t\tcell.qnum = parseInt(bstr.substr(i + 1, 2), 16);\r\n\t\t\t\t\ti += 2;\r\n\t\t\t\t} else if (ca === \"-\") {\r\n\t\t\t\t\tcell.qdir = parseInt(bstr.substr(i + 1, 1), 16);\r\n\t\t\t\t\tcell.qnum = parseInt(bstr.substr(i + 2, 3), 16);\r\n\t\t\t\t\ti += 4;\r\n\t\t\t\t} else if (ca >= \"a\" && ca <= \"z\") {\r\n\t\t\t\t\tc += parseInt(ca, 36) - 10;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tc++;\r\n\t\t\t\tif (!bd.cell[c]) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.outbstr = bstr.substr(i + 1);\r\n\t\t},\r\n\t\tencodeArrowNumber16: function() {\r\n\t\t\tvar cm = \"\",\r\n\t\t\t\tcount = 0,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tfor (var c = 0; c < bd.cell.length; c++) {\r\n\t\t\t\tvar pstr = \"\",\r\n\t\t\t\t\tdir = bd.cell[c].qdir,\r\n\t\t\t\t\tqn = bd.cell[c].qnum;\r\n\t\t\t\tif (qn === -2) {\r\n\t\t\t\t\tpstr = dir + \".\";\r\n\t\t\t\t} else if (qn >= 0 && qn < 16) {\r\n\t\t\t\t\tpstr = dir + qn.toString(16);\r\n\t\t\t\t} else if (qn >= 16 && qn < 256) {\r\n\t\t\t\t\tpstr = dir + 5 + qn.toString(16);\r\n\t\t\t\t} else if (qn >= 256 && qn < 4096) {\r\n\t\t\t\t\tpstr = \"-\" + dir + qn.toString(16);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcount++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (count === 0) {\r\n\t\t\t\t\tcm += pstr;\r\n\t\t\t\t} else if (pstr || count === 26) {\r\n\t\t\t\t\tcm += (count + 9).toString(36) + pstr;\r\n\t\t\t\t\tcount = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tcm += (count + 9).toString(36);\r\n\t\t\t}\r\n\r\n\t\t\tthis.outbstr += cm;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// enc.decodeBorder() 問題の境界線をデコードする\r\n\t\t// enc.encodeBorder() 問題の境界線をエンコードする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeBorder: function() {\r\n\t\t\tvar pos1,\r\n\t\t\t\tpos2,\r\n\t\t\t\tbstr = this.outbstr,\r\n\t\t\t\tid,\r\n\t\t\t\ttwi = [16, 8, 4, 2, 1];\r\n\t\t\tvar bd = this.board;\r\n\r\n\t\t\tif (bstr) {\r\n\t\t\t\tpos1 = Math.min((((bd.cols - 1) * bd.rows + 4) / 5) | 0, bstr.length);\r\n\t\t\t\tpos2 = Math.min(\r\n\t\t\t\t\t(((bd.cols * (bd.rows - 1) + 4) / 5) | 0) + pos1,\r\n\t\t\t\t\tbstr.length\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tpos1 = 0;\r\n\t\t\t\tpos2 = 0;\r\n\t\t\t}\r\n\r\n\t\t\tid = 0;\r\n\t\t\tfor (var i = 0; i < pos1; i++) {\r\n\t\t\t\tvar ca = parseInt(bstr.charAt(i), 32);\r\n\t\t\t\tfor (var w = 0; w < 5; w++) {\r\n\t\t\t\t\tif (id < (bd.cols - 1) * bd.rows) {\r\n\t\t\t\t\t\tbd.border[id].ques = ca & twi[w] ? 1 : 0;\r\n\t\t\t\t\t\tid++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tid = (bd.cols - 1) * bd.rows;\r\n\t\t\tfor (var i = pos1; i < pos2; i++) {\r\n\t\t\t\tvar ca = parseInt(bstr.charAt(i), 32);\r\n\t\t\t\tfor (var w = 0; w < 5; w++) {\r\n\t\t\t\t\tvar border = bd.border[id];\r\n\t\t\t\t\tif (!!border && border.inside) {\r\n\t\t\t\t\t\tborder.ques = ca & twi[w] ? 1 : 0;\r\n\t\t\t\t\t\tid++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tbd.roommgr.rebuild();\r\n\t\t\tthis.outbstr = bstr.substr(pos2);\r\n\t\t},\r\n\t\tencodeBorder: function() {\r\n\t\t\tvar cm = \"\",\r\n\t\t\t\ttwi = [16, 8, 4, 2, 1],\r\n\t\t\t\tnum = 0,\r\n\t\t\t\tpass = 0;\r\n\t\t\tvar bd = this.board;\r\n\r\n\t\t\tfor (var id = 0; id < (bd.cols - 1) * bd.rows; id++) {\r\n\t\t\t\tpass += bd.border[id].ques * twi[num];\r\n\t\t\t\tnum++;\r\n\t\t\t\tif (num === 5) {\r\n\t\t\t\t\tcm += pass.toString(32);\r\n\t\t\t\t\tnum = 0;\r\n\t\t\t\t\tpass = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (num > 0) {\r\n\t\t\t\tcm += pass.toString(32);\r\n\t\t\t}\r\n\r\n\t\t\tnum = 0;\r\n\t\t\tpass = 0;\r\n\t\t\tfor (\r\n\t\t\t\tvar id = (bd.cols - 1) * bd.rows;\r\n\t\t\t\tid < 2 * bd.cols * bd.rows - bd.cols - bd.rows;\r\n\t\t\t\tid++\r\n\t\t\t) {\r\n\t\t\t\tpass += bd.border[id].ques * twi[num];\r\n\t\t\t\tnum++;\r\n\t\t\t\tif (num === 5) {\r\n\t\t\t\t\tcm += pass.toString(32);\r\n\t\t\t\t\tnum = 0;\r\n\t\t\t\t\tpass = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (num > 0) {\r\n\t\t\t\tcm += pass.toString(32);\r\n\t\t\t}\r\n\r\n\t\t\tthis.outbstr += cm;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// enc.decodeCrossMark() 黒点をデコードする\r\n\t\t// enc.encodeCrossMark() 黒点をエンコードする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCrossMark: function() {\r\n\t\t\tvar cc = 0,\r\n\t\t\t\ti = 0,\r\n\t\t\t\tbstr = this.outbstr,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tvar cp = bd.hascross === 2 ? 1 : 0,\r\n\t\t\t\tcp2 = cp << 1;\r\n\t\t\tvar rows = bd.rows - 1 + cp2,\r\n\t\t\t\tcols = bd.cols - 1 + cp2;\r\n\t\t\tfor (i = 0; i < bstr.length; i++) {\r\n\t\t\t\tvar ca = bstr.charAt(i);\r\n\r\n\t\t\t\tif (this.include(ca, \"0\", \"9\") || this.include(ca, \"a\", \"z\")) {\r\n\t\t\t\t\tcc += parseInt(ca, 36);\r\n\t\t\t\t\tvar bx = ((cc % cols) + (1 - cp)) << 1;\r\n\t\t\t\t\tvar by = (((cc / cols) | 0) + (1 - cp)) << 1;\r\n\r\n\t\t\t\t\tif (by > bd.maxby - 2 * (1 - cp)) {\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbd.getx(bx, by).qnum = 1;\r\n\t\t\t\t} else if (ca === \".\") {\r\n\t\t\t\t\tcc += 35;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcc++;\r\n\t\t\t\tif (cc >= cols * rows) {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.outbstr = bstr.substr(i);\r\n\t\t},\r\n\t\tencodeCrossMark: function() {\r\n\t\t\tvar cm = \"\",\r\n\t\t\t\tcount = 0,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tvar cp = bd.hascross === 2 ? 1 : 0,\r\n\t\t\t\tcp2 = cp << 1;\r\n\t\t\tvar rows = bd.rows - 1 + cp2,\r\n\t\t\t\tcols = bd.cols - 1 + cp2;\r\n\t\t\tfor (var c = 0, max = cols * rows; c < max; c++) {\r\n\t\t\t\tvar pstr = \"\";\r\n\t\t\t\tvar bx = ((c % cols) + (1 - cp)) << 1;\r\n\t\t\t\tvar by = (((c / cols) | 0) + (1 - cp)) << 1;\r\n\r\n\t\t\t\tif (bd.getx(bx, by).qnum === 1) {\r\n\t\t\t\t\tpstr = \".\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcount++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (pstr) {\r\n\t\t\t\t\tcm += count.toString(36);\r\n\t\t\t\t\tcount = 0;\r\n\t\t\t\t} else if (count === 36) {\r\n\t\t\t\t\tcm += \".\";\r\n\t\t\t\t\tcount = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tcm += count.toString(36);\r\n\t\t\t}\r\n\r\n\t\t\tthis.outbstr += cm;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// enc.decodeCircle() 白丸・黒丸をデコードする\r\n\t\t// enc.encodeCircle() 白丸・黒丸をエンコードする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCircle: function() {\r\n\t\t\tvar bd = this.board;\r\n\t\t\tvar bstr = this.outbstr,\r\n\t\t\t\tc = 0,\r\n\t\t\t\ttri = [9, 3, 1];\r\n\t\t\tvar pos = bstr\r\n\t\t\t\t? Math.min(((bd.cols * bd.rows + 2) / 3) | 0, bstr.length)\r\n\t\t\t\t: 0;\r\n\t\t\tfor (var i = 0; i < pos; i++) {\r\n\t\t\t\tvar ca = parseInt(bstr.charAt(i), 27);\r\n\t\t\t\tfor (var w = 0; w < 3; w++) {\r\n\t\t\t\t\tif (!!bd.cell[c]) {\r\n\t\t\t\t\t\tvar val = ((ca / tri[w]) | 0) % 3;\r\n\t\t\t\t\t\tif (val > 0) {\r\n\t\t\t\t\t\t\tbd.cell[c].qnum = val;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tc++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.outbstr = bstr.substr(pos);\r\n\t\t},\r\n\t\tencodeCircle: function() {\r\n\t\t\tvar bd = this.board;\r\n\t\t\tvar cm = \"\",\r\n\t\t\t\tnum = 0,\r\n\t\t\t\tpass = 0,\r\n\t\t\t\ttri = [9, 3, 1];\r\n\t\t\tfor (var c = 0; c < bd.cell.length; c++) {\r\n\t\t\t\tif (bd.cell[c].qnum > 0) {\r\n\t\t\t\t\tpass += bd.cell[c].qnum * tri[num];\r\n\t\t\t\t}\r\n\t\t\t\tnum++;\r\n\t\t\t\tif (num === 3) {\r\n\t\t\t\t\tcm += pass.toString(27);\r\n\t\t\t\t\tnum = 0;\r\n\t\t\t\t\tpass = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (num > 0) {\r\n\t\t\t\tcm += pass.toString(27);\r\n\t\t\t}\r\n\r\n\t\t\tthis.outbstr += cm;\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// enc.decodeIce() cell.ques===6をデコードする\r\n\t\t// enc.encodeIce() cell.ques===6をエンコードする\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeQues: function(val) {\r\n\t\t\tvar bstr = this.outbstr,\r\n\t\t\t\tbd = this.board;\r\n\r\n\t\t\tvar c = 0,\r\n\t\t\t\ttwi = [16, 8, 4, 2, 1];\r\n\t\t\tfor (var i = 0; i < bstr.length; i++) {\r\n\t\t\t\tvar num = parseInt(bstr.charAt(i), 32);\r\n\t\t\t\tfor (var w = 0; w < 5; w++) {\r\n\t\t\t\t\tif (!!bd.cell[c]) {\r\n\t\t\t\t\t\tbd.cell[c].ques = num & twi[w] ? val : 0;\r\n\t\t\t\t\t\tc++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!bd.cell[c]) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.outbstr = bstr.substr(i + 1);\r\n\t\t},\r\n\t\tencodeQues: function(val, skipnone) {\r\n\t\t\tvar cm = \"\",\r\n\t\t\t\tnum = 0,\r\n\t\t\t\tpass = 0,\r\n\t\t\t\ttwi = [16, 8, 4, 2, 1],\r\n\t\t\t\tbd = this.board;\r\n\t\t\tvar found = false;\r\n\t\t\tfor (var c = 0; c < bd.cell.length; c++) {\r\n\t\t\t\tif (bd.cell[c].ques === val) {\r\n\t\t\t\t\tpass += twi[num];\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t}\r\n\t\t\t\tnum++;\r\n\t\t\t\tif (num === 5) {\r\n\t\t\t\t\tcm += pass.toString(32);\r\n\t\t\t\t\tnum = 0;\r\n\t\t\t\t\tpass = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (num > 0) {\r\n\t\t\t\tcm += pass.toString(32);\r\n\t\t\t}\r\n\r\n\t\t\tif (found || !skipnone) {\r\n\t\t\t\tthis.outbstr += cm;\r\n\t\t\t}\r\n\t\t},\r\n\t\tdecodeIce: function() {\r\n\t\t\tthis.decodeQues(6);\r\n\t\t},\r\n\t\tencodeIce: function() {\r\n\t\t\tthis.encodeQues(6);\r\n\t\t},\r\n\t\tdecodeEmpty: function() {\r\n\t\t\tthis.decodeQues(7);\r\n\t\t},\r\n\t\tencodeEmpty: function() {\r\n\t\t\tthis.encodeQues(7, true);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// enc.decodecross_old() Crossの問題部をデコードする(旧形式)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodecross_old: function() {\r\n\t\t\tvar bstr = this.outbstr,\r\n\t\t\t\tc = 0,\r\n\t\t\t\tbd = this.board;\r\n\t\t\tfor (var i = 0; i < bstr.length; i++) {\r\n\t\t\t\tvar ca = bstr.charAt(i);\r\n\t\t\t\tif (this.include(ca, \"0\", \"4\")) {\r\n\t\t\t\t\tbd.cross[c].qnum = parseInt(ca, 10);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tc++;\r\n\t\t\t\tif (!bd.cross[c]) {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.outbstr = bstr.substr(i);\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// enc.decodeDot() Decodes Cross/Cell/Border values up to 2\r\n\t\t// enc.encodeDot() Encodes Cross/Cell/Border values up to 2\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeDot: function(bstr) {\r\n\t\t\tvar bd = this.board;\r\n\t\t\tbd.disableInfo();\r\n\t\t\tvar s = 0,\r\n\t\t\t\tbstr = this.outbstr;\r\n\t\t\tfor (var i = 0; i < bstr.length; i++) {\r\n\t\t\t\tvar dot = bd.dots[s],\r\n\t\t\t\t\tca = bstr.charAt(i);\r\n\t\t\t\tif (this.include(ca, \"0\", \"f\")) {\r\n\t\t\t\t\tvar val = parseInt(ca, 16);\r\n\t\t\t\t\tdot.setDot((val % 2) + 1);\r\n\t\t\t\t\ts += (val >> 1) + 1;\r\n\t\t\t\t} else if (this.include(ca, \"g\", \"z\")) {\r\n\t\t\t\t\ts += parseInt(ca, 36) - 15;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (s >= bd.dotsmax) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tbd.enableInfo();\r\n\t\t\tthis.outbstr = bstr.substr(i + 1);\r\n\t\t},\r\n\t\tencodeDot: function() {\r\n\t\t\tvar count = 0,\r\n\t\t\t\tcm = \"\",\r\n\t\t\t\tbd = this.board;\r\n\t\t\tfor (var s = 0; s < bd.dotsmax; s++) {\r\n\t\t\t\tvar pstr = \"\",\r\n\t\t\t\t\tdot = bd.dots[s];\r\n\t\t\t\tif (dot.getDot() > 0) {\r\n\t\t\t\t\tfor (var i = 1; i <= 7; i++) {\r\n\t\t\t\t\t\tvar dot2 = bd.dots[s + i];\r\n\t\t\t\t\t\tif (!!dot2 && dot2.getDot() > 0) {\r\n\t\t\t\t\t\t\tpstr = \"\" + (2 * (i - 1) + (dot.getDot() - 1)).toString(16);\r\n\t\t\t\t\t\t\ts += i - 1;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (pstr === \"\") {\r\n\t\t\t\t\t\tpstr = (13 + dot.getDot()).toString(16);\r\n\t\t\t\t\t\ts += 7;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcount++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (count === 0) {\r\n\t\t\t\t\tcm += pstr;\r\n\t\t\t\t} else if (pstr || count === 20) {\r\n\t\t\t\t\tcm += (count + 15).toString(36) + pstr;\r\n\t\t\t\t\tcount = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (count > 0) {\r\n\t\t\t\tcm += (count + 15).toString(36);\r\n\t\t\t}\r\n\r\n\t\t\tthis.outbstr += cm;\r\n\t\t}\r\n\t}\r\n});\r\n","// FileDataCommon.js v3.4.1\r\n\r\npzpr.classmgr.makeCommon({\r\n\t//---------------------------------------------------------\r\n\tFileIO: {\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeCellQnum() 問題数字のデコードを行う\r\n\t\t// fio.encodeCellQnum() 問題数字のエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCellQnum: function() {\r\n\t\t\tthis.decodeCell(function(cell, ca) {\r\n\t\t\t\tif (ca === \"-\") {\r\n\t\t\t\t\tcell.qnum = -2;\r\n\t\t\t\t} else if (ca !== \".\") {\r\n\t\t\t\t\tcell.qnum = +ca;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeCellQnum: function() {\r\n\t\t\tthis.encodeCell(function(cell) {\r\n\t\t\t\tif (cell.qnum >= 0) {\r\n\t\t\t\t\treturn cell.qnum + \" \";\r\n\t\t\t\t} else if (cell.qnum === -2) {\r\n\t\t\t\t\treturn \"- \";\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn \". \";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeCellQnumb() 黒背景な問題数字のデコードを行う\r\n\t\t// fio.encodeCellQnumb() 黒背景な問題数字のエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCellQnumb: function() {\r\n\t\t\tthis.decodeCell(function(cell, ca) {\r\n\t\t\t\tif (ca === \"5\") {\r\n\t\t\t\t\tcell.qnum = -2;\r\n\t\t\t\t} else if (ca !== \".\") {\r\n\t\t\t\t\tcell.qnum = +ca;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeCellQnumb: function() {\r\n\t\t\tthis.encodeCell(function(cell) {\r\n\t\t\t\tif (cell.qnum >= 0) {\r\n\t\t\t\t\treturn cell.qnum + \" \";\r\n\t\t\t\t} else if (cell.qnum === -2) {\r\n\t\t\t\t\treturn \"5 \";\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn \". \";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeCellQnumAns() 問題数字＋黒マス白マスのデコードを行う\r\n\t\t// fio.encodeCellQnumAns() 問題数字＋黒マス白マスのエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCellQnumAns: function() {\r\n\t\t\tthis.decodeCell(function(cell, ca) {\r\n\t\t\t\tif (ca === \"#\") {\r\n\t\t\t\t\tcell.qans = 1;\r\n\t\t\t\t} else if (ca === \"+\") {\r\n\t\t\t\t\tcell.qsub = 1;\r\n\t\t\t\t} else if (ca === \"-\") {\r\n\t\t\t\t\tcell.qnum = -2;\r\n\t\t\t\t} else if (ca !== \".\") {\r\n\t\t\t\t\tcell.qnum = +ca;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeCellQnumAns: function() {\r\n\t\t\tthis.encodeCell(function(cell) {\r\n\t\t\t\tif (cell.qnum >= 0) {\r\n\t\t\t\t\treturn cell.qnum + \" \";\r\n\t\t\t\t} else if (cell.qnum === -2) {\r\n\t\t\t\t\treturn \"- \";\r\n\t\t\t\t} else if (cell.qans === 1) {\r\n\t\t\t\t\treturn \"# \";\r\n\t\t\t\t} else if (cell.qsub === 1) {\r\n\t\t\t\t\treturn \"+ \";\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn \". \";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeCellDirecQnum() 方向＋問題数字のデコードを行う\r\n\t\t// fio.encodeCellDirecQnum() 方向＋問題数字のエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCellDirecQnum: function() {\r\n\t\t\tthis.decodeCell(function(cell, ca) {\r\n\t\t\t\tif (ca !== \".\") {\r\n\t\t\t\t\tvar inp = ca.split(\",\");\r\n\t\t\t\t\tcell.qdir = inp[0] !== \"0\" ? +inp[0] : 0;\r\n\t\t\t\t\tcell.qnum = inp[1] !== \"-\" ? +inp[1] : -2;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeCellDirecQnum: function() {\r\n\t\t\tthis.encodeCell(function(cell) {\r\n\t\t\t\tif (cell.qnum !== -1) {\r\n\t\t\t\t\tvar ca1 = cell.qdir !== 0 ? \"\" + cell.qdir : \"0\";\r\n\t\t\t\t\tvar ca2 = cell.qnum !== -2 ? \"\" + cell.qnum : \"-\";\r\n\t\t\t\t\treturn [ca1, \",\", ca2, \" \"].join(\"\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn \". \";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeCellAns() 黒マス白マスのデコードを行う\r\n\t\t// fio.encodeCellAns() 黒マス白マスのエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCellAns: function() {\r\n\t\t\tthis.decodeCell(function(cell, ca) {\r\n\t\t\t\tif (ca === \"#\") {\r\n\t\t\t\t\tcell.qans = 1;\r\n\t\t\t\t} else if (ca === \"+\") {\r\n\t\t\t\t\tcell.qsub = 1;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeCellAns: function() {\r\n\t\t\tthis.encodeCell(function(cell) {\r\n\t\t\t\tif (cell.qans === 1) {\r\n\t\t\t\t\treturn \"# \";\r\n\t\t\t\t} else if (cell.qsub === 1) {\r\n\t\t\t\t\treturn \"+ \";\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn \". \";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeCellQanssub() 黒マスと背景色のデコードを行う\r\n\t\t// fio.encodeCellQanssub() 黒マスと背景色のエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCellQanssub: function() {\r\n\t\t\tthis.decodeCell(function(cell, ca) {\r\n\t\t\t\tif (ca === \"+\") {\r\n\t\t\t\t\tcell.qsub = 1;\r\n\t\t\t\t} else if (ca === \"-\") {\r\n\t\t\t\t\tcell.qsub = 2;\r\n\t\t\t\t} else if (ca === \"=\") {\r\n\t\t\t\t\tcell.qsub = 3;\r\n\t\t\t\t} else if (ca === \"%\") {\r\n\t\t\t\t\tcell.qsub = 4;\r\n\t\t\t\t} else if (ca !== \".\") {\r\n\t\t\t\t\tcell.qans = +ca;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeCellQanssub: function() {\r\n\t\t\tthis.encodeCell(function(cell) {\r\n\t\t\t\tif (cell.qans !== 0) {\r\n\t\t\t\t\treturn cell.qans + \" \";\r\n\t\t\t\t} else if (cell.qsub === 1) {\r\n\t\t\t\t\treturn \"+ \";\r\n\t\t\t\t} else if (cell.qsub === 2) {\r\n\t\t\t\t\treturn \"- \";\r\n\t\t\t\t} else if (cell.qsub === 3) {\r\n\t\t\t\t\treturn \"= \";\r\n\t\t\t\t} else if (cell.qsub === 4) {\r\n\t\t\t\t\treturn \"% \";\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn \". \";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeCellAnumsub() 回答数字と背景色のデコードを行う\r\n\t\t// fio.encodeCellAnumsub() 回答数字と背景色のエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCellAnumsub: function() {\r\n\t\t\tthis.decodeCell(function(cell, ca) {\r\n\t\t\t\tif (cell.enableSubNumberArray && ca.indexOf(\"[\") >= 0) {\r\n\t\t\t\t\tca = this.setCellSnum(cell, ca);\r\n\t\t\t\t}\r\n\t\t\t\tif (ca === \"+\") {\r\n\t\t\t\t\tcell.qsub = 1;\r\n\t\t\t\t} else if (ca === \"-\") {\r\n\t\t\t\t\tcell.qsub = 2;\r\n\t\t\t\t} else if (ca === \"=\") {\r\n\t\t\t\t\tcell.qsub = 3;\r\n\t\t\t\t} else if (ca === \"%\") {\r\n\t\t\t\t\tcell.qsub = 4;\r\n\t\t\t\t} else if (ca !== \".\") {\r\n\t\t\t\t\tcell.anum = +ca;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeCellAnumsub: function() {\r\n\t\t\tthis.encodeCell(function(cell) {\r\n\t\t\t\tvar ca = \".\";\r\n\t\t\t\tif (cell.anum !== -1) {\r\n\t\t\t\t\tca = \"\" + cell.anum;\r\n\t\t\t\t} else if (cell.qsub === 1) {\r\n\t\t\t\t\tca = \"+\";\r\n\t\t\t\t} else if (cell.qsub === 2) {\r\n\t\t\t\t\tca = \"-\";\r\n\t\t\t\t} else if (cell.qsub === 3) {\r\n\t\t\t\t\tca = \"=\";\r\n\t\t\t\t} else if (cell.qsub === 4) {\r\n\t\t\t\t\tca = \"%\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tca = \".\";\r\n\t\t\t\t}\r\n\t\t\t\tif (cell.enableSubNumberArray && cell.anum === -1) {\r\n\t\t\t\t\tca += this.getCellSnum(cell);\r\n\t\t\t\t}\r\n\t\t\t\treturn ca + \" \";\r\n\t\t\t});\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.setCellSnum() 補助数字のデコードを行う   (decodeCellAnumsubで内部的に使用)\r\n\t\t// fio.getCellSnum() 補助数字のエンコードを行う (encodeCellAnumsubで内部的に使用)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tsetCellSnum: function(cell, ca) {\r\n\t\t\tvar snumtext = ca.substring(ca.indexOf(\"[\") + 1, ca.indexOf(\"]\"));\r\n\t\t\tvar list = snumtext.split(/,/);\r\n\t\t\tfor (var i = 0; i < list.length; ++i) {\r\n\t\t\t\tcell.snum[i] = !!list[i] ? +list[i] : -1;\r\n\t\t\t}\r\n\t\t\treturn ca.substr(0, ca.indexOf(\"[\"));\r\n\t\t},\r\n\t\tgetCellSnum: function(cell) {\r\n\t\t\tvar list = [];\r\n\t\t\tfor (var i = 0; i < cell.snum.length; ++i) {\r\n\t\t\t\tlist[i] = cell.snum[i] !== -1 ? \"\" + cell.snum[i] : \"\";\r\n\t\t\t}\r\n\t\t\tvar snumtext = list.join(\",\");\r\n\t\t\treturn snumtext !== \",,,\" ? \"[\" + snumtext + \"]\" : \"\";\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeCellQsub() 背景色のデコードを行う\r\n\t\t// fio.encodeCellQsub() 背景色のエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCellQsub: function() {\r\n\t\t\tthis.decodeCell(function(cell, ca) {\r\n\t\t\t\tif (ca !== \"0\") {\r\n\t\t\t\t\tcell.qsub = +ca;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeCellQsub: function() {\r\n\t\t\tthis.encodeCell(function(cell) {\r\n\t\t\t\tif (cell.qsub > 0) {\r\n\t\t\t\t\treturn cell.qsub + \" \";\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn \"0 \";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeCrossNum() 交点の数字のデコードを行う\r\n\t\t// fio.encodeCrossNum() 交点の数字のエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCrossNum: function() {\r\n\t\t\tthis.decodeCross(function(cross, ca) {\r\n\t\t\t\tif (ca === \"-\") {\r\n\t\t\t\t\tcross.qnum = -2;\r\n\t\t\t\t} else if (ca !== \".\") {\r\n\t\t\t\t\tcross.qnum = +ca;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeCrossNum: function() {\r\n\t\t\tthis.encodeCross(function(cross) {\r\n\t\t\t\tif (cross.qnum >= 0) {\r\n\t\t\t\t\treturn cross.qnum + \" \";\r\n\t\t\t\t} else if (cross.qnum === -2) {\r\n\t\t\t\t\treturn \"- \";\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn \". \";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeBorderQues() 問題の境界線のデコードを行う\r\n\t\t// fio.encodeBorderQues() 問題の境界線のエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeBorderQues: function() {\r\n\t\t\tthis.decodeBorder(function(border, ca) {\r\n\t\t\t\tif (ca === \"1\") {\r\n\t\t\t\t\tborder.ques = 1;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeBorderQues: function() {\r\n\t\t\tthis.encodeBorder(function(border) {\r\n\t\t\t\treturn (border.ques === 1 ? \"1\" : \"0\") + \" \";\r\n\t\t\t});\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeBorderAns() 問題・回答の境界線のデコードを行う\r\n\t\t// fio.encodeBorderAns() 問題・回答の境界線のエンコードを行う\r\n\t\t// fio.decodeBorderArrowAns() Decode lines and dir. aux. marks\r\n\t\t// fio.encodeBorderArrowAns() Encode lines and dir. aux. marks\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeBorderAns: function() {\r\n\t\t\tthis.decodeBorder(function(border, ca) {\r\n\t\t\t\tif (ca === \"2\") {\r\n\t\t\t\t\tborder.qans = 1;\r\n\t\t\t\t\tborder.qsub = 1;\r\n\t\t\t\t} else if (ca === \"1\") {\r\n\t\t\t\t\tborder.qans = 1;\r\n\t\t\t\t} else if (ca === \"-1\") {\r\n\t\t\t\t\tborder.qsub = 1;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeBorderAns: function() {\r\n\t\t\tthis.encodeBorder(function(border) {\r\n\t\t\t\tif (border.qans === 1 && border.qsub === 1) {\r\n\t\t\t\t\treturn \"2 \";\r\n\t\t\t\t} else if (border.qans === 1) {\r\n\t\t\t\t\treturn \"1 \";\r\n\t\t\t\t} else if (border.qsub === 1) {\r\n\t\t\t\t\treturn \"-1 \";\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn \"0 \";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tdecodeBorderArrowAns: function() {\r\n\t\t\tthis.decodeBorder(function(border, ca) {\r\n\t\t\t\tvar lca = ca.charAt(ca.length - 1);\r\n\t\t\t\tif (lca >= \"a\" && lca <= \"z\") {\r\n\t\t\t\t\tif (lca === \"u\") {\r\n\t\t\t\t\t\tborder.qsub = 11;\r\n\t\t\t\t\t} else if (lca === \"d\") {\r\n\t\t\t\t\t\tborder.qsub = 12;\r\n\t\t\t\t\t} else if (lca === \"l\") {\r\n\t\t\t\t\t\tborder.qsub = 13;\r\n\t\t\t\t\t} else if (lca === \"r\") {\r\n\t\t\t\t\t\tborder.qsub = 14;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tca = ca.substr(0, ca.length - 1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (ca !== \"\" && ca !== \"0\") {\r\n\t\t\t\t\tif (ca.charAt(0) === \"-\") {\r\n\t\t\t\t\t\tborder.line = -ca - 1;\r\n\t\t\t\t\t\tborder.qsub = 2;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tborder.line = +ca;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeBorderArrowAns: function() {\r\n\t\t\tthis.encodeBorder(function(border) {\r\n\t\t\t\tvar ca = \"\";\r\n\t\t\t\tif (border.qsub === 2) {\r\n\t\t\t\t\tca += \"\" + (-1 - border.line);\r\n\t\t\t\t} else if (border.line > 0) {\r\n\t\t\t\t\tca += \"\" + border.line;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (border.qsub >= 11) {\r\n\t\t\t\t\tca += [\"u\", \"d\", \"l\", \"r\"][border.qsub - 11];\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn ca !== \"\" ? ca + \" \" : \"0 \";\r\n\t\t\t});\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeBorderLine() Lineのデコードを行う\r\n\t\t// fio.encodeBorderLine() Lineのエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeBorderLine: function() {\r\n\t\t\tthis.decodeBorder(function(border, ca) {\r\n\t\t\t\tif (ca === \"-1\") {\r\n\t\t\t\t\tborder.qsub = 2;\r\n\t\t\t\t} else if (ca !== \"0\") {\r\n\t\t\t\t\tborder.line = +ca;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeBorderLine: function() {\r\n\t\t\tthis.encodeBorder(function(border) {\r\n\t\t\t\tif (border.line > 0) {\r\n\t\t\t\t\treturn border.line + \" \";\r\n\t\t\t\t} else if (border.qsub === 2) {\r\n\t\t\t\t\treturn \"-1 \";\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn \"0 \";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeAreaRoom() 部屋のデコードを行う\r\n\t\t// fio.encodeAreaRoom() 部屋のエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeAreaRoom: function() {\r\n\t\t\tthis.decodeAreaRoom_com(true);\r\n\t\t},\r\n\t\tencodeAreaRoom: function() {\r\n\t\t\tthis.encodeAreaRoom_com(true);\r\n\t\t},\r\n\t\tdecodeAreaRoom_com: function(isques) {\r\n\t\t\tthis.readLine();\r\n\t\t\tthis.rdata2Border(isques, this.getItemList(this.board.rows));\r\n\r\n\t\t\tthis.board.roommgr.rebuild();\r\n\t\t},\r\n\t\tencodeAreaRoom_com: function(isques) {\r\n\t\t\tvar bd = this.board;\r\n\t\t\tbd.roommgr.rebuild();\r\n\r\n\t\t\tvar rooms = bd.roommgr.components;\r\n\t\t\tthis.writeLine(rooms.length);\r\n\t\t\tvar data = \"\";\r\n\t\t\tfor (var c = 0; c < bd.cell.length; c++) {\r\n\t\t\t\tvar roomid = rooms.indexOf(bd.cell[c].room);\r\n\t\t\t\tdata += \"\" + (roomid >= 0 ? roomid : \".\") + \" \";\r\n\t\t\t\tif ((c + 1) % bd.cols === 0) {\r\n\t\t\t\t\tthis.writeLine(data);\r\n\t\t\t\t\tdata = \"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.rdata2Border() 入力された配列から境界線を入力する\r\n\t\t//---------------------------------------------------------------------------\r\n\t\trdata2Border: function(isques, rdata) {\r\n\t\t\tvar bd = this.board;\r\n\t\t\tfor (var id = 0; id < bd.border.length; id++) {\r\n\t\t\t\tvar border = bd.border[id],\r\n\t\t\t\t\tcell1 = border.sidecell[0],\r\n\t\t\t\t\tcell2 = border.sidecell[1];\r\n\t\t\t\tvar isdiff =\r\n\t\t\t\t\t!cell1.isnull && !cell2.isnull && rdata[cell1.id] !== rdata[cell2.id];\r\n\t\t\t\tborder[isques ? \"ques\" : \"qans\"] = isdiff ? 1 : 0;\r\n\t\t\t}\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeCellQnum51() [＼]のデコードを行う\r\n\t\t// fio.encodeCellQnum51() [＼]のエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCellQnum51: function() {\r\n\t\t\tvar bd = this.board;\r\n\t\t\tbd.disableInfo(); /* mv.set51cell()用 */\r\n\t\t\tthis.decodeCellExCell(function(obj, ca) {\r\n\t\t\t\tif (ca === \".\") {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else if (obj.group === \"excell\") {\r\n\t\t\t\t\tif (obj.bx !== -1 && obj.by === -1) {\r\n\t\t\t\t\t\tobj.qnum2 = +ca;\r\n\t\t\t\t\t} else if (obj.bx === -1 && obj.by !== -1) {\r\n\t\t\t\t\t\tobj.qnum = +ca;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (obj.group === \"cell\") {\r\n\t\t\t\t\tvar inp = ca.split(\",\");\r\n\t\t\t\t\tobj.set51cell();\r\n\t\t\t\t\tobj.qnum = +inp[0];\r\n\t\t\t\t\tobj.qnum2 = +inp[1];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tbd.enableInfo(); /* mv.set51cell()用 */\r\n\t\t},\r\n\t\tencodeCellQnum51: function() {\r\n\t\t\tthis.encodeCellExCell(function(obj) {\r\n\t\t\t\tif (obj.group === \"excell\") {\r\n\t\t\t\t\tif (obj.bx === -1 && obj.by === -1) {\r\n\t\t\t\t\t\treturn \"0 \";\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn (obj.by === -1 ? obj.qnum2 : obj.qnum) + \" \";\r\n\t\t\t\t} else if (obj.group === \"cell\") {\r\n\t\t\t\t\tif (obj.ques === 51) {\r\n\t\t\t\t\t\treturn obj.qnum + \",\" + obj.qnum2 + \" \";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn \". \";\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeDotFile() Decodes Cross/Cell/Border values and empty cells (ques===7)\r\n\t\t// fio.encodeDotFile() Encodes Cross/Cell/Border values and empty cells (ques===7)\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeDotFile: function() {\r\n\t\t\tvar bd = this.board,\r\n\t\t\t\ts = 0,\r\n\t\t\t\tdata = \"\";\r\n\t\t\tfor (var i = 0, rows = 2 * bd.rows - 1; i < rows; i++) {\r\n\t\t\t\tvar line = this.readLine();\r\n\t\t\t\tif (line) {\r\n\t\t\t\t\tdata += line.match(/[12X\\.]+/)[0];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tbd.disableInfo();\r\n\t\t\tfor (var s = 0; s < data.length; ++s) {\r\n\t\t\t\tvar dot = bd.dots[s],\r\n\t\t\t\t\tca = data.charAt(s);\r\n\t\t\t\tif (ca === \"1\") {\r\n\t\t\t\t\tdot.setDot(1);\r\n\t\t\t\t} else if (ca === \"2\") {\r\n\t\t\t\t\tdot.setDot(2);\r\n\t\t\t\t} else if (ca === \"X\") {\r\n\t\t\t\t\tdot.piece.ques = 7;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tbd.enableInfo();\r\n\t\t},\r\n\t\tencodeDotFile: function() {\r\n\t\t\tvar bd = this.board,\r\n\t\t\t\ts = 0;\r\n\t\t\tfor (var by = 1; by <= 2 * bd.rows - 1; by++) {\r\n\t\t\t\tvar data = \"\";\r\n\t\t\t\tfor (var bx = 1; bx <= 2 * bd.cols - 1; bx++) {\r\n\t\t\t\t\tvar dot = bd.dots[s];\r\n\t\t\t\t\tif (dot.getDot() === 1) {\r\n\t\t\t\t\t\tdata += \"1\";\r\n\t\t\t\t\t} else if (dot.getDot() === 2) {\r\n\t\t\t\t\t\tdata += \"2\";\r\n\t\t\t\t\t} else if (dot.piece.ques === 7) {\r\n\t\t\t\t\t\tdata += \"X\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdata += \".\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\ts++;\r\n\t\t\t\t}\r\n\t\t\t\tthis.writeLine(data);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeCellQnum_kanpen() pencilbox用問題数字のデコードを行う\r\n\t\t// fio.encodeCellQnum_kanpen() pencilbox用問題数字のエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCellQnum_kanpen: function() {\r\n\t\t\tthis.decodeCell(function(cell, ca) {\r\n\t\t\t\tif (ca !== \".\") {\r\n\t\t\t\t\tcell.qnum = +ca;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeCellQnum_kanpen: function() {\r\n\t\t\tthis.encodeCell(function(cell) {\r\n\t\t\t\treturn cell.qnum >= 0 ? cell.qnum + \" \" : \". \";\r\n\t\t\t});\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeCellAnum_kanpen() pencilbox用回答数字のデコードを行う\r\n\t\t// fio.encodeCellAnum_kanpen() pencilbox用回答数字のエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCellAnum_kanpen: function() {\r\n\t\t\tthis.decodeCell(function(cell, ca) {\r\n\t\t\t\tif (ca !== \".\" && ca !== \"0\") {\r\n\t\t\t\t\tcell.anum = +ca;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeCellAnum_kanpen: function() {\r\n\t\t\tthis.encodeCell(function(cell) {\r\n\t\t\t\tif (cell.qnum !== -1) {\r\n\t\t\t\t\treturn \". \";\r\n\t\t\t\t} else if (cell.anum === -1) {\r\n\t\t\t\t\treturn \"0 \";\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn cell.anum + \" \";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeCellQnumAns_kanpen() pencilbox用問題数字＋黒マス白マスのデコードを行う\r\n\t\t// fio.encodeCellQnumAns_kanpen() pencilbox用問題数字＋黒マス白マスのエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCellQnumAns_kanpen: function() {\r\n\t\t\tthis.decodeCell(function(cell, ca) {\r\n\t\t\t\tif (ca === \"#\") {\r\n\t\t\t\t\tcell.qans = 1;\r\n\t\t\t\t} else if (ca === \"+\") {\r\n\t\t\t\t\tcell.qsub = 1;\r\n\t\t\t\t} else if (ca === \"?\") {\r\n\t\t\t\t\tcell.qnum = -2;\r\n\t\t\t\t} else if (ca !== \".\") {\r\n\t\t\t\t\tcell.qnum = +ca;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeCellQnumAns_kanpen: function() {\r\n\t\t\tthis.encodeCell(function(cell) {\r\n\t\t\t\tif (cell.qnum >= 0) {\r\n\t\t\t\t\treturn cell.qnum + \" \";\r\n\t\t\t\t} else if (cell.qnum === -2) {\r\n\t\t\t\t\treturn \"? \";\r\n\t\t\t\t} else if (cell.qans === 1) {\r\n\t\t\t\t\treturn \"# \";\r\n\t\t\t\t} else if (cell.qsub === 1) {\r\n\t\t\t\t\treturn \"+ \";\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn \". \";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeCellQnum_XMLBoard() pencilbox XML用問題用数字のデコードを行う\r\n\t\t// fio.encodeCellQnum_XMLBoard() pencilbox XML用問題用数字のエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tUNDECIDED_NUM_XML: -1,\r\n\t\tdecodeCellQnum_XMLBoard: function() {\r\n\t\t\tvar minnum = this.board.cell[0].getminnum() > 0 ? 1 : 0;\r\n\t\t\tvar undecnum = this.UNDECIDED_NUM_XML;\r\n\t\t\tthis.decodeCellXMLBoard(function(cell, val) {\r\n\t\t\t\tif (val === undecnum) {\r\n\t\t\t\t\tcell.qnum = -2;\r\n\t\t\t\t} else if (val >= minnum) {\r\n\t\t\t\t\tcell.qnum = val;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeCellQnum_XMLBoard: function() {\r\n\t\t\tvar minnum = this.board.cell[0].getminnum() > 0 ? 1 : 0;\r\n\t\t\tvar undecnum = this.UNDECIDED_NUM_XML;\r\n\t\t\tthis.encodeCellXMLBoard(function(cell) {\r\n\t\t\t\tvar val = null;\r\n\t\t\t\tif (cell.qnum === -2) {\r\n\t\t\t\t\tval = undecnum;\r\n\t\t\t\t} else if (cell.qnum >= minnum) {\r\n\t\t\t\t\tval = cell.qnum;\r\n\t\t\t\t}\r\n\t\t\t\treturn val;\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeCellQnum_XMLBoard() pencilbox XML用問題用数字(browタイプ)のデコードを行う\r\n\t\t// fio.encodeCellQnum_XMLBoard() pencilbox XML用問題用数字(browタイプ)のエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCellQnum_XMLBoard_Brow: function() {\r\n\t\t\tvar undecnum = this.UNDECIDED_NUM_XML;\r\n\t\t\tthis.decodeCellXMLBrow(function(cell, name) {\r\n\t\t\t\tif (name === \"n\" + undecnum) {\r\n\t\t\t\t\tcell.qnum = -2;\r\n\t\t\t\t} else if (name !== \"s\") {\r\n\t\t\t\t\tcell.qnum = +name.substr(1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeCellQnum_XMLBoard_Brow: function() {\r\n\t\t\tvar undecnum = this.UNDECIDED_NUM_XML;\r\n\t\t\tthis.encodeCellXMLBrow(function(cell) {\r\n\t\t\t\tif (cell.qnum === -2) {\r\n\t\t\t\t\treturn \"n\" + undecnum;\r\n\t\t\t\t} else if (cell.qnum >= 0) {\r\n\t\t\t\t\treturn \"n\" + cell.qnum;\r\n\t\t\t\t}\r\n\t\t\t\treturn \"s\";\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeCellAnum_XMLBoard() pencilbox XML用回答用数字のデコードを行う\r\n\t\t// fio.encodeCellAnum_XMLBoard() pencilbox XML用回答用数字のエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCellAnum_XMLAnswer: function() {\r\n\t\t\tthis.decodeCellXMLArow(function(cell, name) {\r\n\t\t\t\tif (name === \"n0\") {\r\n\t\t\t\t\tcell.anum = -1;\r\n\t\t\t\t} else if (name !== \"s\") {\r\n\t\t\t\t\tcell.anum = +name.substr(1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeCellAnum_XMLAnswer: function() {\r\n\t\t\tthis.encodeCellXMLArow(function(cell) {\r\n\t\t\t\tif (cell.anum > 0) {\r\n\t\t\t\t\treturn \"n\" + cell.anum;\r\n\t\t\t\t} else if (cell.anum === -1) {\r\n\t\t\t\t\treturn \"n0\";\r\n\t\t\t\t}\r\n\t\t\t\treturn \"s\";\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeAreaRoom_XMLBoard() pencilbox XML用問題用不定形部屋のデコードを行う\r\n\t\t// fio.encodeAreaRoom_XMLBoard() pencilbox XML用問題用不定形部屋のエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeAreaRoom_XMLBoard: function() {\r\n\t\t\tvar rdata = [];\r\n\t\t\tthis.decodeCellXMLBrow(function(cell, name) {\r\n\t\t\t\trdata.push(+name.substr(1));\r\n\t\t\t});\r\n\t\t\tthis.rdata2Border(true, rdata);\r\n\t\t\tthis.board.roommgr.rebuild();\r\n\t\t},\r\n\t\tencodeAreaRoom_XMLBoard: function() {\r\n\t\t\tvar bd = this.board;\r\n\t\t\tbd.roommgr.rebuild();\r\n\t\t\tvar rooms = bd.roommgr.components;\r\n\t\t\tthis.xmldoc\r\n\t\t\t\t.querySelector(\"board\")\r\n\t\t\t\t.appendChild(this.createXMLNode(\"areas\", { N: rooms.length }));\r\n\t\t\tthis.encodeCellXMLBrow(function(cell) {\r\n\t\t\t\tvar roomid = rooms.indexOf(cell.room);\r\n\t\t\t\treturn \"n\" + (roomid > 0 ? roomid : -1);\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeCellAns_XMLAnswer() pencilbox XML用黒マスのデコードを行う\r\n\t\t// fio.encodeCellAns_XMLAnswer() pencilbox XML用黒マスのエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeCellAns_XMLAnswer: function() {\r\n\t\t\tthis.decodeCellXMLArow(function(cell, name) {\r\n\t\t\t\tif (name === \"w\") {\r\n\t\t\t\t\tcell.qans = 1;\r\n\t\t\t\t} else if (name === \"s\") {\r\n\t\t\t\t\tcell.qsub = 1;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeCellAns_XMLAnswer: function() {\r\n\t\t\tthis.encodeCellXMLArow(function(cell) {\r\n\t\t\t\tif (cell.qans === 1) {\r\n\t\t\t\t\treturn \"w\";\r\n\t\t\t\t} else if (cell.qsub === 1) {\r\n\t\t\t\t\treturn \"s\";\r\n\t\t\t\t}\r\n\t\t\t\treturn \"u\";\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t//---------------------------------------------------------------------------\r\n\t\t// fio.decodeBorderLine_XMLAnswer() pencilbox XML用Lineのデコードを行う\r\n\t\t// fio.encodeBorderLine_XMLAnswer() pencilbox XML用Lineのエンコードを行う\r\n\t\t//---------------------------------------------------------------------------\r\n\t\tdecodeBorderLine_XMLAnswer: function() {\r\n\t\t\tthis.decodeCellXMLArow(function(cell, name) {\r\n\t\t\t\tvar val = 0;\r\n\t\t\t\tvar bdh = cell.adjborder.bottom,\r\n\t\t\t\t\tbdv = cell.adjborder.right;\r\n\t\t\t\tif (name.charAt(0) === \"n\") {\r\n\t\t\t\t\tval = +name.substr(1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (name.match(/h/)) {\r\n\t\t\t\t\t\tval += 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (name.match(/v/)) {\r\n\t\t\t\t\t\tval += 2;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (val & 1) {\r\n\t\t\t\t\tbdh.line = 1;\r\n\t\t\t\t}\r\n\t\t\t\tif (val & 2) {\r\n\t\t\t\t\tbdv.line = 1;\r\n\t\t\t\t}\r\n\t\t\t\tif (val & 4) {\r\n\t\t\t\t\tbdh.qsub = 2;\r\n\t\t\t\t}\r\n\t\t\t\tif (val & 8) {\r\n\t\t\t\t\tbdv.qsub = 2;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tencodeBorderLine_XMLAnswer: function() {\r\n\t\t\tthis.encodeCellXMLArow(function(cell) {\r\n\t\t\t\tvar val = 0,\r\n\t\t\t\t\tnodename = \"\";\r\n\t\t\t\tvar bdh = cell.adjborder.bottom,\r\n\t\t\t\t\tbdv = cell.adjborder.right;\r\n\t\t\t\tif (bdh.line === 1) {\r\n\t\t\t\t\tval += 1;\r\n\t\t\t\t}\r\n\t\t\t\tif (bdv.line === 1) {\r\n\t\t\t\t\tval += 2;\r\n\t\t\t\t}\r\n\t\t\t\tif (bdh.qsub === 2) {\r\n\t\t\t\t\tval += 4;\r\n\t\t\t\t}\r\n\t\t\t\tif (bdv.qsub === 2) {\r\n\t\t\t\t\tval += 8;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (val === 0) {\r\n\t\t\t\t\tnodename = \"s\";\r\n\t\t\t\t} else if (val === 1) {\r\n\t\t\t\t\tnodename = \"h\";\r\n\t\t\t\t} else if (val === 2) {\r\n\t\t\t\t\tnodename = \"v\";\r\n\t\t\t\t} else if (val === 3) {\r\n\t\t\t\t\tnodename = \"hv\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnodename = \"n\" + val;\r\n\t\t\t\t}\r\n\t\t\t\treturn nodename;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n});\r\n","// Operation.js\r\n\r\npzpr.classmgr.makeCommon({\r\n\t//---------------------------------------------------------\r\n\t\"StartGoalOperation:Operation\": {\r\n\t\tsetData: function(prop, x1, y1, x2, y2) {\r\n\t\t\tthis.property = prop;\r\n\t\t\tthis.bx1 = x1;\r\n\t\t\tthis.by1 = y1;\r\n\t\t\tthis.bx2 = x2;\r\n\t\t\tthis.by2 = y2;\r\n\t\t},\r\n\t\tdecode: function(strs) {\r\n\t\t\tif (strs[0] !== \"PS\" && strs[0] !== \"PG\") {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tthis.property = strs[0] === \"PS\" ? \"start\" : \"goal\";\r\n\t\t\tthis.bx1 = +strs[1];\r\n\t\t\tthis.by1 = +strs[2];\r\n\t\t\tthis.bx2 = +strs[3];\r\n\t\t\tthis.by2 = +strs[4];\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\ttoString: function() {\r\n\t\t\treturn [\r\n\t\t\t\tthis.property === \"start\" ? \"PS\" : \"PG\",\r\n\t\t\t\tthis.bx1,\r\n\t\t\t\tthis.by1,\r\n\t\t\t\tthis.bx2,\r\n\t\t\t\tthis.by2\r\n\t\t\t].join(\",\");\r\n\t\t},\r\n\r\n\t\tisModify: function(lastope) {\r\n\t\t\t// 1回の入力でstartpos, goalposが連続して更新されているなら前回の更新のみ\r\n\t\t\tif (\r\n\t\t\t\tthis.manager.changeflag &&\r\n\t\t\t\tlastope.bx2 === this.bx1 &&\r\n\t\t\t\tlastope.by2 === this.by1 &&\r\n\t\t\t\tlastope.property === this.property\r\n\t\t\t) {\r\n\t\t\t\tlastope.bx2 = this.bx2;\r\n\t\t\t\tlastope.by2 = this.by2;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\tundo: function() {\r\n\t\t\tthis.exec(this.bx1, this.by1);\r\n\t\t},\r\n\t\tredo: function() {\r\n\t\t\tthis.exec(this.bx2, this.by2);\r\n\t\t},\r\n\t\texec: function(bx, by) {\r\n\t\t\tvar bd = this.board,\r\n\t\t\t\tcell = bd.getc(bx, by);\r\n\t\t\tif (this.property === \"start\") {\r\n\t\t\t\tbd.startpos.set(cell);\r\n\t\t\t} else if (this.property === \"goal\") {\r\n\t\t\t\tbd.goalpos.set(cell);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n","// Piece.js\r\n\r\npzpr.classmgr.makeCommon({\r\n\t//---------------------------------------------------------\r\n\t\"StartGoalAddress:Address\": {\r\n\t\ttype: \"\",\r\n\t\tpartner: null,\r\n\r\n\t\tinit: function(bx, by) {\r\n\t\t\tthis.bx = bx;\r\n\t\t\tthis.by = by;\r\n\t\t\treturn this;\r\n\t\t},\r\n\r\n\t\tinput: function(cell) {\r\n\t\t\tif (!this.partner.equals(cell)) {\r\n\t\t\t\tif (!this.equals(cell)) {\r\n\t\t\t\t\tthis.set(cell);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.draw();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.board.exchangestartgoal();\r\n\t\t\t}\r\n\t\t},\r\n\t\tset: function(pos) {\r\n\t\t\tvar pos0 = this.getaddr();\r\n\t\t\tthis.addOpe(pos.bx, pos.by);\r\n\r\n\t\t\tthis.bx = pos.bx;\r\n\t\t\tthis.by = pos.by;\r\n\r\n\t\t\tpos0.draw();\r\n\t\t\tthis.draw();\r\n\t\t},\r\n\r\n\t\taddOpe: function(bx, by) {\r\n\t\t\tif (this.bx === bx && this.by === by) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.puzzle.opemgr.add(\r\n\t\t\t\tnew this.klass.StartGoalOperation(this.type, this.bx, this.by, bx, by)\r\n\t\t\t);\r\n\t\t}\r\n\t},\r\n\t\"StartAddress:StartGoalAddress\": {\r\n\t\ttype: \"start\"\r\n\t},\r\n\t\"GoalAddress:StartGoalAddress\": {\r\n\t\ttype: \"goal\"\r\n\t}\r\n});\r\n"]}